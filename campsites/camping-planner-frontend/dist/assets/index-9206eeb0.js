function FT(e,r){for(var o=0;o<r.length;o++){const u=r[o];if(typeof u!="string"&&!Array.isArray(u)){for(const f in u)if(f!=="default"&&!(f in e)){const v=Object.getOwnPropertyDescriptor(u,f);v&&Object.defineProperty(e,f,v.get?v:{enumerable:!0,get:()=>u[f]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))u(f);new MutationObserver(f=>{for(const v of f)if(v.type==="childList")for(const T of v.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&u(T)}).observe(document,{childList:!0,subtree:!0});function o(f){const v={};return f.integrity&&(v.integrity=f.integrity),f.referrerPolicy&&(v.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?v.credentials="include":f.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function u(f){if(f.ep)return;f.ep=!0;const v=o(f);fetch(f.href,v)}})();var OT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var k1={exports:{}},af={},P1={exports:{}},zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ah=Symbol.for("react.element"),BT=Symbol.for("react.portal"),NT=Symbol.for("react.fragment"),jT=Symbol.for("react.strict_mode"),UT=Symbol.for("react.profiler"),VT=Symbol.for("react.provider"),$T=Symbol.for("react.context"),qT=Symbol.for("react.forward_ref"),GT=Symbol.for("react.suspense"),ZT=Symbol.for("react.memo"),HT=Symbol.for("react.lazy"),A0=Symbol.iterator;function WT(e){return e===null||typeof e!="object"?null:(e=A0&&e[A0]||e["@@iterator"],typeof e=="function"?e:null)}var A1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M1=Object.assign,z1={};function Pc(e,r,o){this.props=e,this.context=r,this.refs=z1,this.updater=o||A1}Pc.prototype.isReactComponent={};Pc.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Pc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function R1(){}R1.prototype=Pc.prototype;function Vy(e,r,o){this.props=e,this.context=r,this.refs=z1,this.updater=o||A1}var $y=Vy.prototype=new R1;$y.constructor=Vy;M1($y,Pc.prototype);$y.isPureReactComponent=!0;var M0=Array.isArray,D1=Object.prototype.hasOwnProperty,qy={current:null},L1={key:!0,ref:!0,__self:!0,__source:!0};function F1(e,r,o){var u,f={},v=null,T=null;if(r!=null)for(u in r.ref!==void 0&&(T=r.ref),r.key!==void 0&&(v=""+r.key),r)D1.call(r,u)&&!L1.hasOwnProperty(u)&&(f[u]=r[u]);var c=arguments.length-2;if(c===1)f.children=o;else if(1<c){for(var z=Array(c),P=0;P<c;P++)z[P]=arguments[P+2];f.children=z}if(e&&e.defaultProps)for(u in c=e.defaultProps,c)f[u]===void 0&&(f[u]=c[u]);return{$$typeof:Ah,type:e,key:v,ref:T,props:f,_owner:qy.current}}function KT(e,r){return{$$typeof:Ah,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function Gy(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ah}function XT(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return r[o]})}var z0=/\/+/g;function qm(e,r){return typeof e=="object"&&e!==null&&e.key!=null?XT(""+e.key):r.toString(36)}function hp(e,r,o,u,f){var v=typeof e;(v==="undefined"||v==="boolean")&&(e=null);var T=!1;if(e===null)T=!0;else switch(v){case"string":case"number":T=!0;break;case"object":switch(e.$$typeof){case Ah:case BT:T=!0}}if(T)return T=e,f=f(T),e=u===""?"."+qm(T,0):u,M0(f)?(o="",e!=null&&(o=e.replace(z0,"$&/")+"/"),hp(f,r,o,"",function(P){return P})):f!=null&&(Gy(f)&&(f=KT(f,o+(!f.key||T&&T.key===f.key?"":(""+f.key).replace(z0,"$&/")+"/")+e)),r.push(f)),1;if(T=0,u=u===""?".":u+":",M0(e))for(var c=0;c<e.length;c++){v=e[c];var z=u+qm(v,c);T+=hp(v,r,o,z,f)}else if(z=WT(e),typeof z=="function")for(e=z.call(e),c=0;!(v=e.next()).done;)v=v.value,z=u+qm(v,c++),T+=hp(v,r,o,z,f);else if(v==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return T}function Gd(e,r,o){if(e==null)return e;var u=[],f=0;return hp(e,u,"","",function(v){return r.call(o,v,f++)}),u}function YT(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var ni={current:null},dp={transition:null},JT={ReactCurrentDispatcher:ni,ReactCurrentBatchConfig:dp,ReactCurrentOwner:qy};zt.Children={map:Gd,forEach:function(e,r,o){Gd(e,function(){r.apply(this,arguments)},o)},count:function(e){var r=0;return Gd(e,function(){r++}),r},toArray:function(e){return Gd(e,function(r){return r})||[]},only:function(e){if(!Gy(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};zt.Component=Pc;zt.Fragment=NT;zt.Profiler=UT;zt.PureComponent=Vy;zt.StrictMode=jT;zt.Suspense=GT;zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JT;zt.cloneElement=function(e,r,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var u=M1({},e.props),f=e.key,v=e.ref,T=e._owner;if(r!=null){if(r.ref!==void 0&&(v=r.ref,T=qy.current),r.key!==void 0&&(f=""+r.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(z in r)D1.call(r,z)&&!L1.hasOwnProperty(z)&&(u[z]=r[z]===void 0&&c!==void 0?c[z]:r[z])}var z=arguments.length-2;if(z===1)u.children=o;else if(1<z){c=Array(z);for(var P=0;P<z;P++)c[P]=arguments[P+2];u.children=c}return{$$typeof:Ah,type:e.type,key:f,ref:v,props:u,_owner:T}};zt.createContext=function(e){return e={$$typeof:$T,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:VT,_context:e},e.Consumer=e};zt.createElement=F1;zt.createFactory=function(e){var r=F1.bind(null,e);return r.type=e,r};zt.createRef=function(){return{current:null}};zt.forwardRef=function(e){return{$$typeof:qT,render:e}};zt.isValidElement=Gy;zt.lazy=function(e){return{$$typeof:HT,_payload:{_status:-1,_result:e},_init:YT}};zt.memo=function(e,r){return{$$typeof:ZT,type:e,compare:r===void 0?null:r}};zt.startTransition=function(e){var r=dp.transition;dp.transition={};try{e()}finally{dp.transition=r}};zt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};zt.useCallback=function(e,r){return ni.current.useCallback(e,r)};zt.useContext=function(e){return ni.current.useContext(e)};zt.useDebugValue=function(){};zt.useDeferredValue=function(e){return ni.current.useDeferredValue(e)};zt.useEffect=function(e,r){return ni.current.useEffect(e,r)};zt.useId=function(){return ni.current.useId()};zt.useImperativeHandle=function(e,r,o){return ni.current.useImperativeHandle(e,r,o)};zt.useInsertionEffect=function(e,r){return ni.current.useInsertionEffect(e,r)};zt.useLayoutEffect=function(e,r){return ni.current.useLayoutEffect(e,r)};zt.useMemo=function(e,r){return ni.current.useMemo(e,r)};zt.useReducer=function(e,r,o){return ni.current.useReducer(e,r,o)};zt.useRef=function(e){return ni.current.useRef(e)};zt.useState=function(e){return ni.current.useState(e)};zt.useSyncExternalStore=function(e,r,o){return ni.current.useSyncExternalStore(e,r,o)};zt.useTransition=function(){return ni.current.useTransition()};zt.version="18.2.0";P1.exports=zt;var lt=P1.exports;const Ja=C1(lt),QT=FT({__proto__:null,default:Ja},[lt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eE=lt,tE=Symbol.for("react.element"),nE=Symbol.for("react.fragment"),rE=Object.prototype.hasOwnProperty,iE=eE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sE={key:!0,ref:!0,__self:!0,__source:!0};function O1(e,r,o){var u,f={},v=null,T=null;o!==void 0&&(v=""+o),r.key!==void 0&&(v=""+r.key),r.ref!==void 0&&(T=r.ref);for(u in r)rE.call(r,u)&&!sE.hasOwnProperty(u)&&(f[u]=r[u]);if(e&&e.defaultProps)for(u in r=e.defaultProps,r)f[u]===void 0&&(f[u]=r[u]);return{$$typeof:tE,type:e,key:v,ref:T,props:f,_owner:iE.current}}af.Fragment=nE;af.jsx=O1;af.jsxs=O1;k1.exports=af;var ce=k1.exports,Ag={},B1={exports:{}},zi={},N1={exports:{}},j1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(We,dt){var pt=We.length;We.push(dt);e:for(;0<pt;){var jt=pt-1>>>1,Rt=We[jt];if(0<f(Rt,dt))We[jt]=dt,We[pt]=Rt,pt=jt;else break e}}function o(We){return We.length===0?null:We[0]}function u(We){if(We.length===0)return null;var dt=We[0],pt=We.pop();if(pt!==dt){We[0]=pt;e:for(var jt=0,Rt=We.length,Pt=Rt>>>1;jt<Pt;){var Zt=2*(jt+1)-1,cr=We[Zt],zn=Zt+1,jn=We[zn];if(0>f(cr,pt))zn<Rt&&0>f(jn,cr)?(We[jt]=jn,We[zn]=pt,jt=zn):(We[jt]=cr,We[Zt]=pt,jt=Zt);else if(zn<Rt&&0>f(jn,pt))We[jt]=jn,We[zn]=pt,jt=zn;else break e}}return dt}function f(We,dt){var pt=We.sortIndex-dt.sortIndex;return pt!==0?pt:We.id-dt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;e.unstable_now=function(){return v.now()}}else{var T=Date,c=T.now();e.unstable_now=function(){return T.now()-c}}var z=[],P=[],V=1,U=null,N=3,le=!1,ie=!1,ge=!1,Me=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(We){for(var dt=o(P);dt!==null;){if(dt.callback===null)u(P);else if(dt.startTime<=We)u(P),dt.sortIndex=dt.expirationTime,r(z,dt);else break;dt=o(P)}}function xe(We){if(ge=!1,se(We),!ie)if(o(z)!==null)ie=!0,er(Ae);else{var dt=o(P);dt!==null&&tn(xe,dt.startTime-We)}}function Ae(We,dt){ie=!1,ge&&(ge=!1,X(qe),qe=-1),le=!0;var pt=N;try{for(se(dt),U=o(z);U!==null&&(!(U.expirationTime>dt)||We&&!An());){var jt=U.callback;if(typeof jt=="function"){U.callback=null,N=U.priorityLevel;var Rt=jt(U.expirationTime<=dt);dt=e.unstable_now(),typeof Rt=="function"?U.callback=Rt:U===o(z)&&u(z),se(dt)}else u(z);U=o(z)}if(U!==null)var Pt=!0;else{var Zt=o(P);Zt!==null&&tn(xe,Zt.startTime-dt),Pt=!1}return Pt}finally{U=null,N=pt,le=!1}}var Fe=!1,De=null,qe=-1,Gt=5,it=-1;function An(){return!(e.unstable_now()-it<Gt)}function Nn(){if(De!==null){var We=e.unstable_now();it=We;var dt=!0;try{dt=De(!0,We)}finally{dt?lr():(Fe=!1,De=null)}}else Fe=!1}var lr;if(typeof Y=="function")lr=function(){Y(Nn)};else if(typeof MessageChannel<"u"){var Mn=new MessageChannel,Qn=Mn.port2;Mn.port1.onmessage=Nn,lr=function(){Qn.postMessage(null)}}else lr=function(){Me(Nn,0)};function er(We){De=We,Fe||(Fe=!0,lr())}function tn(We,dt){qe=Me(function(){We(e.unstable_now())},dt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(We){We.callback=null},e.unstable_continueExecution=function(){ie||le||(ie=!0,er(Ae))},e.unstable_forceFrameRate=function(We){0>We||125<We?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Gt=0<We?Math.floor(1e3/We):5},e.unstable_getCurrentPriorityLevel=function(){return N},e.unstable_getFirstCallbackNode=function(){return o(z)},e.unstable_next=function(We){switch(N){case 1:case 2:case 3:var dt=3;break;default:dt=N}var pt=N;N=dt;try{return We()}finally{N=pt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(We,dt){switch(We){case 1:case 2:case 3:case 4:case 5:break;default:We=3}var pt=N;N=We;try{return dt()}finally{N=pt}},e.unstable_scheduleCallback=function(We,dt,pt){var jt=e.unstable_now();switch(typeof pt=="object"&&pt!==null?(pt=pt.delay,pt=typeof pt=="number"&&0<pt?jt+pt:jt):pt=jt,We){case 1:var Rt=-1;break;case 2:Rt=250;break;case 5:Rt=1073741823;break;case 4:Rt=1e4;break;default:Rt=5e3}return Rt=pt+Rt,We={id:V++,callback:dt,priorityLevel:We,startTime:pt,expirationTime:Rt,sortIndex:-1},pt>jt?(We.sortIndex=pt,r(P,We),o(z)===null&&We===o(P)&&(ge?(X(qe),qe=-1):ge=!0,tn(xe,pt-jt))):(We.sortIndex=Rt,r(z,We),ie||le||(ie=!0,er(Ae))),We},e.unstable_shouldYield=An,e.unstable_wrapCallback=function(We){var dt=N;return function(){var pt=N;N=dt;try{return We.apply(this,arguments)}finally{N=pt}}}})(j1);N1.exports=j1;var oE=N1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U1=lt,Mi=oE;function Ne(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var V1=new Set,hh={};function il(e,r){mc(e,r),mc(e+"Capture",r)}function mc(e,r){for(hh[e]=r,e=0;e<r.length;e++)V1.add(r[e])}var _o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mg=Object.prototype.hasOwnProperty,aE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,R0={},D0={};function lE(e){return Mg.call(D0,e)?!0:Mg.call(R0,e)?!1:aE.test(e)?D0[e]=!0:(R0[e]=!0,!1)}function cE(e,r,o,u){if(o!==null&&o.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return u?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function uE(e,r,o,u){if(r===null||typeof r>"u"||cE(e,r,o,u))return!0;if(u)return!1;if(o!==null)switch(o.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function ri(e,r,o,u,f,v,T){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=u,this.attributeNamespace=f,this.mustUseProperty=o,this.propertyName=e,this.type=r,this.sanitizeURL=v,this.removeEmptyString=T}var Pr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pr[e]=new ri(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];Pr[r]=new ri(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pr[e]=new ri(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pr[e]=new ri(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pr[e]=new ri(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pr[e]=new ri(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pr[e]=new ri(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pr[e]=new ri(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pr[e]=new ri(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zy=/[\-:]([a-z])/g;function Hy(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(Zy,Hy);Pr[r]=new ri(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(Zy,Hy);Pr[r]=new ri(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(Zy,Hy);Pr[r]=new ri(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pr[e]=new ri(e,1,!1,e.toLowerCase(),null,!1,!1)});Pr.xlinkHref=new ri("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pr[e]=new ri(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wy(e,r,o,u){var f=Pr.hasOwnProperty(r)?Pr[r]:null;(f!==null?f.type!==0:u||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(uE(r,o,f,u)&&(o=null),u||f===null?lE(r)&&(o===null?e.removeAttribute(r):e.setAttribute(r,""+o)):f.mustUseProperty?e[f.propertyName]=o===null?f.type===3?!1:"":o:(r=f.attributeName,u=f.attributeNamespace,o===null?e.removeAttribute(r):(f=f.type,o=f===3||f===4&&o===!0?"":""+o,u?e.setAttributeNS(u,r,o):e.setAttribute(r,o))))}var bo=U1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zd=Symbol.for("react.element"),Wl=Symbol.for("react.portal"),Kl=Symbol.for("react.fragment"),Ky=Symbol.for("react.strict_mode"),zg=Symbol.for("react.profiler"),$1=Symbol.for("react.provider"),q1=Symbol.for("react.context"),Xy=Symbol.for("react.forward_ref"),Rg=Symbol.for("react.suspense"),Dg=Symbol.for("react.suspense_list"),Yy=Symbol.for("react.memo"),Xo=Symbol.for("react.lazy"),G1=Symbol.for("react.offscreen"),L0=Symbol.iterator;function ju(e){return e===null||typeof e!="object"?null:(e=L0&&e[L0]||e["@@iterator"],typeof e=="function"?e:null)}var Pn=Object.assign,Gm;function Ku(e){if(Gm===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Gm=r&&r[1]||""}return`
`+Gm+e}var Zm=!1;function Hm(e,r){if(!e||Zm)return"";Zm=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(P){var u=P}Reflect.construct(e,[],r)}else{try{r.call()}catch(P){u=P}e.call(r.prototype)}else{try{throw Error()}catch(P){u=P}e()}}catch(P){if(P&&u&&typeof P.stack=="string"){for(var f=P.stack.split(`
`),v=u.stack.split(`
`),T=f.length-1,c=v.length-1;1<=T&&0<=c&&f[T]!==v[c];)c--;for(;1<=T&&0<=c;T--,c--)if(f[T]!==v[c]){if(T!==1||c!==1)do if(T--,c--,0>c||f[T]!==v[c]){var z=`
`+f[T].replace(" at new "," at ");return e.displayName&&z.includes("<anonymous>")&&(z=z.replace("<anonymous>",e.displayName)),z}while(1<=T&&0<=c);break}}}finally{Zm=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?Ku(e):""}function hE(e){switch(e.tag){case 5:return Ku(e.type);case 16:return Ku("Lazy");case 13:return Ku("Suspense");case 19:return Ku("SuspenseList");case 0:case 2:case 15:return e=Hm(e.type,!1),e;case 11:return e=Hm(e.type.render,!1),e;case 1:return e=Hm(e.type,!0),e;default:return""}}function Lg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Kl:return"Fragment";case Wl:return"Portal";case zg:return"Profiler";case Ky:return"StrictMode";case Rg:return"Suspense";case Dg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case q1:return(e.displayName||"Context")+".Consumer";case $1:return(e._context.displayName||"Context")+".Provider";case Xy:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yy:return r=e.displayName||null,r!==null?r:Lg(e.type)||"Memo";case Xo:r=e._payload,e=e._init;try{return Lg(e(r))}catch{}}return null}function dE(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lg(r);case 8:return r===Ky?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function da(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Z1(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function pE(e){var r=Z1(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),u=""+e[r];if(!e.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var f=o.get,v=o.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return f.call(this)},set:function(T){u=""+T,v.call(this,T)}}),Object.defineProperty(e,r,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function Hd(e){e._valueTracker||(e._valueTracker=pE(e))}function H1(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return e&&(u=Z1(e)?e.checked?"true":"false":e.value),e=u,e!==o?(r.setValue(e),!0):!1}function Mp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Fg(e,r){var o=r.checked;return Pn({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function F0(e,r){var o=r.defaultValue==null?"":r.defaultValue,u=r.checked!=null?r.checked:r.defaultChecked;o=da(r.value!=null?r.value:o),e._wrapperState={initialChecked:u,initialValue:o,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function W1(e,r){r=r.checked,r!=null&&Wy(e,"checked",r,!1)}function Og(e,r){W1(e,r);var o=da(r.value),u=r.type;if(o!=null)u==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?Bg(e,r.type,o):r.hasOwnProperty("defaultValue")&&Bg(e,r.type,da(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function O0(e,r,o){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var u=r.type;if(!(u!=="submit"&&u!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,o||r===e.value||(e.value=r),e.defaultValue=r}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function Bg(e,r,o){(r!=="number"||Mp(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var Xu=Array.isArray;function lc(e,r,o,u){if(e=e.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<e.length;o++)f=r.hasOwnProperty("$"+e[o].value),e[o].selected!==f&&(e[o].selected=f),f&&u&&(e[o].defaultSelected=!0)}else{for(o=""+da(o),r=null,f=0;f<e.length;f++){if(e[f].value===o){e[f].selected=!0,u&&(e[f].defaultSelected=!0);return}r!==null||e[f].disabled||(r=e[f])}r!==null&&(r.selected=!0)}}function Ng(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(Ne(91));return Pn({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function B0(e,r){var o=r.value;if(o==null){if(o=r.children,r=r.defaultValue,o!=null){if(r!=null)throw Error(Ne(92));if(Xu(o)){if(1<o.length)throw Error(Ne(93));o=o[0]}r=o}r==null&&(r=""),o=r}e._wrapperState={initialValue:da(o)}}function K1(e,r){var o=da(r.value),u=da(r.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),r.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),u!=null&&(e.defaultValue=""+u)}function N0(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function X1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jg(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?X1(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Wd,Y1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,o,u,f){MSApp.execUnsafeLocalFunction(function(){return e(r,o,u,f)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(Wd=Wd||document.createElement("div"),Wd.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Wd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function dh(e,r){if(r){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=r;return}}e.textContent=r}var th={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fE=["Webkit","ms","Moz","O"];Object.keys(th).forEach(function(e){fE.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),th[r]=th[e]})});function J1(e,r,o){return r==null||typeof r=="boolean"||r===""?"":o||typeof r!="number"||r===0||th.hasOwnProperty(e)&&th[e]?(""+r).trim():r+"px"}function Q1(e,r){e=e.style;for(var o in r)if(r.hasOwnProperty(o)){var u=o.indexOf("--")===0,f=J1(o,r[o],u);o==="float"&&(o="cssFloat"),u?e.setProperty(o,f):e[o]=f}}var mE=Pn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ug(e,r){if(r){if(mE[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(Ne(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(Ne(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(Ne(61))}if(r.style!=null&&typeof r.style!="object")throw Error(Ne(62))}}function Vg(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $g=null;function Jy(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qg=null,cc=null,uc=null;function j0(e){if(e=Rh(e)){if(typeof qg!="function")throw Error(Ne(280));var r=e.stateNode;r&&(r=df(r),qg(e.stateNode,e.type,r))}}function ew(e){cc?uc?uc.push(e):uc=[e]:cc=e}function tw(){if(cc){var e=cc,r=uc;if(uc=cc=null,j0(e),r)for(e=0;e<r.length;e++)j0(r[e])}}function nw(e,r){return e(r)}function rw(){}var Wm=!1;function iw(e,r,o){if(Wm)return e(r,o);Wm=!0;try{return nw(e,r,o)}finally{Wm=!1,(cc!==null||uc!==null)&&(rw(),tw())}}function ph(e,r){var o=e.stateNode;if(o===null)return null;var u=df(o);if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(Ne(231,r,typeof o));return o}var Gg=!1;if(_o)try{var Uu={};Object.defineProperty(Uu,"passive",{get:function(){Gg=!0}}),window.addEventListener("test",Uu,Uu),window.removeEventListener("test",Uu,Uu)}catch{Gg=!1}function gE(e,r,o,u,f,v,T,c,z){var P=Array.prototype.slice.call(arguments,3);try{r.apply(o,P)}catch(V){this.onError(V)}}var nh=!1,zp=null,Rp=!1,Zg=null,yE={onError:function(e){nh=!0,zp=e}};function _E(e,r,o,u,f,v,T,c,z){nh=!1,zp=null,gE.apply(yE,arguments)}function vE(e,r,o,u,f,v,T,c,z){if(_E.apply(this,arguments),nh){if(nh){var P=zp;nh=!1,zp=null}else throw Error(Ne(198));Rp||(Rp=!0,Zg=P)}}function sl(e){var r=e,o=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(o=r.return),e=r.return;while(e)}return r.tag===3?o:null}function sw(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function U0(e){if(sl(e)!==e)throw Error(Ne(188))}function xE(e){var r=e.alternate;if(!r){if(r=sl(e),r===null)throw Error(Ne(188));return r!==e?null:e}for(var o=e,u=r;;){var f=o.return;if(f===null)break;var v=f.alternate;if(v===null){if(u=f.return,u!==null){o=u;continue}break}if(f.child===v.child){for(v=f.child;v;){if(v===o)return U0(f),e;if(v===u)return U0(f),r;v=v.sibling}throw Error(Ne(188))}if(o.return!==u.return)o=f,u=v;else{for(var T=!1,c=f.child;c;){if(c===o){T=!0,o=f,u=v;break}if(c===u){T=!0,u=f,o=v;break}c=c.sibling}if(!T){for(c=v.child;c;){if(c===o){T=!0,o=v,u=f;break}if(c===u){T=!0,u=v,o=f;break}c=c.sibling}if(!T)throw Error(Ne(189))}}if(o.alternate!==u)throw Error(Ne(190))}if(o.tag!==3)throw Error(Ne(188));return o.stateNode.current===o?e:r}function ow(e){return e=xE(e),e!==null?aw(e):null}function aw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=aw(e);if(r!==null)return r;e=e.sibling}return null}var lw=Mi.unstable_scheduleCallback,V0=Mi.unstable_cancelCallback,wE=Mi.unstable_shouldYield,bE=Mi.unstable_requestPaint,Kn=Mi.unstable_now,SE=Mi.unstable_getCurrentPriorityLevel,Qy=Mi.unstable_ImmediatePriority,cw=Mi.unstable_UserBlockingPriority,Dp=Mi.unstable_NormalPriority,TE=Mi.unstable_LowPriority,uw=Mi.unstable_IdlePriority,lf=null,Ns=null;function EE(e){if(Ns&&typeof Ns.onCommitFiberRoot=="function")try{Ns.onCommitFiberRoot(lf,e,void 0,(e.current.flags&128)===128)}catch{}}var ys=Math.clz32?Math.clz32:kE,IE=Math.log,CE=Math.LN2;function kE(e){return e>>>=0,e===0?32:31-(IE(e)/CE|0)|0}var Kd=64,Xd=4194304;function Yu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Lp(e,r){var o=e.pendingLanes;if(o===0)return 0;var u=0,f=e.suspendedLanes,v=e.pingedLanes,T=o&268435455;if(T!==0){var c=T&~f;c!==0?u=Yu(c):(v&=T,v!==0&&(u=Yu(v)))}else T=o&~f,T!==0?u=Yu(T):v!==0&&(u=Yu(v));if(u===0)return 0;if(r!==0&&r!==u&&!(r&f)&&(f=u&-u,v=r&-r,f>=v||f===16&&(v&4194240)!==0))return r;if(u&4&&(u|=o&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=u;0<r;)o=31-ys(r),f=1<<o,u|=e[o],r&=~f;return u}function PE(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AE(e,r){for(var o=e.suspendedLanes,u=e.pingedLanes,f=e.expirationTimes,v=e.pendingLanes;0<v;){var T=31-ys(v),c=1<<T,z=f[T];z===-1?(!(c&o)||c&u)&&(f[T]=PE(c,r)):z<=r&&(e.expiredLanes|=c),v&=~c}}function Hg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function hw(){var e=Kd;return Kd<<=1,!(Kd&4194240)&&(Kd=64),e}function Km(e){for(var r=[],o=0;31>o;o++)r.push(e);return r}function Mh(e,r,o){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-ys(r),e[r]=o}function ME(e,r){var o=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<o;){var f=31-ys(o),v=1<<f;r[f]=0,u[f]=-1,e[f]=-1,o&=~v}}function e_(e,r){var o=e.entangledLanes|=r;for(e=e.entanglements;o;){var u=31-ys(o),f=1<<u;f&r|e[u]&r&&(e[u]|=r),o&=~f}}var Yt=0;function dw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var pw,t_,fw,mw,gw,Wg=!1,Yd=[],ia=null,sa=null,oa=null,fh=new Map,mh=new Map,Jo=[],zE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $0(e,r){switch(e){case"focusin":case"focusout":ia=null;break;case"dragenter":case"dragleave":sa=null;break;case"mouseover":case"mouseout":oa=null;break;case"pointerover":case"pointerout":fh.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":mh.delete(r.pointerId)}}function Vu(e,r,o,u,f,v){return e===null||e.nativeEvent!==v?(e={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:v,targetContainers:[f]},r!==null&&(r=Rh(r),r!==null&&t_(r)),e):(e.eventSystemFlags|=u,r=e.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),e)}function RE(e,r,o,u,f){switch(r){case"focusin":return ia=Vu(ia,e,r,o,u,f),!0;case"dragenter":return sa=Vu(sa,e,r,o,u,f),!0;case"mouseover":return oa=Vu(oa,e,r,o,u,f),!0;case"pointerover":var v=f.pointerId;return fh.set(v,Vu(fh.get(v)||null,e,r,o,u,f)),!0;case"gotpointercapture":return v=f.pointerId,mh.set(v,Vu(mh.get(v)||null,e,r,o,u,f)),!0}return!1}function yw(e){var r=qa(e.target);if(r!==null){var o=sl(r);if(o!==null){if(r=o.tag,r===13){if(r=sw(o),r!==null){e.blockedOn=r,gw(e.priority,function(){fw(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function pp(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var o=Kg(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var u=new o.constructor(o.type,o);$g=u,o.target.dispatchEvent(u),$g=null}else return r=Rh(o),r!==null&&t_(r),e.blockedOn=o,!1;r.shift()}return!0}function q0(e,r,o){pp(e)&&o.delete(r)}function DE(){Wg=!1,ia!==null&&pp(ia)&&(ia=null),sa!==null&&pp(sa)&&(sa=null),oa!==null&&pp(oa)&&(oa=null),fh.forEach(q0),mh.forEach(q0)}function $u(e,r){e.blockedOn===r&&(e.blockedOn=null,Wg||(Wg=!0,Mi.unstable_scheduleCallback(Mi.unstable_NormalPriority,DE)))}function gh(e){function r(f){return $u(f,e)}if(0<Yd.length){$u(Yd[0],e);for(var o=1;o<Yd.length;o++){var u=Yd[o];u.blockedOn===e&&(u.blockedOn=null)}}for(ia!==null&&$u(ia,e),sa!==null&&$u(sa,e),oa!==null&&$u(oa,e),fh.forEach(r),mh.forEach(r),o=0;o<Jo.length;o++)u=Jo[o],u.blockedOn===e&&(u.blockedOn=null);for(;0<Jo.length&&(o=Jo[0],o.blockedOn===null);)yw(o),o.blockedOn===null&&Jo.shift()}var hc=bo.ReactCurrentBatchConfig,Fp=!0;function LE(e,r,o,u){var f=Yt,v=hc.transition;hc.transition=null;try{Yt=1,n_(e,r,o,u)}finally{Yt=f,hc.transition=v}}function FE(e,r,o,u){var f=Yt,v=hc.transition;hc.transition=null;try{Yt=4,n_(e,r,o,u)}finally{Yt=f,hc.transition=v}}function n_(e,r,o,u){if(Fp){var f=Kg(e,r,o,u);if(f===null)sg(e,r,u,Op,o),$0(e,u);else if(RE(f,e,r,o,u))u.stopPropagation();else if($0(e,u),r&4&&-1<zE.indexOf(e)){for(;f!==null;){var v=Rh(f);if(v!==null&&pw(v),v=Kg(e,r,o,u),v===null&&sg(e,r,u,Op,o),v===f)break;f=v}f!==null&&u.stopPropagation()}else sg(e,r,u,null,o)}}var Op=null;function Kg(e,r,o,u){if(Op=null,e=Jy(u),e=qa(e),e!==null)if(r=sl(e),r===null)e=null;else if(o=r.tag,o===13){if(e=sw(r),e!==null)return e;e=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return Op=e,null}function _w(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(SE()){case Qy:return 1;case cw:return 4;case Dp:case TE:return 16;case uw:return 536870912;default:return 16}default:return 16}}var ea=null,r_=null,fp=null;function vw(){if(fp)return fp;var e,r=r_,o=r.length,u,f="value"in ea?ea.value:ea.textContent,v=f.length;for(e=0;e<o&&r[e]===f[e];e++);var T=o-e;for(u=1;u<=T&&r[o-u]===f[v-u];u++);return fp=f.slice(e,1<u?1-u:void 0)}function mp(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function Jd(){return!0}function G0(){return!1}function Ri(e){function r(o,u,f,v,T){this._reactName=o,this._targetInst=f,this.type=u,this.nativeEvent=v,this.target=T,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(o=e[c],this[c]=o?o(v):v[c]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Jd:G0,this.isPropagationStopped=G0,this}return Pn(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Jd)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Jd)},persist:function(){},isPersistent:Jd}),r}var Ac={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},i_=Ri(Ac),zh=Pn({},Ac,{view:0,detail:0}),OE=Ri(zh),Xm,Ym,qu,cf=Pn({},zh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:s_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==qu&&(qu&&e.type==="mousemove"?(Xm=e.screenX-qu.screenX,Ym=e.screenY-qu.screenY):Ym=Xm=0,qu=e),Xm)},movementY:function(e){return"movementY"in e?e.movementY:Ym}}),Z0=Ri(cf),BE=Pn({},cf,{dataTransfer:0}),NE=Ri(BE),jE=Pn({},zh,{relatedTarget:0}),Jm=Ri(jE),UE=Pn({},Ac,{animationName:0,elapsedTime:0,pseudoElement:0}),VE=Ri(UE),$E=Pn({},Ac,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),qE=Ri($E),GE=Pn({},Ac,{data:0}),H0=Ri(GE),ZE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KE(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=WE[e])?!!r[e]:!1}function s_(){return KE}var XE=Pn({},zh,{key:function(e){if(e.key){var r=ZE[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=mp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?HE[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:s_,charCode:function(e){return e.type==="keypress"?mp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?mp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),YE=Ri(XE),JE=Pn({},cf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),W0=Ri(JE),QE=Pn({},zh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:s_}),eI=Ri(QE),tI=Pn({},Ac,{propertyName:0,elapsedTime:0,pseudoElement:0}),nI=Ri(tI),rI=Pn({},cf,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),iI=Ri(rI),sI=[9,13,27,32],o_=_o&&"CompositionEvent"in window,rh=null;_o&&"documentMode"in document&&(rh=document.documentMode);var oI=_o&&"TextEvent"in window&&!rh,xw=_o&&(!o_||rh&&8<rh&&11>=rh),K0=String.fromCharCode(32),X0=!1;function ww(e,r){switch(e){case"keyup":return sI.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xl=!1;function aI(e,r){switch(e){case"compositionend":return bw(r);case"keypress":return r.which!==32?null:(X0=!0,K0);case"textInput":return e=r.data,e===K0&&X0?null:e;default:return null}}function lI(e,r){if(Xl)return e==="compositionend"||!o_&&ww(e,r)?(e=vw(),fp=r_=ea=null,Xl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return xw&&r.locale!=="ko"?null:r.data;default:return null}}var cI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Y0(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!cI[e.type]:r==="textarea"}function Sw(e,r,o,u){ew(u),r=Bp(r,"onChange"),0<r.length&&(o=new i_("onChange","change",null,o,u),e.push({event:o,listeners:r}))}var ih=null,yh=null;function uI(e){Dw(e,0)}function uf(e){var r=Ql(e);if(H1(r))return e}function hI(e,r){if(e==="change")return r}var Tw=!1;if(_o){var Qm;if(_o){var eg="oninput"in document;if(!eg){var J0=document.createElement("div");J0.setAttribute("oninput","return;"),eg=typeof J0.oninput=="function"}Qm=eg}else Qm=!1;Tw=Qm&&(!document.documentMode||9<document.documentMode)}function Q0(){ih&&(ih.detachEvent("onpropertychange",Ew),yh=ih=null)}function Ew(e){if(e.propertyName==="value"&&uf(yh)){var r=[];Sw(r,yh,e,Jy(e)),iw(uI,r)}}function dI(e,r,o){e==="focusin"?(Q0(),ih=r,yh=o,ih.attachEvent("onpropertychange",Ew)):e==="focusout"&&Q0()}function pI(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return uf(yh)}function fI(e,r){if(e==="click")return uf(r)}function mI(e,r){if(e==="input"||e==="change")return uf(r)}function gI(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var xs=typeof Object.is=="function"?Object.is:gI;function _h(e,r){if(xs(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var o=Object.keys(e),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var f=o[u];if(!Mg.call(r,f)||!xs(e[f],r[f]))return!1}return!0}function ex(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tx(e,r){var o=ex(e);e=0;for(var u;o;){if(o.nodeType===3){if(u=e+o.textContent.length,e<=r&&u>=r)return{node:o,offset:r-e};e=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ex(o)}}function Iw(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?Iw(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function Cw(){for(var e=window,r=Mp();r instanceof e.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)e=r.contentWindow;else break;r=Mp(e.document)}return r}function a_(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function yI(e){var r=Cw(),o=e.focusedElem,u=e.selectionRange;if(r!==o&&o&&o.ownerDocument&&Iw(o.ownerDocument.documentElement,o)){if(u!==null&&a_(o)){if(r=u.start,e=u.end,e===void 0&&(e=r),"selectionStart"in o)o.selectionStart=r,o.selectionEnd=Math.min(e,o.value.length);else if(e=(r=o.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var f=o.textContent.length,v=Math.min(u.start,f);u=u.end===void 0?v:Math.min(u.end,f),!e.extend&&v>u&&(f=u,u=v,v=f),f=tx(o,v);var T=tx(o,u);f&&T&&(e.rangeCount!==1||e.anchorNode!==f.node||e.anchorOffset!==f.offset||e.focusNode!==T.node||e.focusOffset!==T.offset)&&(r=r.createRange(),r.setStart(f.node,f.offset),e.removeAllRanges(),v>u?(e.addRange(r),e.extend(T.node,T.offset)):(r.setEnd(T.node,T.offset),e.addRange(r)))}}for(r=[],e=o;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<r.length;o++)e=r[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _I=_o&&"documentMode"in document&&11>=document.documentMode,Yl=null,Xg=null,sh=null,Yg=!1;function nx(e,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Yg||Yl==null||Yl!==Mp(u)||(u=Yl,"selectionStart"in u&&a_(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),sh&&_h(sh,u)||(sh=u,u=Bp(Xg,"onSelect"),0<u.length&&(r=new i_("onSelect","select",null,r,o),e.push({event:r,listeners:u}),r.target=Yl)))}function Qd(e,r){var o={};return o[e.toLowerCase()]=r.toLowerCase(),o["Webkit"+e]="webkit"+r,o["Moz"+e]="moz"+r,o}var Jl={animationend:Qd("Animation","AnimationEnd"),animationiteration:Qd("Animation","AnimationIteration"),animationstart:Qd("Animation","AnimationStart"),transitionend:Qd("Transition","TransitionEnd")},tg={},kw={};_o&&(kw=document.createElement("div").style,"AnimationEvent"in window||(delete Jl.animationend.animation,delete Jl.animationiteration.animation,delete Jl.animationstart.animation),"TransitionEvent"in window||delete Jl.transitionend.transition);function hf(e){if(tg[e])return tg[e];if(!Jl[e])return e;var r=Jl[e],o;for(o in r)if(r.hasOwnProperty(o)&&o in kw)return tg[e]=r[o];return e}var Pw=hf("animationend"),Aw=hf("animationiteration"),Mw=hf("animationstart"),zw=hf("transitionend"),Rw=new Map,rx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ma(e,r){Rw.set(e,r),il(r,[e])}for(var ng=0;ng<rx.length;ng++){var rg=rx[ng],vI=rg.toLowerCase(),xI=rg[0].toUpperCase()+rg.slice(1);ma(vI,"on"+xI)}ma(Pw,"onAnimationEnd");ma(Aw,"onAnimationIteration");ma(Mw,"onAnimationStart");ma("dblclick","onDoubleClick");ma("focusin","onFocus");ma("focusout","onBlur");ma(zw,"onTransitionEnd");mc("onMouseEnter",["mouseout","mouseover"]);mc("onMouseLeave",["mouseout","mouseover"]);mc("onPointerEnter",["pointerout","pointerover"]);mc("onPointerLeave",["pointerout","pointerover"]);il("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));il("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));il("onBeforeInput",["compositionend","keypress","textInput","paste"]);il("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));il("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));il("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ju));function ix(e,r,o){var u=e.type||"unknown-event";e.currentTarget=o,vE(u,r,void 0,e),e.currentTarget=null}function Dw(e,r){r=(r&4)!==0;for(var o=0;o<e.length;o++){var u=e[o],f=u.event;u=u.listeners;e:{var v=void 0;if(r)for(var T=u.length-1;0<=T;T--){var c=u[T],z=c.instance,P=c.currentTarget;if(c=c.listener,z!==v&&f.isPropagationStopped())break e;ix(f,c,P),v=z}else for(T=0;T<u.length;T++){if(c=u[T],z=c.instance,P=c.currentTarget,c=c.listener,z!==v&&f.isPropagationStopped())break e;ix(f,c,P),v=z}}}if(Rp)throw e=Zg,Rp=!1,Zg=null,e}function mn(e,r){var o=r[ny];o===void 0&&(o=r[ny]=new Set);var u=e+"__bubble";o.has(u)||(Lw(r,e,2,!1),o.add(u))}function ig(e,r,o){var u=0;r&&(u|=4),Lw(o,e,u,r)}var ep="_reactListening"+Math.random().toString(36).slice(2);function vh(e){if(!e[ep]){e[ep]=!0,V1.forEach(function(o){o!=="selectionchange"&&(wI.has(o)||ig(o,!1,e),ig(o,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[ep]||(r[ep]=!0,ig("selectionchange",!1,r))}}function Lw(e,r,o,u){switch(_w(r)){case 1:var f=LE;break;case 4:f=FE;break;default:f=n_}o=f.bind(null,r,o,e),f=void 0,!Gg||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?e.addEventListener(r,o,{capture:!0,passive:f}):e.addEventListener(r,o,!0):f!==void 0?e.addEventListener(r,o,{passive:f}):e.addEventListener(r,o,!1)}function sg(e,r,o,u,f){var v=u;if(!(r&1)&&!(r&2)&&u!==null)e:for(;;){if(u===null)return;var T=u.tag;if(T===3||T===4){var c=u.stateNode.containerInfo;if(c===f||c.nodeType===8&&c.parentNode===f)break;if(T===4)for(T=u.return;T!==null;){var z=T.tag;if((z===3||z===4)&&(z=T.stateNode.containerInfo,z===f||z.nodeType===8&&z.parentNode===f))return;T=T.return}for(;c!==null;){if(T=qa(c),T===null)return;if(z=T.tag,z===5||z===6){u=v=T;continue e}c=c.parentNode}}u=u.return}iw(function(){var P=v,V=Jy(o),U=[];e:{var N=Rw.get(e);if(N!==void 0){var le=i_,ie=e;switch(e){case"keypress":if(mp(o)===0)break e;case"keydown":case"keyup":le=YE;break;case"focusin":ie="focus",le=Jm;break;case"focusout":ie="blur",le=Jm;break;case"beforeblur":case"afterblur":le=Jm;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=Z0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=NE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=eI;break;case Pw:case Aw:case Mw:le=VE;break;case zw:le=nI;break;case"scroll":le=OE;break;case"wheel":le=iI;break;case"copy":case"cut":case"paste":le=qE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=W0}var ge=(r&4)!==0,Me=!ge&&e==="scroll",X=ge?N!==null?N+"Capture":null:N;ge=[];for(var Y=P,se;Y!==null;){se=Y;var xe=se.stateNode;if(se.tag===5&&xe!==null&&(se=xe,X!==null&&(xe=ph(Y,X),xe!=null&&ge.push(xh(Y,xe,se)))),Me)break;Y=Y.return}0<ge.length&&(N=new le(N,ie,null,o,V),U.push({event:N,listeners:ge}))}}if(!(r&7)){e:{if(N=e==="mouseover"||e==="pointerover",le=e==="mouseout"||e==="pointerout",N&&o!==$g&&(ie=o.relatedTarget||o.fromElement)&&(qa(ie)||ie[vo]))break e;if((le||N)&&(N=V.window===V?V:(N=V.ownerDocument)?N.defaultView||N.parentWindow:window,le?(ie=o.relatedTarget||o.toElement,le=P,ie=ie?qa(ie):null,ie!==null&&(Me=sl(ie),ie!==Me||ie.tag!==5&&ie.tag!==6)&&(ie=null)):(le=null,ie=P),le!==ie)){if(ge=Z0,xe="onMouseLeave",X="onMouseEnter",Y="mouse",(e==="pointerout"||e==="pointerover")&&(ge=W0,xe="onPointerLeave",X="onPointerEnter",Y="pointer"),Me=le==null?N:Ql(le),se=ie==null?N:Ql(ie),N=new ge(xe,Y+"leave",le,o,V),N.target=Me,N.relatedTarget=se,xe=null,qa(V)===P&&(ge=new ge(X,Y+"enter",ie,o,V),ge.target=se,ge.relatedTarget=Me,xe=ge),Me=xe,le&&ie)t:{for(ge=le,X=ie,Y=0,se=ge;se;se=Zl(se))Y++;for(se=0,xe=X;xe;xe=Zl(xe))se++;for(;0<Y-se;)ge=Zl(ge),Y--;for(;0<se-Y;)X=Zl(X),se--;for(;Y--;){if(ge===X||X!==null&&ge===X.alternate)break t;ge=Zl(ge),X=Zl(X)}ge=null}else ge=null;le!==null&&sx(U,N,le,ge,!1),ie!==null&&Me!==null&&sx(U,Me,ie,ge,!0)}}e:{if(N=P?Ql(P):window,le=N.nodeName&&N.nodeName.toLowerCase(),le==="select"||le==="input"&&N.type==="file")var Ae=hI;else if(Y0(N))if(Tw)Ae=mI;else{Ae=pI;var Fe=dI}else(le=N.nodeName)&&le.toLowerCase()==="input"&&(N.type==="checkbox"||N.type==="radio")&&(Ae=fI);if(Ae&&(Ae=Ae(e,P))){Sw(U,Ae,o,V);break e}Fe&&Fe(e,N,P),e==="focusout"&&(Fe=N._wrapperState)&&Fe.controlled&&N.type==="number"&&Bg(N,"number",N.value)}switch(Fe=P?Ql(P):window,e){case"focusin":(Y0(Fe)||Fe.contentEditable==="true")&&(Yl=Fe,Xg=P,sh=null);break;case"focusout":sh=Xg=Yl=null;break;case"mousedown":Yg=!0;break;case"contextmenu":case"mouseup":case"dragend":Yg=!1,nx(U,o,V);break;case"selectionchange":if(_I)break;case"keydown":case"keyup":nx(U,o,V)}var De;if(o_)e:{switch(e){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else Xl?ww(e,o)&&(qe="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(qe="onCompositionStart");qe&&(xw&&o.locale!=="ko"&&(Xl||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Xl&&(De=vw()):(ea=V,r_="value"in ea?ea.value:ea.textContent,Xl=!0)),Fe=Bp(P,qe),0<Fe.length&&(qe=new H0(qe,e,null,o,V),U.push({event:qe,listeners:Fe}),De?qe.data=De:(De=bw(o),De!==null&&(qe.data=De)))),(De=oI?aI(e,o):lI(e,o))&&(P=Bp(P,"onBeforeInput"),0<P.length&&(V=new H0("onBeforeInput","beforeinput",null,o,V),U.push({event:V,listeners:P}),V.data=De))}Dw(U,r)})}function xh(e,r,o){return{instance:e,listener:r,currentTarget:o}}function Bp(e,r){for(var o=r+"Capture",u=[];e!==null;){var f=e,v=f.stateNode;f.tag===5&&v!==null&&(f=v,v=ph(e,o),v!=null&&u.unshift(xh(e,v,f)),v=ph(e,r),v!=null&&u.push(xh(e,v,f))),e=e.return}return u}function Zl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function sx(e,r,o,u,f){for(var v=r._reactName,T=[];o!==null&&o!==u;){var c=o,z=c.alternate,P=c.stateNode;if(z!==null&&z===u)break;c.tag===5&&P!==null&&(c=P,f?(z=ph(o,v),z!=null&&T.unshift(xh(o,z,c))):f||(z=ph(o,v),z!=null&&T.push(xh(o,z,c)))),o=o.return}T.length!==0&&e.push({event:r,listeners:T})}var bI=/\r\n?/g,SI=/\u0000|\uFFFD/g;function ox(e){return(typeof e=="string"?e:""+e).replace(bI,`
`).replace(SI,"")}function tp(e,r,o){if(r=ox(r),ox(e)!==r&&o)throw Error(Ne(425))}function Np(){}var Jg=null,Qg=null;function ey(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var ty=typeof setTimeout=="function"?setTimeout:void 0,TI=typeof clearTimeout=="function"?clearTimeout:void 0,ax=typeof Promise=="function"?Promise:void 0,EI=typeof queueMicrotask=="function"?queueMicrotask:typeof ax<"u"?function(e){return ax.resolve(null).then(e).catch(II)}:ty;function II(e){setTimeout(function(){throw e})}function og(e,r){var o=r,u=0;do{var f=o.nextSibling;if(e.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"){if(u===0){e.removeChild(f),gh(r);return}u--}else o!=="$"&&o!=="$?"&&o!=="$!"||u++;o=f}while(o);gh(r)}function aa(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function lx(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return e;r--}else o==="/$"&&r++}e=e.previousSibling}return null}var Mc=Math.random().toString(36).slice(2),Os="__reactFiber$"+Mc,wh="__reactProps$"+Mc,vo="__reactContainer$"+Mc,ny="__reactEvents$"+Mc,CI="__reactListeners$"+Mc,kI="__reactHandles$"+Mc;function qa(e){var r=e[Os];if(r)return r;for(var o=e.parentNode;o;){if(r=o[vo]||o[Os]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(e=lx(e);e!==null;){if(o=e[Os])return o;e=lx(e)}return r}e=o,o=e.parentNode}return null}function Rh(e){return e=e[Os]||e[vo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ql(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ne(33))}function df(e){return e[wh]||null}var ry=[],ec=-1;function ga(e){return{current:e}}function yn(e){0>ec||(e.current=ry[ec],ry[ec]=null,ec--)}function cn(e,r){ec++,ry[ec]=e.current,e.current=r}var pa={},$r=ga(pa),vi=ga(!1),Qa=pa;function gc(e,r){var o=e.type.contextTypes;if(!o)return pa;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===r)return u.__reactInternalMemoizedMaskedChildContext;var f={},v;for(v in o)f[v]=r[v];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=f),f}function xi(e){return e=e.childContextTypes,e!=null}function jp(){yn(vi),yn($r)}function cx(e,r,o){if($r.current!==pa)throw Error(Ne(168));cn($r,r),cn(vi,o)}function Fw(e,r,o){var u=e.stateNode;if(r=r.childContextTypes,typeof u.getChildContext!="function")return o;u=u.getChildContext();for(var f in u)if(!(f in r))throw Error(Ne(108,dE(e)||"Unknown",f));return Pn({},o,u)}function Up(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||pa,Qa=$r.current,cn($r,e),cn(vi,vi.current),!0}function ux(e,r,o){var u=e.stateNode;if(!u)throw Error(Ne(169));o?(e=Fw(e,r,Qa),u.__reactInternalMemoizedMergedChildContext=e,yn(vi),yn($r),cn($r,e)):yn(vi),cn(vi,o)}var po=null,pf=!1,ag=!1;function Ow(e){po===null?po=[e]:po.push(e)}function PI(e){pf=!0,Ow(e)}function ya(){if(!ag&&po!==null){ag=!0;var e=0,r=Yt;try{var o=po;for(Yt=1;e<o.length;e++){var u=o[e];do u=u(!0);while(u!==null)}po=null,pf=!1}catch(f){throw po!==null&&(po=po.slice(e+1)),lw(Qy,ya),f}finally{Yt=r,ag=!1}}return null}var tc=[],nc=0,Vp=null,$p=0,Gi=[],Zi=0,el=null,fo=1,mo="";function Va(e,r){tc[nc++]=$p,tc[nc++]=Vp,Vp=e,$p=r}function Bw(e,r,o){Gi[Zi++]=fo,Gi[Zi++]=mo,Gi[Zi++]=el,el=e;var u=fo;e=mo;var f=32-ys(u)-1;u&=~(1<<f),o+=1;var v=32-ys(r)+f;if(30<v){var T=f-f%5;v=(u&(1<<T)-1).toString(32),u>>=T,f-=T,fo=1<<32-ys(r)+f|o<<f|u,mo=v+e}else fo=1<<v|o<<f|u,mo=e}function l_(e){e.return!==null&&(Va(e,1),Bw(e,1,0))}function c_(e){for(;e===Vp;)Vp=tc[--nc],tc[nc]=null,$p=tc[--nc],tc[nc]=null;for(;e===el;)el=Gi[--Zi],Gi[Zi]=null,mo=Gi[--Zi],Gi[Zi]=null,fo=Gi[--Zi],Gi[Zi]=null}var Ai=null,Pi=null,wn=!1,gs=null;function Nw(e,r){var o=Hi(5,null,null,0);o.elementType="DELETED",o.stateNode=r,o.return=e,r=e.deletions,r===null?(e.deletions=[o],e.flags|=16):r.push(o)}function hx(e,r){switch(e.tag){case 5:var o=e.type;return r=r.nodeType!==1||o.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,Ai=e,Pi=aa(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,Ai=e,Pi=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(o=el!==null?{id:fo,overflow:mo}:null,e.memoizedState={dehydrated:r,treeContext:o,retryLane:1073741824},o=Hi(18,null,null,0),o.stateNode=r,o.return=e,e.child=o,Ai=e,Pi=null,!0):!1;default:return!1}}function iy(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sy(e){if(wn){var r=Pi;if(r){var o=r;if(!hx(e,r)){if(iy(e))throw Error(Ne(418));r=aa(o.nextSibling);var u=Ai;r&&hx(e,r)?Nw(u,o):(e.flags=e.flags&-4097|2,wn=!1,Ai=e)}}else{if(iy(e))throw Error(Ne(418));e.flags=e.flags&-4097|2,wn=!1,Ai=e}}}function dx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ai=e}function np(e){if(e!==Ai)return!1;if(!wn)return dx(e),wn=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!ey(e.type,e.memoizedProps)),r&&(r=Pi)){if(iy(e))throw jw(),Error(Ne(418));for(;r;)Nw(e,r),r=aa(r.nextSibling)}if(dx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ne(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(r===0){Pi=aa(e.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++}e=e.nextSibling}Pi=null}}else Pi=Ai?aa(e.stateNode.nextSibling):null;return!0}function jw(){for(var e=Pi;e;)e=aa(e.nextSibling)}function yc(){Pi=Ai=null,wn=!1}function u_(e){gs===null?gs=[e]:gs.push(e)}var AI=bo.ReactCurrentBatchConfig;function fs(e,r){if(e&&e.defaultProps){r=Pn({},r),e=e.defaultProps;for(var o in e)r[o]===void 0&&(r[o]=e[o]);return r}return r}var qp=ga(null),Gp=null,rc=null,h_=null;function d_(){h_=rc=Gp=null}function p_(e){var r=qp.current;yn(qp),e._currentValue=r}function oy(e,r,o){for(;e!==null;){var u=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),e===o)break;e=e.return}}function dc(e,r){Gp=e,h_=rc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(yi=!0),e.firstContext=null)}function Xi(e){var r=e._currentValue;if(h_!==e)if(e={context:e,memoizedValue:r,next:null},rc===null){if(Gp===null)throw Error(Ne(308));rc=e,Gp.dependencies={lanes:0,firstContext:e}}else rc=rc.next=e;return r}var Ga=null;function f_(e){Ga===null?Ga=[e]:Ga.push(e)}function Uw(e,r,o,u){var f=r.interleaved;return f===null?(o.next=o,f_(r)):(o.next=f.next,f.next=o),r.interleaved=o,xo(e,u)}function xo(e,r){e.lanes|=r;var o=e.alternate;for(o!==null&&(o.lanes|=r),o=e,e=e.return;e!==null;)e.childLanes|=r,o=e.alternate,o!==null&&(o.childLanes|=r),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Yo=!1;function m_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vw(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function go(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function la(e,r,o){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,Nt&2){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,xo(e,o)}return f=u.interleaved,f===null?(r.next=r,f_(u)):(r.next=f.next,f.next=r),u.interleaved=r,xo(e,o)}function gp(e,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194240)!==0)){var u=r.lanes;u&=e.pendingLanes,o|=u,r.lanes=o,e_(e,o)}}function px(e,r){var o=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var f=null,v=null;if(o=o.firstBaseUpdate,o!==null){do{var T={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};v===null?f=v=T:v=v.next=T,o=o.next}while(o!==null);v===null?f=v=r:v=v.next=r}else f=v=r;o={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:v,shared:u.shared,effects:u.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=r:e.next=r,o.lastBaseUpdate=r}function Zp(e,r,o,u){var f=e.updateQueue;Yo=!1;var v=f.firstBaseUpdate,T=f.lastBaseUpdate,c=f.shared.pending;if(c!==null){f.shared.pending=null;var z=c,P=z.next;z.next=null,T===null?v=P:T.next=P,T=z;var V=e.alternate;V!==null&&(V=V.updateQueue,c=V.lastBaseUpdate,c!==T&&(c===null?V.firstBaseUpdate=P:c.next=P,V.lastBaseUpdate=z))}if(v!==null){var U=f.baseState;T=0,V=P=z=null,c=v;do{var N=c.lane,le=c.eventTime;if((u&N)===N){V!==null&&(V=V.next={eventTime:le,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var ie=e,ge=c;switch(N=r,le=o,ge.tag){case 1:if(ie=ge.payload,typeof ie=="function"){U=ie.call(le,U,N);break e}U=ie;break e;case 3:ie.flags=ie.flags&-65537|128;case 0:if(ie=ge.payload,N=typeof ie=="function"?ie.call(le,U,N):ie,N==null)break e;U=Pn({},U,N);break e;case 2:Yo=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,N=f.effects,N===null?f.effects=[c]:N.push(c))}else le={eventTime:le,lane:N,tag:c.tag,payload:c.payload,callback:c.callback,next:null},V===null?(P=V=le,z=U):V=V.next=le,T|=N;if(c=c.next,c===null){if(c=f.shared.pending,c===null)break;N=c,c=N.next,N.next=null,f.lastBaseUpdate=N,f.shared.pending=null}}while(1);if(V===null&&(z=U),f.baseState=z,f.firstBaseUpdate=P,f.lastBaseUpdate=V,r=f.shared.interleaved,r!==null){f=r;do T|=f.lane,f=f.next;while(f!==r)}else v===null&&(f.shared.lanes=0);nl|=T,e.lanes=T,e.memoizedState=U}}function fx(e,r,o){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var u=e[r],f=u.callback;if(f!==null){if(u.callback=null,u=o,typeof f!="function")throw Error(Ne(191,f));f.call(u)}}}var $w=new U1.Component().refs;function ay(e,r,o,u){r=e.memoizedState,o=o(u,r),o=o==null?r:Pn({},r,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var ff={isMounted:function(e){return(e=e._reactInternals)?sl(e)===e:!1},enqueueSetState:function(e,r,o){e=e._reactInternals;var u=ti(),f=ua(e),v=go(u,f);v.payload=r,o!=null&&(v.callback=o),r=la(e,v,f),r!==null&&(_s(r,e,f,u),gp(r,e,f))},enqueueReplaceState:function(e,r,o){e=e._reactInternals;var u=ti(),f=ua(e),v=go(u,f);v.tag=1,v.payload=r,o!=null&&(v.callback=o),r=la(e,v,f),r!==null&&(_s(r,e,f,u),gp(r,e,f))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var o=ti(),u=ua(e),f=go(o,u);f.tag=2,r!=null&&(f.callback=r),r=la(e,f,u),r!==null&&(_s(r,e,u,o),gp(r,e,u))}};function mx(e,r,o,u,f,v,T){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,v,T):r.prototype&&r.prototype.isPureReactComponent?!_h(o,u)||!_h(f,v):!0}function qw(e,r,o){var u=!1,f=pa,v=r.contextType;return typeof v=="object"&&v!==null?v=Xi(v):(f=xi(r)?Qa:$r.current,u=r.contextTypes,v=(u=u!=null)?gc(e,f):pa),r=new r(o,v),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=ff,e.stateNode=r,r._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=f,e.__reactInternalMemoizedMaskedChildContext=v),r}function gx(e,r,o,u){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==e&&ff.enqueueReplaceState(r,r.state,null)}function ly(e,r,o,u){var f=e.stateNode;f.props=o,f.state=e.memoizedState,f.refs=$w,m_(e);var v=r.contextType;typeof v=="object"&&v!==null?f.context=Xi(v):(v=xi(r)?Qa:$r.current,f.context=gc(e,v)),f.state=e.memoizedState,v=r.getDerivedStateFromProps,typeof v=="function"&&(ay(e,r,v,o),f.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(r=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),r!==f.state&&ff.enqueueReplaceState(f,f.state,null),Zp(e,o,f,u),f.state=e.memoizedState),typeof f.componentDidMount=="function"&&(e.flags|=4194308)}function Gu(e,r,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(Ne(309));var u=o.stateNode}if(!u)throw Error(Ne(147,e));var f=u,v=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===v?r.ref:(r=function(T){var c=f.refs;c===$w&&(c=f.refs={}),T===null?delete c[v]:c[v]=T},r._stringRef=v,r)}if(typeof e!="string")throw Error(Ne(284));if(!o._owner)throw Error(Ne(290,e))}return e}function rp(e,r){throw e=Object.prototype.toString.call(r),Error(Ne(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function yx(e){var r=e._init;return r(e._payload)}function Gw(e){function r(X,Y){if(e){var se=X.deletions;se===null?(X.deletions=[Y],X.flags|=16):se.push(Y)}}function o(X,Y){if(!e)return null;for(;Y!==null;)r(X,Y),Y=Y.sibling;return null}function u(X,Y){for(X=new Map;Y!==null;)Y.key!==null?X.set(Y.key,Y):X.set(Y.index,Y),Y=Y.sibling;return X}function f(X,Y){return X=ha(X,Y),X.index=0,X.sibling=null,X}function v(X,Y,se){return X.index=se,e?(se=X.alternate,se!==null?(se=se.index,se<Y?(X.flags|=2,Y):se):(X.flags|=2,Y)):(X.flags|=1048576,Y)}function T(X){return e&&X.alternate===null&&(X.flags|=2),X}function c(X,Y,se,xe){return Y===null||Y.tag!==6?(Y=fg(se,X.mode,xe),Y.return=X,Y):(Y=f(Y,se),Y.return=X,Y)}function z(X,Y,se,xe){var Ae=se.type;return Ae===Kl?V(X,Y,se.props.children,xe,se.key):Y!==null&&(Y.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===Xo&&yx(Ae)===Y.type)?(xe=f(Y,se.props),xe.ref=Gu(X,Y,se),xe.return=X,xe):(xe=bp(se.type,se.key,se.props,null,X.mode,xe),xe.ref=Gu(X,Y,se),xe.return=X,xe)}function P(X,Y,se,xe){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==se.containerInfo||Y.stateNode.implementation!==se.implementation?(Y=mg(se,X.mode,xe),Y.return=X,Y):(Y=f(Y,se.children||[]),Y.return=X,Y)}function V(X,Y,se,xe,Ae){return Y===null||Y.tag!==7?(Y=Ka(se,X.mode,xe,Ae),Y.return=X,Y):(Y=f(Y,se),Y.return=X,Y)}function U(X,Y,se){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=fg(""+Y,X.mode,se),Y.return=X,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case Zd:return se=bp(Y.type,Y.key,Y.props,null,X.mode,se),se.ref=Gu(X,null,Y),se.return=X,se;case Wl:return Y=mg(Y,X.mode,se),Y.return=X,Y;case Xo:var xe=Y._init;return U(X,xe(Y._payload),se)}if(Xu(Y)||ju(Y))return Y=Ka(Y,X.mode,se,null),Y.return=X,Y;rp(X,Y)}return null}function N(X,Y,se,xe){var Ae=Y!==null?Y.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return Ae!==null?null:c(X,Y,""+se,xe);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case Zd:return se.key===Ae?z(X,Y,se,xe):null;case Wl:return se.key===Ae?P(X,Y,se,xe):null;case Xo:return Ae=se._init,N(X,Y,Ae(se._payload),xe)}if(Xu(se)||ju(se))return Ae!==null?null:V(X,Y,se,xe,null);rp(X,se)}return null}function le(X,Y,se,xe,Ae){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return X=X.get(se)||null,c(Y,X,""+xe,Ae);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case Zd:return X=X.get(xe.key===null?se:xe.key)||null,z(Y,X,xe,Ae);case Wl:return X=X.get(xe.key===null?se:xe.key)||null,P(Y,X,xe,Ae);case Xo:var Fe=xe._init;return le(X,Y,se,Fe(xe._payload),Ae)}if(Xu(xe)||ju(xe))return X=X.get(se)||null,V(Y,X,xe,Ae,null);rp(Y,xe)}return null}function ie(X,Y,se,xe){for(var Ae=null,Fe=null,De=Y,qe=Y=0,Gt=null;De!==null&&qe<se.length;qe++){De.index>qe?(Gt=De,De=null):Gt=De.sibling;var it=N(X,De,se[qe],xe);if(it===null){De===null&&(De=Gt);break}e&&De&&it.alternate===null&&r(X,De),Y=v(it,Y,qe),Fe===null?Ae=it:Fe.sibling=it,Fe=it,De=Gt}if(qe===se.length)return o(X,De),wn&&Va(X,qe),Ae;if(De===null){for(;qe<se.length;qe++)De=U(X,se[qe],xe),De!==null&&(Y=v(De,Y,qe),Fe===null?Ae=De:Fe.sibling=De,Fe=De);return wn&&Va(X,qe),Ae}for(De=u(X,De);qe<se.length;qe++)Gt=le(De,X,qe,se[qe],xe),Gt!==null&&(e&&Gt.alternate!==null&&De.delete(Gt.key===null?qe:Gt.key),Y=v(Gt,Y,qe),Fe===null?Ae=Gt:Fe.sibling=Gt,Fe=Gt);return e&&De.forEach(function(An){return r(X,An)}),wn&&Va(X,qe),Ae}function ge(X,Y,se,xe){var Ae=ju(se);if(typeof Ae!="function")throw Error(Ne(150));if(se=Ae.call(se),se==null)throw Error(Ne(151));for(var Fe=Ae=null,De=Y,qe=Y=0,Gt=null,it=se.next();De!==null&&!it.done;qe++,it=se.next()){De.index>qe?(Gt=De,De=null):Gt=De.sibling;var An=N(X,De,it.value,xe);if(An===null){De===null&&(De=Gt);break}e&&De&&An.alternate===null&&r(X,De),Y=v(An,Y,qe),Fe===null?Ae=An:Fe.sibling=An,Fe=An,De=Gt}if(it.done)return o(X,De),wn&&Va(X,qe),Ae;if(De===null){for(;!it.done;qe++,it=se.next())it=U(X,it.value,xe),it!==null&&(Y=v(it,Y,qe),Fe===null?Ae=it:Fe.sibling=it,Fe=it);return wn&&Va(X,qe),Ae}for(De=u(X,De);!it.done;qe++,it=se.next())it=le(De,X,qe,it.value,xe),it!==null&&(e&&it.alternate!==null&&De.delete(it.key===null?qe:it.key),Y=v(it,Y,qe),Fe===null?Ae=it:Fe.sibling=it,Fe=it);return e&&De.forEach(function(Nn){return r(X,Nn)}),wn&&Va(X,qe),Ae}function Me(X,Y,se,xe){if(typeof se=="object"&&se!==null&&se.type===Kl&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case Zd:e:{for(var Ae=se.key,Fe=Y;Fe!==null;){if(Fe.key===Ae){if(Ae=se.type,Ae===Kl){if(Fe.tag===7){o(X,Fe.sibling),Y=f(Fe,se.props.children),Y.return=X,X=Y;break e}}else if(Fe.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===Xo&&yx(Ae)===Fe.type){o(X,Fe.sibling),Y=f(Fe,se.props),Y.ref=Gu(X,Fe,se),Y.return=X,X=Y;break e}o(X,Fe);break}else r(X,Fe);Fe=Fe.sibling}se.type===Kl?(Y=Ka(se.props.children,X.mode,xe,se.key),Y.return=X,X=Y):(xe=bp(se.type,se.key,se.props,null,X.mode,xe),xe.ref=Gu(X,Y,se),xe.return=X,X=xe)}return T(X);case Wl:e:{for(Fe=se.key;Y!==null;){if(Y.key===Fe)if(Y.tag===4&&Y.stateNode.containerInfo===se.containerInfo&&Y.stateNode.implementation===se.implementation){o(X,Y.sibling),Y=f(Y,se.children||[]),Y.return=X,X=Y;break e}else{o(X,Y);break}else r(X,Y);Y=Y.sibling}Y=mg(se,X.mode,xe),Y.return=X,X=Y}return T(X);case Xo:return Fe=se._init,Me(X,Y,Fe(se._payload),xe)}if(Xu(se))return ie(X,Y,se,xe);if(ju(se))return ge(X,Y,se,xe);rp(X,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,Y!==null&&Y.tag===6?(o(X,Y.sibling),Y=f(Y,se),Y.return=X,X=Y):(o(X,Y),Y=fg(se,X.mode,xe),Y.return=X,X=Y),T(X)):o(X,Y)}return Me}var _c=Gw(!0),Zw=Gw(!1),Dh={},js=ga(Dh),bh=ga(Dh),Sh=ga(Dh);function Za(e){if(e===Dh)throw Error(Ne(174));return e}function g_(e,r){switch(cn(Sh,r),cn(bh,e),cn(js,Dh),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:jg(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=jg(r,e)}yn(js),cn(js,r)}function vc(){yn(js),yn(bh),yn(Sh)}function Hw(e){Za(Sh.current);var r=Za(js.current),o=jg(r,e.type);r!==o&&(cn(bh,e),cn(js,o))}function y_(e){bh.current===e&&(yn(js),yn(bh))}var In=ga(0);function Hp(e){for(var r=e;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var lg=[];function __(){for(var e=0;e<lg.length;e++)lg[e]._workInProgressVersionPrimary=null;lg.length=0}var yp=bo.ReactCurrentDispatcher,cg=bo.ReactCurrentBatchConfig,tl=0,Cn=null,or=null,yr=null,Wp=!1,oh=!1,Th=0,MI=0;function Nr(){throw Error(Ne(321))}function v_(e,r){if(r===null)return!1;for(var o=0;o<r.length&&o<e.length;o++)if(!xs(e[o],r[o]))return!1;return!0}function x_(e,r,o,u,f,v){if(tl=v,Cn=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,yp.current=e===null||e.memoizedState===null?LI:FI,e=o(u,f),oh){v=0;do{if(oh=!1,Th=0,25<=v)throw Error(Ne(301));v+=1,yr=or=null,r.updateQueue=null,yp.current=OI,e=o(u,f)}while(oh)}if(yp.current=Kp,r=or!==null&&or.next!==null,tl=0,yr=or=Cn=null,Wp=!1,r)throw Error(Ne(300));return e}function w_(){var e=Th!==0;return Th=0,e}function Ls(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?Cn.memoizedState=yr=e:yr=yr.next=e,yr}function Yi(){if(or===null){var e=Cn.alternate;e=e!==null?e.memoizedState:null}else e=or.next;var r=yr===null?Cn.memoizedState:yr.next;if(r!==null)yr=r,or=e;else{if(e===null)throw Error(Ne(310));or=e,e={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},yr===null?Cn.memoizedState=yr=e:yr=yr.next=e}return yr}function Eh(e,r){return typeof r=="function"?r(e):r}function ug(e){var r=Yi(),o=r.queue;if(o===null)throw Error(Ne(311));o.lastRenderedReducer=e;var u=or,f=u.baseQueue,v=o.pending;if(v!==null){if(f!==null){var T=f.next;f.next=v.next,v.next=T}u.baseQueue=f=v,o.pending=null}if(f!==null){v=f.next,u=u.baseState;var c=T=null,z=null,P=v;do{var V=P.lane;if((tl&V)===V)z!==null&&(z=z.next={lane:0,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),u=P.hasEagerState?P.eagerState:e(u,P.action);else{var U={lane:V,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null};z===null?(c=z=U,T=u):z=z.next=U,Cn.lanes|=V,nl|=V}P=P.next}while(P!==null&&P!==v);z===null?T=u:z.next=c,xs(u,r.memoizedState)||(yi=!0),r.memoizedState=u,r.baseState=T,r.baseQueue=z,o.lastRenderedState=u}if(e=o.interleaved,e!==null){f=e;do v=f.lane,Cn.lanes|=v,nl|=v,f=f.next;while(f!==e)}else f===null&&(o.lanes=0);return[r.memoizedState,o.dispatch]}function hg(e){var r=Yi(),o=r.queue;if(o===null)throw Error(Ne(311));o.lastRenderedReducer=e;var u=o.dispatch,f=o.pending,v=r.memoizedState;if(f!==null){o.pending=null;var T=f=f.next;do v=e(v,T.action),T=T.next;while(T!==f);xs(v,r.memoizedState)||(yi=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),o.lastRenderedState=v}return[v,u]}function Ww(){}function Kw(e,r){var o=Cn,u=Yi(),f=r(),v=!xs(u.memoizedState,f);if(v&&(u.memoizedState=f,yi=!0),u=u.queue,b_(Jw.bind(null,o,u,e),[e]),u.getSnapshot!==r||v||yr!==null&&yr.memoizedState.tag&1){if(o.flags|=2048,Ih(9,Yw.bind(null,o,u,f,r),void 0,null),vr===null)throw Error(Ne(349));tl&30||Xw(o,r,f)}return f}function Xw(e,r,o){e.flags|=16384,e={getSnapshot:r,value:o},r=Cn.updateQueue,r===null?(r={lastEffect:null,stores:null},Cn.updateQueue=r,r.stores=[e]):(o=r.stores,o===null?r.stores=[e]:o.push(e))}function Yw(e,r,o,u){r.value=o,r.getSnapshot=u,Qw(r)&&eb(e)}function Jw(e,r,o){return o(function(){Qw(r)&&eb(e)})}function Qw(e){var r=e.getSnapshot;e=e.value;try{var o=r();return!xs(e,o)}catch{return!0}}function eb(e){var r=xo(e,1);r!==null&&_s(r,e,1,-1)}function _x(e){var r=Ls();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eh,lastRenderedState:e},r.queue=e,e=e.dispatch=DI.bind(null,Cn,e),[r.memoizedState,e]}function Ih(e,r,o,u){return e={tag:e,create:r,destroy:o,deps:u,next:null},r=Cn.updateQueue,r===null?(r={lastEffect:null,stores:null},Cn.updateQueue=r,r.lastEffect=e.next=e):(o=r.lastEffect,o===null?r.lastEffect=e.next=e:(u=o.next,o.next=e,e.next=u,r.lastEffect=e)),e}function tb(){return Yi().memoizedState}function _p(e,r,o,u){var f=Ls();Cn.flags|=e,f.memoizedState=Ih(1|r,o,void 0,u===void 0?null:u)}function mf(e,r,o,u){var f=Yi();u=u===void 0?null:u;var v=void 0;if(or!==null){var T=or.memoizedState;if(v=T.destroy,u!==null&&v_(u,T.deps)){f.memoizedState=Ih(r,o,v,u);return}}Cn.flags|=e,f.memoizedState=Ih(1|r,o,v,u)}function vx(e,r){return _p(8390656,8,e,r)}function b_(e,r){return mf(2048,8,e,r)}function nb(e,r){return mf(4,2,e,r)}function rb(e,r){return mf(4,4,e,r)}function ib(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function sb(e,r,o){return o=o!=null?o.concat([e]):null,mf(4,4,ib.bind(null,r,e),o)}function S_(){}function ob(e,r){var o=Yi();r=r===void 0?null:r;var u=o.memoizedState;return u!==null&&r!==null&&v_(r,u[1])?u[0]:(o.memoizedState=[e,r],e)}function ab(e,r){var o=Yi();r=r===void 0?null:r;var u=o.memoizedState;return u!==null&&r!==null&&v_(r,u[1])?u[0]:(e=e(),o.memoizedState=[e,r],e)}function lb(e,r,o){return tl&21?(xs(o,r)||(o=hw(),Cn.lanes|=o,nl|=o,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,yi=!0),e.memoizedState=o)}function zI(e,r){var o=Yt;Yt=o!==0&&4>o?o:4,e(!0);var u=cg.transition;cg.transition={};try{e(!1),r()}finally{Yt=o,cg.transition=u}}function cb(){return Yi().memoizedState}function RI(e,r,o){var u=ua(e);if(o={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null},ub(e))hb(r,o);else if(o=Uw(e,r,o,u),o!==null){var f=ti();_s(o,e,u,f),db(o,r,u)}}function DI(e,r,o){var u=ua(e),f={lane:u,action:o,hasEagerState:!1,eagerState:null,next:null};if(ub(e))hb(r,f);else{var v=e.alternate;if(e.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var T=r.lastRenderedState,c=v(T,o);if(f.hasEagerState=!0,f.eagerState=c,xs(c,T)){var z=r.interleaved;z===null?(f.next=f,f_(r)):(f.next=z.next,z.next=f),r.interleaved=f;return}}catch{}finally{}o=Uw(e,r,f,u),o!==null&&(f=ti(),_s(o,e,u,f),db(o,r,u))}}function ub(e){var r=e.alternate;return e===Cn||r!==null&&r===Cn}function hb(e,r){oh=Wp=!0;var o=e.pending;o===null?r.next=r:(r.next=o.next,o.next=r),e.pending=r}function db(e,r,o){if(o&4194240){var u=r.lanes;u&=e.pendingLanes,o|=u,r.lanes=o,e_(e,o)}}var Kp={readContext:Xi,useCallback:Nr,useContext:Nr,useEffect:Nr,useImperativeHandle:Nr,useInsertionEffect:Nr,useLayoutEffect:Nr,useMemo:Nr,useReducer:Nr,useRef:Nr,useState:Nr,useDebugValue:Nr,useDeferredValue:Nr,useTransition:Nr,useMutableSource:Nr,useSyncExternalStore:Nr,useId:Nr,unstable_isNewReconciler:!1},LI={readContext:Xi,useCallback:function(e,r){return Ls().memoizedState=[e,r===void 0?null:r],e},useContext:Xi,useEffect:vx,useImperativeHandle:function(e,r,o){return o=o!=null?o.concat([e]):null,_p(4194308,4,ib.bind(null,r,e),o)},useLayoutEffect:function(e,r){return _p(4194308,4,e,r)},useInsertionEffect:function(e,r){return _p(4,2,e,r)},useMemo:function(e,r){var o=Ls();return r=r===void 0?null:r,e=e(),o.memoizedState=[e,r],e},useReducer:function(e,r,o){var u=Ls();return r=o!==void 0?o(r):r,u.memoizedState=u.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},u.queue=e,e=e.dispatch=RI.bind(null,Cn,e),[u.memoizedState,e]},useRef:function(e){var r=Ls();return e={current:e},r.memoizedState=e},useState:_x,useDebugValue:S_,useDeferredValue:function(e){return Ls().memoizedState=e},useTransition:function(){var e=_x(!1),r=e[0];return e=zI.bind(null,e[1]),Ls().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,o){var u=Cn,f=Ls();if(wn){if(o===void 0)throw Error(Ne(407));o=o()}else{if(o=r(),vr===null)throw Error(Ne(349));tl&30||Xw(u,r,o)}f.memoizedState=o;var v={value:o,getSnapshot:r};return f.queue=v,vx(Jw.bind(null,u,v,e),[e]),u.flags|=2048,Ih(9,Yw.bind(null,u,v,o,r),void 0,null),o},useId:function(){var e=Ls(),r=vr.identifierPrefix;if(wn){var o=mo,u=fo;o=(u&~(1<<32-ys(u)-1)).toString(32)+o,r=":"+r+"R"+o,o=Th++,0<o&&(r+="H"+o.toString(32)),r+=":"}else o=MI++,r=":"+r+"r"+o.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},FI={readContext:Xi,useCallback:ob,useContext:Xi,useEffect:b_,useImperativeHandle:sb,useInsertionEffect:nb,useLayoutEffect:rb,useMemo:ab,useReducer:ug,useRef:tb,useState:function(){return ug(Eh)},useDebugValue:S_,useDeferredValue:function(e){var r=Yi();return lb(r,or.memoizedState,e)},useTransition:function(){var e=ug(Eh)[0],r=Yi().memoizedState;return[e,r]},useMutableSource:Ww,useSyncExternalStore:Kw,useId:cb,unstable_isNewReconciler:!1},OI={readContext:Xi,useCallback:ob,useContext:Xi,useEffect:b_,useImperativeHandle:sb,useInsertionEffect:nb,useLayoutEffect:rb,useMemo:ab,useReducer:hg,useRef:tb,useState:function(){return hg(Eh)},useDebugValue:S_,useDeferredValue:function(e){var r=Yi();return or===null?r.memoizedState=e:lb(r,or.memoizedState,e)},useTransition:function(){var e=hg(Eh)[0],r=Yi().memoizedState;return[e,r]},useMutableSource:Ww,useSyncExternalStore:Kw,useId:cb,unstable_isNewReconciler:!1};function xc(e,r){try{var o="",u=r;do o+=hE(u),u=u.return;while(u);var f=o}catch(v){f=`
Error generating stack: `+v.message+`
`+v.stack}return{value:e,source:r,stack:f,digest:null}}function dg(e,r,o){return{value:e,source:null,stack:o??null,digest:r??null}}function cy(e,r){try{console.error(r.value)}catch(o){setTimeout(function(){throw o})}}var BI=typeof WeakMap=="function"?WeakMap:Map;function pb(e,r,o){o=go(-1,o),o.tag=3,o.payload={element:null};var u=r.value;return o.callback=function(){Yp||(Yp=!0,vy=u),cy(e,r)},o}function fb(e,r,o){o=go(-1,o),o.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var f=r.value;o.payload=function(){return u(f)},o.callback=function(){cy(e,r)}}var v=e.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(o.callback=function(){cy(e,r),typeof u!="function"&&(ca===null?ca=new Set([this]):ca.add(this));var T=r.stack;this.componentDidCatch(r.value,{componentStack:T!==null?T:""})}),o}function xx(e,r,o){var u=e.pingCache;if(u===null){u=e.pingCache=new BI;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(o)||(f.add(o),e=JI.bind(null,e,r,o),r.then(e,e))}function wx(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function bx(e,r,o,u,f){return e.mode&1?(e.flags|=65536,e.lanes=f,e):(e===r?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(r=go(-1,1),r.tag=2,la(o,r,1))),o.lanes|=1),e)}var NI=bo.ReactCurrentOwner,yi=!1;function ei(e,r,o,u){r.child=e===null?Zw(r,null,o,u):_c(r,e.child,o,u)}function Sx(e,r,o,u,f){o=o.render;var v=r.ref;return dc(r,f),u=x_(e,r,o,u,v,f),o=w_(),e!==null&&!yi?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~f,wo(e,r,f)):(wn&&o&&l_(r),r.flags|=1,ei(e,r,u,f),r.child)}function Tx(e,r,o,u,f){if(e===null){var v=o.type;return typeof v=="function"&&!M_(v)&&v.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(r.tag=15,r.type=v,mb(e,r,v,u,f)):(e=bp(o.type,null,u,r,r.mode,f),e.ref=r.ref,e.return=r,r.child=e)}if(v=e.child,!(e.lanes&f)){var T=v.memoizedProps;if(o=o.compare,o=o!==null?o:_h,o(T,u)&&e.ref===r.ref)return wo(e,r,f)}return r.flags|=1,e=ha(v,u),e.ref=r.ref,e.return=r,r.child=e}function mb(e,r,o,u,f){if(e!==null){var v=e.memoizedProps;if(_h(v,u)&&e.ref===r.ref)if(yi=!1,r.pendingProps=u=v,(e.lanes&f)!==0)e.flags&131072&&(yi=!0);else return r.lanes=e.lanes,wo(e,r,f)}return uy(e,r,o,u,f)}function gb(e,r,o){var u=r.pendingProps,f=u.children,v=e!==null?e.memoizedState:null;if(u.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},cn(sc,ki),ki|=o;else{if(!(o&1073741824))return e=v!==null?v.baseLanes|o:o,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,cn(sc,ki),ki|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=v!==null?v.baseLanes:o,cn(sc,ki),ki|=u}else v!==null?(u=v.baseLanes|o,r.memoizedState=null):u=o,cn(sc,ki),ki|=u;return ei(e,r,f,o),r.child}function yb(e,r){var o=r.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(r.flags|=512,r.flags|=2097152)}function uy(e,r,o,u,f){var v=xi(o)?Qa:$r.current;return v=gc(r,v),dc(r,f),o=x_(e,r,o,u,v,f),u=w_(),e!==null&&!yi?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~f,wo(e,r,f)):(wn&&u&&l_(r),r.flags|=1,ei(e,r,o,f),r.child)}function Ex(e,r,o,u,f){if(xi(o)){var v=!0;Up(r)}else v=!1;if(dc(r,f),r.stateNode===null)vp(e,r),qw(r,o,u),ly(r,o,u,f),u=!0;else if(e===null){var T=r.stateNode,c=r.memoizedProps;T.props=c;var z=T.context,P=o.contextType;typeof P=="object"&&P!==null?P=Xi(P):(P=xi(o)?Qa:$r.current,P=gc(r,P));var V=o.getDerivedStateFromProps,U=typeof V=="function"||typeof T.getSnapshotBeforeUpdate=="function";U||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(c!==u||z!==P)&&gx(r,T,u,P),Yo=!1;var N=r.memoizedState;T.state=N,Zp(r,u,T,f),z=r.memoizedState,c!==u||N!==z||vi.current||Yo?(typeof V=="function"&&(ay(r,o,V,u),z=r.memoizedState),(c=Yo||mx(r,o,c,u,N,z,P))?(U||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(r.flags|=4194308)):(typeof T.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=z),T.props=u,T.state=z,T.context=P,u=c):(typeof T.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{T=r.stateNode,Vw(e,r),c=r.memoizedProps,P=r.type===r.elementType?c:fs(r.type,c),T.props=P,U=r.pendingProps,N=T.context,z=o.contextType,typeof z=="object"&&z!==null?z=Xi(z):(z=xi(o)?Qa:$r.current,z=gc(r,z));var le=o.getDerivedStateFromProps;(V=typeof le=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(c!==U||N!==z)&&gx(r,T,u,z),Yo=!1,N=r.memoizedState,T.state=N,Zp(r,u,T,f);var ie=r.memoizedState;c!==U||N!==ie||vi.current||Yo?(typeof le=="function"&&(ay(r,o,le,u),ie=r.memoizedState),(P=Yo||mx(r,o,P,u,N,ie,z)||!1)?(V||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(u,ie,z),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(u,ie,z)),typeof T.componentDidUpdate=="function"&&(r.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof T.componentDidUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(r.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=ie),T.props=u,T.state=ie,T.context=z,u=P):(typeof T.componentDidUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(r.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&N===e.memoizedState||(r.flags|=1024),u=!1)}return hy(e,r,o,u,v,f)}function hy(e,r,o,u,f,v){yb(e,r);var T=(r.flags&128)!==0;if(!u&&!T)return f&&ux(r,o,!1),wo(e,r,v);u=r.stateNode,NI.current=r;var c=T&&typeof o.getDerivedStateFromError!="function"?null:u.render();return r.flags|=1,e!==null&&T?(r.child=_c(r,e.child,null,v),r.child=_c(r,null,c,v)):ei(e,r,c,v),r.memoizedState=u.state,f&&ux(r,o,!0),r.child}function _b(e){var r=e.stateNode;r.pendingContext?cx(e,r.pendingContext,r.pendingContext!==r.context):r.context&&cx(e,r.context,!1),g_(e,r.containerInfo)}function Ix(e,r,o,u,f){return yc(),u_(f),r.flags|=256,ei(e,r,o,u),r.child}var dy={dehydrated:null,treeContext:null,retryLane:0};function py(e){return{baseLanes:e,cachePool:null,transitions:null}}function vb(e,r,o){var u=r.pendingProps,f=In.current,v=!1,T=(r.flags&128)!==0,c;if((c=T)||(c=e!==null&&e.memoizedState===null?!1:(f&2)!==0),c?(v=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(f|=1),cn(In,f&1),e===null)return sy(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(T=u.children,e=u.fallback,v?(u=r.mode,v=r.child,T={mode:"hidden",children:T},!(u&1)&&v!==null?(v.childLanes=0,v.pendingProps=T):v=_f(T,u,0,null),e=Ka(e,u,o,null),v.return=r,e.return=r,v.sibling=e,r.child=v,r.child.memoizedState=py(o),r.memoizedState=dy,e):T_(r,T));if(f=e.memoizedState,f!==null&&(c=f.dehydrated,c!==null))return jI(e,r,T,u,c,f,o);if(v){v=u.fallback,T=r.mode,f=e.child,c=f.sibling;var z={mode:"hidden",children:u.children};return!(T&1)&&r.child!==f?(u=r.child,u.childLanes=0,u.pendingProps=z,r.deletions=null):(u=ha(f,z),u.subtreeFlags=f.subtreeFlags&14680064),c!==null?v=ha(c,v):(v=Ka(v,T,o,null),v.flags|=2),v.return=r,u.return=r,u.sibling=v,r.child=u,u=v,v=r.child,T=e.child.memoizedState,T=T===null?py(o):{baseLanes:T.baseLanes|o,cachePool:null,transitions:T.transitions},v.memoizedState=T,v.childLanes=e.childLanes&~o,r.memoizedState=dy,u}return v=e.child,e=v.sibling,u=ha(v,{mode:"visible",children:u.children}),!(r.mode&1)&&(u.lanes=o),u.return=r,u.sibling=null,e!==null&&(o=r.deletions,o===null?(r.deletions=[e],r.flags|=16):o.push(e)),r.child=u,r.memoizedState=null,u}function T_(e,r){return r=_f({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function ip(e,r,o,u){return u!==null&&u_(u),_c(r,e.child,null,o),e=T_(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function jI(e,r,o,u,f,v,T){if(o)return r.flags&256?(r.flags&=-257,u=dg(Error(Ne(422))),ip(e,r,T,u)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(v=u.fallback,f=r.mode,u=_f({mode:"visible",children:u.children},f,0,null),v=Ka(v,f,T,null),v.flags|=2,u.return=r,v.return=r,u.sibling=v,r.child=u,r.mode&1&&_c(r,e.child,null,T),r.child.memoizedState=py(T),r.memoizedState=dy,v);if(!(r.mode&1))return ip(e,r,T,null);if(f.data==="$!"){if(u=f.nextSibling&&f.nextSibling.dataset,u)var c=u.dgst;return u=c,v=Error(Ne(419)),u=dg(v,u,void 0),ip(e,r,T,u)}if(c=(T&e.childLanes)!==0,yi||c){if(u=vr,u!==null){switch(T&-T){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=f&(u.suspendedLanes|T)?0:f,f!==0&&f!==v.retryLane&&(v.retryLane=f,xo(e,f),_s(u,e,f,-1))}return A_(),u=dg(Error(Ne(421))),ip(e,r,T,u)}return f.data==="$?"?(r.flags|=128,r.child=e.child,r=QI.bind(null,e),f._reactRetry=r,null):(e=v.treeContext,Pi=aa(f.nextSibling),Ai=r,wn=!0,gs=null,e!==null&&(Gi[Zi++]=fo,Gi[Zi++]=mo,Gi[Zi++]=el,fo=e.id,mo=e.overflow,el=r),r=T_(r,u.children),r.flags|=4096,r)}function Cx(e,r,o){e.lanes|=r;var u=e.alternate;u!==null&&(u.lanes|=r),oy(e.return,r,o)}function pg(e,r,o,u,f){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:f}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=o,v.tailMode=f)}function xb(e,r,o){var u=r.pendingProps,f=u.revealOrder,v=u.tail;if(ei(e,r,u.children,o),u=In.current,u&2)u=u&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Cx(e,o,r);else if(e.tag===19)Cx(e,o,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(cn(In,u),!(r.mode&1))r.memoizedState=null;else switch(f){case"forwards":for(o=r.child,f=null;o!==null;)e=o.alternate,e!==null&&Hp(e)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),pg(r,!1,f,o,v);break;case"backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(e=f.alternate,e!==null&&Hp(e)===null){r.child=f;break}e=f.sibling,f.sibling=o,o=f,f=e}pg(r,!0,o,null,v);break;case"together":pg(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function vp(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function wo(e,r,o){if(e!==null&&(r.dependencies=e.dependencies),nl|=r.lanes,!(o&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(Ne(153));if(r.child!==null){for(e=r.child,o=ha(e,e.pendingProps),r.child=o,o.return=r;e.sibling!==null;)e=e.sibling,o=o.sibling=ha(e,e.pendingProps),o.return=r;o.sibling=null}return r.child}function UI(e,r,o){switch(r.tag){case 3:_b(r),yc();break;case 5:Hw(r);break;case 1:xi(r.type)&&Up(r);break;case 4:g_(r,r.stateNode.containerInfo);break;case 10:var u=r.type._context,f=r.memoizedProps.value;cn(qp,u._currentValue),u._currentValue=f;break;case 13:if(u=r.memoizedState,u!==null)return u.dehydrated!==null?(cn(In,In.current&1),r.flags|=128,null):o&r.child.childLanes?vb(e,r,o):(cn(In,In.current&1),e=wo(e,r,o),e!==null?e.sibling:null);cn(In,In.current&1);break;case 19:if(u=(o&r.childLanes)!==0,e.flags&128){if(u)return xb(e,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),cn(In,In.current),u)break;return null;case 22:case 23:return r.lanes=0,gb(e,r,o)}return wo(e,r,o)}var wb,fy,bb,Sb;wb=function(e,r){for(var o=r.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};fy=function(){};bb=function(e,r,o,u){var f=e.memoizedProps;if(f!==u){e=r.stateNode,Za(js.current);var v=null;switch(o){case"input":f=Fg(e,f),u=Fg(e,u),v=[];break;case"select":f=Pn({},f,{value:void 0}),u=Pn({},u,{value:void 0}),v=[];break;case"textarea":f=Ng(e,f),u=Ng(e,u),v=[];break;default:typeof f.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=Np)}Ug(o,u);var T;o=null;for(P in f)if(!u.hasOwnProperty(P)&&f.hasOwnProperty(P)&&f[P]!=null)if(P==="style"){var c=f[P];for(T in c)c.hasOwnProperty(T)&&(o||(o={}),o[T]="")}else P!=="dangerouslySetInnerHTML"&&P!=="children"&&P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(hh.hasOwnProperty(P)?v||(v=[]):(v=v||[]).push(P,null));for(P in u){var z=u[P];if(c=f!=null?f[P]:void 0,u.hasOwnProperty(P)&&z!==c&&(z!=null||c!=null))if(P==="style")if(c){for(T in c)!c.hasOwnProperty(T)||z&&z.hasOwnProperty(T)||(o||(o={}),o[T]="");for(T in z)z.hasOwnProperty(T)&&c[T]!==z[T]&&(o||(o={}),o[T]=z[T])}else o||(v||(v=[]),v.push(P,o)),o=z;else P==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,c=c?c.__html:void 0,z!=null&&c!==z&&(v=v||[]).push(P,z)):P==="children"?typeof z!="string"&&typeof z!="number"||(v=v||[]).push(P,""+z):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&(hh.hasOwnProperty(P)?(z!=null&&P==="onScroll"&&mn("scroll",e),v||c===z||(v=[])):(v=v||[]).push(P,z))}o&&(v=v||[]).push("style",o);var P=v;(r.updateQueue=P)&&(r.flags|=4)}};Sb=function(e,r,o,u){o!==u&&(r.flags|=4)};function Zu(e,r){if(!wn)switch(e.tailMode){case"hidden":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function jr(e){var r=e.alternate!==null&&e.alternate.child===e.child,o=0,u=0;if(r)for(var f=e.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags&14680064,u|=f.flags&14680064,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=u,e.childLanes=o,r}function VI(e,r,o){var u=r.pendingProps;switch(c_(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jr(r),null;case 1:return xi(r.type)&&jp(),jr(r),null;case 3:return u=r.stateNode,vc(),yn(vi),yn($r),__(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(np(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,gs!==null&&(by(gs),gs=null))),fy(e,r),jr(r),null;case 5:y_(r);var f=Za(Sh.current);if(o=r.type,e!==null&&r.stateNode!=null)bb(e,r,o,u,f),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!u){if(r.stateNode===null)throw Error(Ne(166));return jr(r),null}if(e=Za(js.current),np(r)){u=r.stateNode,o=r.type;var v=r.memoizedProps;switch(u[Os]=r,u[wh]=v,e=(r.mode&1)!==0,o){case"dialog":mn("cancel",u),mn("close",u);break;case"iframe":case"object":case"embed":mn("load",u);break;case"video":case"audio":for(f=0;f<Ju.length;f++)mn(Ju[f],u);break;case"source":mn("error",u);break;case"img":case"image":case"link":mn("error",u),mn("load",u);break;case"details":mn("toggle",u);break;case"input":F0(u,v),mn("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!v.multiple},mn("invalid",u);break;case"textarea":B0(u,v),mn("invalid",u)}Ug(o,v),f=null;for(var T in v)if(v.hasOwnProperty(T)){var c=v[T];T==="children"?typeof c=="string"?u.textContent!==c&&(v.suppressHydrationWarning!==!0&&tp(u.textContent,c,e),f=["children",c]):typeof c=="number"&&u.textContent!==""+c&&(v.suppressHydrationWarning!==!0&&tp(u.textContent,c,e),f=["children",""+c]):hh.hasOwnProperty(T)&&c!=null&&T==="onScroll"&&mn("scroll",u)}switch(o){case"input":Hd(u),O0(u,v,!0);break;case"textarea":Hd(u),N0(u);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(u.onclick=Np)}u=f,r.updateQueue=u,u!==null&&(r.flags|=4)}else{T=f.nodeType===9?f:f.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=X1(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=T.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=T.createElement(o,{is:u.is}):(e=T.createElement(o),o==="select"&&(T=e,u.multiple?T.multiple=!0:u.size&&(T.size=u.size))):e=T.createElementNS(e,o),e[Os]=r,e[wh]=u,wb(e,r,!1,!1),r.stateNode=e;e:{switch(T=Vg(o,u),o){case"dialog":mn("cancel",e),mn("close",e),f=u;break;case"iframe":case"object":case"embed":mn("load",e),f=u;break;case"video":case"audio":for(f=0;f<Ju.length;f++)mn(Ju[f],e);f=u;break;case"source":mn("error",e),f=u;break;case"img":case"image":case"link":mn("error",e),mn("load",e),f=u;break;case"details":mn("toggle",e),f=u;break;case"input":F0(e,u),f=Fg(e,u),mn("invalid",e);break;case"option":f=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},f=Pn({},u,{value:void 0}),mn("invalid",e);break;case"textarea":B0(e,u),f=Ng(e,u),mn("invalid",e);break;default:f=u}Ug(o,f),c=f;for(v in c)if(c.hasOwnProperty(v)){var z=c[v];v==="style"?Q1(e,z):v==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,z!=null&&Y1(e,z)):v==="children"?typeof z=="string"?(o!=="textarea"||z!=="")&&dh(e,z):typeof z=="number"&&dh(e,""+z):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(hh.hasOwnProperty(v)?z!=null&&v==="onScroll"&&mn("scroll",e):z!=null&&Wy(e,v,z,T))}switch(o){case"input":Hd(e),O0(e,u,!1);break;case"textarea":Hd(e),N0(e);break;case"option":u.value!=null&&e.setAttribute("value",""+da(u.value));break;case"select":e.multiple=!!u.multiple,v=u.value,v!=null?lc(e,!!u.multiple,v,!1):u.defaultValue!=null&&lc(e,!!u.multiple,u.defaultValue,!0);break;default:typeof f.onClick=="function"&&(e.onclick=Np)}switch(o){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return jr(r),null;case 6:if(e&&r.stateNode!=null)Sb(e,r,e.memoizedProps,u);else{if(typeof u!="string"&&r.stateNode===null)throw Error(Ne(166));if(o=Za(Sh.current),Za(js.current),np(r)){if(u=r.stateNode,o=r.memoizedProps,u[Os]=r,(v=u.nodeValue!==o)&&(e=Ai,e!==null))switch(e.tag){case 3:tp(u.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&tp(u.nodeValue,o,(e.mode&1)!==0)}v&&(r.flags|=4)}else u=(o.nodeType===9?o:o.ownerDocument).createTextNode(u),u[Os]=r,r.stateNode=u}return jr(r),null;case 13:if(yn(In),u=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(wn&&Pi!==null&&r.mode&1&&!(r.flags&128))jw(),yc(),r.flags|=98560,v=!1;else if(v=np(r),u!==null&&u.dehydrated!==null){if(e===null){if(!v)throw Error(Ne(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(Ne(317));v[Os]=r}else yc(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;jr(r),v=!1}else gs!==null&&(by(gs),gs=null),v=!0;if(!v)return r.flags&65536?r:null}return r.flags&128?(r.lanes=o,r):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(r.child.flags|=8192,r.mode&1&&(e===null||In.current&1?ar===0&&(ar=3):A_())),r.updateQueue!==null&&(r.flags|=4),jr(r),null);case 4:return vc(),fy(e,r),e===null&&vh(r.stateNode.containerInfo),jr(r),null;case 10:return p_(r.type._context),jr(r),null;case 17:return xi(r.type)&&jp(),jr(r),null;case 19:if(yn(In),v=r.memoizedState,v===null)return jr(r),null;if(u=(r.flags&128)!==0,T=v.rendering,T===null)if(u)Zu(v,!1);else{if(ar!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(T=Hp(e),T!==null){for(r.flags|=128,Zu(v,!1),u=T.updateQueue,u!==null&&(r.updateQueue=u,r.flags|=4),r.subtreeFlags=0,u=o,o=r.child;o!==null;)v=o,e=u,v.flags&=14680066,T=v.alternate,T===null?(v.childLanes=0,v.lanes=e,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=T.childLanes,v.lanes=T.lanes,v.child=T.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=T.memoizedProps,v.memoizedState=T.memoizedState,v.updateQueue=T.updateQueue,v.type=T.type,e=T.dependencies,v.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return cn(In,In.current&1|2),r.child}e=e.sibling}v.tail!==null&&Kn()>wc&&(r.flags|=128,u=!0,Zu(v,!1),r.lanes=4194304)}else{if(!u)if(e=Hp(T),e!==null){if(r.flags|=128,u=!0,o=e.updateQueue,o!==null&&(r.updateQueue=o,r.flags|=4),Zu(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!wn)return jr(r),null}else 2*Kn()-v.renderingStartTime>wc&&o!==1073741824&&(r.flags|=128,u=!0,Zu(v,!1),r.lanes=4194304);v.isBackwards?(T.sibling=r.child,r.child=T):(o=v.last,o!==null?o.sibling=T:r.child=T,v.last=T)}return v.tail!==null?(r=v.tail,v.rendering=r,v.tail=r.sibling,v.renderingStartTime=Kn(),r.sibling=null,o=In.current,cn(In,u?o&1|2:o&1),r):(jr(r),null);case 22:case 23:return P_(),u=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(r.flags|=8192),u&&r.mode&1?ki&1073741824&&(jr(r),r.subtreeFlags&6&&(r.flags|=8192)):jr(r),null;case 24:return null;case 25:return null}throw Error(Ne(156,r.tag))}function $I(e,r){switch(c_(r),r.tag){case 1:return xi(r.type)&&jp(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return vc(),yn(vi),yn($r),__(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return y_(r),null;case 13:if(yn(In),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(Ne(340));yc()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return yn(In),null;case 4:return vc(),null;case 10:return p_(r.type._context),null;case 22:case 23:return P_(),null;case 24:return null;default:return null}}var sp=!1,Ur=!1,qI=typeof WeakSet=="function"?WeakSet:Set,rt=null;function ic(e,r){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(u){Fn(e,r,u)}else o.current=null}function my(e,r,o){try{o()}catch(u){Fn(e,r,u)}}var kx=!1;function GI(e,r){if(Jg=Fp,e=Cw(),a_(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var f=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{o.nodeType,v.nodeType}catch{o=null;break e}var T=0,c=-1,z=-1,P=0,V=0,U=e,N=null;t:for(;;){for(var le;U!==o||f!==0&&U.nodeType!==3||(c=T+f),U!==v||u!==0&&U.nodeType!==3||(z=T+u),U.nodeType===3&&(T+=U.nodeValue.length),(le=U.firstChild)!==null;)N=U,U=le;for(;;){if(U===e)break t;if(N===o&&++P===f&&(c=T),N===v&&++V===u&&(z=T),(le=U.nextSibling)!==null)break;U=N,N=U.parentNode}U=le}o=c===-1||z===-1?null:{start:c,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(Qg={focusedElem:e,selectionRange:o},Fp=!1,rt=r;rt!==null;)if(r=rt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,rt=e;else for(;rt!==null;){r=rt;try{var ie=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(ie!==null){var ge=ie.memoizedProps,Me=ie.memoizedState,X=r.stateNode,Y=X.getSnapshotBeforeUpdate(r.elementType===r.type?ge:fs(r.type,ge),Me);X.__reactInternalSnapshotBeforeUpdate=Y}break;case 3:var se=r.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ne(163))}}catch(xe){Fn(r,r.return,xe)}if(e=r.sibling,e!==null){e.return=r.return,rt=e;break}rt=r.return}return ie=kx,kx=!1,ie}function ah(e,r,o){var u=r.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&e)===e){var v=f.destroy;f.destroy=void 0,v!==void 0&&my(r,o,v)}f=f.next}while(f!==u)}}function gf(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var u=o.create;o.destroy=u()}o=o.next}while(o!==r)}}function gy(e){var r=e.ref;if(r!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof r=="function"?r(e):r.current=e}}function Tb(e){var r=e.alternate;r!==null&&(e.alternate=null,Tb(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Os],delete r[wh],delete r[ny],delete r[CI],delete r[kI])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Eb(e){return e.tag===5||e.tag===3||e.tag===4}function Px(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Eb(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yy(e,r,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,r?o.nodeType===8?o.parentNode.insertBefore(e,r):o.insertBefore(e,r):(o.nodeType===8?(r=o.parentNode,r.insertBefore(e,o)):(r=o,r.appendChild(e)),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Np));else if(u!==4&&(e=e.child,e!==null))for(yy(e,r,o),e=e.sibling;e!==null;)yy(e,r,o),e=e.sibling}function _y(e,r,o){var u=e.tag;if(u===5||u===6)e=e.stateNode,r?o.insertBefore(e,r):o.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(_y(e,r,o),e=e.sibling;e!==null;)_y(e,r,o),e=e.sibling}var Cr=null,ms=!1;function Zo(e,r,o){for(o=o.child;o!==null;)Ib(e,r,o),o=o.sibling}function Ib(e,r,o){if(Ns&&typeof Ns.onCommitFiberUnmount=="function")try{Ns.onCommitFiberUnmount(lf,o)}catch{}switch(o.tag){case 5:Ur||ic(o,r);case 6:var u=Cr,f=ms;Cr=null,Zo(e,r,o),Cr=u,ms=f,Cr!==null&&(ms?(e=Cr,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):Cr.removeChild(o.stateNode));break;case 18:Cr!==null&&(ms?(e=Cr,o=o.stateNode,e.nodeType===8?og(e.parentNode,o):e.nodeType===1&&og(e,o),gh(e)):og(Cr,o.stateNode));break;case 4:u=Cr,f=ms,Cr=o.stateNode.containerInfo,ms=!0,Zo(e,r,o),Cr=u,ms=f;break;case 0:case 11:case 14:case 15:if(!Ur&&(u=o.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){f=u=u.next;do{var v=f,T=v.destroy;v=v.tag,T!==void 0&&(v&2||v&4)&&my(o,r,T),f=f.next}while(f!==u)}Zo(e,r,o);break;case 1:if(!Ur&&(ic(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=o.memoizedProps,u.state=o.memoizedState,u.componentWillUnmount()}catch(c){Fn(o,r,c)}Zo(e,r,o);break;case 21:Zo(e,r,o);break;case 22:o.mode&1?(Ur=(u=Ur)||o.memoizedState!==null,Zo(e,r,o),Ur=u):Zo(e,r,o);break;default:Zo(e,r,o)}}function Ax(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new qI),r.forEach(function(u){var f=eC.bind(null,e,u);o.has(u)||(o.add(u),u.then(f,f))})}}function ps(e,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];try{var v=e,T=r,c=T;e:for(;c!==null;){switch(c.tag){case 5:Cr=c.stateNode,ms=!1;break e;case 3:Cr=c.stateNode.containerInfo,ms=!0;break e;case 4:Cr=c.stateNode.containerInfo,ms=!0;break e}c=c.return}if(Cr===null)throw Error(Ne(160));Ib(v,T,f),Cr=null,ms=!1;var z=f.alternate;z!==null&&(z.return=null),f.return=null}catch(P){Fn(f,r,P)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Cb(r,e),r=r.sibling}function Cb(e,r){var o=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ps(r,e),Ds(e),u&4){try{ah(3,e,e.return),gf(3,e)}catch(ge){Fn(e,e.return,ge)}try{ah(5,e,e.return)}catch(ge){Fn(e,e.return,ge)}}break;case 1:ps(r,e),Ds(e),u&512&&o!==null&&ic(o,o.return);break;case 5:if(ps(r,e),Ds(e),u&512&&o!==null&&ic(o,o.return),e.flags&32){var f=e.stateNode;try{dh(f,"")}catch(ge){Fn(e,e.return,ge)}}if(u&4&&(f=e.stateNode,f!=null)){var v=e.memoizedProps,T=o!==null?o.memoizedProps:v,c=e.type,z=e.updateQueue;if(e.updateQueue=null,z!==null)try{c==="input"&&v.type==="radio"&&v.name!=null&&W1(f,v),Vg(c,T);var P=Vg(c,v);for(T=0;T<z.length;T+=2){var V=z[T],U=z[T+1];V==="style"?Q1(f,U):V==="dangerouslySetInnerHTML"?Y1(f,U):V==="children"?dh(f,U):Wy(f,V,U,P)}switch(c){case"input":Og(f,v);break;case"textarea":K1(f,v);break;case"select":var N=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!v.multiple;var le=v.value;le!=null?lc(f,!!v.multiple,le,!1):N!==!!v.multiple&&(v.defaultValue!=null?lc(f,!!v.multiple,v.defaultValue,!0):lc(f,!!v.multiple,v.multiple?[]:"",!1))}f[wh]=v}catch(ge){Fn(e,e.return,ge)}}break;case 6:if(ps(r,e),Ds(e),u&4){if(e.stateNode===null)throw Error(Ne(162));f=e.stateNode,v=e.memoizedProps;try{f.nodeValue=v}catch(ge){Fn(e,e.return,ge)}}break;case 3:if(ps(r,e),Ds(e),u&4&&o!==null&&o.memoizedState.isDehydrated)try{gh(r.containerInfo)}catch(ge){Fn(e,e.return,ge)}break;case 4:ps(r,e),Ds(e);break;case 13:ps(r,e),Ds(e),f=e.child,f.flags&8192&&(v=f.memoizedState!==null,f.stateNode.isHidden=v,!v||f.alternate!==null&&f.alternate.memoizedState!==null||(C_=Kn())),u&4&&Ax(e);break;case 22:if(V=o!==null&&o.memoizedState!==null,e.mode&1?(Ur=(P=Ur)||V,ps(r,e),Ur=P):ps(r,e),Ds(e),u&8192){if(P=e.memoizedState!==null,(e.stateNode.isHidden=P)&&!V&&e.mode&1)for(rt=e,V=e.child;V!==null;){for(U=rt=V;rt!==null;){switch(N=rt,le=N.child,N.tag){case 0:case 11:case 14:case 15:ah(4,N,N.return);break;case 1:ic(N,N.return);var ie=N.stateNode;if(typeof ie.componentWillUnmount=="function"){u=N,o=N.return;try{r=u,ie.props=r.memoizedProps,ie.state=r.memoizedState,ie.componentWillUnmount()}catch(ge){Fn(u,o,ge)}}break;case 5:ic(N,N.return);break;case 22:if(N.memoizedState!==null){zx(U);continue}}le!==null?(le.return=N,rt=le):zx(U)}V=V.sibling}e:for(V=null,U=e;;){if(U.tag===5){if(V===null){V=U;try{f=U.stateNode,P?(v=f.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(c=U.stateNode,z=U.memoizedProps.style,T=z!=null&&z.hasOwnProperty("display")?z.display:null,c.style.display=J1("display",T))}catch(ge){Fn(e,e.return,ge)}}}else if(U.tag===6){if(V===null)try{U.stateNode.nodeValue=P?"":U.memoizedProps}catch(ge){Fn(e,e.return,ge)}}else if((U.tag!==22&&U.tag!==23||U.memoizedState===null||U===e)&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===e)break e;for(;U.sibling===null;){if(U.return===null||U.return===e)break e;V===U&&(V=null),U=U.return}V===U&&(V=null),U.sibling.return=U.return,U=U.sibling}}break;case 19:ps(r,e),Ds(e),u&4&&Ax(e);break;case 21:break;default:ps(r,e),Ds(e)}}function Ds(e){var r=e.flags;if(r&2){try{e:{for(var o=e.return;o!==null;){if(Eb(o)){var u=o;break e}o=o.return}throw Error(Ne(160))}switch(u.tag){case 5:var f=u.stateNode;u.flags&32&&(dh(f,""),u.flags&=-33);var v=Px(e);_y(e,v,f);break;case 3:case 4:var T=u.stateNode.containerInfo,c=Px(e);yy(e,c,T);break;default:throw Error(Ne(161))}}catch(z){Fn(e,e.return,z)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function ZI(e,r,o){rt=e,kb(e)}function kb(e,r,o){for(var u=(e.mode&1)!==0;rt!==null;){var f=rt,v=f.child;if(f.tag===22&&u){var T=f.memoizedState!==null||sp;if(!T){var c=f.alternate,z=c!==null&&c.memoizedState!==null||Ur;c=sp;var P=Ur;if(sp=T,(Ur=z)&&!P)for(rt=f;rt!==null;)T=rt,z=T.child,T.tag===22&&T.memoizedState!==null?Rx(f):z!==null?(z.return=T,rt=z):Rx(f);for(;v!==null;)rt=v,kb(v),v=v.sibling;rt=f,sp=c,Ur=P}Mx(e)}else f.subtreeFlags&8772&&v!==null?(v.return=f,rt=v):Mx(e)}}function Mx(e){for(;rt!==null;){var r=rt;if(r.flags&8772){var o=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:Ur||gf(5,r);break;case 1:var u=r.stateNode;if(r.flags&4&&!Ur)if(o===null)u.componentDidMount();else{var f=r.elementType===r.type?o.memoizedProps:fs(r.type,o.memoizedProps);u.componentDidUpdate(f,o.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var v=r.updateQueue;v!==null&&fx(r,v,u);break;case 3:var T=r.updateQueue;if(T!==null){if(o=null,r.child!==null)switch(r.child.tag){case 5:o=r.child.stateNode;break;case 1:o=r.child.stateNode}fx(r,T,o)}break;case 5:var c=r.stateNode;if(o===null&&r.flags&4){o=c;var z=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":z.autoFocus&&o.focus();break;case"img":z.src&&(o.src=z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var P=r.alternate;if(P!==null){var V=P.memoizedState;if(V!==null){var U=V.dehydrated;U!==null&&gh(U)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ne(163))}Ur||r.flags&512&&gy(r)}catch(N){Fn(r,r.return,N)}}if(r===e){rt=null;break}if(o=r.sibling,o!==null){o.return=r.return,rt=o;break}rt=r.return}}function zx(e){for(;rt!==null;){var r=rt;if(r===e){rt=null;break}var o=r.sibling;if(o!==null){o.return=r.return,rt=o;break}rt=r.return}}function Rx(e){for(;rt!==null;){var r=rt;try{switch(r.tag){case 0:case 11:case 15:var o=r.return;try{gf(4,r)}catch(z){Fn(r,o,z)}break;case 1:var u=r.stateNode;if(typeof u.componentDidMount=="function"){var f=r.return;try{u.componentDidMount()}catch(z){Fn(r,f,z)}}var v=r.return;try{gy(r)}catch(z){Fn(r,v,z)}break;case 5:var T=r.return;try{gy(r)}catch(z){Fn(r,T,z)}}}catch(z){Fn(r,r.return,z)}if(r===e){rt=null;break}var c=r.sibling;if(c!==null){c.return=r.return,rt=c;break}rt=r.return}}var HI=Math.ceil,Xp=bo.ReactCurrentDispatcher,E_=bo.ReactCurrentOwner,Wi=bo.ReactCurrentBatchConfig,Nt=0,vr=null,Yn=null,kr=0,ki=0,sc=ga(0),ar=0,Ch=null,nl=0,yf=0,I_=0,lh=null,gi=null,C_=0,wc=1/0,uo=null,Yp=!1,vy=null,ca=null,op=!1,ta=null,Jp=0,ch=0,xy=null,xp=-1,wp=0;function ti(){return Nt&6?Kn():xp!==-1?xp:xp=Kn()}function ua(e){return e.mode&1?Nt&2&&kr!==0?kr&-kr:AI.transition!==null?(wp===0&&(wp=hw()),wp):(e=Yt,e!==0||(e=window.event,e=e===void 0?16:_w(e.type)),e):1}function _s(e,r,o,u){if(50<ch)throw ch=0,xy=null,Error(Ne(185));Mh(e,o,u),(!(Nt&2)||e!==vr)&&(e===vr&&(!(Nt&2)&&(yf|=o),ar===4&&Qo(e,kr)),wi(e,u),o===1&&Nt===0&&!(r.mode&1)&&(wc=Kn()+500,pf&&ya()))}function wi(e,r){var o=e.callbackNode;AE(e,r);var u=Lp(e,e===vr?kr:0);if(u===0)o!==null&&V0(o),e.callbackNode=null,e.callbackPriority=0;else if(r=u&-u,e.callbackPriority!==r){if(o!=null&&V0(o),r===1)e.tag===0?PI(Dx.bind(null,e)):Ow(Dx.bind(null,e)),EI(function(){!(Nt&6)&&ya()}),o=null;else{switch(dw(u)){case 1:o=Qy;break;case 4:o=cw;break;case 16:o=Dp;break;case 536870912:o=uw;break;default:o=Dp}o=Fb(o,Pb.bind(null,e))}e.callbackPriority=r,e.callbackNode=o}}function Pb(e,r){if(xp=-1,wp=0,Nt&6)throw Error(Ne(327));var o=e.callbackNode;if(pc()&&e.callbackNode!==o)return null;var u=Lp(e,e===vr?kr:0);if(u===0)return null;if(u&30||u&e.expiredLanes||r)r=Qp(e,u);else{r=u;var f=Nt;Nt|=2;var v=Mb();(vr!==e||kr!==r)&&(uo=null,wc=Kn()+500,Wa(e,r));do try{XI();break}catch(c){Ab(e,c)}while(1);d_(),Xp.current=v,Nt=f,Yn!==null?r=0:(vr=null,kr=0,r=ar)}if(r!==0){if(r===2&&(f=Hg(e),f!==0&&(u=f,r=wy(e,f))),r===1)throw o=Ch,Wa(e,0),Qo(e,u),wi(e,Kn()),o;if(r===6)Qo(e,u);else{if(f=e.current.alternate,!(u&30)&&!WI(f)&&(r=Qp(e,u),r===2&&(v=Hg(e),v!==0&&(u=v,r=wy(e,v))),r===1))throw o=Ch,Wa(e,0),Qo(e,u),wi(e,Kn()),o;switch(e.finishedWork=f,e.finishedLanes=u,r){case 0:case 1:throw Error(Ne(345));case 2:$a(e,gi,uo);break;case 3:if(Qo(e,u),(u&130023424)===u&&(r=C_+500-Kn(),10<r)){if(Lp(e,0)!==0)break;if(f=e.suspendedLanes,(f&u)!==u){ti(),e.pingedLanes|=e.suspendedLanes&f;break}e.timeoutHandle=ty($a.bind(null,e,gi,uo),r);break}$a(e,gi,uo);break;case 4:if(Qo(e,u),(u&4194240)===u)break;for(r=e.eventTimes,f=-1;0<u;){var T=31-ys(u);v=1<<T,T=r[T],T>f&&(f=T),u&=~v}if(u=f,u=Kn()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*HI(u/1960))-u,10<u){e.timeoutHandle=ty($a.bind(null,e,gi,uo),u);break}$a(e,gi,uo);break;case 5:$a(e,gi,uo);break;default:throw Error(Ne(329))}}}return wi(e,Kn()),e.callbackNode===o?Pb.bind(null,e):null}function wy(e,r){var o=lh;return e.current.memoizedState.isDehydrated&&(Wa(e,r).flags|=256),e=Qp(e,r),e!==2&&(r=gi,gi=o,r!==null&&by(r)),e}function by(e){gi===null?gi=e:gi.push.apply(gi,e)}function WI(e){for(var r=e;;){if(r.flags&16384){var o=r.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var u=0;u<o.length;u++){var f=o[u],v=f.getSnapshot;f=f.value;try{if(!xs(v(),f))return!1}catch{return!1}}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Qo(e,r){for(r&=~I_,r&=~yf,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var o=31-ys(r),u=1<<o;e[o]=-1,r&=~u}}function Dx(e){if(Nt&6)throw Error(Ne(327));pc();var r=Lp(e,0);if(!(r&1))return wi(e,Kn()),null;var o=Qp(e,r);if(e.tag!==0&&o===2){var u=Hg(e);u!==0&&(r=u,o=wy(e,u))}if(o===1)throw o=Ch,Wa(e,0),Qo(e,r),wi(e,Kn()),o;if(o===6)throw Error(Ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,$a(e,gi,uo),wi(e,Kn()),null}function k_(e,r){var o=Nt;Nt|=1;try{return e(r)}finally{Nt=o,Nt===0&&(wc=Kn()+500,pf&&ya())}}function rl(e){ta!==null&&ta.tag===0&&!(Nt&6)&&pc();var r=Nt;Nt|=1;var o=Wi.transition,u=Yt;try{if(Wi.transition=null,Yt=1,e)return e()}finally{Yt=u,Wi.transition=o,Nt=r,!(Nt&6)&&ya()}}function P_(){ki=sc.current,yn(sc)}function Wa(e,r){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,TI(o)),Yn!==null)for(o=Yn.return;o!==null;){var u=o;switch(c_(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&jp();break;case 3:vc(),yn(vi),yn($r),__();break;case 5:y_(u);break;case 4:vc();break;case 13:yn(In);break;case 19:yn(In);break;case 10:p_(u.type._context);break;case 22:case 23:P_()}o=o.return}if(vr=e,Yn=e=ha(e.current,null),kr=ki=r,ar=0,Ch=null,I_=yf=nl=0,gi=lh=null,Ga!==null){for(r=0;r<Ga.length;r++)if(o=Ga[r],u=o.interleaved,u!==null){o.interleaved=null;var f=u.next,v=o.pending;if(v!==null){var T=v.next;v.next=f,u.next=T}o.pending=u}Ga=null}return e}function Ab(e,r){do{var o=Yn;try{if(d_(),yp.current=Kp,Wp){for(var u=Cn.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}Wp=!1}if(tl=0,yr=or=Cn=null,oh=!1,Th=0,E_.current=null,o===null||o.return===null){ar=1,Ch=r,Yn=null;break}e:{var v=e,T=o.return,c=o,z=r;if(r=kr,c.flags|=32768,z!==null&&typeof z=="object"&&typeof z.then=="function"){var P=z,V=c,U=V.tag;if(!(V.mode&1)&&(U===0||U===11||U===15)){var N=V.alternate;N?(V.updateQueue=N.updateQueue,V.memoizedState=N.memoizedState,V.lanes=N.lanes):(V.updateQueue=null,V.memoizedState=null)}var le=wx(T);if(le!==null){le.flags&=-257,bx(le,T,c,v,r),le.mode&1&&xx(v,P,r),r=le,z=P;var ie=r.updateQueue;if(ie===null){var ge=new Set;ge.add(z),r.updateQueue=ge}else ie.add(z);break e}else{if(!(r&1)){xx(v,P,r),A_();break e}z=Error(Ne(426))}}else if(wn&&c.mode&1){var Me=wx(T);if(Me!==null){!(Me.flags&65536)&&(Me.flags|=256),bx(Me,T,c,v,r),u_(xc(z,c));break e}}v=z=xc(z,c),ar!==4&&(ar=2),lh===null?lh=[v]:lh.push(v),v=T;do{switch(v.tag){case 3:v.flags|=65536,r&=-r,v.lanes|=r;var X=pb(v,z,r);px(v,X);break e;case 1:c=z;var Y=v.type,se=v.stateNode;if(!(v.flags&128)&&(typeof Y.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(ca===null||!ca.has(se)))){v.flags|=65536,r&=-r,v.lanes|=r;var xe=fb(v,c,r);px(v,xe);break e}}v=v.return}while(v!==null)}Rb(o)}catch(Ae){r=Ae,Yn===o&&o!==null&&(Yn=o=o.return);continue}break}while(1)}function Mb(){var e=Xp.current;return Xp.current=Kp,e===null?Kp:e}function A_(){(ar===0||ar===3||ar===2)&&(ar=4),vr===null||!(nl&268435455)&&!(yf&268435455)||Qo(vr,kr)}function Qp(e,r){var o=Nt;Nt|=2;var u=Mb();(vr!==e||kr!==r)&&(uo=null,Wa(e,r));do try{KI();break}catch(f){Ab(e,f)}while(1);if(d_(),Nt=o,Xp.current=u,Yn!==null)throw Error(Ne(261));return vr=null,kr=0,ar}function KI(){for(;Yn!==null;)zb(Yn)}function XI(){for(;Yn!==null&&!wE();)zb(Yn)}function zb(e){var r=Lb(e.alternate,e,ki);e.memoizedProps=e.pendingProps,r===null?Rb(e):Yn=r,E_.current=null}function Rb(e){var r=e;do{var o=r.alternate;if(e=r.return,r.flags&32768){if(o=$I(o,r),o!==null){o.flags&=32767,Yn=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ar=6,Yn=null;return}}else if(o=VI(o,r,ki),o!==null){Yn=o;return}if(r=r.sibling,r!==null){Yn=r;return}Yn=r=e}while(r!==null);ar===0&&(ar=5)}function $a(e,r,o){var u=Yt,f=Wi.transition;try{Wi.transition=null,Yt=1,YI(e,r,o,u)}finally{Wi.transition=f,Yt=u}return null}function YI(e,r,o,u){do pc();while(ta!==null);if(Nt&6)throw Error(Ne(327));o=e.finishedWork;var f=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(Ne(177));e.callbackNode=null,e.callbackPriority=0;var v=o.lanes|o.childLanes;if(ME(e,v),e===vr&&(Yn=vr=null,kr=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||op||(op=!0,Fb(Dp,function(){return pc(),null})),v=(o.flags&15990)!==0,o.subtreeFlags&15990||v){v=Wi.transition,Wi.transition=null;var T=Yt;Yt=1;var c=Nt;Nt|=4,E_.current=null,GI(e,o),Cb(o,e),yI(Qg),Fp=!!Jg,Qg=Jg=null,e.current=o,ZI(o),bE(),Nt=c,Yt=T,Wi.transition=v}else e.current=o;if(op&&(op=!1,ta=e,Jp=f),v=e.pendingLanes,v===0&&(ca=null),EE(o.stateNode),wi(e,Kn()),r!==null)for(u=e.onRecoverableError,o=0;o<r.length;o++)f=r[o],u(f.value,{componentStack:f.stack,digest:f.digest});if(Yp)throw Yp=!1,e=vy,vy=null,e;return Jp&1&&e.tag!==0&&pc(),v=e.pendingLanes,v&1?e===xy?ch++:(ch=0,xy=e):ch=0,ya(),null}function pc(){if(ta!==null){var e=dw(Jp),r=Wi.transition,o=Yt;try{if(Wi.transition=null,Yt=16>e?16:e,ta===null)var u=!1;else{if(e=ta,ta=null,Jp=0,Nt&6)throw Error(Ne(331));var f=Nt;for(Nt|=4,rt=e.current;rt!==null;){var v=rt,T=v.child;if(rt.flags&16){var c=v.deletions;if(c!==null){for(var z=0;z<c.length;z++){var P=c[z];for(rt=P;rt!==null;){var V=rt;switch(V.tag){case 0:case 11:case 15:ah(8,V,v)}var U=V.child;if(U!==null)U.return=V,rt=U;else for(;rt!==null;){V=rt;var N=V.sibling,le=V.return;if(Tb(V),V===P){rt=null;break}if(N!==null){N.return=le,rt=N;break}rt=le}}}var ie=v.alternate;if(ie!==null){var ge=ie.child;if(ge!==null){ie.child=null;do{var Me=ge.sibling;ge.sibling=null,ge=Me}while(ge!==null)}}rt=v}}if(v.subtreeFlags&2064&&T!==null)T.return=v,rt=T;else e:for(;rt!==null;){if(v=rt,v.flags&2048)switch(v.tag){case 0:case 11:case 15:ah(9,v,v.return)}var X=v.sibling;if(X!==null){X.return=v.return,rt=X;break e}rt=v.return}}var Y=e.current;for(rt=Y;rt!==null;){T=rt;var se=T.child;if(T.subtreeFlags&2064&&se!==null)se.return=T,rt=se;else e:for(T=Y;rt!==null;){if(c=rt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:gf(9,c)}}catch(Ae){Fn(c,c.return,Ae)}if(c===T){rt=null;break e}var xe=c.sibling;if(xe!==null){xe.return=c.return,rt=xe;break e}rt=c.return}}if(Nt=f,ya(),Ns&&typeof Ns.onPostCommitFiberRoot=="function")try{Ns.onPostCommitFiberRoot(lf,e)}catch{}u=!0}return u}finally{Yt=o,Wi.transition=r}}return!1}function Lx(e,r,o){r=xc(o,r),r=pb(e,r,1),e=la(e,r,1),r=ti(),e!==null&&(Mh(e,1,r),wi(e,r))}function Fn(e,r,o){if(e.tag===3)Lx(e,e,o);else for(;r!==null;){if(r.tag===3){Lx(r,e,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ca===null||!ca.has(u))){e=xc(o,e),e=fb(r,e,1),r=la(r,e,1),e=ti(),r!==null&&(Mh(r,1,e),wi(r,e));break}}r=r.return}}function JI(e,r,o){var u=e.pingCache;u!==null&&u.delete(r),r=ti(),e.pingedLanes|=e.suspendedLanes&o,vr===e&&(kr&o)===o&&(ar===4||ar===3&&(kr&130023424)===kr&&500>Kn()-C_?Wa(e,0):I_|=o),wi(e,r)}function Db(e,r){r===0&&(e.mode&1?(r=Xd,Xd<<=1,!(Xd&130023424)&&(Xd=4194304)):r=1);var o=ti();e=xo(e,r),e!==null&&(Mh(e,r,o),wi(e,o))}function QI(e){var r=e.memoizedState,o=0;r!==null&&(o=r.retryLane),Db(e,o)}function eC(e,r){var o=0;switch(e.tag){case 13:var u=e.stateNode,f=e.memoizedState;f!==null&&(o=f.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(Ne(314))}u!==null&&u.delete(r),Db(e,o)}var Lb;Lb=function(e,r,o){if(e!==null)if(e.memoizedProps!==r.pendingProps||vi.current)yi=!0;else{if(!(e.lanes&o)&&!(r.flags&128))return yi=!1,UI(e,r,o);yi=!!(e.flags&131072)}else yi=!1,wn&&r.flags&1048576&&Bw(r,$p,r.index);switch(r.lanes=0,r.tag){case 2:var u=r.type;vp(e,r),e=r.pendingProps;var f=gc(r,$r.current);dc(r,o),f=x_(null,r,u,e,f,o);var v=w_();return r.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,xi(u)?(v=!0,Up(r)):v=!1,r.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,m_(r),f.updater=ff,r.stateNode=f,f._reactInternals=r,ly(r,u,e,o),r=hy(null,r,u,!0,v,o)):(r.tag=0,wn&&v&&l_(r),ei(null,r,f,o),r=r.child),r;case 16:u=r.elementType;e:{switch(vp(e,r),e=r.pendingProps,f=u._init,u=f(u._payload),r.type=u,f=r.tag=nC(u),e=fs(u,e),f){case 0:r=uy(null,r,u,e,o);break e;case 1:r=Ex(null,r,u,e,o);break e;case 11:r=Sx(null,r,u,e,o);break e;case 14:r=Tx(null,r,u,fs(u.type,e),o);break e}throw Error(Ne(306,u,""))}return r;case 0:return u=r.type,f=r.pendingProps,f=r.elementType===u?f:fs(u,f),uy(e,r,u,f,o);case 1:return u=r.type,f=r.pendingProps,f=r.elementType===u?f:fs(u,f),Ex(e,r,u,f,o);case 3:e:{if(_b(r),e===null)throw Error(Ne(387));u=r.pendingProps,v=r.memoizedState,f=v.element,Vw(e,r),Zp(r,u,null,o);var T=r.memoizedState;if(u=T.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){f=xc(Error(Ne(423)),r),r=Ix(e,r,u,o,f);break e}else if(u!==f){f=xc(Error(Ne(424)),r),r=Ix(e,r,u,o,f);break e}else for(Pi=aa(r.stateNode.containerInfo.firstChild),Ai=r,wn=!0,gs=null,o=Zw(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(yc(),u===f){r=wo(e,r,o);break e}ei(e,r,u,o)}r=r.child}return r;case 5:return Hw(r),e===null&&sy(r),u=r.type,f=r.pendingProps,v=e!==null?e.memoizedProps:null,T=f.children,ey(u,f)?T=null:v!==null&&ey(u,v)&&(r.flags|=32),yb(e,r),ei(e,r,T,o),r.child;case 6:return e===null&&sy(r),null;case 13:return vb(e,r,o);case 4:return g_(r,r.stateNode.containerInfo),u=r.pendingProps,e===null?r.child=_c(r,null,u,o):ei(e,r,u,o),r.child;case 11:return u=r.type,f=r.pendingProps,f=r.elementType===u?f:fs(u,f),Sx(e,r,u,f,o);case 7:return ei(e,r,r.pendingProps,o),r.child;case 8:return ei(e,r,r.pendingProps.children,o),r.child;case 12:return ei(e,r,r.pendingProps.children,o),r.child;case 10:e:{if(u=r.type._context,f=r.pendingProps,v=r.memoizedProps,T=f.value,cn(qp,u._currentValue),u._currentValue=T,v!==null)if(xs(v.value,T)){if(v.children===f.children&&!vi.current){r=wo(e,r,o);break e}}else for(v=r.child,v!==null&&(v.return=r);v!==null;){var c=v.dependencies;if(c!==null){T=v.child;for(var z=c.firstContext;z!==null;){if(z.context===u){if(v.tag===1){z=go(-1,o&-o),z.tag=2;var P=v.updateQueue;if(P!==null){P=P.shared;var V=P.pending;V===null?z.next=z:(z.next=V.next,V.next=z),P.pending=z}}v.lanes|=o,z=v.alternate,z!==null&&(z.lanes|=o),oy(v.return,o,r),c.lanes|=o;break}z=z.next}}else if(v.tag===10)T=v.type===r.type?null:v.child;else if(v.tag===18){if(T=v.return,T===null)throw Error(Ne(341));T.lanes|=o,c=T.alternate,c!==null&&(c.lanes|=o),oy(T,o,r),T=v.sibling}else T=v.child;if(T!==null)T.return=v;else for(T=v;T!==null;){if(T===r){T=null;break}if(v=T.sibling,v!==null){v.return=T.return,T=v;break}T=T.return}v=T}ei(e,r,f.children,o),r=r.child}return r;case 9:return f=r.type,u=r.pendingProps.children,dc(r,o),f=Xi(f),u=u(f),r.flags|=1,ei(e,r,u,o),r.child;case 14:return u=r.type,f=fs(u,r.pendingProps),f=fs(u.type,f),Tx(e,r,u,f,o);case 15:return mb(e,r,r.type,r.pendingProps,o);case 17:return u=r.type,f=r.pendingProps,f=r.elementType===u?f:fs(u,f),vp(e,r),r.tag=1,xi(u)?(e=!0,Up(r)):e=!1,dc(r,o),qw(r,u,f),ly(r,u,f,o),hy(null,r,u,!0,e,o);case 19:return xb(e,r,o);case 22:return gb(e,r,o)}throw Error(Ne(156,r.tag))};function Fb(e,r){return lw(e,r)}function tC(e,r,o,u){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hi(e,r,o,u){return new tC(e,r,o,u)}function M_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function nC(e){if(typeof e=="function")return M_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xy)return 11;if(e===Yy)return 14}return 2}function ha(e,r){var o=e.alternate;return o===null?(o=Hi(e.tag,r,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=r,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,r=e.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function bp(e,r,o,u,f,v){var T=2;if(u=e,typeof e=="function")M_(e)&&(T=1);else if(typeof e=="string")T=5;else e:switch(e){case Kl:return Ka(o.children,f,v,r);case Ky:T=8,f|=8;break;case zg:return e=Hi(12,o,r,f|2),e.elementType=zg,e.lanes=v,e;case Rg:return e=Hi(13,o,r,f),e.elementType=Rg,e.lanes=v,e;case Dg:return e=Hi(19,o,r,f),e.elementType=Dg,e.lanes=v,e;case G1:return _f(o,f,v,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $1:T=10;break e;case q1:T=9;break e;case Xy:T=11;break e;case Yy:T=14;break e;case Xo:T=16,u=null;break e}throw Error(Ne(130,e==null?e:typeof e,""))}return r=Hi(T,o,r,f),r.elementType=e,r.type=u,r.lanes=v,r}function Ka(e,r,o,u){return e=Hi(7,e,u,r),e.lanes=o,e}function _f(e,r,o,u){return e=Hi(22,e,u,r),e.elementType=G1,e.lanes=o,e.stateNode={isHidden:!1},e}function fg(e,r,o){return e=Hi(6,e,null,r),e.lanes=o,e}function mg(e,r,o){return r=Hi(4,e.children!==null?e.children:[],e.key,r),r.lanes=o,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function rC(e,r,o,u,f){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Km(0),this.expirationTimes=Km(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Km(0),this.identifierPrefix=u,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function z_(e,r,o,u,f,v,T,c,z){return e=new rC(e,r,o,c,z),r===1?(r=1,v===!0&&(r|=8)):r=0,v=Hi(3,null,null,r),e.current=v,v.stateNode=e,v.memoizedState={element:u,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},m_(v),e}function iC(e,r,o){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wl,key:u==null?null:""+u,children:e,containerInfo:r,implementation:o}}function Ob(e){if(!e)return pa;e=e._reactInternals;e:{if(sl(e)!==e||e.tag!==1)throw Error(Ne(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(xi(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(Ne(171))}if(e.tag===1){var o=e.type;if(xi(o))return Fw(e,o,r)}return r}function Bb(e,r,o,u,f,v,T,c,z){return e=z_(o,u,!0,e,f,v,T,c,z),e.context=Ob(null),o=e.current,u=ti(),f=ua(o),v=go(u,f),v.callback=r??null,la(o,v,f),e.current.lanes=f,Mh(e,f,u),wi(e,u),e}function vf(e,r,o,u){var f=r.current,v=ti(),T=ua(f);return o=Ob(o),r.context===null?r.context=o:r.pendingContext=o,r=go(v,T),r.payload={element:e},u=u===void 0?null:u,u!==null&&(r.callback=u),e=la(f,r,T),e!==null&&(_s(e,f,T,v),gp(e,f,T)),T}function ef(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Fx(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<r?o:r}}function R_(e,r){Fx(e,r),(e=e.alternate)&&Fx(e,r)}function sC(){return null}var Nb=typeof reportError=="function"?reportError:function(e){console.error(e)};function D_(e){this._internalRoot=e}xf.prototype.render=D_.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(Ne(409));vf(e,r,null,null)};xf.prototype.unmount=D_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;rl(function(){vf(null,e,null,null)}),r[vo]=null}};function xf(e){this._internalRoot=e}xf.prototype.unstable_scheduleHydration=function(e){if(e){var r=mw();e={blockedOn:null,target:e,priority:r};for(var o=0;o<Jo.length&&r!==0&&r<Jo[o].priority;o++);Jo.splice(o,0,e),o===0&&yw(e)}};function L_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function wf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ox(){}function oC(e,r,o,u,f){if(f){if(typeof u=="function"){var v=u;u=function(){var P=ef(T);v.call(P)}}var T=Bb(r,u,e,0,null,!1,!1,"",Ox);return e._reactRootContainer=T,e[vo]=T.current,vh(e.nodeType===8?e.parentNode:e),rl(),T}for(;f=e.lastChild;)e.removeChild(f);if(typeof u=="function"){var c=u;u=function(){var P=ef(z);c.call(P)}}var z=z_(e,0,!1,null,null,!1,!1,"",Ox);return e._reactRootContainer=z,e[vo]=z.current,vh(e.nodeType===8?e.parentNode:e),rl(function(){vf(r,z,o,u)}),z}function bf(e,r,o,u,f){var v=o._reactRootContainer;if(v){var T=v;if(typeof f=="function"){var c=f;f=function(){var z=ef(T);c.call(z)}}vf(r,T,e,f)}else T=oC(o,r,e,f,u);return ef(T)}pw=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var o=Yu(r.pendingLanes);o!==0&&(e_(r,o|1),wi(r,Kn()),!(Nt&6)&&(wc=Kn()+500,ya()))}break;case 13:rl(function(){var u=xo(e,1);if(u!==null){var f=ti();_s(u,e,1,f)}}),R_(e,1)}};t_=function(e){if(e.tag===13){var r=xo(e,134217728);if(r!==null){var o=ti();_s(r,e,134217728,o)}R_(e,134217728)}};fw=function(e){if(e.tag===13){var r=ua(e),o=xo(e,r);if(o!==null){var u=ti();_s(o,e,r,u)}R_(e,r)}};mw=function(){return Yt};gw=function(e,r){var o=Yt;try{return Yt=e,r()}finally{Yt=o}};qg=function(e,r,o){switch(r){case"input":if(Og(e,o),r=o.name,o.type==="radio"&&r!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==e&&u.form===e.form){var f=df(u);if(!f)throw Error(Ne(90));H1(u),Og(u,f)}}}break;case"textarea":K1(e,o);break;case"select":r=o.value,r!=null&&lc(e,!!o.multiple,r,!1)}};nw=k_;rw=rl;var aC={usingClientEntryPoint:!1,Events:[Rh,Ql,df,ew,tw,k_]},Hu={findFiberByHostInstance:qa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},lC={bundleType:Hu.bundleType,version:Hu.version,rendererPackageName:Hu.rendererPackageName,rendererConfig:Hu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ow(e),e===null?null:e.stateNode},findFiberByHostInstance:Hu.findFiberByHostInstance||sC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ap=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ap.isDisabled&&ap.supportsFiber)try{lf=ap.inject(lC),Ns=ap}catch{}}zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aC;zi.createPortal=function(e,r){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L_(r))throw Error(Ne(200));return iC(e,r,null,o)};zi.createRoot=function(e,r){if(!L_(e))throw Error(Ne(299));var o=!1,u="",f=Nb;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onRecoverableError!==void 0&&(f=r.onRecoverableError)),r=z_(e,1,!1,null,null,o,!1,u,f),e[vo]=r.current,vh(e.nodeType===8?e.parentNode:e),new D_(r)};zi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(Ne(188)):(e=Object.keys(e).join(","),Error(Ne(268,e)));return e=ow(r),e=e===null?null:e.stateNode,e};zi.flushSync=function(e){return rl(e)};zi.hydrate=function(e,r,o){if(!wf(r))throw Error(Ne(200));return bf(null,e,r,!0,o)};zi.hydrateRoot=function(e,r,o){if(!L_(e))throw Error(Ne(405));var u=o!=null&&o.hydratedSources||null,f=!1,v="",T=Nb;if(o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onRecoverableError!==void 0&&(T=o.onRecoverableError)),r=Bb(r,null,e,1,o??null,f,!1,v,T),e[vo]=r.current,vh(e),u)for(e=0;e<u.length;e++)o=u[e],f=o._getVersion,f=f(o._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[o,f]:r.mutableSourceEagerHydrationData.push(o,f);return new xf(r)};zi.render=function(e,r,o){if(!wf(r))throw Error(Ne(200));return bf(null,e,r,!1,o)};zi.unmountComponentAtNode=function(e){if(!wf(e))throw Error(Ne(40));return e._reactRootContainer?(rl(function(){bf(null,null,e,!1,function(){e._reactRootContainer=null,e[vo]=null})}),!0):!1};zi.unstable_batchedUpdates=k_;zi.unstable_renderSubtreeIntoContainer=function(e,r,o,u){if(!wf(o))throw Error(Ne(200));if(e==null||e._reactInternals===void 0)throw Error(Ne(38));return bf(e,r,o,!1,u)};zi.version="18.2.0-next-9e3b772b8-20220608";function jb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jb)}catch(e){console.error(e)}}jb(),B1.exports=zi;var cC=B1.exports,Bx=cC;Ag.createRoot=Bx.createRoot,Ag.hydrateRoot=Bx.hydrateRoot;function Ub(e,r){return function(){return e.apply(r,arguments)}}const{toString:uC}=Object.prototype,{getPrototypeOf:F_}=Object,Sf=(e=>r=>{const o=uC.call(r);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),$s=e=>(e=e.toLowerCase(),r=>Sf(r)===e),Tf=e=>r=>typeof r===e,{isArray:zc}=Array,kh=Tf("undefined");function hC(e){return e!==null&&!kh(e)&&e.constructor!==null&&!kh(e.constructor)&&Ki(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Vb=$s("ArrayBuffer");function dC(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&Vb(e.buffer),r}const pC=Tf("string"),Ki=Tf("function"),$b=Tf("number"),Ef=e=>e!==null&&typeof e=="object",fC=e=>e===!0||e===!1,Sp=e=>{if(Sf(e)!=="object")return!1;const r=F_(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},mC=$s("Date"),gC=$s("File"),yC=$s("Blob"),_C=$s("FileList"),vC=e=>Ef(e)&&Ki(e.pipe),xC=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||Ki(e.append)&&((r=Sf(e))==="formdata"||r==="object"&&Ki(e.toString)&&e.toString()==="[object FormData]"))},wC=$s("URLSearchParams"),bC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Lh(e,r,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let u,f;if(typeof e!="object"&&(e=[e]),zc(e))for(u=0,f=e.length;u<f;u++)r.call(null,e[u],u,e);else{const v=o?Object.getOwnPropertyNames(e):Object.keys(e),T=v.length;let c;for(u=0;u<T;u++)c=v[u],r.call(null,e[c],c,e)}}function qb(e,r){r=r.toLowerCase();const o=Object.keys(e);let u=o.length,f;for(;u-- >0;)if(f=o[u],r===f.toLowerCase())return f;return null}const Gb=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Zb=e=>!kh(e)&&e!==Gb;function Sy(){const{caseless:e}=Zb(this)&&this||{},r={},o=(u,f)=>{const v=e&&qb(r,f)||f;Sp(r[v])&&Sp(u)?r[v]=Sy(r[v],u):Sp(u)?r[v]=Sy({},u):zc(u)?r[v]=u.slice():r[v]=u};for(let u=0,f=arguments.length;u<f;u++)arguments[u]&&Lh(arguments[u],o);return r}const SC=(e,r,o,{allOwnKeys:u}={})=>(Lh(r,(f,v)=>{o&&Ki(f)?e[v]=Ub(f,o):e[v]=f},{allOwnKeys:u}),e),TC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),EC=(e,r,o,u)=>{e.prototype=Object.create(r.prototype,u),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),o&&Object.assign(e.prototype,o)},IC=(e,r,o,u)=>{let f,v,T;const c={};if(r=r||{},e==null)return r;do{for(f=Object.getOwnPropertyNames(e),v=f.length;v-- >0;)T=f[v],(!u||u(T,e,r))&&!c[T]&&(r[T]=e[T],c[T]=!0);e=o!==!1&&F_(e)}while(e&&(!o||o(e,r))&&e!==Object.prototype);return r},CC=(e,r,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=r.length;const u=e.indexOf(r,o);return u!==-1&&u===o},kC=e=>{if(!e)return null;if(zc(e))return e;let r=e.length;if(!$b(r))return null;const o=new Array(r);for(;r-- >0;)o[r]=e[r];return o},PC=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&F_(Uint8Array)),AC=(e,r)=>{const u=(e&&e[Symbol.iterator]).call(e);let f;for(;(f=u.next())&&!f.done;){const v=f.value;r.call(e,v[0],v[1])}},MC=(e,r)=>{let o;const u=[];for(;(o=e.exec(r))!==null;)u.push(o);return u},zC=$s("HTMLFormElement"),RC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,u,f){return u.toUpperCase()+f}),Nx=(({hasOwnProperty:e})=>(r,o)=>e.call(r,o))(Object.prototype),DC=$s("RegExp"),Hb=(e,r)=>{const o=Object.getOwnPropertyDescriptors(e),u={};Lh(o,(f,v)=>{let T;(T=r(f,v,e))!==!1&&(u[v]=T||f)}),Object.defineProperties(e,u)},LC=e=>{Hb(e,(r,o)=>{if(Ki(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const u=e[o];if(Ki(u)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},FC=(e,r)=>{const o={},u=f=>{f.forEach(v=>{o[v]=!0})};return zc(e)?u(e):u(String(e).split(r)),o},OC=()=>{},BC=(e,r)=>(e=+e,Number.isFinite(e)?e:r),gg="abcdefghijklmnopqrstuvwxyz",jx="0123456789",Wb={DIGIT:jx,ALPHA:gg,ALPHA_DIGIT:gg+gg.toUpperCase()+jx},NC=(e=16,r=Wb.ALPHA_DIGIT)=>{let o="";const{length:u}=r;for(;e--;)o+=r[Math.random()*u|0];return o};function jC(e){return!!(e&&Ki(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const UC=e=>{const r=new Array(10),o=(u,f)=>{if(Ef(u)){if(r.indexOf(u)>=0)return;if(!("toJSON"in u)){r[f]=u;const v=zc(u)?[]:{};return Lh(u,(T,c)=>{const z=o(T,f+1);!kh(z)&&(v[c]=z)}),r[f]=void 0,v}}return u};return o(e,0)},VC=$s("AsyncFunction"),$C=e=>e&&(Ef(e)||Ki(e))&&Ki(e.then)&&Ki(e.catch),Pe={isArray:zc,isArrayBuffer:Vb,isBuffer:hC,isFormData:xC,isArrayBufferView:dC,isString:pC,isNumber:$b,isBoolean:fC,isObject:Ef,isPlainObject:Sp,isUndefined:kh,isDate:mC,isFile:gC,isBlob:yC,isRegExp:DC,isFunction:Ki,isStream:vC,isURLSearchParams:wC,isTypedArray:PC,isFileList:_C,forEach:Lh,merge:Sy,extend:SC,trim:bC,stripBOM:TC,inherits:EC,toFlatObject:IC,kindOf:Sf,kindOfTest:$s,endsWith:CC,toArray:kC,forEachEntry:AC,matchAll:MC,isHTMLForm:zC,hasOwnProperty:Nx,hasOwnProp:Nx,reduceDescriptors:Hb,freezeMethods:LC,toObjectSet:FC,toCamelCase:RC,noop:OC,toFiniteNumber:BC,findKey:qb,global:Gb,isContextDefined:Zb,ALPHABET:Wb,generateString:NC,isSpecCompliantForm:jC,toJSONObject:UC,isAsyncFn:VC,isThenable:$C};function Bt(e,r,o,u,f){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),o&&(this.config=o),u&&(this.request=u),f&&(this.response=f)}Pe.inherits(Bt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Pe.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Kb=Bt.prototype,Xb={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Xb[e]={value:e}});Object.defineProperties(Bt,Xb);Object.defineProperty(Kb,"isAxiosError",{value:!0});Bt.from=(e,r,o,u,f,v)=>{const T=Object.create(Kb);return Pe.toFlatObject(e,T,function(z){return z!==Error.prototype},c=>c!=="isAxiosError"),Bt.call(T,e.message,r,o,u,f),T.cause=e,T.name=e.name,v&&Object.assign(T,v),T};const qC=null;function Ty(e){return Pe.isPlainObject(e)||Pe.isArray(e)}function Yb(e){return Pe.endsWith(e,"[]")?e.slice(0,-2):e}function Ux(e,r,o){return e?e.concat(r).map(function(f,v){return f=Yb(f),!o&&v?"["+f+"]":f}).join(o?".":""):r}function GC(e){return Pe.isArray(e)&&!e.some(Ty)}const ZC=Pe.toFlatObject(Pe,{},null,function(r){return/^is[A-Z]/.test(r)});function If(e,r,o){if(!Pe.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,o=Pe.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(ge,Me){return!Pe.isUndefined(Me[ge])});const u=o.metaTokens,f=o.visitor||V,v=o.dots,T=o.indexes,z=(o.Blob||typeof Blob<"u"&&Blob)&&Pe.isSpecCompliantForm(r);if(!Pe.isFunction(f))throw new TypeError("visitor must be a function");function P(ie){if(ie===null)return"";if(Pe.isDate(ie))return ie.toISOString();if(!z&&Pe.isBlob(ie))throw new Bt("Blob is not supported. Use a Buffer instead.");return Pe.isArrayBuffer(ie)||Pe.isTypedArray(ie)?z&&typeof Blob=="function"?new Blob([ie]):Buffer.from(ie):ie}function V(ie,ge,Me){let X=ie;if(ie&&!Me&&typeof ie=="object"){if(Pe.endsWith(ge,"{}"))ge=u?ge:ge.slice(0,-2),ie=JSON.stringify(ie);else if(Pe.isArray(ie)&&GC(ie)||(Pe.isFileList(ie)||Pe.endsWith(ge,"[]"))&&(X=Pe.toArray(ie)))return ge=Yb(ge),X.forEach(function(se,xe){!(Pe.isUndefined(se)||se===null)&&r.append(T===!0?Ux([ge],xe,v):T===null?ge:ge+"[]",P(se))}),!1}return Ty(ie)?!0:(r.append(Ux(Me,ge,v),P(ie)),!1)}const U=[],N=Object.assign(ZC,{defaultVisitor:V,convertValue:P,isVisitable:Ty});function le(ie,ge){if(!Pe.isUndefined(ie)){if(U.indexOf(ie)!==-1)throw Error("Circular reference detected in "+ge.join("."));U.push(ie),Pe.forEach(ie,function(X,Y){(!(Pe.isUndefined(X)||X===null)&&f.call(r,X,Pe.isString(Y)?Y.trim():Y,ge,N))===!0&&le(X,ge?ge.concat(Y):[Y])}),U.pop()}}if(!Pe.isObject(e))throw new TypeError("data must be an object");return le(e),r}function Vx(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(u){return r[u]})}function O_(e,r){this._pairs=[],e&&If(e,this,r)}const Jb=O_.prototype;Jb.append=function(r,o){this._pairs.push([r,o])};Jb.toString=function(r){const o=r?function(u){return r.call(this,u,Vx)}:Vx;return this._pairs.map(function(f){return o(f[0])+"="+o(f[1])},"").join("&")};function HC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Qb(e,r,o){if(!r)return e;const u=o&&o.encode||HC,f=o&&o.serialize;let v;if(f?v=f(r,o):v=Pe.isURLSearchParams(r)?r.toString():new O_(r,o).toString(u),v){const T=e.indexOf("#");T!==-1&&(e=e.slice(0,T)),e+=(e.indexOf("?")===-1?"?":"&")+v}return e}class WC{constructor(){this.handlers=[]}use(r,o,u){return this.handlers.push({fulfilled:r,rejected:o,synchronous:u?u.synchronous:!1,runWhen:u?u.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){Pe.forEach(this.handlers,function(u){u!==null&&r(u)})}}const $x=WC,e2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},KC=typeof URLSearchParams<"u"?URLSearchParams:O_,XC=typeof FormData<"u"?FormData:null,YC=typeof Blob<"u"?Blob:null,JC={isBrowser:!0,classes:{URLSearchParams:KC,FormData:XC,Blob:YC},protocols:["http","https","file","blob","url","data"]},t2=typeof window<"u"&&typeof document<"u",QC=(e=>t2&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),ek=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),tk=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:t2,hasStandardBrowserEnv:QC,hasStandardBrowserWebWorkerEnv:ek},Symbol.toStringTag,{value:"Module"})),Bs={...tk,...JC};function nk(e,r){return If(e,new Bs.classes.URLSearchParams,Object.assign({visitor:function(o,u,f,v){return Bs.isNode&&Pe.isBuffer(o)?(this.append(u,o.toString("base64")),!1):v.defaultVisitor.apply(this,arguments)}},r))}function rk(e){return Pe.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function ik(e){const r={},o=Object.keys(e);let u;const f=o.length;let v;for(u=0;u<f;u++)v=o[u],r[v]=e[v];return r}function n2(e){function r(o,u,f,v){let T=o[v++];const c=Number.isFinite(+T),z=v>=o.length;return T=!T&&Pe.isArray(f)?f.length:T,z?(Pe.hasOwnProp(f,T)?f[T]=[f[T],u]:f[T]=u,!c):((!f[T]||!Pe.isObject(f[T]))&&(f[T]=[]),r(o,u,f[T],v)&&Pe.isArray(f[T])&&(f[T]=ik(f[T])),!c)}if(Pe.isFormData(e)&&Pe.isFunction(e.entries)){const o={};return Pe.forEachEntry(e,(u,f)=>{r(rk(u),f,o,0)}),o}return null}function sk(e,r,o){if(Pe.isString(e))try{return(r||JSON.parse)(e),Pe.trim(e)}catch(u){if(u.name!=="SyntaxError")throw u}return(o||JSON.stringify)(e)}const B_={transitional:e2,adapter:["xhr","http"],transformRequest:[function(r,o){const u=o.getContentType()||"",f=u.indexOf("application/json")>-1,v=Pe.isObject(r);if(v&&Pe.isHTMLForm(r)&&(r=new FormData(r)),Pe.isFormData(r))return f&&f?JSON.stringify(n2(r)):r;if(Pe.isArrayBuffer(r)||Pe.isBuffer(r)||Pe.isStream(r)||Pe.isFile(r)||Pe.isBlob(r))return r;if(Pe.isArrayBufferView(r))return r.buffer;if(Pe.isURLSearchParams(r))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let c;if(v){if(u.indexOf("application/x-www-form-urlencoded")>-1)return nk(r,this.formSerializer).toString();if((c=Pe.isFileList(r))||u.indexOf("multipart/form-data")>-1){const z=this.env&&this.env.FormData;return If(c?{"files[]":r}:r,z&&new z,this.formSerializer)}}return v||f?(o.setContentType("application/json",!1),sk(r)):r}],transformResponse:[function(r){const o=this.transitional||B_.transitional,u=o&&o.forcedJSONParsing,f=this.responseType==="json";if(r&&Pe.isString(r)&&(u&&!this.responseType||f)){const T=!(o&&o.silentJSONParsing)&&f;try{return JSON.parse(r)}catch(c){if(T)throw c.name==="SyntaxError"?Bt.from(c,Bt.ERR_BAD_RESPONSE,this,null,this.response):c}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Bs.classes.FormData,Blob:Bs.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Pe.forEach(["delete","get","head","post","put","patch"],e=>{B_.headers[e]={}});const N_=B_,ok=Pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ak=e=>{const r={};let o,u,f;return e&&e.split(`
`).forEach(function(T){f=T.indexOf(":"),o=T.substring(0,f).trim().toLowerCase(),u=T.substring(f+1).trim(),!(!o||r[o]&&ok[o])&&(o==="set-cookie"?r[o]?r[o].push(u):r[o]=[u]:r[o]=r[o]?r[o]+", "+u:u)}),r},qx=Symbol("internals");function Wu(e){return e&&String(e).trim().toLowerCase()}function Tp(e){return e===!1||e==null?e:Pe.isArray(e)?e.map(Tp):String(e)}function lk(e){const r=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let u;for(;u=o.exec(e);)r[u[1]]=u[2];return r}const ck=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function yg(e,r,o,u,f){if(Pe.isFunction(u))return u.call(this,r,o);if(f&&(r=o),!!Pe.isString(r)){if(Pe.isString(u))return r.indexOf(u)!==-1;if(Pe.isRegExp(u))return u.test(r)}}function uk(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,o,u)=>o.toUpperCase()+u)}function hk(e,r){const o=Pe.toCamelCase(" "+r);["get","set","has"].forEach(u=>{Object.defineProperty(e,u+o,{value:function(f,v,T){return this[u].call(this,r,f,v,T)},configurable:!0})})}class Cf{constructor(r){r&&this.set(r)}set(r,o,u){const f=this;function v(c,z,P){const V=Wu(z);if(!V)throw new Error("header name must be a non-empty string");const U=Pe.findKey(f,V);(!U||f[U]===void 0||P===!0||P===void 0&&f[U]!==!1)&&(f[U||z]=Tp(c))}const T=(c,z)=>Pe.forEach(c,(P,V)=>v(P,V,z));return Pe.isPlainObject(r)||r instanceof this.constructor?T(r,o):Pe.isString(r)&&(r=r.trim())&&!ck(r)?T(ak(r),o):r!=null&&v(o,r,u),this}get(r,o){if(r=Wu(r),r){const u=Pe.findKey(this,r);if(u){const f=this[u];if(!o)return f;if(o===!0)return lk(f);if(Pe.isFunction(o))return o.call(this,f,u);if(Pe.isRegExp(o))return o.exec(f);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,o){if(r=Wu(r),r){const u=Pe.findKey(this,r);return!!(u&&this[u]!==void 0&&(!o||yg(this,this[u],u,o)))}return!1}delete(r,o){const u=this;let f=!1;function v(T){if(T=Wu(T),T){const c=Pe.findKey(u,T);c&&(!o||yg(u,u[c],c,o))&&(delete u[c],f=!0)}}return Pe.isArray(r)?r.forEach(v):v(r),f}clear(r){const o=Object.keys(this);let u=o.length,f=!1;for(;u--;){const v=o[u];(!r||yg(this,this[v],v,r,!0))&&(delete this[v],f=!0)}return f}normalize(r){const o=this,u={};return Pe.forEach(this,(f,v)=>{const T=Pe.findKey(u,v);if(T){o[T]=Tp(f),delete o[v];return}const c=r?uk(v):String(v).trim();c!==v&&delete o[v],o[c]=Tp(f),u[c]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const o=Object.create(null);return Pe.forEach(this,(u,f)=>{u!=null&&u!==!1&&(o[f]=r&&Pe.isArray(u)?u.join(", "):u)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,o])=>r+": "+o).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...o){const u=new this(r);return o.forEach(f=>u.set(f)),u}static accessor(r){const u=(this[qx]=this[qx]={accessors:{}}).accessors,f=this.prototype;function v(T){const c=Wu(T);u[c]||(hk(f,T),u[c]=!0)}return Pe.isArray(r)?r.forEach(v):v(r),this}}Cf.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Pe.reduceDescriptors(Cf.prototype,({value:e},r)=>{let o=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(u){this[o]=u}}});Pe.freezeMethods(Cf);const yo=Cf;function _g(e,r){const o=this||N_,u=r||o,f=yo.from(u.headers);let v=u.data;return Pe.forEach(e,function(c){v=c.call(o,v,f.normalize(),r?r.status:void 0)}),f.normalize(),v}function r2(e){return!!(e&&e.__CANCEL__)}function Fh(e,r,o){Bt.call(this,e??"canceled",Bt.ERR_CANCELED,r,o),this.name="CanceledError"}Pe.inherits(Fh,Bt,{__CANCEL__:!0});function dk(e,r,o){const u=o.config.validateStatus;!o.status||!u||u(o.status)?e(o):r(new Bt("Request failed with status code "+o.status,[Bt.ERR_BAD_REQUEST,Bt.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}const pk=Bs.hasStandardBrowserEnv?{write(e,r,o,u,f,v){const T=[e+"="+encodeURIComponent(r)];Pe.isNumber(o)&&T.push("expires="+new Date(o).toGMTString()),Pe.isString(u)&&T.push("path="+u),Pe.isString(f)&&T.push("domain="+f),v===!0&&T.push("secure"),document.cookie=T.join("; ")},read(e){const r=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function fk(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function mk(e,r){return r?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e}function i2(e,r){return e&&!fk(r)?mk(e,r):r}const gk=Bs.hasStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");let u;function f(v){let T=v;return r&&(o.setAttribute("href",T),T=o.href),o.setAttribute("href",T),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:o.pathname.charAt(0)==="/"?o.pathname:"/"+o.pathname}}return u=f(window.location.href),function(T){const c=Pe.isString(T)?f(T):T;return c.protocol===u.protocol&&c.host===u.host}}():function(){return function(){return!0}}();function yk(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function _k(e,r){e=e||10;const o=new Array(e),u=new Array(e);let f=0,v=0,T;return r=r!==void 0?r:1e3,function(z){const P=Date.now(),V=u[v];T||(T=P),o[f]=z,u[f]=P;let U=v,N=0;for(;U!==f;)N+=o[U++],U=U%e;if(f=(f+1)%e,f===v&&(v=(v+1)%e),P-T<r)return;const le=V&&P-V;return le?Math.round(N*1e3/le):void 0}}function Gx(e,r){let o=0;const u=_k(50,250);return f=>{const v=f.loaded,T=f.lengthComputable?f.total:void 0,c=v-o,z=u(c),P=v<=T;o=v;const V={loaded:v,total:T,progress:T?v/T:void 0,bytes:c,rate:z||void 0,estimated:z&&T&&P?(T-v)/z:void 0,event:f};V[r?"download":"upload"]=!0,e(V)}}const vk=typeof XMLHttpRequest<"u",xk=vk&&function(e){return new Promise(function(o,u){let f=e.data;const v=yo.from(e.headers).normalize();let{responseType:T,withXSRFToken:c}=e,z;function P(){e.cancelToken&&e.cancelToken.unsubscribe(z),e.signal&&e.signal.removeEventListener("abort",z)}let V;if(Pe.isFormData(f)){if(Bs.hasStandardBrowserEnv||Bs.hasStandardBrowserWebWorkerEnv)v.setContentType(!1);else if((V=v.getContentType())!==!1){const[ge,...Me]=V?V.split(";").map(X=>X.trim()).filter(Boolean):[];v.setContentType([ge||"multipart/form-data",...Me].join("; "))}}let U=new XMLHttpRequest;if(e.auth){const ge=e.auth.username||"",Me=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";v.set("Authorization","Basic "+btoa(ge+":"+Me))}const N=i2(e.baseURL,e.url);U.open(e.method.toUpperCase(),Qb(N,e.params,e.paramsSerializer),!0),U.timeout=e.timeout;function le(){if(!U)return;const ge=yo.from("getAllResponseHeaders"in U&&U.getAllResponseHeaders()),X={data:!T||T==="text"||T==="json"?U.responseText:U.response,status:U.status,statusText:U.statusText,headers:ge,config:e,request:U};dk(function(se){o(se),P()},function(se){u(se),P()},X),U=null}if("onloadend"in U?U.onloadend=le:U.onreadystatechange=function(){!U||U.readyState!==4||U.status===0&&!(U.responseURL&&U.responseURL.indexOf("file:")===0)||setTimeout(le)},U.onabort=function(){U&&(u(new Bt("Request aborted",Bt.ECONNABORTED,e,U)),U=null)},U.onerror=function(){u(new Bt("Network Error",Bt.ERR_NETWORK,e,U)),U=null},U.ontimeout=function(){let Me=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const X=e.transitional||e2;e.timeoutErrorMessage&&(Me=e.timeoutErrorMessage),u(new Bt(Me,X.clarifyTimeoutError?Bt.ETIMEDOUT:Bt.ECONNABORTED,e,U)),U=null},Bs.hasStandardBrowserEnv&&(c&&Pe.isFunction(c)&&(c=c(e)),c||c!==!1&&gk(N))){const ge=e.xsrfHeaderName&&e.xsrfCookieName&&pk.read(e.xsrfCookieName);ge&&v.set(e.xsrfHeaderName,ge)}f===void 0&&v.setContentType(null),"setRequestHeader"in U&&Pe.forEach(v.toJSON(),function(Me,X){U.setRequestHeader(X,Me)}),Pe.isUndefined(e.withCredentials)||(U.withCredentials=!!e.withCredentials),T&&T!=="json"&&(U.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&U.addEventListener("progress",Gx(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&U.upload&&U.upload.addEventListener("progress",Gx(e.onUploadProgress)),(e.cancelToken||e.signal)&&(z=ge=>{U&&(u(!ge||ge.type?new Fh(null,e,U):ge),U.abort(),U=null)},e.cancelToken&&e.cancelToken.subscribe(z),e.signal&&(e.signal.aborted?z():e.signal.addEventListener("abort",z)));const ie=yk(N);if(ie&&Bs.protocols.indexOf(ie)===-1){u(new Bt("Unsupported protocol "+ie+":",Bt.ERR_BAD_REQUEST,e));return}U.send(f||null)})},Ey={http:qC,xhr:xk};Pe.forEach(Ey,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const Zx=e=>`- ${e}`,wk=e=>Pe.isFunction(e)||e===null||e===!1,s2={getAdapter:e=>{e=Pe.isArray(e)?e:[e];const{length:r}=e;let o,u;const f={};for(let v=0;v<r;v++){o=e[v];let T;if(u=o,!wk(o)&&(u=Ey[(T=String(o)).toLowerCase()],u===void 0))throw new Bt(`Unknown adapter '${T}'`);if(u)break;f[T||"#"+v]=u}if(!u){const v=Object.entries(f).map(([c,z])=>`adapter ${c} `+(z===!1?"is not supported by the environment":"is not available in the build"));let T=r?v.length>1?`since :
`+v.map(Zx).join(`
`):" "+Zx(v[0]):"as no adapter specified";throw new Bt("There is no suitable adapter to dispatch the request "+T,"ERR_NOT_SUPPORT")}return u},adapters:Ey};function vg(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Fh(null,e)}function Hx(e){return vg(e),e.headers=yo.from(e.headers),e.data=_g.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),s2.getAdapter(e.adapter||N_.adapter)(e).then(function(u){return vg(e),u.data=_g.call(e,e.transformResponse,u),u.headers=yo.from(u.headers),u},function(u){return r2(u)||(vg(e),u&&u.response&&(u.response.data=_g.call(e,e.transformResponse,u.response),u.response.headers=yo.from(u.response.headers))),Promise.reject(u)})}const Wx=e=>e instanceof yo?e.toJSON():e;function bc(e,r){r=r||{};const o={};function u(P,V,U){return Pe.isPlainObject(P)&&Pe.isPlainObject(V)?Pe.merge.call({caseless:U},P,V):Pe.isPlainObject(V)?Pe.merge({},V):Pe.isArray(V)?V.slice():V}function f(P,V,U){if(Pe.isUndefined(V)){if(!Pe.isUndefined(P))return u(void 0,P,U)}else return u(P,V,U)}function v(P,V){if(!Pe.isUndefined(V))return u(void 0,V)}function T(P,V){if(Pe.isUndefined(V)){if(!Pe.isUndefined(P))return u(void 0,P)}else return u(void 0,V)}function c(P,V,U){if(U in r)return u(P,V);if(U in e)return u(void 0,P)}const z={url:v,method:v,data:v,baseURL:T,transformRequest:T,transformResponse:T,paramsSerializer:T,timeout:T,timeoutMessage:T,withCredentials:T,withXSRFToken:T,adapter:T,responseType:T,xsrfCookieName:T,xsrfHeaderName:T,onUploadProgress:T,onDownloadProgress:T,decompress:T,maxContentLength:T,maxBodyLength:T,beforeRedirect:T,transport:T,httpAgent:T,httpsAgent:T,cancelToken:T,socketPath:T,responseEncoding:T,validateStatus:c,headers:(P,V)=>f(Wx(P),Wx(V),!0)};return Pe.forEach(Object.keys(Object.assign({},e,r)),function(V){const U=z[V]||f,N=U(e[V],r[V],V);Pe.isUndefined(N)&&U!==c||(o[V]=N)}),o}const o2="1.6.2",j_={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{j_[e]=function(u){return typeof u===e||"a"+(r<1?"n ":" ")+e}});const Kx={};j_.transitional=function(r,o,u){function f(v,T){return"[Axios v"+o2+"] Transitional option '"+v+"'"+T+(u?". "+u:"")}return(v,T,c)=>{if(r===!1)throw new Bt(f(T," has been removed"+(o?" in "+o:"")),Bt.ERR_DEPRECATED);return o&&!Kx[T]&&(Kx[T]=!0,console.warn(f(T," has been deprecated since v"+o+" and will be removed in the near future"))),r?r(v,T,c):!0}};function bk(e,r,o){if(typeof e!="object")throw new Bt("options must be an object",Bt.ERR_BAD_OPTION_VALUE);const u=Object.keys(e);let f=u.length;for(;f-- >0;){const v=u[f],T=r[v];if(T){const c=e[v],z=c===void 0||T(c,v,e);if(z!==!0)throw new Bt("option "+v+" must be "+z,Bt.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new Bt("Unknown option "+v,Bt.ERR_BAD_OPTION)}}const Iy={assertOptions:bk,validators:j_},Ho=Iy.validators;class tf{constructor(r){this.defaults=r,this.interceptors={request:new $x,response:new $x}}request(r,o){typeof r=="string"?(o=o||{},o.url=r):o=r||{},o=bc(this.defaults,o);const{transitional:u,paramsSerializer:f,headers:v}=o;u!==void 0&&Iy.assertOptions(u,{silentJSONParsing:Ho.transitional(Ho.boolean),forcedJSONParsing:Ho.transitional(Ho.boolean),clarifyTimeoutError:Ho.transitional(Ho.boolean)},!1),f!=null&&(Pe.isFunction(f)?o.paramsSerializer={serialize:f}:Iy.assertOptions(f,{encode:Ho.function,serialize:Ho.function},!0)),o.method=(o.method||this.defaults.method||"get").toLowerCase();let T=v&&Pe.merge(v.common,v[o.method]);v&&Pe.forEach(["delete","get","head","post","put","patch","common"],ie=>{delete v[ie]}),o.headers=yo.concat(T,v);const c=[];let z=!0;this.interceptors.request.forEach(function(ge){typeof ge.runWhen=="function"&&ge.runWhen(o)===!1||(z=z&&ge.synchronous,c.unshift(ge.fulfilled,ge.rejected))});const P=[];this.interceptors.response.forEach(function(ge){P.push(ge.fulfilled,ge.rejected)});let V,U=0,N;if(!z){const ie=[Hx.bind(this),void 0];for(ie.unshift.apply(ie,c),ie.push.apply(ie,P),N=ie.length,V=Promise.resolve(o);U<N;)V=V.then(ie[U++],ie[U++]);return V}N=c.length;let le=o;for(U=0;U<N;){const ie=c[U++],ge=c[U++];try{le=ie(le)}catch(Me){ge.call(this,Me);break}}try{V=Hx.call(this,le)}catch(ie){return Promise.reject(ie)}for(U=0,N=P.length;U<N;)V=V.then(P[U++],P[U++]);return V}getUri(r){r=bc(this.defaults,r);const o=i2(r.baseURL,r.url);return Qb(o,r.params,r.paramsSerializer)}}Pe.forEach(["delete","get","head","options"],function(r){tf.prototype[r]=function(o,u){return this.request(bc(u||{},{method:r,url:o,data:(u||{}).data}))}});Pe.forEach(["post","put","patch"],function(r){function o(u){return function(v,T,c){return this.request(bc(c||{},{method:r,headers:u?{"Content-Type":"multipart/form-data"}:{},url:v,data:T}))}}tf.prototype[r]=o(),tf.prototype[r+"Form"]=o(!0)});const Ep=tf;class U_{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(v){o=v});const u=this;this.promise.then(f=>{if(!u._listeners)return;let v=u._listeners.length;for(;v-- >0;)u._listeners[v](f);u._listeners=null}),this.promise.then=f=>{let v;const T=new Promise(c=>{u.subscribe(c),v=c}).then(f);return T.cancel=function(){u.unsubscribe(v)},T},r(function(v,T,c){u.reason||(u.reason=new Fh(v,T,c),o(u.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const o=this._listeners.indexOf(r);o!==-1&&this._listeners.splice(o,1)}static source(){let r;return{token:new U_(function(f){r=f}),cancel:r}}}const Sk=U_;function Tk(e){return function(o){return e.apply(null,o)}}function Ek(e){return Pe.isObject(e)&&e.isAxiosError===!0}const Cy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Cy).forEach(([e,r])=>{Cy[r]=e});const Ik=Cy;function a2(e){const r=new Ep(e),o=Ub(Ep.prototype.request,r);return Pe.extend(o,Ep.prototype,r,{allOwnKeys:!0}),Pe.extend(o,r,null,{allOwnKeys:!0}),o.create=function(f){return a2(bc(e,f))},o}const Jn=a2(N_);Jn.Axios=Ep;Jn.CanceledError=Fh;Jn.CancelToken=Sk;Jn.isCancel=r2;Jn.VERSION=o2;Jn.toFormData=If;Jn.AxiosError=Bt;Jn.Cancel=Jn.CanceledError;Jn.all=function(r){return Promise.all(r)};Jn.spread=Tk;Jn.isAxiosError=Ek;Jn.mergeConfig=bc;Jn.AxiosHeaders=yo;Jn.formToJSON=e=>n2(Pe.isHTMLForm(e)?new FormData(e):e);Jn.getAdapter=s2.getAdapter;Jn.HttpStatusCode=Ik;Jn.default=Jn;const Us=Jn;const Xx=localStorage.getItem("jwt");Xx&&(Us.defaults.headers.common.Authorization=`Bearer ${Xx}`);function Ck(){const[e,r]=lt.useState([]),o=f=>{f.preventDefault(),r([]);const v=new FormData(f.target);Us.post("http://localhost:3000/sessions.json",v).then(T=>{console.log(T.data),Us.defaults.headers.common.Authorization="Bearer "+T.data.jwt,localStorage.setItem("jwt",T.data.jwt),f.target.reset(),window.location.href="/"}).catch(T=>{console.log(T.response),r(["Invalid email or password"])})},u=f=>{f.preventDefault(),delete Us.defaults.headers.common.Authorization,localStorage.removeItem("jwt"),window.location.href="/"};return ce.jsx("div",{className:"content",children:ce.jsx("nav",{className:"navbar navbar-expand-lg .bg-transparent",children:ce.jsx("div",{className:"container-fluid",children:ce.jsxs("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[ce.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[ce.jsx("li",{className:"nav-item",children:ce.jsx("a",{className:"nav-link active text-white","aria-current":"page",href:"/",children:ce.jsx("h3",{className:"navtext",children:"HOME"})})}),ce.jsx("li",{className:"nav-item",children:ce.jsx("a",{className:"nav-link text-white",href:"/nationalparks",children:ce.jsx("h3",{className:"navtext",children:"PARK INDEX"})})}),ce.jsx("li",{className:"nav-item",children:ce.jsx("a",{className:"nav-link text-white",href:"/myparks",children:ce.jsx("h3",{className:"navtext",children:"MY PARKS"})})}),ce.jsx("li",{className:"Signup",children:ce.jsx("a",{className:"nav-link text-white",href:"/signup",children:ce.jsx("h3",{className:"navtext",children:"SIGN UP"})})})]}),ce.jsxs("div",{children:[e.map(f=>ce.jsx("div",{children:f},f)),ce.jsx("form",{onSubmit:o,children:ce.jsx("div",{className:"signinblock",children:ce.jsxs("div",{className:"row",children:[ce.jsx("div",{className:"col",children:ce.jsx("input",{name:"email",type:"email",placeholder:"Email"})}),ce.jsx("div",{className:"col",children:ce.jsx("input",{name:"password",type:"password",placeholder:"Password"})}),ce.jsx("div",{className:"col",children:ce.jsx("button",{className:"loginbutton",type:"submit",children:ce.jsx("h3",{className:"navtext",children:"SIGN IN"})})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"logout",children:ce.jsx("button",{className:"noline",href:"#",type:"submit",onClick:u,children:ce.jsx("h3",{className:"navtext",children:"LOGOUT"})})})})]})})})]})]})})})})}/**
 * @remix-run/router v1.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nf(){return nf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(e[u]=o[u])}return e},nf.apply(this,arguments)}var na;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(na||(na={}));const Yx="popstate";function kk(e){e===void 0&&(e={});function r(u,f){let{pathname:v,search:T,hash:c}=u.location;return ky("",{pathname:v,search:T,hash:c},f.state&&f.state.usr||null,f.state&&f.state.key||"default")}function o(u,f){return typeof f=="string"?f:l2(f)}return Ak(r,o,null,e)}function bi(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function V_(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function Pk(){return Math.random().toString(36).substr(2,8)}function Jx(e,r){return{usr:e.state,key:e.key,idx:r}}function ky(e,r,o,u){return o===void 0&&(o=null),nf({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?kf(r):r,{state:o,key:r&&r.key||u||Pk()})}function l2(e){let{pathname:r="/",search:o="",hash:u=""}=e;return o&&o!=="?"&&(r+=o.charAt(0)==="?"?o:"?"+o),u&&u!=="#"&&(r+=u.charAt(0)==="#"?u:"#"+u),r}function kf(e){let r={};if(e){let o=e.indexOf("#");o>=0&&(r.hash=e.substr(o),e=e.substr(0,o));let u=e.indexOf("?");u>=0&&(r.search=e.substr(u),e=e.substr(0,u)),e&&(r.pathname=e)}return r}function Ak(e,r,o,u){u===void 0&&(u={});let{window:f=document.defaultView,v5Compat:v=!1}=u,T=f.history,c=na.Pop,z=null,P=V();P==null&&(P=0,T.replaceState(nf({},T.state,{idx:P}),""));function V(){return(T.state||{idx:null}).idx}function U(){c=na.Pop;let Me=V(),X=Me==null?null:Me-P;P=Me,z&&z({action:c,location:ge.location,delta:X})}function N(Me,X){c=na.Push;let Y=ky(ge.location,Me,X);o&&o(Y,Me),P=V()+1;let se=Jx(Y,P),xe=ge.createHref(Y);try{T.pushState(se,"",xe)}catch(Ae){if(Ae instanceof DOMException&&Ae.name==="DataCloneError")throw Ae;f.location.assign(xe)}v&&z&&z({action:c,location:ge.location,delta:1})}function le(Me,X){c=na.Replace;let Y=ky(ge.location,Me,X);o&&o(Y,Me),P=V();let se=Jx(Y,P),xe=ge.createHref(Y);T.replaceState(se,"",xe),v&&z&&z({action:c,location:ge.location,delta:0})}function ie(Me){let X=f.location.origin!=="null"?f.location.origin:f.location.href,Y=typeof Me=="string"?Me:l2(Me);return bi(X,"No window.location.(origin|href) available to create URL for href: "+Y),new URL(Y,X)}let ge={get action(){return c},get location(){return e(f,T)},listen(Me){if(z)throw new Error("A history only accepts one active listener");return f.addEventListener(Yx,U),z=Me,()=>{f.removeEventListener(Yx,U),z=null}},createHref(Me){return r(f,Me)},createURL:ie,encodeLocation(Me){let X=ie(Me);return{pathname:X.pathname,search:X.search,hash:X.hash}},push:N,replace:le,go(Me){return T.go(Me)}};return ge}var Qx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Qx||(Qx={}));function Mk(e,r,o){o===void 0&&(o="/");let u=typeof r=="string"?kf(r):r,f=h2(u.pathname||"/",o);if(f==null)return null;let v=c2(e);zk(v);let T=null;for(let c=0;T==null&&c<v.length;++c)T=Uk(v[c],qk(f));return T}function c2(e,r,o,u){r===void 0&&(r=[]),o===void 0&&(o=[]),u===void 0&&(u="");let f=(v,T,c)=>{let z={relativePath:c===void 0?v.path||"":c,caseSensitive:v.caseSensitive===!0,childrenIndex:T,route:v};z.relativePath.startsWith("/")&&(bi(z.relativePath.startsWith(u),'Absolute route path "'+z.relativePath+'" nested under path '+('"'+u+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),z.relativePath=z.relativePath.slice(u.length));let P=fc([u,z.relativePath]),V=o.concat(z);v.children&&v.children.length>0&&(bi(v.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+P+'".')),c2(v.children,r,V,P)),!(v.path==null&&!v.index)&&r.push({path:P,score:Nk(P,v.index),routesMeta:V})};return e.forEach((v,T)=>{var c;if(v.path===""||!((c=v.path)!=null&&c.includes("?")))f(v,T);else for(let z of u2(v.path))f(v,T,z)}),r}function u2(e){let r=e.split("/");if(r.length===0)return[];let[o,...u]=r,f=o.endsWith("?"),v=o.replace(/\?$/,"");if(u.length===0)return f?[v,""]:[v];let T=u2(u.join("/")),c=[];return c.push(...T.map(z=>z===""?v:[v,z].join("/"))),f&&c.push(...T),c.map(z=>e.startsWith("/")&&z===""?"/":z)}function zk(e){e.sort((r,o)=>r.score!==o.score?o.score-r.score:jk(r.routesMeta.map(u=>u.childrenIndex),o.routesMeta.map(u=>u.childrenIndex)))}const Rk=/^:\w+$/,Dk=3,Lk=2,Fk=1,Ok=10,Bk=-2,e1=e=>e==="*";function Nk(e,r){let o=e.split("/"),u=o.length;return o.some(e1)&&(u+=Bk),r&&(u+=Lk),o.filter(f=>!e1(f)).reduce((f,v)=>f+(Rk.test(v)?Dk:v===""?Fk:Ok),u)}function jk(e,r){return e.length===r.length&&e.slice(0,-1).every((u,f)=>u===r[f])?e[e.length-1]-r[r.length-1]:0}function Uk(e,r){let{routesMeta:o}=e,u={},f="/",v=[];for(let T=0;T<o.length;++T){let c=o[T],z=T===o.length-1,P=f==="/"?r:r.slice(f.length)||"/",V=Vk({path:c.relativePath,caseSensitive:c.caseSensitive,end:z},P);if(!V)return null;Object.assign(u,V.params);let U=c.route;v.push({params:u,pathname:fc([f,V.pathname]),pathnameBase:Zk(fc([f,V.pathnameBase])),route:U}),V.pathnameBase!=="/"&&(f=fc([f,V.pathnameBase]))}return v}function Vk(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,u]=$k(e.path,e.caseSensitive,e.end),f=r.match(o);if(!f)return null;let v=f[0],T=v.replace(/(.)\/+$/,"$1"),c=f.slice(1);return{params:u.reduce((P,V,U)=>{if(V==="*"){let N=c[U]||"";T=v.slice(0,v.length-N.length).replace(/(.)\/+$/,"$1")}return P[V]=Gk(c[U]||"",V),P},{}),pathname:v,pathnameBase:T,pattern:e}}function $k(e,r,o){r===void 0&&(r=!1),o===void 0&&(o=!0),V_(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let u=[],f="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(T,c)=>(u.push(c),"/([^\\/]+)"));return e.endsWith("*")?(u.push("*"),f+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?f+="\\/*$":e!==""&&e!=="/"&&(f+="(?:(?=\\/|$))"),[new RegExp(f,r?void 0:"i"),u]}function qk(e){try{return decodeURI(e)}catch(r){return V_(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function Gk(e,r){try{return decodeURIComponent(e)}catch(o){return V_(!1,'The value for the URL param "'+r+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+o+").")),e}}function h2(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let o=r.endsWith("/")?r.length-1:r.length,u=e.charAt(o);return u&&u!=="/"?null:e.slice(o)||"/"}const fc=e=>e.join("/").replace(/\/\/+/g,"/"),Zk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function Hk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const d2=["post","put","patch","delete"];new Set(d2);const Wk=["get",...d2];new Set(Wk);/**
 * React Router v6.17.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Py(){return Py=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(e[u]=o[u])}return e},Py.apply(this,arguments)}const Kk=lt.createContext(null),Xk=lt.createContext(null),p2=lt.createContext(null),Pf=lt.createContext(null),Af=lt.createContext({outlet:null,matches:[],isDataRoute:!1}),f2=lt.createContext(null);function $_(){return lt.useContext(Pf)!=null}function Yk(){return $_()||bi(!1),lt.useContext(Pf).location}function Jk(e,r){return Qk(e,r)}function Qk(e,r,o){$_()||bi(!1);let{navigator:u}=lt.useContext(p2),{matches:f}=lt.useContext(Af),v=f[f.length-1],T=v?v.params:{};v&&v.pathname;let c=v?v.pathnameBase:"/";v&&v.route;let z=Yk(),P;if(r){var V;let ge=typeof r=="string"?kf(r):r;c==="/"||(V=ge.pathname)!=null&&V.startsWith(c)||bi(!1),P=ge}else P=z;let U=P.pathname||"/",N=c==="/"?U:U.slice(c.length)||"/",le=Mk(e,{pathname:N}),ie=iP(le&&le.map(ge=>Object.assign({},ge,{params:Object.assign({},T,ge.params),pathname:fc([c,u.encodeLocation?u.encodeLocation(ge.pathname).pathname:ge.pathname]),pathnameBase:ge.pathnameBase==="/"?c:fc([c,u.encodeLocation?u.encodeLocation(ge.pathnameBase).pathname:ge.pathnameBase])})),f,o);return r&&ie?lt.createElement(Pf.Provider,{value:{location:Py({pathname:"/",search:"",hash:"",state:null,key:"default"},P),navigationType:na.Pop}},ie):ie}function eP(){let e=lP(),r=Hk(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,f={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},v=null;return lt.createElement(lt.Fragment,null,lt.createElement("h2",null,"Unexpected Application Error!"),lt.createElement("h3",{style:{fontStyle:"italic"}},r),o?lt.createElement("pre",{style:f},o):null,v)}const tP=lt.createElement(eP,null);class nP extends lt.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,o){return o.location!==r.location||o.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error||o.error,location:o.location,revalidation:r.revalidation||o.revalidation}}componentDidCatch(r,o){console.error("React Router caught the following error during render",r,o)}render(){return this.state.error?lt.createElement(Af.Provider,{value:this.props.routeContext},lt.createElement(f2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function rP(e){let{routeContext:r,match:o,children:u}=e,f=lt.useContext(Kk);return f&&f.static&&f.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(f.staticContext._deepestRenderedBoundaryId=o.route.id),lt.createElement(Af.Provider,{value:r},u)}function iP(e,r,o){var u;if(r===void 0&&(r=[]),o===void 0&&(o=null),e==null){var f;if((f=o)!=null&&f.errors)e=o.matches;else return null}let v=e,T=(u=o)==null?void 0:u.errors;if(T!=null){let c=v.findIndex(z=>z.route.id&&(T==null?void 0:T[z.route.id]));c>=0||bi(!1),v=v.slice(0,Math.min(v.length,c+1))}return v.reduceRight((c,z,P)=>{let V=z.route.id?T==null?void 0:T[z.route.id]:null,U=null;o&&(U=z.route.errorElement||tP);let N=r.concat(v.slice(0,P+1)),le=()=>{let ie;return V?ie=U:z.route.Component?ie=lt.createElement(z.route.Component,null):z.route.element?ie=z.route.element:ie=c,lt.createElement(rP,{match:z,routeContext:{outlet:c,matches:N,isDataRoute:o!=null},children:ie})};return o&&(z.route.ErrorBoundary||z.route.errorElement||P===0)?lt.createElement(nP,{location:o.location,revalidation:o.revalidation,component:U,error:V,children:le(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):le()},null)}var Ay=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ay||{});function sP(e){let r=lt.useContext(Xk);return r||bi(!1),r}function oP(e){let r=lt.useContext(Af);return r||bi(!1),r}function aP(e){let r=oP(),o=r.matches[r.matches.length-1];return o.route.id||bi(!1),o.route.id}function lP(){var e;let r=lt.useContext(f2),o=sP(Ay.UseRouteError),u=aP(Ay.UseRouteError);return r||((e=o.errors)==null?void 0:e[u])}function oc(e){bi(!1)}function cP(e){let{basename:r="/",children:o=null,location:u,navigationType:f=na.Pop,navigator:v,static:T=!1}=e;$_()&&bi(!1);let c=r.replace(/^\/*/,"/"),z=lt.useMemo(()=>({basename:c,navigator:v,static:T}),[c,v,T]);typeof u=="string"&&(u=kf(u));let{pathname:P="/",search:V="",hash:U="",state:N=null,key:le="default"}=u,ie=lt.useMemo(()=>{let ge=h2(P,c);return ge==null?null:{location:{pathname:ge,search:V,hash:U,state:N,key:le},navigationType:f}},[c,P,V,U,N,le,f]);return ie==null?null:lt.createElement(p2.Provider,{value:z},lt.createElement(Pf.Provider,{children:o,value:ie}))}function m2(e){let{children:r,location:o}=e;return Jk(My(r),o)}new Promise(()=>{});function My(e,r){r===void 0&&(r=[]);let o=[];return lt.Children.forEach(e,(u,f)=>{if(!lt.isValidElement(u))return;let v=[...r,f];if(u.type===lt.Fragment){o.push.apply(o,My(u.props.children,v));return}u.type!==oc&&bi(!1),!u.props.index||!u.props.children||bi(!1);let T={id:u.props.id||v.join("-"),caseSensitive:u.props.caseSensitive,element:u.props.element,Component:u.props.Component,index:u.props.index,path:u.props.path,loader:u.props.loader,action:u.props.action,errorElement:u.props.errorElement,ErrorBoundary:u.props.ErrorBoundary,hasErrorBoundary:u.props.ErrorBoundary!=null||u.props.errorElement!=null,shouldRevalidate:u.props.shouldRevalidate,handle:u.props.handle,lazy:u.props.lazy};u.props.children&&(T.children=My(u.props.children,v)),o.push(T)}),o}/**
 * React Router DOM v6.17.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const uP="startTransition",t1=QT[uP];function hP(e){let{basename:r,children:o,future:u,window:f}=e,v=lt.useRef();v.current==null&&(v.current=kk({window:f,v5Compat:!0}));let T=v.current,[c,z]=lt.useState({action:T.action,location:T.location}),{v7_startTransition:P}=u||{},V=lt.useCallback(U=>{P&&t1?t1(()=>z(U)):z(U)},[z,P]);return lt.useLayoutEffect(()=>T.listen(V),[T,V]),lt.createElement(cP,{basename:r,children:o,location:c.location,navigationType:c.action,navigator:T})}var n1;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(n1||(n1={}));var r1;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(r1||(r1={}));function dP(){return ce.jsx("div",{className:"home-page",children:ce.jsxs("div",{className:"home",children:[ce.jsxs("div",{className:"title",children:[ce.jsx("h1",{children:"NATIONAL PARKS"}),ce.jsxs("div",{className:"row",children:[ce.jsx("h1",{className:"col",children:"CAMP REVIEWS"}),ce.jsx("div",{className:"col-2",children:ce.jsx("img",{src:"https://icon-library.com/images/camping-icon-png/camping-icon-png-15.jpg",width:"350",height:"300"})})]})]}),ce.jsx("div",{className:"yosemite",children:ce.jsxs("div",{className:"row",children:[ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yose-description",children:ce.jsx("h6",{className:"description",children:"Yosemite is noted for its outstanding sceneryincluding peaks, canyons, cliffs, domes, rivers, lakes, immense waterfalls, lush green meadows, wildlife, and forests. Yosemite National Park contains a unique assemblage of massive granite domes and glacial features, which resulted from a rich geologic history."})})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yose-image",children:ce.jsx("img",{src:"https://cdn.aarp.net/content/dam/aarp/travel/destinations/2020/09/1140-yosemite-hero.imgcache.rev.web.1914.1100.jpg",width:"350",height:"200",alt:"Yosemite"})})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yose",children:"YOSEMITE"})})]})}),ce.jsx("div",{className:"yellowstone",children:ce.jsxs("div",{className:"row",children:[ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yellow",children:"YELLOWSTONE"})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yellow-image",children:ce.jsx("img",{src:"https://national-park.com/wp-content/uploads/2016/04/Welcome-to-Yellowstone-National-Park.jpg",width:"350",height:"200",alt:"Yellowstone"})})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yellow-description",children:ce.jsx("h6",{className:"description-2",children:"Yellowstone sits on top of a dormant volcano and is home to more geysers and hot springs than any other place on earth. Wonders abound at this truly unique national park, from sites like the Yellowstone Grand Canyon to wildlife like Americas largest buffalo herd, grizzly bears, and wolves."})})})]})}),ce.jsx("div",{className:"olympic",children:ce.jsxs("div",{className:"row",children:[ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yose-description",children:ce.jsx("h6",{className:"description",children:"Encompassing nearly a million acres, the park protects a vast wilderness, thousands of years of human history, and several distinctly different ecosystems, including glacier-capped mountains, old-growth temperate rain forests, and over 70 miles of wild coastline."})})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"olympic-image",children:ce.jsx("img",{src:"https://s27363.pcdn.co/wp-content/uploads/2021/02/Hurricane-Ridge-Olympic-NP.jpg.optimal.jpg",width:"350",height:"200",alt:"Olympic"})})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"yellow",children:"OLYMPIC"})})]})})]})})}function pP(){return ce.jsx("div",{children:ce.jsx(m2,{children:ce.jsx(oc,{path:"/",element:ce.jsx(dP,{})})})})}function fP(){const[e,r]=lt.useState([]),o=u=>{u.preventDefault(),r([]);const f=new FormData(u.target);Us.post("http://localhost:3000/users.json",f).then(v=>{console.log(v.data),u.target.reset(),window.location.href="/"}).catch(v=>{console.log(v.response.data.errors),r(v.response.data.errors)})};return ce.jsx("div",{className:"signup-page",children:ce.jsx("div",{className:"signup",children:ce.jsxs("div",{id:"signup",children:[ce.jsx("h1",{children:"SIGN UP"}),ce.jsx("ul",{children:e.map(u=>ce.jsx("li",{children:u},u))}),ce.jsx("form",{onSubmit:o,children:ce.jsxs("div",{className:"form-info",children:[ce.jsxs("div",{className:"form-text",children:[ce.jsxs("div",{children:[ce.jsx("h6",{className:"form"}),ce.jsx("input",{className:"bar",name:"name",type:"text",placeholder:"Name"})]}),ce.jsxs("div",{children:[ce.jsx("h6",{className:"form"}),ce.jsx("input",{className:"bar",name:"email",type:"email",placeholder:"Email"})]}),ce.jsxs("div",{children:[ce.jsx("h6",{className:"form"}),ce.jsx("input",{className:"bar",name:"password",type:"password",placeholder:"Password"})]}),ce.jsxs("div",{children:[ce.jsx("h6",{className:"form"}),ce.jsx("input",{className:"bar",name:"password_confirmation",type:"password",placeholder:"Password Confirmation"})]}),ce.jsx("br",{})]}),ce.jsx("button",{className:"button",type:"submit",children:"Join Now"})]})})]})})})}function mP(){const[e,r]=lt.useState([]),[o,u]=lt.useState(""),[f,v]=lt.useState(""),[T,c]=lt.useState(""),[z,P]=lt.useState([]),V=()=>{Us.get("http://localhost:3000/parks.json").then(N=>{console.log(N.data),r(N.data)})};lt.useEffect(V,[]);const U=N=>{N!==0&&Us.post(`http://localhost:3000/parks_lists/${N}.json`).then(le=>{console.log(le.data),P([...z,le.data])})};return ce.jsx("div",{className:"parksindex-page",children:ce.jsxs("div",{className:"parksindex",children:[ce.jsx("h1",{className:"nationalp",children:"NATIONAL PARKS"}),ce.jsx("div",{className:"searchbars",children:ce.jsx("div",{className:"container text-center",children:ce.jsxs("div",{className:"row justify-content-evenly",children:[ce.jsx("span",{className:"col-4",children:ce.jsx("input",{className:"searchfield",type:"text",value:o,placeholder:"Search by Name..",onChange:N=>u(N.target.value)})}),ce.jsx("br",{}),ce.jsx("span",{className:"col-4",children:ce.jsx("input",{className:"searchfield",type:"text",placeholder:"Search by City..",value:T,onChange:N=>c(N.target.value)})}),ce.jsx("br",{}),ce.jsx("span",{className:"col-4",children:ce.jsx("input",{className:"searchfield",type:"number",placeholder:"Search by Campsites Provided..",value:f,onChange:N=>v(N.target.value)})})]})})}),ce.jsx("div",{className:"summary",children:e.filter(N=>N.name.toLowerCase().includes(o.toLowerCase())&&(T===""||N&&N.city&&N.city.toLowerCase().includes(T.toLowerCase()))&&N.totalsites>=f).map(N=>ce.jsxs("div",{className:"parksummary",children:[ce.jsxs("div",{children:[ce.jsxs("span",{children:[ce.jsx("h2",{className:"park-name",children:N.name.toUpperCase()}),N.city&&N.city.length>1&&ce.jsx("h2",{className:"city-name",children:N.city.toUpperCase()})]}),ce.jsx("div",{className:"parkinfo-background",children:ce.jsxs("div",{className:"row",children:[ce.jsx("div",{className:"col",children:ce.jsxs("div",{className:"campsites",children:[ce.jsxs("span",{children:[ce.jsx("h6",{children:"Total Campsites"}),N.totalsites]}),ce.jsxs("span",{children:[ce.jsx("h6",{children:"First Come First Serve"}),N.firstcome]}),ce.jsxs("span",{children:[ce.jsx("h6",{children:"Reservable"}),N.reservable]})]})}),ce.jsx("div",{className:"col",children:ce.jsxs("div",{className:"ratinginfo",children:[ce.jsx("h5",{children:"Site Info"}),N.fees&&N.fees.length>0&&ce.jsx("div",{children:ce.jsxs("p",{children:["Entry Fee - ",N.fees[0].cost]})}),ce.jsxs("p",{children:["Showers - ",N.showers]}),ce.jsxs("p",{children:["Toilets - ",N.toilets]}),ce.jsxs("p",{children:["Phone Reception - ",N.cellPhoneReception]}),ce.jsx("a",{href:N.url,children:N.url})]})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"parkinfo",children:ce.jsxs("span",{children:[ce.jsx("h5",{children:"Description"}),N.description]})})})]})})]}),ce.jsx("button",{className:"button2",type:"button",onClick:()=>U(N.id),children:"Add to my List"})]},N.id))})]})})}var g2={exports:{}};(function(e,r){(function(o,u){e.exports=u()})(OT,function(){var o,u,f;function v(c,z){if(!o)o=z;else if(!u)u=z;else{var P="var sharedChunk = {}; ("+o+")(sharedChunk); ("+u+")(sharedChunk);",V={};o(V),f=z(V),typeof window<"u"&&(f.workerUrl=window.URL.createObjectURL(new Blob([P],{type:"text/javascript"})))}}v(["exports"],function(c){function z(i,t,s,l){return new(s||(s=Promise))(function(d,g){function _(I){try{S(l.next(I))}catch(k){g(k)}}function x(I){try{S(l.throw(I))}catch(k){g(k)}}function S(I){var k;I.done?d(I.value):(k=I.value,k instanceof s?k:new s(function(R){R(k)})).then(_,x)}S((l=l.apply(i,t||[])).next())})}function P(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var V=U;function U(i,t){this.x=i,this.y=t}U.prototype={clone:function(){return new U(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,s=i.y-this.y;return t*t+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),s=Math.sin(i),l=s*this.x+t*this.y;return this.x=t*this.x-s*this.y,this.y=l,this},_rotateAround:function(i,t){var s=Math.cos(i),l=Math.sin(i),d=t.y+l*(this.x-t.x)+s*(this.y-t.y);return this.x=t.x+s*(this.x-t.x)-l*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},U.convert=function(i){return i instanceof U?i:Array.isArray(i)?new U(i[0],i[1]):i};var N=P(V),le=ie;function ie(i,t,s,l){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=s,this.p2y=l}ie.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,l=0;l<8;l++){var d=this.sampleCurveX(s)-i;if(Math.abs(d)<t)return s;var g=this.sampleCurveDerivativeX(s);if(Math.abs(g)<1e-6)break;s-=d/g}var _=0,x=1;for(s=i,l=0;l<20&&(d=this.sampleCurveX(s),!(Math.abs(d-i)<t));l++)i>d?_=s:x=s,s=.5*(x-_)+_;return s},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var ge=P(le);let Me,X;function Y(){return Me==null&&(Me=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Me}function se(){if(X==null&&(X=!1,Y())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){const d=4*l;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const s=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&s[l]!==l){X=!0;break}}}return X||!1}function xe(i,t,s,l){const d=new ge(i,t,s,l);return function(g){return d.solve(g)}}const Ae=xe(.25,.1,.25,1);function Fe(i,t,s){return Math.min(s,Math.max(t,i))}function De(i,t,s){const l=s-t,d=((i-t)%l+l)%l+t;return d===t?s:d}function qe(i,...t){for(const s of t)for(const l in s)i[l]=s[l];return i}let Gt=1;function it(i,t,s){const l={};for(const d in i)l[d]=t.call(s||this,i[d],d,i);return l}function An(i,t,s){const l={};for(const d in i)t.call(s||this,i[d],d,i)&&(l[d]=i[d]);return l}function Nn(i){return Array.isArray(i)?i.map(Nn):typeof i=="object"&&i?it(i,Nn):i}const lr={};function Mn(i){lr[i]||(typeof console<"u"&&console.warn(i),lr[i]=!0)}function Qn(i,t,s){return(s.y-i.y)*(t.x-i.x)>(t.y-i.y)*(s.x-i.x)}function er(i){let t=0;for(let s,l,d=0,g=i.length,_=g-1;d<g;_=d++)s=i[d],l=i[_],t+=(l.x-s.x)*(s.y+l.y);return t}function tn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let We=null;function dt(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const pt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function jt(i,t,s,l,d){return z(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(i,{timestamp:0});try{const _=g==null?void 0:g.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const x=_.startsWith("BGR"),S=new Uint8ClampedArray(l*d*4);if(yield g.copyTo(S,function(I,k,R,L,B){const j=4*Math.max(-k,0),G=(Math.max(0,R)-R)*L*4+j,Q=4*L,ne=Math.max(0,k),pe=Math.max(0,R);return{rect:{x:ne,y:pe,width:Math.min(I.width,k+L)-ne,height:Math.min(I.height,R+B)-pe},layout:[{offset:G,stride:Q}]}}(i,t,s,l,d)),x)for(let I=0;I<S.length;I+=4){const k=S[I];S[I]=S[I+2],S[I+2]=k}return S}finally{g.close()}})}let Rt,Pt,Zt,cr;const zn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const t=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(i,t=0){return this.getImageCanvasContext(i).getImageData(-t,-t,i.width+2*t,i.height+2*t)},getImageCanvasContext(i){const t=window.document.createElement("canvas"),s=t.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return t.width=i.width,t.height=i.height,s.drawImage(i,0,0,i.width,i.height),s},resolveURL:i=>(Zt||(Zt=document.createElement("a")),Zt.href=i,Zt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(cr==null&&(cr=matchMedia("(prefers-reduced-motion: reduce)")),cr.matches)}},jn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class si extends Error{constructor(t,s,l,d){super(`AJAXError: ${s} (${t}): ${l}`),this.status=t,this.statusText=s,this.url=l,this.body=d}}const ur=tn()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,bn=i=>jn.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))];function _a(i,t){const s=new AbortController,l=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,cache:i.cache,referrer:ur(),signal:s.signal});let d=!1,g=!1;return i.type==="json"&&l.headers.set("Accept","application/json"),g||fetch(l).then(_=>_.ok?(x=>{(i.type==="arrayBuffer"||i.type==="image"?x.arrayBuffer():i.type==="json"?x.json():x.text()).then(S=>{g||(d=!0,t(null,S,x.headers.get("Cache-Control"),x.headers.get("Expires")))}).catch(S=>{g||t(new Error(S.message))})})(_):_.blob().then(x=>t(new si(_.status,_.statusText,i.url,x)))).catch(_=>{_.code!==20&&t(new Error(_.message))}),{cancel:()=>{g=!0,d||s.abort()}}}const ws=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(tn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t);if(!tn())return(bn(i.url)||_a)(i,t)}if(!(/^file:/.test(s=i.url)||/^file:/.test(ur())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return _a(i,t);if(tn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var s;return function(l,d){const g=new XMLHttpRequest;g.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(g.responseType="arraybuffer");for(const _ in l.headers)g.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=l.credentials==="include",g.onerror=()=>{d(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let _=g.response;if(l.type==="json")try{_=JSON.parse(g.response)}catch(x){return d(x)}d(null,_,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else{const _=new Blob([g.response],{type:g.getResponseHeader("Content-Type")});d(new si(g.status,g.statusText,l.url,_))}},g.send(l.body),{cancel:()=>g.abort()}}(i,t)},va=function(i,t){return ws(qe(i,{type:"arrayBuffer"}),t)};function Qi(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),s=window.location;return t.protocol===s.protocol&&t.host===s.host}function So(i,t,s){s[i]&&s[i].indexOf(t)!==-1||(s[i]=s[i]||[],s[i].push(t))}function qs(i,t,s){if(s&&s[i]){const l=s[i].indexOf(t);l!==-1&&s[i].splice(l,1)}}class bs{constructor(t,s={}){qe(this,s),this.type=t}}class Ss extends bs{constructor(t,s={}){super("error",qe({error:t},s))}}class Gs{on(t,s){return this._listeners=this._listeners||{},So(t,s,this._listeners),this}off(t,s){return qs(t,s,this._listeners),qs(t,s,this._oneTimeListeners),this}once(t,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},So(t,s,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,s){typeof t=="string"&&(t=new bs(t,s||{}));const l=t.type;if(this.listens(l)){t.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const x of d)x.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const x of g)qs(l,x,this._oneTimeListeners),x.call(this,t);const _=this._eventedParent;_&&(qe(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof Ss&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,s){return this._eventedParent=t,this._eventedParentData=s,this}}var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ar=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function oi(i,t){const s={};for(const l in i)l!=="ref"&&(s[l]=i[l]);return Ar.forEach(l=>{l in t&&(s[l]=t[l])}),s}function Ht(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let s=0;s<i.length;s++)if(!Ht(i[s],t[s]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const s in i)if(!Ht(i[s],t[s]))return!1;return!0}return i===t}const Mt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Di(i,t,s){s.push({command:Mt.addSource,args:[i,t[i]]})}function To(i,t,s){t.push({command:Mt.removeSource,args:[i]}),s[i]=!0}function es(i,t,s,l){To(i,s,l),Di(i,t,s)}function ol(i,t,s){let l;for(l in i[s])if(Object.prototype.hasOwnProperty.call(i[s],l)&&l!=="data"&&!Ht(i[s][l],t[s][l]))return!1;for(l in t[s])if(Object.prototype.hasOwnProperty.call(t[s],l)&&l!=="data"&&!Ht(i[s][l],t[s][l]))return!1;return!0}function Eo(i,t,s,l,d,g){let _;for(_ in t=t||{},i=i||{})Object.prototype.hasOwnProperty.call(i,_)&&(Ht(i[_],t[_])||s.push({command:g,args:[l,_,t[_],d]}));for(_ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(i,_)&&(Ht(i[_],t[_])||s.push({command:g,args:[l,_,t[_],d]}))}function Ts(i){return i.id}function Zs(i,t){return i[t.id]=t,i}class Be{constructor(t,s,l,d){this.message=(t?`${t}: `:"")+l,d&&(this.identifier=d),s!=null&&s.__line__&&(this.line=s.__line__)}}function Li(i,...t){for(const s of t)for(const l in s)i[l]=s[l];return i}class hn extends Error{constructor(t,s){super(s),this.message=s,this.key=t}}class Hs{constructor(t,s=[]){this.parent=t,this.bindings={};for(const[l,d]of s)this.bindings[l]=d}concat(t){return new Hs(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ts={kind:"null"},Ue={kind:"number"},vt={kind:"string"},mt={kind:"boolean"},xr={kind:"color"},Fi={kind:"object"},yt={kind:"value"},ns={kind:"collator"},W={kind:"formatted"},D={kind:"padding"},F={kind:"resolvedImage"},$={kind:"variableAnchorOffsetCollection"};function J(i,t){return{kind:"array",itemType:i,N:t}}function ee(i){if(i.kind==="array"){const t=ee(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const fe=[ts,Ue,vt,mt,xr,W,Fi,J(yt),D,F,$];function ae(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ae(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const s of fe)if(!ae(s,t))return null}}return`Expected ${ee(i)} but found ${ee(t)} instead.`}function re(i,t){return t.some(s=>s.kind===i.kind)}function de(i,t){return t.some(s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i)}function Se(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const Te=.96422,Ce=.82521,st=4/29,ft=6/29,Ye=3*ft*ft,at=ft*ft*ft,gt=Math.PI/180,Ot=180/Math.PI;function $t(i){return(i%=360)<0&&(i+=360),i}function At([i,t,s,l]){let d,g;const _=hr((.2225045*(i=kt(i))+.7168786*(t=kt(t))+.0606169*(s=kt(s)))/1);i===t&&t===s?d=g=_:(d=hr((.4360747*i+.3850649*t+.1430804*s)/Te),g=hr((.0139322*i+.0971045*t+.7141733*s)/Ce));const x=116*_-16;return[x<0?0:x,500*(d-_),200*(_-g),l]}function kt(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function hr(i){return i>at?Math.pow(i,1/3):i/Ye+st}function Kt([i,t,s,l]){let d=(i+16)/116,g=isNaN(t)?d:d+t/500,_=isNaN(s)?d:d-s/200;return d=1*tr(d),g=Te*tr(g),_=Ce*tr(_),[Rn(3.1338561*g-1.6168667*d-.4906146*_),Rn(-.9787684*g+1.9161415*d+.033454*_),Rn(.0719453*g-.2289914*d+1.4052427*_),l]}function Rn(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function tr(i){return i>ft?i*i*i:Ye*(i-st)}function ai(i){return parseInt(i.padEnd(2,i),16)/255}function Bh(i,t){return Io(t?i/100:i,0,1)}function Io(i,t,s){return Math.min(Math.max(t,i),s)}function Co(i){return!i.some(Number.isNaN)}const Of={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ut{constructor(t,s,l,d=1,g=!0){this.r=t,this.g=s,this.b=l,this.a=d,g||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,s,l,d]))}static parse(t){if(t instanceof Ut)return t;if(typeof t!="string")return;const s=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=Of[l];if(d){const[_,x,S]=d;return[_/255,x/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const _=l.length<6?1:2;let x=1;return[ai(l.slice(x,x+=_)),ai(l.slice(x,x+=_)),ai(l.slice(x,x+=_)),ai(l.slice(x,x+_)||"ff")]}if(l.startsWith("rgb")){const _=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,S,I,k,R,L,B,j,G,Q,ne,pe]=_,oe=[k||" ",B||" ",Q].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const me=[I,L,G].join(""),_e=me==="%%%"?100:me===""?255:0;if(_e){const Ie=[Io(+S/_e,0,1),Io(+R/_e,0,1),Io(+j/_e,0,1),ne?Bh(+ne,pe):1];if(Co(Ie))return Ie}}return}}const g=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,x,S,I,k,R,L,B,j]=g,G=[S||" ",k||" ",L].join("");if(G==="  "||G==="  /"||G===",,"||G===",,,"){const Q=[+x,Io(+I,0,100),Io(+R,0,100),B?Bh(+B,j):1];if(Co(Q))return function([ne,pe,oe,me]){function _e(Ie){const He=(Ie+ne/30)%12,Qe=pe*Math.min(oe,1-oe);return oe-Qe*Math.max(-1,Math.min(He-3,9-He,1))}return ne=$t(ne),pe/=100,oe/=100,[_e(0),_e(8),_e(4),me]}(Q)}}}(t);return s?new Ut(...s,!1):void 0}get rgb(){const{r:t,g:s,b:l,a:d}=this,g=d||1/0;return this.overwriteGetter("rgb",[t/g,s/g,l/g,d])}get hcl(){return this.overwriteGetter("hcl",function(t){const[s,l,d,g]=At(t),_=Math.sqrt(l*l+d*d);return[Math.round(1e4*_)?$t(Math.atan2(d,l)*Ot):NaN,_,s,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",At(this.rgb))}overwriteGetter(t,s){return Object.defineProperty(this,t,{value:s}),s}toString(){const[t,s,l,d]=this.rgb;return`rgba(${[t,s,l].map(g=>Math.round(255*g)).join(",")},${d})`}}Ut.black=new Ut(0,0,0,1),Ut.white=new Ut(1,1,1,1),Ut.transparent=new Ut(0,0,0,0),Ut.red=new Ut(1,0,0,1);class Dc{constructor(t,s,l){this.sensitivity=t?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,s){return this.collator.compare(t,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class al{constructor(t,s,l,d,g){this.text=t,this.image=s,this.scale=l,this.fontStack=d,this.textColor=g}}class dr{constructor(t){this.sections=t}static fromString(t){return new dr([new al(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof dr?t:dr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class qr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof qr)return t;if(typeof t=="number")return new qr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const s of t)if(typeof s!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new qr(t)}}toString(){return JSON.stringify(this.values)}}const Bf=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class li{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof li)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let s=0;s<t.length;s+=2){const l=t[s],d=t[s+1];if(typeof l!="string"||!Bf.has(l)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new li(t)}}toString(){return JSON.stringify(this.values)}}class nr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new nr({name:t,available:!1}):null}}function ll(i,t,s,l){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof s=="number"&&s>=0&&s<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,t,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,t,s,l]:[i,t,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ko(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Ut||i instanceof Dc||i instanceof dr||i instanceof qr||i instanceof li||i instanceof nr)return!0;if(Array.isArray(i)){for(const t of i)if(!ko(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!ko(i[t]))return!1;return!0}return!1}function sn(i){if(i===null)return ts;if(typeof i=="string")return vt;if(typeof i=="boolean")return mt;if(typeof i=="number")return Ue;if(i instanceof Ut)return xr;if(i instanceof Dc)return ns;if(i instanceof dr)return W;if(i instanceof qr)return D;if(i instanceof li)return $;if(i instanceof nr)return F;if(Array.isArray(i)){const t=i.length;let s;for(const l of i){const d=sn(l);if(s){if(s===d)continue;s=yt;break}s=d}return J(s||yt,t)}return Fi}function Dt(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof Ut||i instanceof dr||i instanceof qr||i instanceof li||i instanceof nr?i.toString():JSON.stringify(i)}class Ws{constructor(t,s){this.type=t,this.value=s}static parse(t,s){if(t.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ko(t[1]))return s.error("invalid value");const l=t[1];let d=sn(l);const g=s.expectedType;return d.kind!=="array"||d.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(d=g),new Ws(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class dn{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const cl={string:vt,number:Ue,boolean:mt,object:Fi};class ci{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");let l,d=1;const g=t[0];if(g==="array"){let x,S;if(t.length>2){const I=t[1];if(typeof I!="string"||!(I in cl)||I==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);x=cl[I],d++}else x=yt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=t[2],d++}l=J(x,S)}else{if(!cl[g])throw new Error(`Types doesn't contain name = ${g}`);l=cl[g]}const _=[];for(;d<t.length;d++){const x=s.parse(t[d],d,yt);if(!x)return null;_.push(x)}return new ci(l,_)}evaluate(t){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(t);if(!ae(this.type,sn(l)))return l;if(s===this.args.length-1)throw new dn(`Expected value to be of type ${ee(this.type)}, but found ${ee(sn(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Lc={"to-boolean":mt,"to-color":xr,"to-number":Ue,"to-string":vt};class Es{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const l=t[0];if(!Lc[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return s.error("Expected one argument.");const d=Lc[l],g=[];for(let _=1;_<t.length;_++){const x=s.parse(t[_],_,yt);if(!x)return null;g.push(x)}return new Es(d,g)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let s,l;for(const d of this.args){if(s=d.evaluate(t),l=null,s instanceof Ut)return s;if(typeof s=="string"){const g=t.parseColor(s);if(g)return g}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:ll(s[0],s[1],s[2],s[3]),!l))return new Ut(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new dn(l||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const l of this.args){s=l.evaluate(t);const d=qr.parse(s);if(d)return d}throw new dn(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const l of this.args){s=l.evaluate(t);const d=li.parse(s);if(d)return d}throw new dn(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const l of this.args){if(s=l.evaluate(t),s===null)return 0;const d=Number(s);if(!isNaN(d))return d}throw new dn(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return dr.fromString(Dt(this.args[0].evaluate(t)));case"resolvedImage":return nr.fromString(Dt(this.args[0].evaluate(t)));default:return Dt(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Nh=["Unknown","Point","LineString","Polygon"];class Fc{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Nh[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let s=this._parseColorCache[t];return s||(s=this._parseColorCache[t]=Ut.parse(t)),s}}class ul{constructor(t,s,l=[],d,g=new Hs,_=[]){this.registry=t,this.path=l,this.key=l.map(x=>`[${x}]`).join(""),this.scope=g,this.errors=_,this.expectedType=d,this._isConstant=s}parse(t,s,l,d,g={}){return s?this.concat(s,l,d)._parse(t,g):this._parse(t,g)}_parse(t,s){function l(d,g,_){return _==="assert"?new ci(g,[d]):_==="coerce"?new Es(g,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[d];if(g){let _=g.parse(t,this);if(!_)return null;if(this.expectedType){const x=this.expectedType,S=_.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||S.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(x.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(x.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(x,S))return null}else _=l(_,x,s.typeAnnotation||"coerce");else _=l(_,x,s.typeAnnotation||"coerce");else _=l(_,x,s.typeAnnotation||"coerce");else _=l(_,x,s.typeAnnotation||"assert")}if(!(_ instanceof Ws)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const x=new Fc;try{_=new Ws(_.type,_.evaluate(x))}catch(S){return this.error(S.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,s,l){const d=typeof t=="number"?this.path.concat(t):this.path,g=l?this.scope.concat(l):this.scope;return new ul(this.registry,this._isConstant,d,s||null,g,this.errors)}error(t,...s){const l=`${this.key}${s.map(d=>`[${d}]`).join("")}`;this.errors.push(new hn(l,t))}checkSubtype(t,s){const l=ae(t,s);return l&&this.error(l),l}}class hl{constructor(t,s,l){this.type=ns,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=s}static parse(t,s){if(t.length!==2)return s.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return s.error("Collator options argument must be an object.");const d=s.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,mt);if(!d)return null;const g=s.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,mt);if(!g)return null;let _=null;return l.locale&&(_=s.parse(l.locale,1,vt),!_)?null:new hl(d,g,_)}evaluate(t){return new Dc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const Is=8192;function Oc(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function xa(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function jh(i,t){const s=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(s*d*Is),Math.round(l*d*Is)]}function Nf(i,t,s){const l=i[0]-t[0],d=i[1]-t[1],g=i[0]-s[0],_=i[1]-s[1];return l*_-g*d==0&&l*g<=0&&d*_<=0}function Bc(i,t){let s=!1;for(let _=0,x=t.length;_<x;_++){const S=t[_];for(let I=0,k=S.length;I<k-1;I++){if(Nf(i,S[I],S[I+1]))return!1;(d=S[I])[1]>(l=i)[1]!=(g=S[I+1])[1]>l[1]&&l[0]<(g[0]-d[0])*(l[1]-d[1])/(g[1]-d[1])+d[0]&&(s=!s)}}var l,d,g;return s}function Nc(i,t){for(let s=0;s<t.length;s++)if(Bc(i,t[s]))return!0;return!1}function Uh(i,t,s,l){const d=l[0]-s[0],g=l[1]-s[1],_=(i[0]-s[0])*g-d*(i[1]-s[1]),x=(t[0]-s[0])*g-d*(t[1]-s[1]);return _>0&&x<0||_<0&&x>0}function jf(i,t,s){for(const I of s)for(let k=0;k<I.length-1;++k)if((x=[(_=I[k+1])[0]-(g=I[k])[0],_[1]-g[1]])[0]*(S=[(d=t)[0]-(l=i)[0],d[1]-l[1]])[1]-x[1]*S[0]!=0&&Uh(l,d,g,_)&&Uh(g,_,l,d))return!0;var l,d,g,_,x,S;return!1}function Vh(i,t){for(let s=0;s<i.length;++s)if(!Bc(i[s],t))return!1;for(let s=0;s<i.length-1;++s)if(jf(i[s],i[s+1],t))return!1;return!0}function $h(i,t){for(let s=0;s<t.length;s++)if(Vh(i,t[s]))return!0;return!1}function dl(i,t,s){const l=[];for(let d=0;d<i.length;d++){const g=[];for(let _=0;_<i[d].length;_++){const x=jh(i[d][_],s);Oc(t,x),g.push(x)}l.push(g)}return l}function qh(i,t,s){const l=[];for(let d=0;d<i.length;d++){const g=dl(i[d],t,s);l.push(g)}return l}function Gh(i,t,s,l){if(i[0]<s[0]||i[0]>s[2]){const d=.5*l;let g=i[0]-s[0]>d?-l:s[0]-i[0]>d?l:0;g===0&&(g=i[0]-s[2]>d?-l:s[2]-i[0]>d?l:0),i[0]+=g}Oc(t,i)}function jc(i,t,s,l){const d=Math.pow(2,l.z)*Is,g=[l.x*Is,l.y*Is],_=[];for(const x of i)for(const S of x){const I=[S.x+g[0],S.y+g[1]];Gh(I,t,s,d),_.push(I)}return _}function Uc(i,t,s,l){const d=Math.pow(2,l.z)*Is,g=[l.x*Is,l.y*Is],_=[];for(const S of i){const I=[];for(const k of S){const R=[k.x+g[0],k.y+g[1]];Oc(t,R),I.push(R)}_.push(I)}if(t[2]-t[0]<=d/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const S of _)for(const I of S)Gh(I,t,s,d)}var x;return _}class Ks{constructor(t,s){this.type=mt,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ko(t[1])){const l=t[1];if(l.type==="FeatureCollection")for(let d=0;d<l.features.length;++d){const g=l.features[d].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Ks(l,l.features[d].geometry)}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Ks(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ks(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(s,l){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const x=dl(l.coordinates,g,_),S=jc(s.geometry(),d,g,_);if(!xa(d,g))return!1;for(const I of S)if(!Bc(I,x))return!1}if(l.type==="MultiPolygon"){const x=qh(l.coordinates,g,_),S=jc(s.geometry(),d,g,_);if(!xa(d,g))return!1;for(const I of S)if(!Nc(I,x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(s,l){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(l.type==="Polygon"){const x=dl(l.coordinates,g,_),S=Uc(s.geometry(),d,g,_);if(!xa(d,g))return!1;for(const I of S)if(!Vh(I,x))return!1}if(l.type==="MultiPolygon"){const x=qh(l.coordinates,g,_),S=Uc(s.geometry(),d,g,_);if(!xa(d,g))return!1;for(const I of S)if(!$h(I,x))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class pl{constructor(t,s){this.type=s.type,this.name=t,this.boundExpression=s}static parse(t,s){if(t.length!==2||typeof t[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const l=t[1];return s.scope.has(l)?new pl(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ui{constructor(t,s,l,d){this.name=t,this.type=s,this._evaluate=l,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,s){const l=t[0],d=ui.definitions[l];if(!d)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,x=_.filter(([I])=>!Array.isArray(I)||I.length===t.length-1);let S=null;for(const[I,k]of x){S=new ul(s.registry,fl,s.path,null,s.scope);const R=[];let L=!1;for(let B=1;B<t.length;B++){const j=t[B],G=Array.isArray(I)?I[B-1]:I.type,Q=S.parse(j,1+R.length,G);if(!Q){L=!0;break}R.push(Q)}if(!L)if(Array.isArray(I)&&I.length!==R.length)S.error(`Expected ${I.length} arguments, but found ${R.length} instead.`);else{for(let B=0;B<R.length;B++){const j=Array.isArray(I)?I[B]:I.type,G=R[B];S.concat(B+1).checkSubtype(j,G.type)}if(S.errors.length===0)return new ui(l,g,k,R)}}if(x.length===1)s.errors.push(...S.errors);else{const I=(x.length?x:_).map(([R])=>{return L=R,Array.isArray(L)?`(${L.map(ee).join(", ")})`:`(${ee(L.type)}...)`;var L}).join(" | "),k=[];for(let R=1;R<t.length;R++){const L=s.parse(t[R],1+k.length);if(!L)return null;k.push(ee(L.type))}s.error(`Expected arguments of type ${I}, but found (${k.join(", ")}) instead.`)}return null}static register(t,s){ui.definitions=s;for(const l in s)t[l]=ui}}function fl(i){if(i instanceof pl)return fl(i.boundExpression);if(i instanceof ui&&i.name==="error"||i instanceof hl||i instanceof Ks)return!1;const t=i instanceof Es||i instanceof ci;let s=!0;return i.eachChild(l=>{s=t?s&&fl(l):s&&l instanceof Ws}),!!s&&ml(i)&&gl(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ml(i){if(i instanceof ui&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Ks)return!1;let t=!0;return i.eachChild(s=>{t&&!ml(s)&&(t=!1)}),t}function wa(i){if(i instanceof ui&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(s=>{t&&!wa(s)&&(t=!1)}),t}function gl(i,t){if(i instanceof ui&&t.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild(l=>{s&&!gl(l,t)&&(s=!1)}),s}function Po(i,t){const s=i.length-1;let l,d,g=0,_=s,x=0;for(;g<=_;)if(x=Math.floor((g+_)/2),l=i[x],d=i[x+1],l<=t){if(x===s||t<d)return x;g=x+1}else{if(!(l>t))throw new dn("Input is not a number.");_=x-1}return 0}class Cs{constructor(t,s,l){this.type=t,this.input=s,this.labels=[],this.outputs=[];for(const[d,g]of l)this.labels.push(d),this.outputs.push(g)}static parse(t,s){if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(t[1],1,Ue);if(!l)return null;const d=[];let g=null;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);for(let _=1;_<t.length;_+=2){const x=_===1?-1/0:t[_],S=t[_+1],I=_,k=_+1;if(typeof x!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(d.length&&d[d.length-1][0]>=x)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const R=s.parse(S,k,g);if(!R)return null;g=g||R.type,d.push([x,R])}return new Cs(g,l,d)}evaluate(t){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(t);const d=this.input.evaluate(t);if(d<=s[0])return l[0].evaluate(t);const g=s.length;return d>=s[g-1]?l[g-1].evaluate(t):l[Po(s,d)].evaluate(t)}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Et(i,t,s){return i+s*(t-i)}function yl(i,t,s){return i.map((l,d)=>Et(l,t[d],s))}const Gr={number:Et,color:function(i,t,s,l="rgb"){switch(l){case"rgb":{const[d,g,_,x]=yl(i.rgb,t.rgb,s);return new Ut(d,g,_,x,!1)}case"hcl":{const[d,g,_,x]=i.hcl,[S,I,k,R]=t.hcl;let L,B;if(isNaN(d)||isNaN(S))isNaN(d)?isNaN(S)?L=NaN:(L=S,_!==1&&_!==0||(B=I)):(L=d,k!==1&&k!==0||(B=g));else{let pe=S-d;S>d&&pe>180?pe-=360:S<d&&d-S>180&&(pe+=360),L=d+s*pe}const[j,G,Q,ne]=function([pe,oe,me,_e]){return pe=isNaN(pe)?0:pe*gt,Kt([me,Math.cos(pe)*oe,Math.sin(pe)*oe,_e])}([L,B??Et(g,I,s),Et(_,k,s),Et(x,R,s)]);return new Ut(j,G,Q,ne,!1)}case"lab":{const[d,g,_,x]=Kt(yl(i.lab,t.lab,s));return new Ut(d,g,_,x,!1)}}},array:yl,padding:function(i,t,s){return new qr(yl(i.values,t.values,s))},variableAnchorOffsetCollection:function(i,t,s){const l=i.values,d=t.values;if(l.length!==d.length)throw new dn(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${t.toString()}`);const g=[];for(let _=0;_<l.length;_+=2){if(l[_]!==d[_])throw new dn(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${l[_]}, to[${_}]: ${d[_]}`);g.push(l[_]);const[x,S]=l[_+1],[I,k]=d[_+1];g.push([Et(x,I,s),Et(S,k,s)])}return new li(g)}};class Zr{constructor(t,s,l,d,g){this.type=t,this.operator=s,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[_,x]of g)this.labels.push(_),this.outputs.push(x)}static interpolationFactor(t,s,l,d){let g=0;if(t.name==="exponential")g=Vc(s,t.base,l,d);else if(t.name==="linear")g=Vc(s,1,l,d);else if(t.name==="cubic-bezier"){const _=t.controlPoints;g=new ge(_[0],_[1],_[2],_[3]).solve(Vc(s,1,l,d))}return g}static parse(t,s){let[l,d,g,..._]=t;if(!Array.isArray(d)||d.length===0)return s.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const I=d[1];if(typeof I!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:I}}else{if(d[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const I=d.slice(1);if(I.length!==4||I.some(k=>typeof k!="number"||k<0||k>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:I}}}if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(g=s.parse(g,2,Ue),!g)return null;const x=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=xr:s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType);for(let I=0;I<_.length;I+=2){const k=_[I],R=_[I+1],L=I+3,B=I+4;if(typeof k!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(x.length&&x[x.length-1][0]>=k)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const j=s.parse(R,B,S);if(!j)return null;S=S||j.type,x.push([k,j])}return Se(S,Ue)||Se(S,xr)||Se(S,D)||Se(S,$)||Se(S,J(Ue))?new Zr(S,l,d,g,x):s.error(`Type ${ee(S)} is not interpolatable.`)}evaluate(t){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(t);const d=this.input.evaluate(t);if(d<=s[0])return l[0].evaluate(t);const g=s.length;if(d>=s[g-1])return l[g-1].evaluate(t);const _=Po(s,d),x=Zr.interpolationFactor(this.interpolation,d,s[_],s[_+1]),S=l[_].evaluate(t),I=l[_+1].evaluate(t);switch(this.operator){case"interpolate":return Gr[this.type.kind](S,I,x);case"interpolate-hcl":return Gr.color(S,I,x,"hcl");case"interpolate-lab":return Gr.color(S,I,x,"lab")}}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Vc(i,t,s,l){const d=l-s,g=i-s;return d===0?0:t===1?g/d:(Math.pow(t,g)-1)/(Math.pow(t,d)-1)}class _l{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expectected at least one argument.");let l=null;const d=s.expectedType;d&&d.kind!=="value"&&(l=d);const g=[];for(const x of t.slice(1)){const S=s.parse(x,1+g.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,g.push(S)}if(!l)throw new Error("No output type");const _=d&&g.some(x=>ae(d,x.type));return new _l(_?yt:l,g)}evaluate(t){let s,l=null,d=0;for(const g of this.args)if(d++,l=g.evaluate(t),l&&l instanceof nr&&!l.available&&(s||(s=l.name),l=null,d===this.args.length&&(l=s)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}class vl{constructor(t,s){this.type=s.type,this.bindings=[].concat(t),this.result=s}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const s of this.bindings)t(s[1]);t(this.result)}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let g=1;g<t.length-1;g+=2){const _=t[g];if(typeof _!="string")return s.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return s.error("Variable names must contain only alphanumeric characters or '_'.",g);const x=s.parse(t[g+1],g+1);if(!x)return null;l.push([_,x])}const d=s.parse(t[t.length-1],t.length-1,s.expectedType,l);return d?new vl(l,d):null}outputDefined(){return this.result.outputDefined()}}class $c{constructor(t,s,l){this.type=t,this.index=s,this.input=l}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,Ue),d=s.parse(t[2],2,J(s.expectedType||yt));return l&&d?new $c(d.type.itemType,l,d):null}evaluate(t){const s=this.index.evaluate(t),l=this.input.evaluate(t);if(s<0)throw new dn(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new dn(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new dn(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class qc{constructor(t,s){this.type=mt,this.needle=t,this.haystack=s}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,yt),d=s.parse(t[2],2,yt);return l&&d?re(l.type,[mt,vt,Ue,ts,yt])?new qc(l,d):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ee(l.type)} instead`):null}evaluate(t){const s=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!de(s,["boolean","string","number","null"]))throw new dn(`Expected first argument to be of type boolean, string, number or null, but found ${ee(sn(s))} instead.`);if(!de(l,["string","array"]))throw new dn(`Expected second argument to be of type array or string, but found ${ee(sn(l))} instead.`);return l.indexOf(s)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class xl{constructor(t,s,l){this.type=Ue,this.needle=t,this.haystack=s,this.fromIndex=l}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,yt),d=s.parse(t[2],2,yt);if(!l||!d)return null;if(!re(l.type,[mt,vt,Ue,ts,yt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${ee(l.type)} instead`);if(t.length===4){const g=s.parse(t[3],3,Ue);return g?new xl(l,d,g):null}return new xl(l,d)}evaluate(t){const s=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!de(s,["boolean","string","number","null"]))throw new dn(`Expected first argument to be of type boolean, string, number or null, but found ${ee(sn(s))} instead.`);if(!de(l,["string","array"]))throw new dn(`Expected second argument to be of type array or string, but found ${ee(sn(l))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(t);return l.indexOf(s,d)}return l.indexOf(s)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Gc{constructor(t,s,l,d,g,_){this.inputType=t,this.type=s,this.input=l,this.cases=d,this.outputs=g,this.otherwise=_}static parse(t,s){if(t.length<5)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return s.error("Expected an even number of arguments.");let l,d;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);const g={},_=[];for(let I=2;I<t.length-1;I+=2){let k=t[I];const R=t[I+1];Array.isArray(k)||(k=[k]);const L=s.concat(I);if(k.length===0)return L.error("Expected at least one branch label.");for(const j of k){if(typeof j!="number"&&typeof j!="string")return L.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return L.error("Numeric branch labels must be integer values.");if(l){if(L.checkSubtype(l,sn(j)))return null}else l=sn(j);if(g[String(j)]!==void 0)return L.error("Branch labels must be unique.");g[String(j)]=_.length}const B=s.parse(R,I,d);if(!B)return null;d=d||B.type,_.push(B)}const x=s.parse(t[1],1,yt);if(!x)return null;const S=s.parse(t[t.length-1],t.length-1,d);return S?x.type.kind!=="value"&&s.concat(1).checkSubtype(l,x.type)?null:new Gc(l,d,x,g,_,S):null}evaluate(t){const s=this.input.evaluate(t);return(sn(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Zc{constructor(t,s,l){this.type=t,this.branches=s,this.otherwise=l}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&s.expectedType.kind!=="value"&&(l=s.expectedType);const d=[];for(let _=1;_<t.length-1;_+=2){const x=s.parse(t[_],_,mt);if(!x)return null;const S=s.parse(t[_+1],_+1,l);if(!S)return null;d.push([x,S]),l=l||S.type}const g=s.parse(t[t.length-1],t.length-1,l);if(!g)return null;if(!l)throw new Error("Can't infer output type");return new Zc(l,d,g)}evaluate(t){for(const[s,l]of this.branches)if(s.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[s,l]of this.branches)t(s),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class wl{constructor(t,s,l,d){this.type=t,this.input=s,this.beginIndex=l,this.endIndex=d}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=s.parse(t[1],1,yt),d=s.parse(t[2],2,Ue);if(!l||!d)return null;if(!re(l.type,[J(yt),vt,yt]))return s.error(`Expected first argument to be of type array or string, but found ${ee(l.type)} instead`);if(t.length===4){const g=s.parse(t[3],3,Ue);return g?new wl(l.type,l,d,g):null}return new wl(l.type,l,d)}evaluate(t){const s=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!de(s,["string","array"]))throw new dn(`Expected first argument to be of type array or string, but found ${ee(sn(s))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(t);return s.slice(l,d)}return s.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Zh(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Hh(i,t,s,l){return l.compare(t,s)===0}function Ao(i,t,s){const l=i!=="=="&&i!=="!=";return class y2{constructor(g,_,x){this.type=mt,this.lhs=g,this.rhs=_,this.collator=x,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const x=g[0];let S=_.parse(g[1],1,yt);if(!S)return null;if(!Zh(x,S.type))return _.concat(1).error(`"${x}" comparisons are not supported for type '${ee(S.type)}'.`);let I=_.parse(g[2],2,yt);if(!I)return null;if(!Zh(x,I.type))return _.concat(2).error(`"${x}" comparisons are not supported for type '${ee(I.type)}'.`);if(S.type.kind!==I.type.kind&&S.type.kind!=="value"&&I.type.kind!=="value")return _.error(`Cannot compare types '${ee(S.type)}' and '${ee(I.type)}'.`);l&&(S.type.kind==="value"&&I.type.kind!=="value"?S=new ci(I.type,[S]):S.type.kind!=="value"&&I.type.kind==="value"&&(I=new ci(S.type,[I])));let k=null;if(g.length===4){if(S.type.kind!=="string"&&I.type.kind!=="string"&&S.type.kind!=="value"&&I.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(k=_.parse(g[3],3,ns),!k)return null}return new y2(S,I,k)}evaluate(g){const _=this.lhs.evaluate(g),x=this.rhs.evaluate(g);if(l&&this.hasUntypedArgument){const S=sn(_),I=sn(x);if(S.kind!==I.kind||S.kind!=="string"&&S.kind!=="number")throw new dn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${I.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=sn(_),I=sn(x);if(S.kind!=="string"||I.kind!=="string")return t(g,_,x)}return this.collator?s(g,_,x,this.collator.evaluate(g)):t(g,_,x)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Uf=Ao("==",function(i,t,s){return t===s},Hh),Vf=Ao("!=",function(i,t,s){return t!==s},function(i,t,s,l){return!Hh(0,t,s,l)}),$f=Ao("<",function(i,t,s){return t<s},function(i,t,s,l){return l.compare(t,s)<0}),qf=Ao(">",function(i,t,s){return t>s},function(i,t,s,l){return l.compare(t,s)>0}),Gf=Ao("<=",function(i,t,s){return t<=s},function(i,t,s,l){return l.compare(t,s)<=0}),Zf=Ao(">=",function(i,t,s){return t>=s},function(i,t,s,l){return l.compare(t,s)>=0});class Hc{constructor(t,s,l,d,g){this.type=vt,this.number=t,this.locale=s,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=g}static parse(t,s){if(t.length!==3)return s.error("Expected two arguments.");const l=s.parse(t[1],1,Ue);if(!l)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return s.error("NumberFormat options argument must be an object.");let g=null;if(d.locale&&(g=s.parse(d.locale,1,vt),!g))return null;let _=null;if(d.currency&&(_=s.parse(d.currency,1,vt),!_))return null;let x=null;if(d["min-fraction-digits"]&&(x=s.parse(d["min-fraction-digits"],1,Ue),!x))return null;let S=null;return d["max-fraction-digits"]&&(S=s.parse(d["max-fraction-digits"],1,Ue),!S)?null:new Hc(l,g,_,x,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class bl{constructor(t){this.type=W,this.sections=t}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return s.error("First argument must be an image or text section.");const d=[];let g=!1;for(let _=1;_<=t.length-1;++_){const x=t[_];if(g&&typeof x=="object"&&!Array.isArray(x)){g=!1;let S=null;if(x["font-scale"]&&(S=s.parse(x["font-scale"],1,Ue),!S))return null;let I=null;if(x["text-font"]&&(I=s.parse(x["text-font"],1,J(vt)),!I))return null;let k=null;if(x["text-color"]&&(k=s.parse(x["text-color"],1,xr),!k))return null;const R=d[d.length-1];R.scale=S,R.font=I,R.textColor=k}else{const S=s.parse(t[_],1,yt);if(!S)return null;const I=S.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,d.push({content:S,scale:null,font:null,textColor:null})}}return new bl(d)}evaluate(t){return new dr(this.sections.map(s=>{const l=s.content.evaluate(t);return sn(l)===F?new al("",l,null,null,null):new al(Dt(l),null,s.scale?s.scale.evaluate(t):null,s.font?s.font.evaluate(t).join(","):null,s.textColor?s.textColor.evaluate(t):null)}))}eachChild(t){for(const s of this.sections)t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor)}outputDefined(){return!1}}class Wc{constructor(t){this.type=F,this.input=t}static parse(t,s){if(t.length!==2)return s.error("Expected two arguments.");const l=s.parse(t[1],1,vt);return l?new Wc(l):s.error("No image name provided.")}evaluate(t){const s=this.input.evaluate(t),l=nr.fromString(s);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(s)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Kc{constructor(t){this.type=Ue,this.input=t}static parse(t,s){if(t.length!==2)return s.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=s.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${ee(l.type)} instead.`):new Kc(l):null}evaluate(t){const s=this.input.evaluate(t);if(typeof s=="string"||Array.isArray(s))return s.length;throw new dn(`Expected value to be of type string or array, but found ${ee(sn(s))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Mo={"==":Uf,"!=":Vf,">":qf,"<":$f,">=":Zf,"<=":Gf,array:ci,at:$c,boolean:ci,case:Zc,coalesce:_l,collator:hl,format:bl,image:Wc,in:qc,"index-of":xl,interpolate:Zr,"interpolate-hcl":Zr,"interpolate-lab":Zr,length:Kc,let:vl,literal:Ws,match:Gc,number:ci,"number-format":Hc,object:ci,slice:wl,step:Cs,string:ci,"to-boolean":Es,"to-color":Es,"to-number":Es,"to-string":Es,var:pl,within:Ks};function Wh(i,[t,s,l,d]){t=t.evaluate(i),s=s.evaluate(i),l=l.evaluate(i);const g=d?d.evaluate(i):1,_=ll(t,s,l,g);if(_)throw new dn(_);return new Ut(t/255,s/255,l/255,g,!1)}function Kh(i,t){return i in t}function Xc(i,t){const s=t[i];return s===void 0?null:s}function Xs(i){return{type:i}}function Xh(i){return{result:"success",value:i}}function ks(i){return{result:"error",value:i}}function zo(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Yh(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Yc(i){return!!i.expression&&i.expression.interpolated}function Lt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function on(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Hf(i){return i}function It(i,t){const s=t.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",d=l||!(l||i.property!==void 0),g=i.type||(Yc(t)?"exponential":"interval");if(s||t.type==="padding"){const k=s?Ut.parse:qr.parse;(i=Li({},i)).stops&&(i.stops=i.stops.map(R=>[R[0],k(R[1])])),i.default=k(i.default?i.default:t.default)}if(i.colorSpace&&(_=i.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var _;let x,S,I;if(g==="exponential")x=ba;else if(g==="interval")x=nn;else if(g==="categorical"){x=an,S=Object.create(null);for(const k of i.stops)S[k[0]]=k[1];I=typeof i.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);x=Jh}if(l){const k={},R=[];for(let j=0;j<i.stops.length;j++){const G=i.stops[j],Q=G[0].zoom;k[Q]===void 0&&(k[Q]={zoom:Q,type:i.type,property:i.property,default:i.default,stops:[]},R.push(Q)),k[Q].stops.push([G[0].value,G[1]])}const L=[];for(const j of R)L.push([k[j].zoom,It(k[j],t)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Zr.interpolationFactor.bind(void 0,B),zoomStops:L.map(j=>j[0]),evaluate:({zoom:j},G)=>ba({stops:L,base:i.base},t,j).evaluate(j,G)}}if(d){const k=g==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Zr.interpolationFactor.bind(void 0,k),zoomStops:i.stops.map(R=>R[0]),evaluate:({zoom:R})=>x(i,t,R,S,I)}}return{kind:"source",evaluate(k,R){const L=R&&R.properties?R.properties[i.property]:void 0;return L===void 0?Ys(i.default,t.default):x(i,t,L,S,I)}}}function Ys(i,t,s){return i!==void 0?i:t!==void 0?t:s!==void 0?s:void 0}function an(i,t,s,l,d){return Ys(typeof s===d?l[s]:void 0,i.default,t.default)}function nn(i,t,s){if(Lt(s)!=="number")return Ys(i.default,t.default);const l=i.stops.length;if(l===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[l-1][0])return i.stops[l-1][1];const d=Po(i.stops.map(g=>g[0]),s);return i.stops[d][1]}function ba(i,t,s){const l=i.base!==void 0?i.base:1;if(Lt(s)!=="number")return Ys(i.default,t.default);const d=i.stops.length;if(d===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[d-1][0])return i.stops[d-1][1];const g=Po(i.stops.map(k=>k[0]),s),_=function(k,R,L,B){const j=B-L,G=k-L;return j===0?0:R===1?G/j:(Math.pow(R,G)-1)/(Math.pow(R,j)-1)}(s,l,i.stops[g][0],i.stops[g+1][0]),x=i.stops[g][1],S=i.stops[g+1][1],I=Gr[t.type]||Hf;return typeof x.evaluate=="function"?{evaluate(...k){const R=x.evaluate.apply(void 0,k),L=S.evaluate.apply(void 0,k);if(R!==void 0&&L!==void 0)return I(R,L,_,i.colorSpace)}}:I(x,S,_,i.colorSpace)}function Jh(i,t,s){switch(t.type){case"color":s=Ut.parse(s);break;case"formatted":s=dr.fromString(s.toString());break;case"resolvedImage":s=nr.fromString(s.toString());break;case"padding":s=qr.parse(s);break;default:Lt(s)===t.type||t.type==="enum"&&t.values[s]||(s=void 0)}return Ys(s,i.default,t.default)}ui.register(Mo,{error:[{kind:"error"},[vt],(i,[t])=>{throw new dn(t.evaluate(i))}],typeof:[vt,[yt],(i,[t])=>ee(sn(t.evaluate(i)))],"to-rgba":[J(Ue,4),[xr],(i,[t])=>{const[s,l,d,g]=t.evaluate(i).rgb;return[255*s,255*l,255*d,g]}],rgb:[xr,[Ue,Ue,Ue],Wh],rgba:[xr,[Ue,Ue,Ue,Ue],Wh],has:{type:mt,overloads:[[[vt],(i,[t])=>Kh(t.evaluate(i),i.properties())],[[vt,Fi],(i,[t,s])=>Kh(t.evaluate(i),s.evaluate(i))]]},get:{type:yt,overloads:[[[vt],(i,[t])=>Xc(t.evaluate(i),i.properties())],[[vt,Fi],(i,[t,s])=>Xc(t.evaluate(i),s.evaluate(i))]]},"feature-state":[yt,[vt],(i,[t])=>Xc(t.evaluate(i),i.featureState||{})],properties:[Fi,[],i=>i.properties()],"geometry-type":[vt,[],i=>i.geometryType()],id:[yt,[],i=>i.id()],zoom:[Ue,[],i=>i.globals.zoom],"heatmap-density":[Ue,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ue,[],i=>i.globals.lineProgress||0],accumulated:[yt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ue,Xs(Ue),(i,t)=>{let s=0;for(const l of t)s+=l.evaluate(i);return s}],"*":[Ue,Xs(Ue),(i,t)=>{let s=1;for(const l of t)s*=l.evaluate(i);return s}],"-":{type:Ue,overloads:[[[Ue,Ue],(i,[t,s])=>t.evaluate(i)-s.evaluate(i)],[[Ue],(i,[t])=>-t.evaluate(i)]]},"/":[Ue,[Ue,Ue],(i,[t,s])=>t.evaluate(i)/s.evaluate(i)],"%":[Ue,[Ue,Ue],(i,[t,s])=>t.evaluate(i)%s.evaluate(i)],ln2:[Ue,[],()=>Math.LN2],pi:[Ue,[],()=>Math.PI],e:[Ue,[],()=>Math.E],"^":[Ue,[Ue,Ue],(i,[t,s])=>Math.pow(t.evaluate(i),s.evaluate(i))],sqrt:[Ue,[Ue],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[Ue,[Ue],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[Ue,[Ue],(i,[t])=>Math.log(t.evaluate(i))],log2:[Ue,[Ue],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[Ue,[Ue],(i,[t])=>Math.sin(t.evaluate(i))],cos:[Ue,[Ue],(i,[t])=>Math.cos(t.evaluate(i))],tan:[Ue,[Ue],(i,[t])=>Math.tan(t.evaluate(i))],asin:[Ue,[Ue],(i,[t])=>Math.asin(t.evaluate(i))],acos:[Ue,[Ue],(i,[t])=>Math.acos(t.evaluate(i))],atan:[Ue,[Ue],(i,[t])=>Math.atan(t.evaluate(i))],min:[Ue,Xs(Ue),(i,t)=>Math.min(...t.map(s=>s.evaluate(i)))],max:[Ue,Xs(Ue),(i,t)=>Math.max(...t.map(s=>s.evaluate(i)))],abs:[Ue,[Ue],(i,[t])=>Math.abs(t.evaluate(i))],round:[Ue,[Ue],(i,[t])=>{const s=t.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[Ue,[Ue],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[Ue,[Ue],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[mt,[vt,yt],(i,[t,s])=>i.properties()[t.value]===s.value],"filter-id-==":[mt,[yt],(i,[t])=>i.id()===t.value],"filter-type-==":[mt,[vt],(i,[t])=>i.geometryType()===t.value],"filter-<":[mt,[vt,yt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l<d}],"filter-id-<":[mt,[yt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s<l}],"filter->":[mt,[vt,yt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l>d}],"filter-id->":[mt,[yt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s>l}],"filter-<=":[mt,[vt,yt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[mt,[yt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s<=l}],"filter->=":[mt,[vt,yt],(i,[t,s])=>{const l=i.properties()[t.value],d=s.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[mt,[yt],(i,[t])=>{const s=i.id(),l=t.value;return typeof s==typeof l&&s>=l}],"filter-has":[mt,[yt],(i,[t])=>t.value in i.properties()],"filter-has-id":[mt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[mt,[J(vt)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[mt,[J(yt)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[mt,[vt,J(yt)],(i,[t,s])=>s.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[mt,[vt,J(yt)],(i,[t,s])=>function(l,d,g,_){for(;g<=_;){const x=g+_>>1;if(d[x]===l)return!0;d[x]>l?_=x-1:g=x+1}return!1}(i.properties()[t.value],s.value,0,s.value.length-1)],all:{type:mt,overloads:[[[mt,mt],(i,[t,s])=>t.evaluate(i)&&s.evaluate(i)],[Xs(mt),(i,t)=>{for(const s of t)if(!s.evaluate(i))return!1;return!0}]]},any:{type:mt,overloads:[[[mt,mt],(i,[t,s])=>t.evaluate(i)||s.evaluate(i)],[Xs(mt),(i,t)=>{for(const s of t)if(s.evaluate(i))return!0;return!1}]]},"!":[mt,[mt],(i,[t])=>!t.evaluate(i)],"is-supported-script":[mt,[vt],(i,[t])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(t.evaluate(i))}],upcase:[vt,[vt],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[vt,[vt],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[vt,Xs(yt),(i,t)=>t.map(s=>Dt(s.evaluate(i))).join("")],"resolved-locale":[vt,[ns],(i,[t])=>t.evaluate(i).resolvedLocale()]});class Jc{constructor(t,s){var l;this.expression=t,this._warningHistory={},this._evaluator=new Fc,this._defaultValue=s?(l=s).type==="color"&&on(l.default)?new Ut(0,0,0,0):l.type==="color"?Ut.parse(l.default)||null:l.type==="padding"?qr.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?li.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(t,s,l,d,g,_){return this._evaluator.globals=t,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,s,l,d,g,_){this._evaluator.globals=t,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new dn(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Sl(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Mo}function Tl(i,t){const s=new ul(Mo,fl,[],t?function(d){const g={color:xr,string:vt,number:Ue,enum:vt,boolean:mt,formatted:W,padding:D,resolvedImage:F,variableAnchorOffsetCollection:$};return d.type==="array"?J(g[d.value]||yt,d.length):g[d.type]}(t):void 0),l=s.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Xh(new Jc(l,t)):ks(s.errors)}class Qc{constructor(t,s){this.kind=t,this._styleExpression=s,this.isStateDependent=t!=="constant"&&!wa(s.expression)}evaluateWithoutErrorHandling(t,s,l,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,s,l,d,g,_)}evaluate(t,s,l,d,g,_){return this._styleExpression.evaluate(t,s,l,d,g,_)}}class El{constructor(t,s,l,d){this.kind=t,this.zoomStops=l,this._styleExpression=s,this.isStateDependent=t!=="camera"&&!wa(s.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,s,l,d,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,s,l,d,g,_)}evaluate(t,s,l,d,g,_){return this._styleExpression.evaluate(t,s,l,d,g,_)}interpolationFactor(t,s,l){return this.interpolationType?Zr.interpolationFactor(this.interpolationType,t,s,l):0}}function eu(i,t){const s=Tl(i,t);if(s.result==="error")return s;const l=s.value.expression,d=ml(l);if(!d&&!zo(t))return ks([new hn("","data expressions not supported")]);const g=gl(l,["zoom"]);if(!g&&!Yh(t))return ks([new hn("","zoom expressions not supported")]);const _=Ta(l);return _||g?_ instanceof hn?ks([_]):_ instanceof Zr&&!Yc(t)?ks([new hn("",'"interpolate" expressions cannot be used with this property')]):Xh(_?new El(d?"camera":"composite",s.value,_.labels,_ instanceof Zr?_.interpolation:void 0):new Qc(d?"constant":"source",s.value)):ks([new hn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Sa{constructor(t,s){this._parameters=t,this._specification=s,Li(this,It(this._parameters,this._specification))}static deserialize(t){return new Sa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ta(i){let t=null;if(i instanceof vl)t=Ta(i.result);else if(i instanceof _l){for(const s of i.args)if(t=Ta(s),t)break}else(i instanceof Cs||i instanceof Zr)&&i.input instanceof ui&&i.input.name==="zoom"&&(t=i);return t instanceof hn||i.eachChild(s=>{const l=Ta(s);l instanceof hn?t=l:!t&&l?t=new hn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new hn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Ea(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Ea(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Wf={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function tu(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Ea(i)||(i=Il(i));const t=Tl(i,Wf);if(t.result==="error")throw new Error(t.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,l,d)=>t.value.evaluate(s,l,{},d),needGeometry:Qh(i)}}function Kf(i,t){return i<t?-1:i>t?1:0}function Qh(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let t=1;t<i.length;t++)if(Qh(i[t]))return!0;return!1}function Il(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?nu(i[1],i[2],"=="):t==="!="?Ia(nu(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?nu(i[1],i[2],t):t==="any"?(s=i.slice(1),["any"].concat(s.map(Il))):t==="all"?["all"].concat(i.slice(1).map(Il)):t==="none"?["all"].concat(i.slice(1).map(Il).map(Ia)):t==="in"?ed(i[1],i.slice(2)):t==="!in"?Ia(ed(i[1],i.slice(2))):t==="has"?td(i[1]):t==="!has"?Ia(td(i[1])):t!=="within"||i;var s}function nu(i,t,s){switch(i){case"$type":return[`filter-type-${s}`,t];case"$id":return[`filter-id-${s}`,t];default:return[`filter-${s}`,i,t]}}function ed(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(s=>typeof s!=typeof t[0])?["filter-in-large",i,["literal",t.sort(Kf)]]:["filter-in-small",i,["literal",t]]}}function td(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Ia(i){return["!",i]}function Cl(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let d="[";for(const g of i)d+=`${Cl(g)},`;return`${d}]`}const s=Object.keys(i).sort();let l="{";for(let d=0;d<s.length;d++)l+=`${JSON.stringify(s[d])}:${Cl(i[s[d]])},`;return`${l}}`}function kl(i){let t="";for(const s of Ar)t+=`/${Cl(i[s])}`;return t}function nd(i){const t=i.value;return t?[new Be(i.key,t,"constants have been deprecated as of v8")]:[]}function pn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Js(i){if(Array.isArray(i))return i.map(Js);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const s in i)t[s]=Js(i[s]);return t}return pn(i)}function Mr(i){const t=i.key,s=i.value,l=i.valueSpec||{},d=i.objectElementValidators||{},g=i.style,_=i.styleSpec,x=i.validateSpec;let S=[];const I=Lt(s);if(I!=="object")return[new Be(t,s,`object expected, ${I} found`)];for(const k in s){const R=k.split(".")[0],L=l[R]||l["*"];let B;if(d[R])B=d[R];else if(l[R])B=x;else if(d["*"])B=d["*"];else{if(!l["*"]){S.push(new Be(t,s[k],`unknown property "${k}"`));continue}B=x}S=S.concat(B({key:(t&&`${t}.`)+k,value:s[k],valueSpec:L,style:g,styleSpec:_,object:s,objectKey:k,validateSpec:x},s))}for(const k in l)d[k]||l[k].required&&l[k].default===void 0&&s[k]===void 0&&S.push(new Be(t,s,`missing required property "${k}"`));return S}function Ro(i){const t=i.value,s=i.valueSpec,l=i.style,d=i.styleSpec,g=i.key,_=i.arrayElementValidator||i.validateSpec;if(Lt(t)!=="array")return[new Be(g,t,`array expected, ${Lt(t)} found`)];if(s.length&&t.length!==s.length)return[new Be(g,t,`array length ${s.length} expected, length ${t.length} found`)];if(s["min-length"]&&t.length<s["min-length"])return[new Be(g,t,`array length at least ${s["min-length"]} expected, length ${t.length} found`)];let x={type:s.value,values:s.values};d.$version<7&&(x.function=s.function),Lt(s.value)==="object"&&(x=s.value);let S=[];for(let I=0;I<t.length;I++)S=S.concat(_({array:t,arrayIndex:I,value:t[I],valueSpec:x,validateSpec:i.validateSpec,style:l,styleSpec:d,key:`${g}[${I}]`}));return S}function Ca(i){const t=i.key,s=i.value,l=i.valueSpec;let d=Lt(s);return d==="number"&&s!=s&&(d="NaN"),d!=="number"?[new Be(t,s,`number expected, ${d} found`)]:"minimum"in l&&s<l.minimum?[new Be(t,s,`${s} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&s>l.maximum?[new Be(t,s,`${s} is greater than the maximum value ${l.maximum}`)]:[]}function Pl(i){const t=i.valueSpec,s=pn(i.value.type);let l,d,g,_={};const x=s!=="categorical"&&i.value.property===void 0,S=!x,I=Lt(i.value.stops)==="array"&&Lt(i.value.stops[0])==="array"&&Lt(i.value.stops[0][0])==="object",k=Mr({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(B){if(s==="identity")return[new Be(B.key,B.value,'identity function may not have a "stops" property')];let j=[];const G=B.value;return j=j.concat(Ro({key:B.key,value:G,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:R})),Lt(G)==="array"&&G.length===0&&j.push(new Be(B.key,G,"array must have at least one stop")),j},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:t,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return s==="identity"&&x&&k.push(new Be(i.key,i.value,'missing required property "property"')),s==="identity"||i.value.stops||k.push(new Be(i.key,i.value,'missing required property "stops"')),s==="exponential"&&i.valueSpec.expression&&!Yc(i.valueSpec)&&k.push(new Be(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!zo(i.valueSpec)?k.push(new Be(i.key,i.value,"property functions not supported")):x&&!Yh(i.valueSpec)&&k.push(new Be(i.key,i.value,"zoom functions not supported"))),s!=="categorical"&&!I||i.value.property!==void 0||k.push(new Be(i.key,i.value,'"property" property is required')),k;function R(B){let j=[];const G=B.value,Q=B.key;if(Lt(G)!=="array")return[new Be(Q,G,`array expected, ${Lt(G)} found`)];if(G.length!==2)return[new Be(Q,G,`array length 2 expected, length ${G.length} found`)];if(I){if(Lt(G[0])!=="object")return[new Be(Q,G,`object expected, ${Lt(G[0])} found`)];if(G[0].zoom===void 0)return[new Be(Q,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new Be(Q,G,"object stop key must have value")];if(g&&g>pn(G[0].zoom))return[new Be(Q,G[0].zoom,"stop zoom values must appear in ascending order")];pn(G[0].zoom)!==g&&(g=pn(G[0].zoom),d=void 0,_={}),j=j.concat(Mr({key:`${Q}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Ca,value:L}}))}else j=j.concat(L({key:`${Q}[0]`,value:G[0],valueSpec:{},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},G));return Sl(Js(G[1]))?j.concat([new Be(`${Q}[1]`,G[1],"expressions are not allowed in function stops.")]):j.concat(B.validateSpec({key:`${Q}[1]`,value:G[1],valueSpec:t,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function L(B,j){const G=Lt(B.value),Q=pn(B.value),ne=B.value!==null?B.value:j;if(l){if(G!==l)return[new Be(B.key,ne,`${G} stop domain type must match previous stop domain type ${l}`)]}else l=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new Be(B.key,ne,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&s!=="categorical"){let pe=`number expected, ${G} found`;return zo(t)&&s===void 0&&(pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(B.key,ne,pe)]}return s!=="categorical"||G!=="number"||isFinite(Q)&&Math.floor(Q)===Q?s!=="categorical"&&G==="number"&&d!==void 0&&Q<d?[new Be(B.key,ne,"stop domain values must appear in ascending order")]:(d=Q,s==="categorical"&&Q in _?[new Be(B.key,ne,"stop domain values must be unique")]:(_[Q]=!0,[])):[new Be(B.key,ne,`integer expected, found ${Q}`)]}}function Qs(i){const t=(i.expressionContext==="property"?eu:Tl)(Js(i.value),i.valueSpec);if(t.result==="error")return t.value.map(l=>new Be(`${i.key}${l.key}`,i.value,l.message));const s=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!s.outputDefined())return[new Be(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!wa(s))return[new Be(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!wa(s))return[new Be(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!gl(s,["zoom","feature-state"]))return[new Be(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ml(s))return[new Be(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ka(i){const t=i.key,s=i.value,l=i.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(pn(s))===-1&&d.push(new Be(t,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(l.values).indexOf(pn(s))===-1&&d.push(new Be(t,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),d}function Do(i){return Ea(Js(i.value))?Qs(Li({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):rd(i)}function rd(i){const t=i.value,s=i.key;if(Lt(t)!=="array")return[new Be(s,t,`array expected, ${Lt(t)} found`)];const l=i.styleSpec;let d,g=[];if(t.length<1)return[new Be(s,t,"filter array must have at least 1 element")];switch(g=g.concat(ka({key:`${s}[0]`,value:t[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),pn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&pn(t[1])==="$type"&&g.push(new Be(s,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new Be(s,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=Lt(t[1]),d!=="string"&&g.push(new Be(`${s}[1]`,t[1],`string expected, ${d} found`)));for(let _=2;_<t.length;_++)d=Lt(t[_]),pn(t[1])==="$type"?g=g.concat(ka({key:`${s}[${_}]`,value:t[_],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&g.push(new Be(`${s}[${_}]`,t[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)g=g.concat(rd({key:`${s}[${_}]`,value:t[_],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=Lt(t[1]),t.length!==2?g.push(new Be(s,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&g.push(new Be(`${s}[1]`,t[1],`string expected, ${d} found`));break;case"within":d=Lt(t[1]),t.length!==2?g.push(new Be(s,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="object"&&g.push(new Be(`${s}[1]`,t[1],`object expected, ${d} found`))}return g}function id(i,t){const s=i.key,l=i.validateSpec,d=i.style,g=i.styleSpec,_=i.value,x=i.objectKey,S=g[`${t}_${i.layerType}`];if(!S)return[];const I=x.match(/^(.*)-transition$/);if(t==="paint"&&I&&S[I[1]]&&S[I[1]].transition)return l({key:s,value:_,valueSpec:g.transition,style:d,styleSpec:g});const k=i.valueSpec||S[x];if(!k)return[new Be(s,_,`unknown property "${x}"`)];let R;if(Lt(_)==="string"&&zo(k)&&!k.tokens&&(R=/^{([^}]+)}$/.exec(_)))return[new Be(s,_,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const L=[];return i.layerType==="symbol"&&(x==="text-field"&&d&&!d.glyphs&&L.push(new Be(s,_,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&on(Js(_))&&pn(_.type)==="identity"&&L.push(new Be(s,_,'"text-font" does not support identity functions'))),L.concat(l({key:i.key,value:_,valueSpec:k,style:d,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:x}))}function sd(i){return id(i,"paint")}function od(i){return id(i,"layout")}function ad(i){let t=[];const s=i.value,l=i.key,d=i.style,g=i.styleSpec;s.type||s.ref||t.push(new Be(l,s,'either "type" or "ref" is required'));let _=pn(s.type);const x=pn(s.ref);if(s.id){const S=pn(s.id);for(let I=0;I<i.arrayIndex;I++){const k=d.layers[I];pn(k.id)===S&&t.push(new Be(l,s.id,`duplicate layer id "${s.id}", previously used at line ${k.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach(I=>{I in s&&t.push(new Be(l,s[I],`"${I}" is prohibited for ref layers`))}),d.layers.forEach(I=>{pn(I.id)===x&&(S=I)}),S?S.ref?t.push(new Be(l,s.ref,"ref cannot reference another ref layer")):_=pn(S.type):t.push(new Be(l,s.ref,`ref layer "${x}" not found`))}else if(_!=="background")if(s.source){const S=d.sources&&d.sources[s.source],I=S&&pn(S.type);S?I==="vector"&&_==="raster"?t.push(new Be(l,s.source,`layer "${s.id}" requires a raster source`)):I!=="raster-dem"&&_==="hillshade"?t.push(new Be(l,s.source,`layer "${s.id}" requires a raster-dem source`)):I==="raster"&&_!=="raster"?t.push(new Be(l,s.source,`layer "${s.id}" requires a vector source`)):I!=="vector"||s["source-layer"]?I==="raster-dem"&&_!=="hillshade"?t.push(new Be(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!s.paint||!s.paint["line-gradient"]||I==="geojson"&&S.lineMetrics||t.push(new Be(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Be(l,s,`layer "${s.id}" must specify a "source-layer"`)):t.push(new Be(l,s.source,`source "${s.source}" not found`))}else t.push(new Be(l,s,'missing required property "source"'));return t=t.concat(Mr({key:l,value:s,valueSpec:g.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:s.type,valueSpec:g.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:s,objectKey:"type"}),filter:Do,layout:S=>Mr({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>od(Li({layerType:_},I))}}),paint:S=>Mr({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>sd(Li({layerType:_},I))}})}})),t}function Oi(i){const t=i.value,s=i.key,l=Lt(t);return l!=="string"?[new Be(s,t,`string expected, ${l} found`)]:[]}const Pa={promoteId:function({key:i,value:t}){if(Lt(t)==="string")return Oi({key:i,value:t});{const s=[];for(const l in t)s.push(...Oi({key:`${i}.${l}`,value:t[l]}));return s}}};function Hr(i){const t=i.value,s=i.key,l=i.styleSpec,d=i.style,g=i.validateSpec;if(!t.type)return[new Be(s,t,'"type" is required')];const _=pn(t.type);let x;switch(_){case"vector":case"raster":return x=Mr({key:s,value:t,valueSpec:l[`source_${_.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Pa,validateSpec:g}),x;case"raster-dem":return x=function(S){var I;const k=(I=S.sourceName)!==null&&I!==void 0?I:"",R=S.value,L=S.styleSpec,B=L.source_raster_dem,j=S.style;let G=[];const Q=Lt(R);if(R===void 0)return G;if(Q!=="object")return G.push(new Be("source_raster_dem",R,`object expected, ${Q} found`)),G;const ne=pn(R.encoding)==="custom",pe=["redFactor","greenFactor","blueFactor","baseShift"],oe=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const me in R)!ne&&pe.includes(me)?G.push(new Be(me,R[me],`In "${k}": "${me}" is only valid when "encoding" is set to "custom". ${oe} encoding found`)):B[me]?G=G.concat(S.validateSpec({key:me,value:R[me],valueSpec:B[me],validateSpec:S.validateSpec,style:j,styleSpec:L})):G.push(new Be(me,R[me],`unknown property "${me}"`));return G}({sourceName:s,value:t,style:i.style,styleSpec:l,validateSpec:g}),x;case"geojson":if(x=Mr({key:s,value:t,valueSpec:l.source_geojson,style:d,styleSpec:l,validateSpec:g,objectElementValidators:Pa}),t.cluster)for(const S in t.clusterProperties){const[I,k]=t.clusterProperties[S],R=typeof I=="string"?[I,["accumulated"],["get",S]]:I;x.push(...Qs({key:`${s}.${S}.map`,value:k,validateSpec:g,expressionContext:"cluster-map"})),x.push(...Qs({key:`${s}.${S}.reduce`,value:R,validateSpec:g,expressionContext:"cluster-reduce"}))}return x;case"video":return Mr({key:s,value:t,valueSpec:l.source_video,style:d,validateSpec:g,styleSpec:l});case"image":return Mr({key:s,value:t,valueSpec:l.source_image,style:d,validateSpec:g,styleSpec:l});case"canvas":return[new Be(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ka({key:`${s}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,validateSpec:g,styleSpec:l})}}function Aa(i){const t=i.value,s=i.styleSpec,l=s.light,d=i.style;let g=[];const _=Lt(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Be("light",t,`object expected, ${_} found`)]),g;for(const x in t){const S=x.match(/^(.*)-transition$/);g=g.concat(S&&l[S[1]]&&l[S[1]].transition?i.validateSpec({key:x,value:t[x],valueSpec:s.transition,validateSpec:i.validateSpec,style:d,styleSpec:s}):l[x]?i.validateSpec({key:x,value:t[x],valueSpec:l[x],validateSpec:i.validateSpec,style:d,styleSpec:s}):[new Be(x,t[x],`unknown property "${x}"`)])}return g}function ld(i){const t=i.value,s=i.styleSpec,l=s.terrain,d=i.style;let g=[];const _=Lt(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Be("terrain",t,`object expected, ${_} found`)]),g;for(const x in t)g=g.concat(l[x]?i.validateSpec({key:x,value:t[x],valueSpec:l[x],validateSpec:i.validateSpec,style:d,styleSpec:s}):[new Be(x,t[x],`unknown property "${x}"`)]);return g}function cd(i){let t=[];const s=i.value,l=i.key;if(Array.isArray(s)){const d=[],g=[];for(const _ in s)s[_].id&&d.includes(s[_].id)&&t.push(new Be(l,s,`all the sprites' ids must be unique, but ${s[_].id} is duplicated`)),d.push(s[_].id),s[_].url&&g.includes(s[_].url)&&t.push(new Be(l,s,`all the sprites' URLs must be unique, but ${s[_].url} is duplicated`)),g.push(s[_].url),t=t.concat(Mr({key:`${l}[${_}]`,value:s[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return Oi({key:l,value:s})}const ud={"*":()=>[],array:Ro,boolean:function(i){const t=i.value,s=i.key,l=Lt(t);return l!=="boolean"?[new Be(s,t,`boolean expected, ${l} found`)]:[]},number:Ca,color:function(i){const t=i.key,s=i.value,l=Lt(s);return l!=="string"?[new Be(t,s,`color expected, ${l} found`)]:Ut.parse(String(s))?[]:[new Be(t,s,`color expected, "${s}" found`)]},constants:nd,enum:ka,filter:Do,function:Pl,layer:ad,object:Mr,source:Hr,light:Aa,terrain:ld,string:Oi,formatted:function(i){return Oi(i).length===0?[]:Qs(i)},resolvedImage:function(i){return Oi(i).length===0?[]:Qs(i)},padding:function(i){const t=i.key,s=i.value;if(Lt(s)==="array"){if(s.length<1||s.length>4)return[new Be(t,s,`padding requires 1 to 4 values; ${s.length} values found`)];const l={type:"number"};let d=[];for(let g=0;g<s.length;g++)d=d.concat(i.validateSpec({key:`${t}[${g}]`,value:s[g],validateSpec:i.validateSpec,valueSpec:l}));return d}return Ca({key:t,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const t=i.key,s=i.value,l=Lt(s),d=i.styleSpec;if(l!=="array"||s.length<1||s.length%2!=0)return[new Be(t,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let _=0;_<s.length;_+=2)g=g.concat(ka({key:`${t}[${_}]`,value:s[_],valueSpec:d.layout_symbol["text-anchor"]})),g=g.concat(Ro({key:`${t}[${_+1}]`,value:s[_+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:d}));return g},sprite:cd};function rs(i){const t=i.value,s=i.valueSpec,l=i.styleSpec;return i.validateSpec=rs,s.expression&&on(pn(t))?Pl(i):s.expression&&Sl(Js(t))?Qs(i):s.type&&ud[s.type]?ud[s.type](i):Mr(Li({},i,{valueSpec:s.type?l[s.type]:s}))}function hd(i){const t=i.value,s=i.key,l=Oi(i);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Be(s,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Be(s,t,'"glyphs" url must include a "{range}" token'))),l}function hi(i,t=be){let s=[];return s=s.concat(rs({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:rs,objectElementValidators:{glyphs:hd,"*":()=>[]}})),i.constants&&(s=s.concat(nd({key:"constants",value:i.constants,style:i,styleSpec:t,validateSpec:rs}))),Al(s)}function is(i){return function(t){return i({...t,validateSpec:rs})}}function Al(i){return[].concat(i).sort((t,s)=>t.line-s.line)}function ss(i){return function(...t){return Al(i.apply(this,t))}}hi.source=ss(is(Hr)),hi.sprite=ss(is(cd)),hi.glyphs=ss(is(hd)),hi.light=ss(is(Aa)),hi.terrain=ss(is(ld)),hi.layer=ss(is(ad)),hi.filter=ss(is(Do)),hi.paintProperty=ss(is(sd)),hi.layoutProperty=ss(is(od));const os=hi,Xf=os.light,ru=os.paintProperty,dd=os.layoutProperty;function Ml(i,t){let s=!1;if(t&&t.length)for(const l of t)i.fire(new Ss(new Error(l.message))),s=!0;return s}class Lo{constructor(t,s,l){const d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(s=_[1])+2*(l=_[2]);for(let S=0;S<this.d*this.d;S++){const I=_[3+S],k=_[3+S+1];d.push(I===k?null:_.subarray(I,k))}const x=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],x),this.bboxes=_.subarray(x),this.insert=this._insertReadonly}else{this.d=s+2*l;for(let _=0;_<this.d*this.d;_++)d.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=t,this.padding=l,this.scale=s/t,this.uid=0;const g=l/s*t;this.min=-g,this.max=t+g}insert(t,s,l,d,g){this._forEachCell(s,l,d,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,s,l,d,g,_){this.cells[g].push(_)}query(t,s,l,d,g){const _=this.min,x=this.max;if(t<=_&&s<=_&&x<=l&&x<=d&&!g)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,s,l,d,this._queryCell,S,{},g),S}}_queryCell(t,s,l,d,g,_,x,S){const I=this.cells[g];if(I!==null){const k=this.keys,R=this.bboxes;for(let L=0;L<I.length;L++){const B=I[L];if(x[B]===void 0){const j=4*B;(S?S(R[j+0],R[j+1],R[j+2],R[j+3]):t<=R[j+2]&&s<=R[j+3]&&l>=R[j+0]&&d>=R[j+1])?(x[B]=!0,_.push(k[B])):x[B]=!1}}}}_forEachCell(t,s,l,d,g,_,x,S){const I=this._convertToCellCoord(t),k=this._convertToCellCoord(s),R=this._convertToCellCoord(l),L=this._convertToCellCoord(d);for(let B=I;B<=R;B++)for(let j=k;j<=L;j++){const G=this.d*j+B;if((!S||S(this._convertFromCellCoord(B),this._convertFromCellCoord(j),this._convertFromCellCoord(B+1),this._convertFromCellCoord(j+1)))&&g.call(this,t,s,l,d,G,_,x,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,s=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const d=new Int32Array(s+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let g=s;for(let _=0;_<t.length;_++){const x=t[_];d[3+_]=g,d.set(x,g),g+=x.length}return d[3+t.length]=g,d.set(this.keys,g),g+=this.keys.length,d[3+t.length+1]=g,d.set(this.bboxes,g),g+=this.bboxes.length,d.buffer}static serialize(t,s){const l=t.toArrayBuffer();return s&&s.push(l),{buffer:l}}static deserialize(t){return new Lo(t.buffer)}}const as={};function Ke(i,t,s={}){if(as[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),as[i]={klass:t,omit:s.omit||[],shallow:s.shallow||[]}}Ke("Object",Object),Ke("TransferableGridIndex",Lo),Ke("Color",Ut),Ke("Error",Error),Ke("AJAXError",si),Ke("ResolvedImage",nr),Ke("StylePropertyFunction",Sa),Ke("StyleExpression",Jc,{omit:["_evaluator"]}),Ke("ZoomDependentExpression",El),Ke("ZoomConstantExpression",Qc),Ke("CompoundExpression",ui,{omit:["_evaluate"]});for(const i in Mo)Mo[i]._classRegistryKey||Ke(`Expression_${i}`,Mo[i]);function zl(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Ps(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(zl(i)||dt(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const s=i;return t&&t.push(s.buffer),s}if(i instanceof ImageData)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const s=[];for(const l of i)s.push(Ps(l,t));return s}if(typeof i=="object"){const s=i.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");if(!as[l])throw new Error(`${l} is not registered.`);const d=s.serialize?s.serialize(i,t):{};if(s.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in i){if(!i.hasOwnProperty(g)||as[l].omit.indexOf(g)>=0)continue;const _=i[g];d[g]=as[l].shallow.indexOf(g)>=0?_:Ps(_,t)}i instanceof Error&&(d.message=i.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(d.$name=l),d}throw new Error("can't serialize object of type "+typeof i)}function Fo(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||zl(i)||dt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Fo);if(typeof i=="object"){const t=i.$name||"Object";if(!as[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:s}=as[t];if(!s)throw new Error(`can't deserialize unregistered class ${t}`);if(s.deserialize)return s.deserialize(i);const l=Object.create(s.prototype);for(const d of Object.keys(i)){if(d==="$name")continue;const g=i[d];l[d]=as[t].shallow.indexOf(d)>=0?g:Fo(g)}return l}throw new Error("can't deserialize object of type "+typeof i)}class pd{constructor(){this.first=!0}update(t,s){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=s),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const Ze={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function iu(i){for(const t of i)if(ou(t.charCodeAt(0)))return!0;return!1}function su(i){for(const t of i)if(!Yf(t.charCodeAt(0)))return!1;return!0}function Yf(i){return!(Ze.Arabic(i)||Ze["Arabic Supplement"](i)||Ze["Arabic Extended-A"](i)||Ze["Arabic Presentation Forms-A"](i)||Ze["Arabic Presentation Forms-B"](i))}function ou(i){return!(i!==746&&i!==747&&(i<4352||!(Ze["Bopomofo Extended"](i)||Ze.Bopomofo(i)||Ze["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ze["CJK Compatibility Ideographs"](i)||Ze["CJK Compatibility"](i)||Ze["CJK Radicals Supplement"](i)||Ze["CJK Strokes"](i)||!(!Ze["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ze["CJK Unified Ideographs Extension A"](i)||Ze["CJK Unified Ideographs"](i)||Ze["Enclosed CJK Letters and Months"](i)||Ze["Hangul Compatibility Jamo"](i)||Ze["Hangul Jamo Extended-A"](i)||Ze["Hangul Jamo Extended-B"](i)||Ze["Hangul Jamo"](i)||Ze["Hangul Syllables"](i)||Ze.Hiragana(i)||Ze["Ideographic Description Characters"](i)||Ze.Kanbun(i)||Ze["Kangxi Radicals"](i)||Ze["Katakana Phonetic Extensions"](i)||Ze.Katakana(i)&&i!==12540||!(!Ze["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ze["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ze["Unified Canadian Aboriginal Syllabics"](i)||Ze["Unified Canadian Aboriginal Syllabics Extended"](i)||Ze["Vertical Forms"](i)||Ze["Yijing Hexagram Symbols"](i)||Ze["Yi Syllables"](i)||Ze["Yi Radicals"](i))))}function fd(i){return!(ou(i)||function(t){return!!(Ze["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ze["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ze["Letterlike Symbols"](t)||Ze["Number Forms"](t)||Ze["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ze["Control Pictures"](t)&&t!==9251||Ze["Optical Character Recognition"](t)||Ze["Enclosed Alphanumerics"](t)||Ze["Geometric Shapes"](t)||Ze["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ze["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ze["CJK Symbols and Punctuation"](t)||Ze.Katakana(t)||Ze["Private Use Area"](t)||Ze["CJK Compatibility Forms"](t)||Ze["Small Form Variants"](t)||Ze["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function md(i){return i>=1424&&i<=2303||Ze["Arabic Presentation Forms-A"](i)||Ze["Arabic Presentation Forms-B"](i)}function gd(i,t){return!(!t&&md(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ze.Khmer(i))}function Jf(i){for(const t of i)if(md(t.charCodeAt(0)))return!0;return!1}const au="deferred",lu="loading",cu="loaded";let uu=null,zr="unavailable",As=null;const Ma=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(zr="error"),uu&&uu(i)};function hu(){za.fire(new bs("pluginStateChange",{pluginStatus:zr,pluginURL:As}))}const za=new Gs,du=function(){return zr},yd=function(){if(zr!==au||!As)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");zr=lu,hu(),As&&va({url:As},i=>{i?Ma(i):(zr=cu,hu())})},Wr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>zr===cu||Wr.applyArabicShaping!=null,isLoading:()=>zr===lu,setState(i){if(!tn())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");zr=i.pluginStatus,As=i.pluginURL},isParsed(){if(!tn())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Wr.applyArabicShaping!=null&&Wr.processBidirectionalText!=null&&Wr.processStyledBidirectionalText!=null},getPluginURL(){if(!tn())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return As}};class Jt{constructor(t,s){this.zoom=t,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pd,this.transition={})}isSupportedScript(t){return function(s,l){for(const d of s)if(!gd(d.charCodeAt(0),l))return!1;return!0}(t,Wr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,s=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*s}}}class Rl{constructor(t,s){this.property=t,this.value=s,this.expression=function(l,d){if(on(l))return new Sa(l,d);if(Sl(l)){const g=eu(l,d);if(g.result==="error")throw new Error(g.value.map(_=>`${_.key}: ${_.message}`).join(", "));return g.value}{let g=l;return d.type==="color"&&typeof l=="string"?g=Ut.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(g=li.parse(l)):g=qr.parse(l),{kind:"constant",evaluate:()=>g}}}(s===void 0?t.specification.default:s,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,s,l){return this.property.possiblyEvaluate(this,t,s,l)}}class pu{constructor(t){this.property=t,this.value=new Rl(t,void 0)}transitioned(t,s){return new vd(this.property,this.value,s,qe({},t.transition,this.transition),t.now)}untransitioned(){return new vd(this.property,this.value,null,{},0)}}class _d{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Nn(this._values[t].value.value)}setValue(t,s){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new pu(this._values[t].property)),this._values[t].value=new Rl(this._values[t].property,s===null?void 0:Nn(s))}getTransition(t){return Nn(this._values[t].transition)}setTransition(t,s){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new pu(this._values[t].property)),this._values[t].transition=Nn(s)||void 0}serialize(){const t={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(t[s]=l);const d=this.getTransition(s);d!==void 0&&(t[`${s}-transition`]=d)}return t}transitioned(t,s){const l=new xd(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(t,s._values[d]);return l}untransitioned(){const t=new xd(this._properties);for(const s of Object.keys(this._values))t._values[s]=this._values[s].untransitioned();return t}}class vd{constructor(t,s,l,d,g){this.property=t,this.value=s,this.begin=g+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(t,s,l){const d=t.now||0,g=this.value.possiblyEvaluate(t,s,l),_=this.prior;if(_){if(d>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(d<this.begin)return _.possiblyEvaluate(t,s,l);{const x=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,s,l),g,function(S){if(S<=0)return 0;if(S>=1)return 1;const I=S*S,k=I*S;return 4*(S<.5?k:3*(S-I)+k-.75)}(x))}}return g}}class xd{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,s,l){const d=new Dl(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,s,l);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Qf{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return Nn(this._values[t].value)}setValue(t,s){this._values[t]=new Rl(this._values[t].property,s===null?void 0:Nn(s))}serialize(){const t={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(t[s]=l)}return t}possiblyEvaluate(t,s,l){const d=new Dl(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(t,s,l);return d}}class wr{constructor(t,s,l){this.property=t,this.value=s,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,s,l,d){return this.property.evaluate(this.value,this.parameters,t,s,l,d)}}class Dl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class nt{constructor(t){this.specification=t}possiblyEvaluate(t,s){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(s)}interpolate(t,s,l){const d=Gr[this.specification.type];return d?d(t,s,l):t}}class ct{constructor(t,s){this.specification=t,this.overrides=s}possiblyEvaluate(t,s,l,d){return new wr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(s,null,{},l,d)}:t.expression,s)}interpolate(t,s,l){if(t.value.kind!=="constant"||s.value.kind!=="constant")return t;if(t.value.value===void 0||s.value.value===void 0)return new wr(this,{kind:"constant",value:void 0},t.parameters);const d=Gr[this.specification.type];if(d){const g=d(t.value.value,s.value.value,l);return new wr(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,s,l,d,g,_){return t.kind==="constant"?t.value:t.evaluate(s,l,d,g,_)}}class Ra extends ct{possiblyEvaluate(t,s,l,d){if(t.value===void 0)return new wr(this,{kind:"constant",value:void 0},s);if(t.expression.kind==="constant"){const g=t.expression.evaluate(s,null,{},l,d),_=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,x=this._calculate(_,_,_,s);return new wr(this,{kind:"constant",value:x},s)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:s.zoom-1}),t.expression.evaluate({zoom:s.zoom}),t.expression.evaluate({zoom:s.zoom+1}),s);return new wr(this,{kind:"constant",value:g},s)}return new wr(this,t.expression,s)}evaluate(t,s,l,d,g,_){if(t.kind==="source"){const x=t.evaluate(s,l,d,g,_);return this._calculate(x,x,x,s)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(s.zoom)-1},l,d),t.evaluate({zoom:Math.floor(s.zoom)},l,d),t.evaluate({zoom:Math.floor(s.zoom)+1},l,d),s):t.value}_calculate(t,s,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:s}:{from:l,to:s}}interpolate(t){return t}}class fu{constructor(t){this.specification=t}possiblyEvaluate(t,s,l,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(s,null,{},l,d);return this._calculate(g,g,g,s)}return this._calculate(t.expression.evaluate(new Jt(Math.floor(s.zoom-1),s)),t.expression.evaluate(new Jt(Math.floor(s.zoom),s)),t.expression.evaluate(new Jt(Math.floor(s.zoom+1),s)),s)}}_calculate(t,s,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:s}:{from:l,to:s}}interpolate(t){return t}}class mu{constructor(t){this.specification=t}possiblyEvaluate(t,s,l,d){return!!t.expression.evaluate(s,null,{},l,d)}interpolate(){return!1}}class Sn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in t){const l=t[s];l.specification.overridable&&this.overridableProperties.push(s);const d=this.defaultPropertyValues[s]=new Rl(l,void 0),g=this.defaultTransitionablePropertyValues[s]=new pu(l);this.defaultTransitioningPropertyValues[s]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=d.possiblyEvaluate({})}}}Ke("DataDrivenProperty",ct),Ke("DataConstantProperty",nt),Ke("CrossFadedDataDrivenProperty",Ra),Ke("CrossFadedProperty",fu),Ke("ColorRampProperty",mu);const gu="-transition";class di extends Gs{constructor(t,s){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),s.layout&&(this._unevaluatedLayout=new Qf(s.layout)),s.paint)){this._transitionablePaint=new _d(s.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Dl(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,s,l={}){s!=null&&this._validate(dd,`layers.${this.id}.layout.${t}`,t,s,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,s):this.visibility=s)}getPaintProperty(t){return t.endsWith(gu)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,s,l={}){if(s!=null&&this._validate(ru,`layers.${this.id}.paint.${t}`,t,s,l))return!1;if(t.endsWith(gu))return this._transitionablePaint.setTransition(t.slice(0,-11),s||void 0),!1;{const d=this._transitionablePaint._values[t],g=d.property.specification["property-type"]==="cross-faded-data-driven",_=d.value.isDataDriven(),x=d.value;this._transitionablePaint.setValue(t,s),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||_||g||this._handleOverridablePaintPropertyUpdate(t,x,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,s,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,s){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,s)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),An(t,(s,l)=>!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length))}_validate(t,s,l,d,g={}){return(!g||g.validate!==!1)&&Ml(this,t.call(os,{key:s,layerType:this.type,objectKey:l,value:d,styleSpec:be,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const s=this.paint.get(t);if(s instanceof wr&&zo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const wd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class eo{constructor(t,s){this._structArray=t,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class fn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,s){return t._trim(),s&&(t.isTransferred=!0,s.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const s=Object.create(this.prototype);return s.arrayBuffer=t.arrayBuffer,s.length=t.length,s.capacity=t.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ln(i,t=1){let s=0,l=0;return{members:i.map(d=>{const g=wd[d.type].BYTES_PER_ELEMENT,_=s=Oo(s,Math.max(t,g)),x=d.components||1;return l=Math.max(l,g),s+=g*x,{name:d.name,type:d.type,components:x,offset:_}}),size:Oo(s,Math.max(l,t)),alignment:t}}function Oo(i,t){return Math.ceil(i/t)*t}class Da extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s){const l=this.length;return this.resize(l+1),this.emplace(l,t,s)}emplace(t,s,l){const d=2*t;return this.int16[d+0]=s,this.int16[d+1]=l,t}}Da.prototype.bytesPerElement=4,Ke("StructArrayLayout2i4",Da);class La extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.int16[g+0]=s,this.int16[g+1]=l,this.int16[g+2]=d,t}}La.prototype.bytesPerElement=6,Ke("StructArrayLayout3i6",La);class to extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,s,l,d)}emplace(t,s,l,d,g){const _=4*t;return this.int16[_+0]=s,this.int16[_+1]=l,this.int16[_+2]=d,this.int16[_+3]=g,t}}to.prototype.bytesPerElement=8,Ke("StructArrayLayout4i8",to);class yu extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,s,l,d,g,_)}emplace(t,s,l,d,g,_,x){const S=6*t;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=d,this.int16[S+3]=g,this.int16[S+4]=_,this.int16[S+5]=x,t}}yu.prototype.bytesPerElement=12,Ke("StructArrayLayout2i4i12",yu);class _u extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,s,l,d,g,_)}emplace(t,s,l,d,g,_,x){const S=4*t,I=8*t;return this.int16[S+0]=s,this.int16[S+1]=l,this.uint8[I+4]=d,this.uint8[I+5]=g,this.uint8[I+6]=_,this.uint8[I+7]=x,t}}_u.prototype.bytesPerElement=8,Ke("StructArrayLayout2i4ub8",_u);class Bo extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s){const l=this.length;return this.resize(l+1),this.emplace(l,t,s)}emplace(t,s,l){const d=2*t;return this.float32[d+0]=s,this.float32[d+1]=l,t}}Bo.prototype.bytesPerElement=8,Ke("StructArrayLayout2f8",Bo);class vu extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,I,k){const R=this.length;return this.resize(R+1),this.emplace(R,t,s,l,d,g,_,x,S,I,k)}emplace(t,s,l,d,g,_,x,S,I,k,R){const L=10*t;return this.uint16[L+0]=s,this.uint16[L+1]=l,this.uint16[L+2]=d,this.uint16[L+3]=g,this.uint16[L+4]=_,this.uint16[L+5]=x,this.uint16[L+6]=S,this.uint16[L+7]=I,this.uint16[L+8]=k,this.uint16[L+9]=R,t}}vu.prototype.bytesPerElement=20,Ke("StructArrayLayout10ui20",vu);class xu extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,I,k,R,L){const B=this.length;return this.resize(B+1),this.emplace(B,t,s,l,d,g,_,x,S,I,k,R,L)}emplace(t,s,l,d,g,_,x,S,I,k,R,L,B){const j=12*t;return this.int16[j+0]=s,this.int16[j+1]=l,this.int16[j+2]=d,this.int16[j+3]=g,this.uint16[j+4]=_,this.uint16[j+5]=x,this.uint16[j+6]=S,this.uint16[j+7]=I,this.int16[j+8]=k,this.int16[j+9]=R,this.int16[j+10]=L,this.int16[j+11]=B,t}}xu.prototype.bytesPerElement=24,Ke("StructArrayLayout4i4ui4i24",xu);class Ft extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.float32[g+0]=s,this.float32[g+1]=l,this.float32[g+2]=d,t}}Ft.prototype.bytesPerElement=12,Ke("StructArrayLayout3f12",Ft);class m extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint32[1*t+0]=s,t}}m.prototype.bytesPerElement=4,Ke("StructArrayLayout1ul4",m);class n extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,I){const k=this.length;return this.resize(k+1),this.emplace(k,t,s,l,d,g,_,x,S,I)}emplace(t,s,l,d,g,_,x,S,I,k){const R=10*t,L=5*t;return this.int16[R+0]=s,this.int16[R+1]=l,this.int16[R+2]=d,this.int16[R+3]=g,this.int16[R+4]=_,this.int16[R+5]=x,this.uint32[L+3]=S,this.uint16[R+8]=I,this.uint16[R+9]=k,t}}n.prototype.bytesPerElement=20,Ke("StructArrayLayout6i1ul2ui20",n);class a extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,s,l,d,g,_)}emplace(t,s,l,d,g,_,x){const S=6*t;return this.int16[S+0]=s,this.int16[S+1]=l,this.int16[S+2]=d,this.int16[S+3]=g,this.int16[S+4]=_,this.int16[S+5]=x,t}}a.prototype.bytesPerElement=12,Ke("StructArrayLayout2i2i2i12",a);class h extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,l,d,g)}emplace(t,s,l,d,g,_){const x=4*t,S=8*t;return this.float32[x+0]=s,this.float32[x+1]=l,this.float32[x+2]=d,this.int16[S+6]=g,this.int16[S+7]=_,t}}h.prototype.bytesPerElement=16,Ke("StructArrayLayout2f1f2i16",h);class p extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,s,l,d)}emplace(t,s,l,d,g){const _=12*t,x=3*t;return this.uint8[_+0]=s,this.uint8[_+1]=l,this.float32[x+1]=d,this.float32[x+2]=g,t}}p.prototype.bytesPerElement=12,Ke("StructArrayLayout2ub2f12",p);class y extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.uint16[g+0]=s,this.uint16[g+1]=l,this.uint16[g+2]=d,t}}y.prototype.bytesPerElement=6,Ke("StructArrayLayout3ui6",y);class w extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,I,k,R,L,B,j,G,Q,ne){const pe=this.length;return this.resize(pe+1),this.emplace(pe,t,s,l,d,g,_,x,S,I,k,R,L,B,j,G,Q,ne)}emplace(t,s,l,d,g,_,x,S,I,k,R,L,B,j,G,Q,ne,pe){const oe=24*t,me=12*t,_e=48*t;return this.int16[oe+0]=s,this.int16[oe+1]=l,this.uint16[oe+2]=d,this.uint16[oe+3]=g,this.uint32[me+2]=_,this.uint32[me+3]=x,this.uint32[me+4]=S,this.uint16[oe+10]=I,this.uint16[oe+11]=k,this.uint16[oe+12]=R,this.float32[me+7]=L,this.float32[me+8]=B,this.uint8[_e+36]=j,this.uint8[_e+37]=G,this.uint8[_e+38]=Q,this.uint32[me+10]=ne,this.int16[oe+22]=pe,t}}w.prototype.bytesPerElement=48,Ke("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",w);class b extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l,d,g,_,x,S,I,k,R,L,B,j,G,Q,ne,pe,oe,me,_e,Ie,He,Qe,Ge,$e,Oe,Xe){const je=this.length;return this.resize(je+1),this.emplace(je,t,s,l,d,g,_,x,S,I,k,R,L,B,j,G,Q,ne,pe,oe,me,_e,Ie,He,Qe,Ge,$e,Oe,Xe)}emplace(t,s,l,d,g,_,x,S,I,k,R,L,B,j,G,Q,ne,pe,oe,me,_e,Ie,He,Qe,Ge,$e,Oe,Xe,je){const Re=32*t,ot=16*t;return this.int16[Re+0]=s,this.int16[Re+1]=l,this.int16[Re+2]=d,this.int16[Re+3]=g,this.int16[Re+4]=_,this.int16[Re+5]=x,this.int16[Re+6]=S,this.int16[Re+7]=I,this.uint16[Re+8]=k,this.uint16[Re+9]=R,this.uint16[Re+10]=L,this.uint16[Re+11]=B,this.uint16[Re+12]=j,this.uint16[Re+13]=G,this.uint16[Re+14]=Q,this.uint16[Re+15]=ne,this.uint16[Re+16]=pe,this.uint16[Re+17]=oe,this.uint16[Re+18]=me,this.uint16[Re+19]=_e,this.uint16[Re+20]=Ie,this.uint16[Re+21]=He,this.uint16[Re+22]=Qe,this.uint32[ot+12]=Ge,this.float32[ot+13]=$e,this.float32[ot+14]=Oe,this.uint16[Re+30]=Xe,this.uint16[Re+31]=je,t}}b.prototype.bytesPerElement=64,Ke("StructArrayLayout8i15ui1ul2f2ui64",b);class E extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.float32[1*t+0]=s,t}}E.prototype.bytesPerElement=4,Ke("StructArrayLayout1f4",E);class C extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=3*t;return this.uint16[6*t+0]=s,this.float32[g+1]=l,this.float32[g+2]=d,t}}C.prototype.bytesPerElement=12,Ke("StructArrayLayout1ui2f12",C);class A extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,l){const d=this.length;return this.resize(d+1),this.emplace(d,t,s,l)}emplace(t,s,l,d){const g=4*t;return this.uint32[2*t+0]=s,this.uint16[g+2]=l,this.uint16[g+3]=d,t}}A.prototype.bytesPerElement=8,Ke("StructArrayLayout1ul2ui8",A);class M extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s){const l=this.length;return this.resize(l+1),this.emplace(l,t,s)}emplace(t,s,l){const d=2*t;return this.uint16[d+0]=s,this.uint16[d+1]=l,t}}M.prototype.bytesPerElement=4,Ke("StructArrayLayout2ui4",M);class O extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint16[1*t+0]=s,t}}O.prototype.bytesPerElement=2,Ke("StructArrayLayout1ui2",O);class H extends fn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,l,d){const g=this.length;return this.resize(g+1),this.emplace(g,t,s,l,d)}emplace(t,s,l,d,g){const _=4*t;return this.float32[_+0]=s,this.float32[_+1]=l,this.float32[_+2]=d,this.float32[_+3]=g,t}}H.prototype.bytesPerElement=16,Ke("StructArrayLayout4f16",H);class Z extends eo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new N(this.anchorPointX,this.anchorPointY)}}Z.prototype.size=20;class K extends n{get(t){return new Z(this,t)}}Ke("CollisionBoxArray",K);class q extends eo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}q.prototype.size=48;class ue extends w{get(t){return new q(this,t)}}Ke("PlacedSymbolArray",ue);class ye extends eo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ye.prototype.size=64;class te extends b{get(t){return new ye(this,t)}}Ke("SymbolInstanceArray",te);class he extends E{getoffsetX(t){return this.float32[1*t+0]}}Ke("GlyphOffsetArray",he);class ve extends La{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ke("SymbolLineVertexArray",ve);class we extends eo{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}we.prototype.size=12;class Ee extends C{get(t){return new we(this,t)}}Ke("TextAnchorOffsetArray",Ee);class ze extends eo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ze.prototype.size=8;class ke extends A{get(t){return new ze(this,t)}}Ke("FeatureIndexArray",ke);class Le extends Da{}class Je extends Da{}class bt extends Da{}class Ve extends yu{}class ut extends _u{}class et extends Bo{}class Vt extends vu{}class wt extends xu{}class _t extends Ft{}class St extends m{}class _n extends a{}class Xt extends p{}class rr extends y{}class Un extends M{}const Tn=ln([{name:"a_pos",components:2,type:"Int16"}],4),{members:Kr}=Tn;class Qt{constructor(t=[]){this.segments=t}prepareSegment(t,s,l,d){let g=this.segments[this.segments.length-1];return t>Qt.MAX_VERTEX_ARRAY_LENGTH&&Mn(`Max vertices per segment is ${Qt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!g||g.vertexLength+t>Qt.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==d)&&(g={vertexOffset:s.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},d!==void 0&&(g.sortKey=d),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const t of this.segments)for(const s in t.vaos)t.vaos[s].destroy()}static simpleSegment(t,s,l,d){return new Qt([{vertexOffset:t,primitiveOffset:s,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function Bi(i,t){return 256*(i=Fe(Math.floor(i),0,255))+Fe(Math.floor(t),0,255)}Qt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ke("SegmentVector",Qt);const Ni=ln([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ms={exports:{}},no={exports:{}};no.exports=function(i,t){var s,l,d,g,_,x,S,I;for(l=i.length-(s=3&i.length),d=t,_=3432918353,x=461845907,I=0;I<l;)S=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,d=27492+(65535&(g=5*(65535&(d=(d^=S=(65535&(S=(S=(65535&S)*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(S=0,s){case 3:S^=(255&i.charCodeAt(I+2))<<16;case 2:S^=(255&i.charCodeAt(I+1))<<8;case 1:d^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(I)))*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*x+(((S>>>16)*x&65535)<<16)&4294967295}return d^=i.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var No=no.exports,pr={exports:{}};pr.exports=function(i,t){for(var s,l=i.length,d=t^l,g=0;l>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(g)|(255&i.charCodeAt(++g))<<8|(255&i.charCodeAt(++g))<<16|(255&i.charCodeAt(++g))<<24))+((1540483477*(s>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),l-=4,++g;switch(l){case 3:d^=(255&i.charCodeAt(g+2))<<16;case 2:d^=(255&i.charCodeAt(g+1))<<8;case 1:d=1540483477*(65535&(d^=255&i.charCodeAt(g)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var ir=No,br=pr.exports;Ms.exports=ir,Ms.exports.murmur3=ir,Ms.exports.murmur2=br;var ro=P(Ms.exports);class vn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,s,l,d){this.ids.push(Vn(t)),this.positions.push(s,l,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Vn(t);let l=0,d=this.ids.length-1;for(;l<d;){const _=l+d>>1;this.ids[_]>=s?d=_:l=_+1}const g=[];for(;this.ids[l]===s;)g.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return g}static serialize(t,s){const l=new Float64Array(t.ids),d=new Uint32Array(t.positions);return Rr(l,d,0,l.length-1),s&&s.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(t){const s=new vn;return s.ids=t.ids,s.positions=t.positions,s.indexed=!0,s}}function Vn(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ro(String(i))}function Rr(i,t,s,l){for(;s<l;){const d=i[s+l>>1];let g=s-1,_=l+1;for(;;){do g++;while(i[g]<d);do _--;while(i[_]>d);if(g>=_)break;xn(i,g,_),xn(t,3*g,3*_),xn(t,3*g+1,3*_+1),xn(t,3*g+2,3*_+2)}_-s<l-_?(Rr(i,t,s,_),s=_+1):(Rr(i,t,_+1,l),l=_)}}function xn(i,t,s){const l=i[t];i[t]=i[s],i[s]=l}Ke("FeaturePositionMap",vn);class io{constructor(t,s){this.gl=t.gl,this.location=s}}class Ll extends io{constructor(t,s){super(t,s),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class bd extends io{constructor(t,s){super(t,s),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Sd extends io{constructor(t,s){super(t,s),this.current=Ut.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const em=new Float32Array(16);function wu(i){return[Bi(255*i.r,255*i.g),Bi(255*i.b,255*i.a)]}class ji{constructor(t,s,l){this.value=t,this.uniformNames=s.map(d=>`u_${d}`),this.type=l}setUniform(t,s,l){t.set(l.constantOr(this.value))}getBinding(t,s,l){return this.type==="color"?new Sd(t,s):new Ll(t,s)}}class so{constructor(t,s){this.uniformNames=s.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=t.tlbr}setUniform(t,s,l,d){const g=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,s,l){return l.substr(0,9)==="u_pattern"?new bd(t,s):new Ll(t,s)}}class Ui{constructor(t,s,l,d){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(g=>({name:`a_${g}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,s,l,d,g){const _=this.paintVertexArray.length,x=this.expression.evaluate(new Jt(0),s,{},d,[],g);this.paintVertexArray.resize(t),this._setPaintValue(_,t,x)}updatePaintArray(t,s,l,d){const g=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(t,s,g)}_setPaintValue(t,s,l){if(this.type==="color"){const d=wu(l);for(let g=t;g<s;g++)this.paintVertexArray.emplace(g,d[0],d[1])}else{for(let d=t;d<s;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pi{constructor(t,s,l,d,g,_){this.expression=t,this.uniformNames=s.map(x=>`u_${x}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=s.map(x=>({name:`a_${x}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,s,l,d,g){const _=this.expression.evaluate(new Jt(this.zoom),s,{},d,[],g),x=this.expression.evaluate(new Jt(this.zoom+1),s,{},d,[],g),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,_,x)}updatePaintArray(t,s,l,d){const g=this.expression.evaluate({zoom:this.zoom},l,d),_=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(t,s,g,_)}_setPaintValue(t,s,l,d){if(this.type==="color"){const g=wu(l),_=wu(d);for(let x=t;x<s;x++)this.paintVertexArray.emplace(x,g[0],g[1],_[0],_[1])}else{for(let g=t;g<s;g++)this.paintVertexArray.emplace(g,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,s){const l=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,d=Fe(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,s,l){return new Ll(t,s)}}class Vi{constructor(t,s,l,d,g,_){this.expression=t,this.type=s,this.useIntegerZoom=l,this.zoom=d,this.layerId=_,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,s,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(t,s,l,d,g){this._setPaintValues(t,s,l.patterns&&l.patterns[this.layerId],g)}_setPaintValues(t,s,l,d){if(!d||!l)return;const{min:g,mid:_,max:x}=l,S=d[g],I=d[_],k=d[x];if(S&&I&&k)for(let R=t;R<s;R++)this.zoomInPaintVertexArray.emplace(R,I.tl[0],I.tl[1],I.br[0],I.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],I.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,I.tl[0],I.tl[1],I.br[0],I.br[1],k.tl[0],k.tl[1],k.br[0],k.br[1],I.pixelRatio,k.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ni.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ni.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class bu{constructor(t,s,l){this.binders={},this._buffers=[];const d=[];for(const g in t.paint._values){if(!l(g))continue;const _=t.paint.get(g);if(!(_ instanceof wr&&zo(_.property.specification)))continue;const x=V2(g,t.type),S=_.value,I=_.property.specification.type,k=_.property.useIntegerZoom,R=_.property.specification["property-type"],L=R==="cross-faded"||R==="cross-faded-data-driven";if(S.kind==="constant")this.binders[g]=L?new so(S.value,x):new ji(S.value,x,I),d.push(`/u_${g}`);else if(S.kind==="source"||L){const B=X_(g,I,"source");this.binders[g]=L?new Vi(S,I,k,s,B,t.id):new Ui(S,x,I,B),d.push(`/a_${g}`)}else{const B=X_(g,I,"composite");this.binders[g]=new pi(S,x,I,k,s,B),d.push(`/z_${g}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){const s=this.binders[t];return s instanceof Ui||s instanceof pi?s.maxValue:0}populatePaintArrays(t,s,l,d,g){for(const _ in this.binders){const x=this.binders[_];(x instanceof Ui||x instanceof pi||x instanceof Vi)&&x.populatePaintArray(t,s,l,d,g)}}setConstantPatternPositions(t,s){for(const l in this.binders){const d=this.binders[l];d instanceof so&&d.setConstantPatternPositions(t,s)}}updatePaintArrays(t,s,l,d,g){let _=!1;for(const x in t){const S=s.getPositions(x);for(const I of S){const k=l.feature(I.index);for(const R in this.binders){const L=this.binders[R];if((L instanceof Ui||L instanceof pi||L instanceof Vi)&&L.expression.isStateDependent===!0){const B=d.paint.get(R);L.expression=B.value,L.updatePaintArray(I.start,I.end,k,t[x],g),_=!0}}}}return _}defines(){const t=[];for(const s in this.binders){const l=this.binders[s];(l instanceof ji||l instanceof so)&&t.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return t}getBinderAttributes(){const t=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Ui||l instanceof pi)for(let d=0;d<l.paintVertexAttributes.length;d++)t.push(l.paintVertexAttributes[d].name);else if(l instanceof Vi)for(let d=0;d<Ni.members.length;d++)t.push(Ni.members[d].name)}return t}getBinderUniforms(){const t=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof ji||l instanceof so||l instanceof pi)for(const d of l.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,s){const l=[];for(const d in this.binders){const g=this.binders[d];if(g instanceof ji||g instanceof so||g instanceof pi){for(const _ of g.uniformNames)if(s[_]){const x=g.getBinding(t,s[_],_);l.push({name:_,property:d,binding:x})}}}return l}setUniforms(t,s,l,d){for(const{name:g,property:_,binding:x}of s)this.binders[_].setUniform(x,d,l.get(_),g)}updatePaintBuffers(t){this._buffers=[];for(const s in this.binders){const l=this.binders[s];if(t&&l instanceof Vi){const d=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof Ui||l instanceof pi)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const s in this.binders){const l=this.binders[s];(l instanceof Ui||l instanceof pi||l instanceof Vi)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const s=this.binders[t];(s instanceof Ui||s instanceof pi||s instanceof Vi)&&s.destroy()}}}class ls{constructor(t,s,l=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new bu(d,s,l);this.needsUpload=!1,this._featureMap=new vn,this._bufferOffset=0}populatePaintArrays(t,s,l,d,g,_){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(t,s,d,g,_);s.id!==void 0&&this._featureMap.add(s.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,s,l,d){for(const g of l)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,s,g,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function V2(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function X_(i,t,s){const l={color:{source:Bo,composite:H},number:{source:E,composite:Bo}},d=function(g){return{"line-pattern":{source:Vt,composite:Vt},"fill-pattern":{source:Vt,composite:Vt},"fill-extrusion-pattern":{source:Vt,composite:Vt}}[g]}(i);return d&&d[s]||l[t][s]}Ke("ConstantBinder",ji),Ke("CrossFadedConstantBinder",so),Ke("SourceExpressionBinder",Ui),Ke("CrossFadedCompositeBinder",Vi),Ke("CompositeExpressionBinder",pi),Ke("ProgramConfiguration",bu,{omit:["_buffers"]}),Ke("ProgramConfigurationSet",ls);const Dn=8192,tm=Math.pow(2,14)-1,Y_=-tm-1;function Fa(i){const t=Dn/i.extent,s=i.loadGeometry();for(let l=0;l<s.length;l++){const d=s[l];for(let g=0;g<d.length;g++){const _=d[g],x=Math.round(_.x*t),S=Math.round(_.y*t);_.x=Fe(x,Y_,tm),_.y=Fe(S,Y_,tm),(x<_.x||x>_.x+1||S<_.y||S>_.y+1)&&Mn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Oa(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?Fa(i):[]}}function Td(i,t,s,l,d){i.emplaceBack(2*t+(l+1)/2,2*s+(d+1)/2)}class nm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Je,this.indexArray=new rr,this.segments=new Qt,this.programConfigurations=new ls(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){const d=this.layers[0],g=[];let _=null,x=!1;d.type==="circle"&&(_=d.layout.get("circle-sort-key"),x=!_.isConstant());for(const{feature:S,id:I,index:k,sourceLayerIndex:R}of t){const L=this.layers[0]._featureFilter.needGeometry,B=Oa(S,L);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),B,l))continue;const j=x?_.evaluate(B,{},l):void 0,G={id:I,properties:S.properties,type:S.type,sourceLayerIndex:R,index:k,geometry:L?B.geometry:Fa(S),patterns:{},sortKey:j};g.push(G)}x&&g.sort((S,I)=>S.sortKey-I.sortKey);for(const S of g){const{geometry:I,index:k,sourceLayerIndex:R}=S,L=t[k].feature;this.addFeature(S,I,k,l),s.featureIndex.insert(L,I,k,R,this.index)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Kr),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,s,l,d){for(const g of s)for(const _ of g){const x=_.x,S=_.y;if(x<0||x>=Dn||S<0||S>=Dn)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),k=I.vertexLength;Td(this.layoutVertexArray,x,S,-1,-1),Td(this.layoutVertexArray,x,S,1,-1),Td(this.layoutVertexArray,x,S,1,1),Td(this.layoutVertexArray,x,S,-1,1),this.indexArray.emplaceBack(k,k+1,k+2),this.indexArray.emplaceBack(k,k+3,k+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},d)}}function J_(i,t){for(let s=0;s<i.length;s++)if(Fl(t,i[s]))return!0;for(let s=0;s<t.length;s++)if(Fl(i,t[s]))return!0;return!!rm(i,t)}function $2(i,t,s){return!!Fl(i,t)||!!im(t,i,s)}function Q_(i,t){if(i.length===1)return tv(t,i[0]);for(let s=0;s<t.length;s++){const l=t[s];for(let d=0;d<l.length;d++)if(Fl(i,l[d]))return!0}for(let s=0;s<i.length;s++)if(tv(t,i[s]))return!0;for(let s=0;s<t.length;s++)if(rm(i,t[s]))return!0;return!1}function q2(i,t,s){if(i.length>1){if(rm(i,t))return!0;for(let l=0;l<t.length;l++)if(im(t[l],i,s))return!0}for(let l=0;l<i.length;l++)if(im(i[l],t,s))return!0;return!1}function rm(i,t){if(i.length===0||t.length===0)return!1;for(let s=0;s<i.length-1;s++){const l=i[s],d=i[s+1];for(let g=0;g<t.length-1;g++)if(G2(l,d,t[g],t[g+1]))return!0}return!1}function G2(i,t,s,l){return Qn(i,s,l)!==Qn(t,s,l)&&Qn(i,t,s)!==Qn(i,t,l)}function im(i,t,s){const l=s*s;if(t.length===1)return i.distSqr(t[0])<l;for(let d=1;d<t.length;d++)if(ev(i,t[d-1],t[d])<l)return!0;return!1}function ev(i,t,s){const l=t.distSqr(s);if(l===0)return i.distSqr(t);const d=((i.x-t.x)*(s.x-t.x)+(i.y-t.y)*(s.y-t.y))/l;return i.distSqr(d<0?t:d>1?s:s.sub(t)._mult(d)._add(t))}function tv(i,t){let s,l,d,g=!1;for(let _=0;_<i.length;_++){s=i[_];for(let x=0,S=s.length-1;x<s.length;S=x++)l=s[x],d=s[S],l.y>t.y!=d.y>t.y&&t.x<(d.x-l.x)*(t.y-l.y)/(d.y-l.y)+l.x&&(g=!g)}return g}function Fl(i,t){let s=!1;for(let l=0,d=i.length-1;l<i.length;d=l++){const g=i[l],_=i[d];g.y>t.y!=_.y>t.y&&t.x<(_.x-g.x)*(t.y-g.y)/(_.y-g.y)+g.x&&(s=!s)}return s}function Z2(i,t,s){const l=s[0],d=s[2];if(i.x<l.x&&t.x<l.x||i.x>d.x&&t.x>d.x||i.y<l.y&&t.y<l.y||i.y>d.y&&t.y>d.y)return!1;const g=Qn(i,t,s[0]);return g!==Qn(i,t,s[1])||g!==Qn(i,t,s[2])||g!==Qn(i,t,s[3])}function Su(i,t,s){const l=t.paint.get(i).value;return l.kind==="constant"?l.value:s.programConfigurations.get(t.id).getMaxValue(i)}function Ed(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Id(i,t,s,l,d){if(!t[0]&&!t[1])return i;const g=N.convert(t)._mult(d);s==="viewport"&&g._rotate(-l);const _=[];for(let x=0;x<i.length;x++)_.push(i[x].sub(g));return _}let nv,rv;Ke("CircleBucket",nm,{omit:["layers"]});var H2={get paint(){return rv=rv||new Sn({"circle-radius":new ct(be.paint_circle["circle-radius"]),"circle-color":new ct(be.paint_circle["circle-color"]),"circle-blur":new ct(be.paint_circle["circle-blur"]),"circle-opacity":new ct(be.paint_circle["circle-opacity"]),"circle-translate":new nt(be.paint_circle["circle-translate"]),"circle-translate-anchor":new nt(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new nt(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new nt(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ct(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ct(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ct(be.paint_circle["circle-stroke-opacity"])})},get layout(){return nv=nv||new Sn({"circle-sort-key":new ct(be.layout_circle["circle-sort-key"])})}},Dr=1e-6,Ol=typeof Float32Array<"u"?Float32Array:Array;function sm(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function iv(i,t,s){var l=t[0],d=t[1],g=t[2],_=t[3],x=t[4],S=t[5],I=t[6],k=t[7],R=t[8],L=t[9],B=t[10],j=t[11],G=t[12],Q=t[13],ne=t[14],pe=t[15],oe=s[0],me=s[1],_e=s[2],Ie=s[3];return i[0]=oe*l+me*x+_e*R+Ie*G,i[1]=oe*d+me*S+_e*L+Ie*Q,i[2]=oe*g+me*I+_e*B+Ie*ne,i[3]=oe*_+me*k+_e*j+Ie*pe,i[4]=(oe=s[4])*l+(me=s[5])*x+(_e=s[6])*R+(Ie=s[7])*G,i[5]=oe*d+me*S+_e*L+Ie*Q,i[6]=oe*g+me*I+_e*B+Ie*ne,i[7]=oe*_+me*k+_e*j+Ie*pe,i[8]=(oe=s[8])*l+(me=s[9])*x+(_e=s[10])*R+(Ie=s[11])*G,i[9]=oe*d+me*S+_e*L+Ie*Q,i[10]=oe*g+me*I+_e*B+Ie*ne,i[11]=oe*_+me*k+_e*j+Ie*pe,i[12]=(oe=s[12])*l+(me=s[13])*x+(_e=s[14])*R+(Ie=s[15])*G,i[13]=oe*d+me*S+_e*L+Ie*Q,i[14]=oe*g+me*I+_e*B+Ie*ne,i[15]=oe*_+me*k+_e*j+Ie*pe,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var Tu,W2=iv;function Cd(i,t,s){var l=t[0],d=t[1],g=t[2],_=t[3];return i[0]=s[0]*l+s[4]*d+s[8]*g+s[12]*_,i[1]=s[1]*l+s[5]*d+s[9]*g+s[13]*_,i[2]=s[2]*l+s[6]*d+s[10]*g+s[14]*_,i[3]=s[3]*l+s[7]*d+s[11]*g+s[15]*_,i}Tu=new Ol(4),Ol!=Float32Array&&(Tu[0]=0,Tu[1]=0,Tu[2]=0,Tu[3]=0);class K2 extends di{constructor(t){super(t,H2)}createBucket(t){return new nm(t)}queryRadius(t){const s=t;return Su("circle-radius",this,s)+Su("circle-stroke-width",this,s)+Ed(this.paint.get("circle-translate"))}queryIntersectsFeature(t,s,l,d,g,_,x,S){const I=Id(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,x),k=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),R=this.paint.get("circle-pitch-alignment")==="map",L=R?I:function(j,G){return j.map(Q=>sv(Q,G))}(I,S),B=R?k*x:k;for(const j of d)for(const G of j){const Q=R?G:sv(G,S);let ne=B;const pe=Cd([],[G.x,G.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ne*=pe[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ne*=_.cameraToCenterDistance/pe[3]),$2(L,Q,ne))return!0}return!1}}function sv(i,t){const s=Cd([],[i.x,i.y,0,1],t);return new N(s[0]/s[3],s[1]/s[3])}class ov extends nm{}let av;Ke("HeatmapBucket",ov,{omit:["layers"]});var X2={get paint(){return av=av||new Sn({"heatmap-radius":new ct(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ct(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new nt(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new mu(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new nt(be.paint_heatmap["heatmap-opacity"])})}};function om(i,{width:t,height:s},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*s*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*s*l}`)}else d=new Uint8Array(t*s*l);return i.width=t,i.height=s,i.data=d,i}function lv(i,{width:t,height:s},l){if(t===i.width&&s===i.height)return;const d=om({},{width:t,height:s},l);am(i,d,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,s)},l),i.width=t,i.height=s,i.data=d.data}function am(i,t,s,l,d,g){if(d.width===0||d.height===0)return t;if(d.width>i.width||d.height>i.height||s.x>i.width-d.width||s.y>i.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||l.x>t.width-d.width||l.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const _=i.data,x=t.data;if(_===x)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<d.height;S++){const I=((s.y+S)*i.width+s.x)*g,k=((l.y+S)*t.width+l.x)*g;for(let R=0;R<d.width*g;R++)x[k+R]=_[I+R]}return t}class Eu{constructor(t,s){om(this,t,1,s)}resize(t){lv(this,t,1)}clone(){return new Eu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,l,d,g){am(t,s,l,d,g,1)}}class Ti{constructor(t,s){om(this,t,4,s)}resize(t){lv(this,t,4)}replace(t,s){s?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Ti({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,l,d,g){am(t,s,l,d,g,4)}}function cv(i){const t={},s=i.resolution||256,l=i.clips?i.clips.length:1,d=i.image||new Ti({width:s,height:l});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const g=(_,x,S)=>{t[i.evaluationKey]=S;const I=i.expression.evaluate(t);d.data[_+x+0]=Math.floor(255*I.r/I.a),d.data[_+x+1]=Math.floor(255*I.g/I.a),d.data[_+x+2]=Math.floor(255*I.b/I.a),d.data[_+x+3]=Math.floor(255*I.a)};if(i.clips)for(let _=0,x=0;_<l;++_,x+=4*s)for(let S=0,I=0;S<s;S++,I+=4){const k=S/(s-1),{start:R,end:L}=i.clips[_];g(x,I,R*(1-k)+L*k)}else for(let _=0,x=0;_<s;_++,x+=4)g(0,x,_/(s-1));return d}Ke("AlphaImage",Eu),Ke("RGBAImage",Ti);class Y2 extends di{createBucket(t){return new ov(t)}constructor(t){super(t,X2),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=cv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let uv;var J2={get paint(){return uv=uv||new Sn({"hillshade-illumination-direction":new nt(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new nt(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new nt(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new nt(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new nt(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new nt(be.paint_hillshade["hillshade-accent-color"])})}};class Q2 extends di{constructor(t){super(t,J2)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const eS=ln([{name:"a_pos",components:2,type:"Int16"}],4),{members:tS}=eS;var lm={exports:{}};function kd(i,t,s){s=s||2;var l,d,g,_,x,S,I,k=t&&t.length,R=k?t[0]*s:i.length,L=hv(i,0,R,s,!0),B=[];if(!L||L.next===L.prev)return B;if(k&&(L=function(G,Q,ne,pe){var oe,me,_e,Ie=[];for(oe=0,me=Q.length;oe<me;oe++)(_e=hv(G,Q[oe]*pe,oe<me-1?Q[oe+1]*pe:G.length,pe,!1))===_e.next&&(_e.steiner=!0),Ie.push(cS(_e));for(Ie.sort(oS),oe=0;oe<Ie.length;oe++)ne=aS(Ie[oe],ne);return ne}(i,t,L,s)),i.length>80*s){l=g=i[0],d=_=i[1];for(var j=s;j<R;j+=s)(x=i[j])<l&&(l=x),(S=i[j+1])<d&&(d=S),x>g&&(g=x),S>_&&(_=S);I=(I=Math.max(g-l,_-d))!==0?32767/I:0}return Iu(L,B,s,l,d,I,0),B}function hv(i,t,s,l,d){var g,_;if(d===hm(i,t,s,l)>0)for(g=t;g<s;g+=l)_=fv(g,i[g],i[g+1],_);else for(g=s-l;g>=t;g-=l)_=fv(g,i[g],i[g+1],_);return _&&Pd(_,_.next)&&(ku(_),_=_.next),_}function Ba(i,t){if(!i)return i;t||(t=i);var s,l=i;do if(s=!1,l.steiner||!Pd(l,l.next)&&En(l.prev,l,l.next)!==0)l=l.next;else{if(ku(l),(l=t=l.prev)===l.next)break;s=!0}while(s||l!==t);return t}function Iu(i,t,s,l,d,g,_){if(i){!_&&g&&function(k,R,L,B){var j=k;do j.z===0&&(j.z=cm(j.x,j.y,R,L,B)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==k);j.prevZ.nextZ=null,j.prevZ=null,function(G){var Q,ne,pe,oe,me,_e,Ie,He,Qe=1;do{for(ne=G,G=null,me=null,_e=0;ne;){for(_e++,pe=ne,Ie=0,Q=0;Q<Qe&&(Ie++,pe=pe.nextZ);Q++);for(He=Qe;Ie>0||He>0&&pe;)Ie!==0&&(He===0||!pe||ne.z<=pe.z)?(oe=ne,ne=ne.nextZ,Ie--):(oe=pe,pe=pe.nextZ,He--),me?me.nextZ=oe:G=oe,oe.prevZ=me,me=oe;ne=pe}me.nextZ=null,Qe*=2}while(_e>1)}(j)}(i,l,d,g);for(var x,S,I=i;i.prev!==i.next;)if(x=i.prev,S=i.next,g?rS(i,l,d,g):nS(i))t.push(x.i/s|0),t.push(i.i/s|0),t.push(S.i/s|0),ku(i),i=S.next,I=S.next;else if((i=S)===I){_?_===1?Iu(i=iS(Ba(i),t,s),t,s,l,d,g,2):_===2&&sS(i,t,s,l,d,g):Iu(Ba(i),t,s,l,d,g,1);break}}}function nS(i){var t=i.prev,s=i,l=i.next;if(En(t,s,l)>=0)return!1;for(var d=t.x,g=s.x,_=l.x,x=t.y,S=s.y,I=l.y,k=d<g?d<_?d:_:g<_?g:_,R=x<S?x<I?x:I:S<I?S:I,L=d>g?d>_?d:_:g>_?g:_,B=x>S?x>I?x:I:S>I?S:I,j=l.next;j!==t;){if(j.x>=k&&j.x<=L&&j.y>=R&&j.y<=B&&Bl(d,x,g,S,_,I,j.x,j.y)&&En(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function rS(i,t,s,l){var d=i.prev,g=i,_=i.next;if(En(d,g,_)>=0)return!1;for(var x=d.x,S=g.x,I=_.x,k=d.y,R=g.y,L=_.y,B=x<S?x<I?x:I:S<I?S:I,j=k<R?k<L?k:L:R<L?R:L,G=x>S?x>I?x:I:S>I?S:I,Q=k>R?k>L?k:L:R>L?R:L,ne=cm(B,j,t,s,l),pe=cm(G,Q,t,s,l),oe=i.prevZ,me=i.nextZ;oe&&oe.z>=ne&&me&&me.z<=pe;){if(oe.x>=B&&oe.x<=G&&oe.y>=j&&oe.y<=Q&&oe!==d&&oe!==_&&Bl(x,k,S,R,I,L,oe.x,oe.y)&&En(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,me.x>=B&&me.x<=G&&me.y>=j&&me.y<=Q&&me!==d&&me!==_&&Bl(x,k,S,R,I,L,me.x,me.y)&&En(me.prev,me,me.next)>=0))return!1;me=me.nextZ}for(;oe&&oe.z>=ne;){if(oe.x>=B&&oe.x<=G&&oe.y>=j&&oe.y<=Q&&oe!==d&&oe!==_&&Bl(x,k,S,R,I,L,oe.x,oe.y)&&En(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;me&&me.z<=pe;){if(me.x>=B&&me.x<=G&&me.y>=j&&me.y<=Q&&me!==d&&me!==_&&Bl(x,k,S,R,I,L,me.x,me.y)&&En(me.prev,me,me.next)>=0)return!1;me=me.nextZ}return!0}function iS(i,t,s){var l=i;do{var d=l.prev,g=l.next.next;!Pd(d,g)&&dv(d,l,l.next,g)&&Cu(d,g)&&Cu(g,d)&&(t.push(d.i/s|0),t.push(l.i/s|0),t.push(g.i/s|0),ku(l),ku(l.next),l=i=g),l=l.next}while(l!==i);return Ba(l)}function sS(i,t,s,l,d,g){var _=i;do{for(var x=_.next.next;x!==_.prev;){if(_.i!==x.i&&uS(_,x)){var S=pv(_,x);return _=Ba(_,_.next),S=Ba(S,S.next),Iu(_,t,s,l,d,g,0),void Iu(S,t,s,l,d,g,0)}x=x.next}_=_.next}while(_!==i)}function oS(i,t){return i.x-t.x}function aS(i,t){var s=function(d,g){var _,x=g,S=d.x,I=d.y,k=-1/0;do{if(I<=x.y&&I>=x.next.y&&x.next.y!==x.y){var R=x.x+(I-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(R<=S&&R>k&&(k=R,_=x.x<x.next.x?x:x.next,R===S))return _}x=x.next}while(x!==g);if(!_)return null;var L,B=_,j=_.x,G=_.y,Q=1/0;x=_;do S>=x.x&&x.x>=j&&S!==x.x&&Bl(I<G?S:k,I,j,G,I<G?k:S,I,x.x,x.y)&&(L=Math.abs(I-x.y)/(S-x.x),Cu(x,d)&&(L<Q||L===Q&&(x.x>_.x||x.x===_.x&&lS(_,x)))&&(_=x,Q=L)),x=x.next;while(x!==B);return _}(i,t);if(!s)return t;var l=pv(s,i);return Ba(l,l.next),Ba(s,s.next)}function lS(i,t){return En(i.prev,i,t.prev)<0&&En(t.next,i,i.next)<0}function cm(i,t,s,l,d){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function cS(i){var t=i,s=i;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==i);return s}function Bl(i,t,s,l,d,g,_,x){return(d-_)*(t-x)>=(i-_)*(g-x)&&(i-_)*(l-x)>=(s-_)*(t-x)&&(s-_)*(g-x)>=(d-_)*(l-x)}function uS(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(s,l){var d=s;do{if(d.i!==s.i&&d.next.i!==s.i&&d.i!==l.i&&d.next.i!==l.i&&dv(d,d.next,s,l))return!0;d=d.next}while(d!==s);return!1}(i,t)&&(Cu(i,t)&&Cu(t,i)&&function(s,l){var d=s,g=!1,_=(s.x+l.x)/2,x=(s.y+l.y)/2;do d.y>x!=d.next.y>x&&d.next.y!==d.y&&_<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(g=!g),d=d.next;while(d!==s);return g}(i,t)&&(En(i.prev,i,t.prev)||En(i,t.prev,t))||Pd(i,t)&&En(i.prev,i,i.next)>0&&En(t.prev,t,t.next)>0)}function En(i,t,s){return(t.y-i.y)*(s.x-t.x)-(t.x-i.x)*(s.y-t.y)}function Pd(i,t){return i.x===t.x&&i.y===t.y}function dv(i,t,s,l){var d=Md(En(i,t,s)),g=Md(En(i,t,l)),_=Md(En(s,l,i)),x=Md(En(s,l,t));return d!==g&&_!==x||!(d!==0||!Ad(i,s,t))||!(g!==0||!Ad(i,l,t))||!(_!==0||!Ad(s,i,l))||!(x!==0||!Ad(s,t,l))}function Ad(i,t,s){return t.x<=Math.max(i.x,s.x)&&t.x>=Math.min(i.x,s.x)&&t.y<=Math.max(i.y,s.y)&&t.y>=Math.min(i.y,s.y)}function Md(i){return i>0?1:i<0?-1:0}function Cu(i,t){return En(i.prev,i,i.next)<0?En(i,t,i.next)>=0&&En(i,i.prev,t)>=0:En(i,t,i.prev)<0||En(i,i.next,t)<0}function pv(i,t){var s=new um(i.i,i.x,i.y),l=new um(t.i,t.x,t.y),d=i.next,g=t.prev;return i.next=t,t.prev=i,s.next=d,d.prev=s,l.next=s,s.prev=l,g.next=l,l.prev=g,l}function fv(i,t,s,l){var d=new um(i,t,s);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function ku(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function um(i,t,s){this.i=i,this.x=t,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hm(i,t,s,l){for(var d=0,g=t,_=s-l;g<s;g+=l)d+=(i[_]-i[g])*(i[g+1]+i[_+1]),_=g;return d}lm.exports=kd,lm.exports.default=kd,kd.deviation=function(i,t,s,l){var d=t&&t.length,g=Math.abs(hm(i,0,d?t[0]*s:i.length,s));if(d)for(var _=0,x=t.length;_<x;_++)g-=Math.abs(hm(i,t[_]*s,_<x-1?t[_+1]*s:i.length,s));var S=0;for(_=0;_<l.length;_+=3){var I=l[_]*s,k=l[_+1]*s,R=l[_+2]*s;S+=Math.abs((i[I]-i[R])*(i[k+1]-i[I+1])-(i[I]-i[k])*(i[R+1]-i[I+1]))}return g===0&&S===0?0:Math.abs((S-g)/g)},kd.flatten=function(i){for(var t=i[0][0].length,s={vertices:[],holes:[],dimensions:t},l=0,d=0;d<i.length;d++){for(var g=0;g<i[d].length;g++)for(var _=0;_<t;_++)s.vertices.push(i[d][g][_]);d>0&&s.holes.push(l+=i[d-1].length)}return s};var mv=P(lm.exports);function hS(i,t,s,l,d){gv(i,t,s||0,l||i.length-1,d||dS)}function gv(i,t,s,l,d){for(;l>s;){if(l-s>600){var g=l-s+1,_=t-s+1,x=Math.log(g),S=.5*Math.exp(2*x/3),I=.5*Math.sqrt(x*S*(g-S)/g)*(_-g/2<0?-1:1);gv(i,t,Math.max(s,Math.floor(t-_*S/g+I)),Math.min(l,Math.floor(t+(g-_)*S/g+I)),d)}var k=i[t],R=s,L=l;for(Pu(i,s,t),d(i[l],k)>0&&Pu(i,s,l);R<L;){for(Pu(i,R,L),R++,L--;d(i[R],k)<0;)R++;for(;d(i[L],k)>0;)L--}d(i[s],k)===0?Pu(i,s,L):Pu(i,++L,l),L<=t&&(s=L+1),t<=L&&(l=L-1)}}function Pu(i,t,s){var l=i[t];i[t]=i[s],i[s]=l}function dS(i,t){return i<t?-1:i>t?1:0}function dm(i,t){const s=i.length;if(s<=1)return[i];const l=[];let d,g;for(let _=0;_<s;_++){const x=er(i[_]);x!==0&&(i[_].area=Math.abs(x),g===void 0&&(g=x<0),g===x<0?(d&&l.push(d),d=[i[_]]):d.push(i[_]))}if(d&&l.push(d),t>1)for(let _=0;_<l.length;_++)l[_].length<=t||(hS(l[_],t,1,l[_].length-1,pS),l[_]=l[_].slice(0,t));return l}function pS(i,t){return t.area-i.area}function pm(i,t,s){const l=s.patternDependencies;let d=!1;for(const g of t){const _=g.paint.get(`${i}-pattern`);_.isConstant()||(d=!0);const x=_.constantOr(null);x&&(d=!0,l[x.to]=!0,l[x.from]=!0)}return d}function fm(i,t,s,l,d){const g=d.patternDependencies;for(const _ of t){const x=_.paint.get(`${i}-pattern`).value;if(x.kind!=="constant"){let S=x.evaluate({zoom:l-1},s,{},d.availableImages),I=x.evaluate({zoom:l},s,{},d.availableImages),k=x.evaluate({zoom:l+1},s,{},d.availableImages);S=S&&S.name?S.name:S,I=I&&I.name?I.name:I,k=k&&k.name?k.name:k,g[S]=!0,g[I]=!0,g[k]=!0,s.patterns[_.id]={min:S,mid:I,max:k}}}return s}class mm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bt,this.indexArray=new rr,this.indexArray2=new Un,this.programConfigurations=new ls(t.layers,t.zoom),this.segments=new Qt,this.segments2=new Qt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){this.hasPattern=pm("fill",this.layers,s);const d=this.layers[0].layout.get("fill-sort-key"),g=!d.isConstant(),_=[];for(const{feature:x,id:S,index:I,sourceLayerIndex:k}of t){const R=this.layers[0]._featureFilter.needGeometry,L=Oa(x,R);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),L,l))continue;const B=g?d.evaluate(L,{},l,s.availableImages):void 0,j={id:S,properties:x.properties,type:x.type,sourceLayerIndex:k,index:I,geometry:R?L.geometry:Fa(x),patterns:{},sortKey:B};_.push(j)}g&&_.sort((x,S)=>x.sortKey-S.sortKey);for(const x of _){const{geometry:S,index:I,sourceLayerIndex:k}=x;if(this.hasPattern){const R=fm("fill",this.layers,x,this.zoom,s);this.patternFeatures.push(R)}else this.addFeature(x,S,I,l,{});s.featureIndex.insert(t[I].feature,S,I,k,this.index)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}addFeatures(t,s,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tS),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,s,l,d,g){for(const _ of dm(s,500)){let x=0;for(const B of _)x+=B.length;const S=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),I=S.vertexLength,k=[],R=[];for(const B of _){if(B.length===0)continue;B!==_[0]&&R.push(k.length/2);const j=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),G=j.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(G+B.length-1,G),k.push(B[0].x),k.push(B[0].y);for(let Q=1;Q<B.length;Q++)this.layoutVertexArray.emplaceBack(B[Q].x,B[Q].y),this.indexArray2.emplaceBack(G+Q-1,G+Q),k.push(B[Q].x),k.push(B[Q].y);j.vertexLength+=B.length,j.primitiveLength+=B.length}const L=mv(k,R);for(let B=0;B<L.length;B+=3)this.indexArray.emplaceBack(I+L[B],I+L[B+1],I+L[B+2]);S.vertexLength+=x,S.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,g,d)}}let yv,_v;Ke("FillBucket",mm,{omit:["layers","patternFeatures"]});var fS={get paint(){return _v=_v||new Sn({"fill-antialias":new nt(be.paint_fill["fill-antialias"]),"fill-opacity":new ct(be.paint_fill["fill-opacity"]),"fill-color":new ct(be.paint_fill["fill-color"]),"fill-outline-color":new ct(be.paint_fill["fill-outline-color"]),"fill-translate":new nt(be.paint_fill["fill-translate"]),"fill-translate-anchor":new nt(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ra(be.paint_fill["fill-pattern"])})},get layout(){return yv=yv||new Sn({"fill-sort-key":new ct(be.layout_fill["fill-sort-key"])})}};class mS extends di{constructor(t){super(t,fS)}recalculate(t,s){super.recalculate(t,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new mm(t)}queryRadius(){return Ed(this.paint.get("fill-translate"))}queryIntersectsFeature(t,s,l,d,g,_,x){return Q_(Id(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,x),d)}isTileClipped(){return!0}}const gS=ln([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),yS=ln([{name:"a_centroid",components:2,type:"Int16"}],4),{members:_S}=gS;var jo={},vS=V,vv=Nl;function Nl(i,t,s,l,d){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=d,i.readFields(xS,this,t)}function xS(i,t,s){i==1?t.id=s.readVarint():i==2?function(l,d){for(var g=l.readVarint()+l.pos;l.pos<g;){var _=d._keys[l.readVarint()],x=d._values[l.readVarint()];d.properties[_]=x}}(s,t):i==3?t.type=s.readVarint():i==4&&(t._geometry=s.pos)}function wS(i){for(var t,s,l=0,d=0,g=i.length,_=g-1;d<g;_=d++)l+=((s=i[_]).x-(t=i[d]).x)*(t.y+s.y);return l}Nl.types=["Unknown","Point","LineString","Polygon"],Nl.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,s=i.readVarint()+i.pos,l=1,d=0,g=0,_=0,x=[];i.pos<s;){if(d<=0){var S=i.readVarint();l=7&S,d=S>>3}if(d--,l===1||l===2)g+=i.readSVarint(),_+=i.readSVarint(),l===1&&(t&&x.push(t),t=[]),t.push(new vS(g,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&x.push(t),x},Nl.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,s=1,l=0,d=0,g=0,_=1/0,x=-1/0,S=1/0,I=-1/0;i.pos<t;){if(l<=0){var k=i.readVarint();s=7&k,l=k>>3}if(l--,s===1||s===2)(d+=i.readSVarint())<_&&(_=d),d>x&&(x=d),(g+=i.readSVarint())<S&&(S=g),g>I&&(I=g);else if(s!==7)throw new Error("unknown command "+s)}return[_,S,x,I]},Nl.prototype.toGeoJSON=function(i,t,s){var l,d,g=this.extent*Math.pow(2,s),_=this.extent*i,x=this.extent*t,S=this.loadGeometry(),I=Nl.types[this.type];function k(B){for(var j=0;j<B.length;j++){var G=B[j];B[j]=[360*(G.x+_)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+x)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(l=0;l<S.length;l++)R[l]=S[l][0];k(S=R);break;case 2:for(l=0;l<S.length;l++)k(S[l]);break;case 3:for(S=function(B){var j=B.length;if(j<=1)return[B];for(var G,Q,ne=[],pe=0;pe<j;pe++){var oe=wS(B[pe]);oe!==0&&(Q===void 0&&(Q=oe<0),Q===oe<0?(G&&ne.push(G),G=[B[pe]]):G.push(B[pe]))}return G&&ne.push(G),ne}(S),l=0;l<S.length;l++)for(d=0;d<S[l].length;d++)k(S[l][d])}S.length===1?S=S[0]:I="Multi"+I;var L={type:"Feature",geometry:{type:I,coordinates:S},properties:this.properties};return"id"in this&&(L.id=this.id),L};var bS=vv,xv=wv;function wv(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(SS,this,t),this.length=this._features.length}function SS(i,t,s){i===15?t.version=s.readVarint():i===1?t.name=s.readString():i===5?t.extent=s.readVarint():i===2?t._features.push(s.pos):i===3?t._keys.push(s.readString()):i===4&&t._values.push(function(l){for(var d=null,g=l.readVarint()+l.pos;l.pos<g;){var _=l.readVarint()>>3;d=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return d}(s))}wv.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new bS(this._pbf,t,this.extent,this._keys,this._values)};var TS=xv;function ES(i,t,s){if(i===3){var l=new TS(s,s.readVarint()+s.pos);l.length&&(t[l.name]=l)}}jo.VectorTile=function(i,t){this.layers=i.readFields(ES,{},t)},jo.VectorTileFeature=vv,jo.VectorTileLayer=xv;const IS=jo.VectorTileFeature.types,gm=Math.pow(2,13);function Au(i,t,s,l,d,g,_,x){i.emplaceBack(t,s,2*Math.floor(l*gm)+_,d*gm*2,g*gm*2,Math.round(x))}class ym{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ve,this.centroidVertexArray=new Le,this.indexArray=new rr,this.programConfigurations=new ls(t.layers,t.zoom),this.segments=new Qt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){this.features=[],this.hasPattern=pm("fill-extrusion",this.layers,s);for(const{feature:d,id:g,index:_,sourceLayerIndex:x}of t){const S=this.layers[0]._featureFilter.needGeometry,I=Oa(d,S);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),I,l))continue;const k={id:g,sourceLayerIndex:x,index:_,geometry:S?I.geometry:Fa(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(fm("fill-extrusion",this.layers,k,this.zoom,s)):this.addFeature(k,k.geometry,_,l,{}),s.featureIndex.insert(d,k.geometry,_,x,this.index,!0)}}addFeatures(t,s,l){for(const d of this.features){const{geometry:g}=d;this.addFeature(d,g,d.index,s,l)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_S),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,yS.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,s,l,d,g){const _={x:0,y:0,vertexCount:0};for(const x of dm(s,500)){let S=0;for(const j of x)S+=j.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const j of x){if(j.length===0||kS(j))continue;let G=0;for(let Q=0;Q<j.length;Q++){const ne=j[Q];if(Q>=1){const pe=j[Q-1];if(!CS(ne,pe)){I.vertexLength+4>Qt.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const oe=ne.sub(pe)._perp()._unit(),me=pe.dist(ne);G+me>32768&&(G=0),Au(this.layoutVertexArray,ne.x,ne.y,oe.x,oe.y,0,0,G),Au(this.layoutVertexArray,ne.x,ne.y,oe.x,oe.y,0,1,G),_.x+=2*ne.x,_.y+=2*ne.y,_.vertexCount+=2,G+=me,Au(this.layoutVertexArray,pe.x,pe.y,oe.x,oe.y,0,0,G),Au(this.layoutVertexArray,pe.x,pe.y,oe.x,oe.y,0,1,G),_.x+=2*pe.x,_.y+=2*pe.y,_.vertexCount+=2;const _e=I.vertexLength;this.indexArray.emplaceBack(_e,_e+2,_e+1),this.indexArray.emplaceBack(_e+1,_e+2,_e+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+S>Qt.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),IS[t.type]!=="Polygon")continue;const k=[],R=[],L=I.vertexLength;for(const j of x)if(j.length!==0){j!==x[0]&&R.push(k.length/2);for(let G=0;G<j.length;G++){const Q=j[G];Au(this.layoutVertexArray,Q.x,Q.y,0,0,1,1,0),_.x+=Q.x,_.y+=Q.y,_.vertexCount+=1,k.push(Q.x),k.push(Q.y)}}const B=mv(k,R);for(let j=0;j<B.length;j+=3)this.indexArray.emplaceBack(L+B[j],L+B[j+2],L+B[j+1]);I.primitiveLength+=B.length/3,I.vertexLength+=S}for(let x=0;x<_.vertexCount;x++)this.centroidVertexArray.emplaceBack(Math.floor(_.x/_.vertexCount),Math.floor(_.y/_.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,g,d)}}function CS(i,t){return i.x===t.x&&(i.x<0||i.x>Dn)||i.y===t.y&&(i.y<0||i.y>Dn)}function kS(i){return i.every(t=>t.x<0)||i.every(t=>t.x>Dn)||i.every(t=>t.y<0)||i.every(t=>t.y>Dn)}let bv;Ke("FillExtrusionBucket",ym,{omit:["layers","features"]});var PS={get paint(){return bv=bv||new Sn({"fill-extrusion-opacity":new nt(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ct(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new nt(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new nt(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ra(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ct(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ct(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new nt(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class AS extends di{constructor(t){super(t,PS)}createBucket(t){return new ym(t)}queryRadius(){return Ed(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,s,l,d,g,_,x,S){const I=Id(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,x),k=this.paint.get("fill-extrusion-height").evaluate(s,l),R=this.paint.get("fill-extrusion-base").evaluate(s,l),L=function(j,G,Q,ne){const pe=[];for(const oe of j){const me=[oe.x,oe.y,0,1];Cd(me,me,G),pe.push(new N(me[0]/me[3],me[1]/me[3]))}return pe}(I,S),B=function(j,G,Q,ne){const pe=[],oe=[],me=ne[8]*G,_e=ne[9]*G,Ie=ne[10]*G,He=ne[11]*G,Qe=ne[8]*Q,Ge=ne[9]*Q,$e=ne[10]*Q,Oe=ne[11]*Q;for(const Xe of j){const je=[],Re=[];for(const ot of Xe){const tt=ot.x,xt=ot.y,en=ne[0]*tt+ne[4]*xt+ne[12],rn=ne[1]*tt+ne[5]*xt+ne[13],qn=ne[2]*tt+ne[6]*xt+ne[14],fi=ne[3]*tt+ne[7]*xt+ne[15],Lr=qn+Ie,Ln=fi+He,sr=en+Qe,mr=rn+Ge,Fr=qn+$e,Or=fi+Oe,Gn=new N((en+me)/Ln,(rn+_e)/Ln);Gn.z=Lr/Ln,je.push(Gn);const Zn=new N(sr/Or,mr/Or);Zn.z=Fr/Or,Re.push(Zn)}pe.push(je),oe.push(Re)}return[pe,oe]}(d,R,k,S);return function(j,G,Q){let ne=1/0;Q_(Q,G)&&(ne=Sv(Q,G[0]));for(let pe=0;pe<G.length;pe++){const oe=G[pe],me=j[pe];for(let _e=0;_e<oe.length-1;_e++){const Ie=oe[_e],He=[Ie,oe[_e+1],me[_e+1],me[_e],Ie];J_(Q,He)&&(ne=Math.min(ne,Sv(Q,He)))}}return ne!==1/0&&ne}(B[0],B[1],L)}}function Mu(i,t){return i.x*t.x+i.y*t.y}function Sv(i,t){if(i.length===1){let s=0;const l=t[s++];let d;for(;!d||l.equals(d);)if(d=t[s++],!d)return 1/0;for(;s<t.length;s++){const g=t[s],_=i[0],x=d.sub(l),S=g.sub(l),I=_.sub(l),k=Mu(x,x),R=Mu(x,S),L=Mu(S,S),B=Mu(I,x),j=Mu(I,S),G=k*L-R*R,Q=(L*B-R*j)/G,ne=(k*j-R*B)/G,pe=l.z*(1-Q-ne)+d.z*Q+g.z*ne;if(isFinite(pe))return pe}return 1/0}{let s=1/0;for(const l of t)s=Math.min(s,l.z);return s}}const MS=ln([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:zS}=MS,RS=ln([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:DS}=RS,LS=jo.VectorTileFeature.types,FS=Math.cos(Math.PI/180*37.5),Tv=Math.pow(2,14)/.5;class _m{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new ut,this.layoutVertexArray2=new et,this.indexArray=new rr,this.programConfigurations=new ls(t.layers,t.zoom),this.segments=new Qt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,l){this.hasPattern=pm("line",this.layers,s);const d=this.layers[0].layout.get("line-sort-key"),g=!d.isConstant(),_=[];for(const{feature:x,id:S,index:I,sourceLayerIndex:k}of t){const R=this.layers[0]._featureFilter.needGeometry,L=Oa(x,R);if(!this.layers[0]._featureFilter.filter(new Jt(this.zoom),L,l))continue;const B=g?d.evaluate(L,{},l):void 0,j={id:S,properties:x.properties,type:x.type,sourceLayerIndex:k,index:I,geometry:R?L.geometry:Fa(x),patterns:{},sortKey:B};_.push(j)}g&&_.sort((x,S)=>x.sortKey-S.sortKey);for(const x of _){const{geometry:S,index:I,sourceLayerIndex:k}=x;if(this.hasPattern){const R=fm("line",this.layers,x,this.zoom,s);this.patternFeatures.push(R)}else this.addFeature(x,S,I,l,{});s.featureIndex.insert(t[I].feature,S,I,k,this.index)}}update(t,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,l)}addFeatures(t,s,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,DS)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,zS),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,s,l,d,g){const _=this.layers[0].layout,x=_.get("line-join").evaluate(t,{}),S=_.get("line-cap"),I=_.get("line-miter-limit"),k=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const R of s)this.addLine(R,t,x,S,I,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,g,d)}addLine(t,s,l,d,g,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ne=0;ne<t.length-1;ne++)this.totalDistance+=t[ne].dist(t[ne+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=LS[s.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let I=0;for(;I<S-1&&t[I].equals(t[I+1]);)I++;if(S<(x?3:2))return;l==="bevel"&&(g=1.05);const k=this.overscaling<=16?15*Dn/(512*this.overscaling):0,R=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let L,B,j,G,Q;this.e1=this.e2=-1,x&&(L=t[S-2],Q=t[I].sub(L)._unit()._perp());for(let ne=I;ne<S;ne++){if(j=ne===S-1?x?t[I+1]:void 0:t[ne+1],j&&t[ne].equals(j))continue;Q&&(G=Q),L&&(B=L),L=t[ne],Q=j?j.sub(L)._unit()._perp():G,G=G||Q;let pe=G.add(Q);pe.x===0&&pe.y===0||pe._unit();const oe=G.x*Q.x+G.y*Q.y,me=pe.x*Q.x+pe.y*Q.y,_e=me!==0?1/me:1/0,Ie=2*Math.sqrt(2-2*me),He=me<FS&&B&&j,Qe=G.x*Q.y-G.y*Q.x>0;if(He&&ne>I){const Oe=L.dist(B);if(Oe>2*k){const Xe=L.sub(L.sub(B)._mult(k/Oe)._round());this.updateDistance(B,Xe),this.addCurrentVertex(Xe,G,0,0,R),B=Xe}}const Ge=B&&j;let $e=Ge?l:x?"butt":d;if(Ge&&$e==="round"&&(_e<_?$e="miter":_e<=2&&($e="fakeround")),$e==="miter"&&_e>g&&($e="bevel"),$e==="bevel"&&(_e>2&&($e="flipbevel"),_e<g&&($e="miter")),B&&this.updateDistance(B,L),$e==="miter")pe._mult(_e),this.addCurrentVertex(L,pe,0,0,R);else if($e==="flipbevel"){if(_e>100)pe=Q.mult(-1);else{const Oe=_e*G.add(Q).mag()/G.sub(Q).mag();pe._perp()._mult(Oe*(Qe?-1:1))}this.addCurrentVertex(L,pe,0,0,R),this.addCurrentVertex(L,pe.mult(-1),0,0,R)}else if($e==="bevel"||$e==="fakeround"){const Oe=-Math.sqrt(_e*_e-1),Xe=Qe?Oe:0,je=Qe?0:Oe;if(B&&this.addCurrentVertex(L,G,Xe,je,R),$e==="fakeround"){const Re=Math.round(180*Ie/Math.PI/20);for(let ot=1;ot<Re;ot++){let tt=ot/Re;if(tt!==.5){const en=tt-.5;tt+=tt*en*(tt-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*en*en+(.848013+oe*(.215638*oe-1.06021)))}const xt=Q.sub(G)._mult(tt)._add(G)._unit()._mult(Qe?-1:1);this.addHalfVertex(L,xt.x,xt.y,!1,Qe,0,R)}}j&&this.addCurrentVertex(L,Q,-Xe,-je,R)}else if($e==="butt")this.addCurrentVertex(L,pe,0,0,R);else if($e==="square"){const Oe=B?1:-1;this.addCurrentVertex(L,pe,Oe,Oe,R)}else $e==="round"&&(B&&(this.addCurrentVertex(L,G,0,0,R),this.addCurrentVertex(L,G,1,1,R,!0)),j&&(this.addCurrentVertex(L,Q,-1,-1,R,!0),this.addCurrentVertex(L,Q,0,0,R)));if(He&&ne<S-1){const Oe=L.dist(j);if(Oe>2*k){const Xe=L.add(j.sub(L)._mult(k/Oe)._round());this.updateDistance(L,Xe),this.addCurrentVertex(Xe,Q,0,0,R),L=Xe}}}}addCurrentVertex(t,s,l,d,g,_=!1){const x=s.y*d-s.x,S=-s.y-s.x*d;this.addHalfVertex(t,s.x+s.y*l,s.y-s.x*l,_,!1,l,g),this.addHalfVertex(t,x,S,_,!0,-d,g),this.distance>Tv/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,s,l,d,g,_))}addHalfVertex({x:t,y:s},l,d,g,_,x,S){const I=.5*(this.lineClips?this.scaledDistance*(Tv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(s<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(x===0?0:x<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const k=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),S.primitiveLength++),_?this.e2=k:this.e1=k}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,s){this.distance+=t.dist(s),this.updateScaledDistance()}}let Ev,Iv;Ke("LineBucket",_m,{omit:["layers","patternFeatures"]});var Cv={get paint(){return Iv=Iv||new Sn({"line-opacity":new ct(be.paint_line["line-opacity"]),"line-color":new ct(be.paint_line["line-color"]),"line-translate":new nt(be.paint_line["line-translate"]),"line-translate-anchor":new nt(be.paint_line["line-translate-anchor"]),"line-width":new ct(be.paint_line["line-width"]),"line-gap-width":new ct(be.paint_line["line-gap-width"]),"line-offset":new ct(be.paint_line["line-offset"]),"line-blur":new ct(be.paint_line["line-blur"]),"line-dasharray":new fu(be.paint_line["line-dasharray"]),"line-pattern":new Ra(be.paint_line["line-pattern"]),"line-gradient":new mu(be.paint_line["line-gradient"])})},get layout(){return Ev=Ev||new Sn({"line-cap":new nt(be.layout_line["line-cap"]),"line-join":new ct(be.layout_line["line-join"]),"line-miter-limit":new nt(be.layout_line["line-miter-limit"]),"line-round-limit":new nt(be.layout_line["line-round-limit"]),"line-sort-key":new ct(be.layout_line["line-sort-key"])})}};class OS extends ct{possiblyEvaluate(t,s){return s=new Jt(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(t,s)}evaluate(t,s,l,d){return s=qe({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(t,s,l,d)}}let zd;class BS extends di{constructor(t){super(t,Cv),this.gradientVersion=0,zd||(zd=new OS(Cv.paint.properties["line-width"].specification),zd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof Cs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,s){super.recalculate(t,s),this.paint._values["line-floorwidth"]=zd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new _m(t)}queryRadius(t){const s=t,l=kv(Su("line-width",this,s),Su("line-gap-width",this,s)),d=Su("line-offset",this,s);return l/2+Math.abs(d)+Ed(this.paint.get("line-translate"))}queryIntersectsFeature(t,s,l,d,g,_,x){const S=Id(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,x),I=x/2*kv(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),k=this.paint.get("line-offset").evaluate(s,l);return k&&(d=function(R,L){const B=[];for(let j=0;j<R.length;j++){const G=R[j],Q=[];for(let ne=0;ne<G.length;ne++){const pe=G[ne-1],oe=G[ne],me=G[ne+1],_e=ne===0?new N(0,0):oe.sub(pe)._unit()._perp(),Ie=ne===G.length-1?new N(0,0):me.sub(oe)._unit()._perp(),He=_e._add(Ie)._unit(),Qe=He.x*Ie.x+He.y*Ie.y;Qe!==0&&He._mult(1/Qe),Q.push(He._mult(L)._add(oe))}B.push(Q)}return B}(d,k*x)),function(R,L,B){for(let j=0;j<L.length;j++){const G=L[j];if(R.length>=3){for(let Q=0;Q<G.length;Q++)if(Fl(R,G[Q]))return!0}if(q2(R,G,B))return!0}return!1}(S,d,I)}isTileClipped(){return!0}}function kv(i,t){return t>0?t+2*i:i}const NS=ln([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),jS=ln([{name:"a_projected_pos",components:3,type:"Float32"}],4);ln([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const US=ln([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ln([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Pv=ln([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),VS=ln([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function $S(i,t,s){return i.sections.forEach(l=>{l.text=function(d,g,_){const x=g.layout.get("text-transform").evaluate(_,{});return x==="uppercase"?d=d.toLocaleUpperCase():x==="lowercase"&&(d=d.toLocaleLowerCase()),Wr.applyArabicShaping&&(d=Wr.applyArabicShaping(d)),d}(l.text,t,s)}),i}ln([{name:"triangle",components:3,type:"Uint16"}]),ln([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ln([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ln([{type:"Float32",name:"offsetX"}]),ln([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ln([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const zu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var $n=24,Av=qt,Mv=function(i,t,s,l,d){var g,_,x=8*d-l-1,S=(1<<x)-1,I=S>>1,k=-7,R=s?d-1:0,L=s?-1:1,B=i[t+R];for(R+=L,g=B&(1<<-k)-1,B>>=-k,k+=x;k>0;g=256*g+i[t+R],R+=L,k-=8);for(_=g&(1<<-k)-1,g>>=-k,k+=l;k>0;_=256*_+i[t+R],R+=L,k-=8);if(g===0)g=1-I;else{if(g===S)return _?NaN:1/0*(B?-1:1);_+=Math.pow(2,l),g-=I}return(B?-1:1)*_*Math.pow(2,g-l)},zv=function(i,t,s,l,d,g){var _,x,S,I=8*g-d-1,k=(1<<I)-1,R=k>>1,L=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=l?0:g-1,j=l?1:-1,G=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,_=k):(_=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-_))<1&&(_--,S*=2),(t+=_+R>=1?L/S:L*Math.pow(2,1-R))*S>=2&&(_++,S/=2),_+R>=k?(x=0,_=k):_+R>=1?(x=(t*S-1)*Math.pow(2,d),_+=R):(x=t*Math.pow(2,R-1)*Math.pow(2,d),_=0));d>=8;i[s+B]=255&x,B+=j,x/=256,d-=8);for(_=_<<d|x,I+=d;I>0;i[s+B]=255&_,B+=j,_/=256,I-=8);i[s+B-j]|=128*G};function qt(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}qt.Varint=0,qt.Fixed64=1,qt.Bytes=2,qt.Fixed32=5;var vm=4294967296,Rv=1/vm,Dv=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function oo(i){return i.type===qt.Bytes?i.readVarint()+i.pos:i.pos+1}function jl(i,t,s){return s?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function Lv(i,t,s){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));s.realloc(l);for(var d=s.pos-1;d>=i;d--)s.buf[d+l]=s.buf[d]}function qS(i,t){for(var s=0;s<i.length;s++)t.writeVarint(i[s])}function GS(i,t){for(var s=0;s<i.length;s++)t.writeSVarint(i[s])}function ZS(i,t){for(var s=0;s<i.length;s++)t.writeFloat(i[s])}function HS(i,t){for(var s=0;s<i.length;s++)t.writeDouble(i[s])}function WS(i,t){for(var s=0;s<i.length;s++)t.writeBoolean(i[s])}function KS(i,t){for(var s=0;s<i.length;s++)t.writeFixed32(i[s])}function XS(i,t){for(var s=0;s<i.length;s++)t.writeSFixed32(i[s])}function YS(i,t){for(var s=0;s<i.length;s++)t.writeFixed64(i[s])}function JS(i,t){for(var s=0;s<i.length;s++)t.writeSFixed64(i[s])}function Rd(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function Ul(i,t,s){i[s]=t,i[s+1]=t>>>8,i[s+2]=t>>>16,i[s+3]=t>>>24}function Fv(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}qt.prototype={destroy:function(){this.buf=null},readFields:function(i,t,s){for(s=s||this.length;this.pos<s;){var l=this.readVarint(),d=l>>3,g=this.pos;this.type=7&l,i(d,t,this),this.pos===g&&this.skip(l)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=Rd(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Fv(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Rd(this.buf,this.pos)+Rd(this.buf,this.pos+4)*vm;return this.pos+=8,i},readSFixed64:function(){var i=Rd(this.buf,this.pos)+Fv(this.buf,this.pos+4)*vm;return this.pos+=8,i},readFloat:function(){var i=Mv(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Mv(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,s,l=this.buf;return t=127&(s=l[this.pos++]),s<128?t:(t|=(127&(s=l[this.pos++]))<<7,s<128?t:(t|=(127&(s=l[this.pos++]))<<14,s<128?t:(t|=(127&(s=l[this.pos++]))<<21,s<128?t:function(d,g,_){var x,S,I=_.buf;if(x=(112&(S=I[_.pos++]))>>4,S<128||(x|=(127&(S=I[_.pos++]))<<3,S<128)||(x|=(127&(S=I[_.pos++]))<<10,S<128)||(x|=(127&(S=I[_.pos++]))<<17,S<128)||(x|=(127&(S=I[_.pos++]))<<24,S<128)||(x|=(1&(S=I[_.pos++]))<<31,S<128))return jl(d,x,g);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(s=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&Dv?function(s,l,d){return Dv.decode(s.subarray(l,d))}(this.buf,t,i):function(s,l,d){for(var g="",_=l;_<d;){var x,S,I,k=s[_],R=null,L=k>239?4:k>223?3:k>191?2:1;if(_+L>d)break;L===1?k<128&&(R=k):L===2?(192&(x=s[_+1]))==128&&(R=(31&k)<<6|63&x)<=127&&(R=null):L===3?(S=s[_+2],(192&(x=s[_+1]))==128&&(192&S)==128&&((R=(15&k)<<12|(63&x)<<6|63&S)<=2047||R>=55296&&R<=57343)&&(R=null)):L===4&&(S=s[_+2],I=s[_+3],(192&(x=s[_+1]))==128&&(192&S)==128&&(192&I)==128&&((R=(15&k)<<18|(63&x)<<12|(63&S)<<6|63&I)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,L=1):R>65535&&(R-=65536,g+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),g+=String.fromCharCode(R),_+=L}return g}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==qt.Bytes)return i.push(this.readVarint(t));var s=oo(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==qt.Bytes)return i.push(this.readSVarint());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==qt.Bytes)return i.push(this.readBoolean());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==qt.Bytes)return i.push(this.readFloat());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==qt.Bytes)return i.push(this.readDouble());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==qt.Bytes)return i.push(this.readFixed32());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==qt.Bytes)return i.push(this.readSFixed32());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==qt.Bytes)return i.push(this.readFixed64());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==qt.Bytes)return i.push(this.readSFixed64());var t=oo(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===qt.Varint)for(;this.buf[this.pos++]>127;);else if(t===qt.Bytes)this.pos=this.readVarint()+this.pos;else if(t===qt.Fixed32)this.pos+=4;else{if(t!==qt.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var s=new Uint8Array(t);s.set(this.buf),this.buf=s,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Ul(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Ul(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Ul(this.buf,-1&i,this.pos),Ul(this.buf,Math.floor(i*Rv),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Ul(this.buf,-1&i,this.pos),Ul(this.buf,Math.floor(i*Rv),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,s){var l,d;if(t>=0?(l=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,d=d+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(g,_,x){x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,x.buf[x.pos]=127&(g>>>=7)}(l,0,s),function(g,_){var x=(7&g)<<4;_.buf[_.pos++]|=x|((g>>>=3)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g)))))}(d,s)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(l,d,g){for(var _,x,S=0;S<d.length;S++){if((_=d.charCodeAt(S))>55295&&_<57344){if(!x){_>56319||S+1===d.length?(l[g++]=239,l[g++]=191,l[g++]=189):x=_;continue}if(_<56320){l[g++]=239,l[g++]=191,l[g++]=189,x=_;continue}_=x-55296<<10|_-56320|65536,x=null}else x&&(l[g++]=239,l[g++]=191,l[g++]=189,x=null);_<128?l[g++]=_:(_<2048?l[g++]=_>>6|192:(_<65536?l[g++]=_>>12|224:(l[g++]=_>>18|240,l[g++]=_>>12&63|128),l[g++]=_>>6&63|128),l[g++]=63&_|128)}return g}(this.buf,i,this.pos);var s=this.pos-t;s>=128&&Lv(t,s,this),this.pos=t-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),zv(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),zv(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var s=0;s<t;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,t){this.pos++;var s=this.pos;i(t,this);var l=this.pos-s;l>=128&&Lv(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,t,s){this.writeTag(i,qt.Bytes),this.writeRawMessage(t,s)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,qS,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,GS,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,WS,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,ZS,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,HS,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,KS,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,XS,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,YS,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,JS,t)},writeBytesField:function(i,t){this.writeTag(i,qt.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,qt.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,qt.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,qt.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,qt.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,qt.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,qt.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,qt.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,qt.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,qt.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,!!t)}};var xm=P(Av);const wm=3;function QS(i,t,s){i===1&&s.readMessage(eT,t)}function eT(i,t,s){if(i===3){const{id:l,bitmap:d,width:g,height:_,left:x,top:S,advance:I}=s.readMessage(tT,{});t.push({id:l,bitmap:new Eu({width:g+2*wm,height:_+2*wm},d),metrics:{width:g,height:_,left:x,top:S,advance:I}})}}function tT(i,t,s){i===1?t.id=s.readVarint():i===2?t.bitmap=s.readBytes():i===3?t.width=s.readVarint():i===4?t.height=s.readVarint():i===5?t.left=s.readSVarint():i===6?t.top=s.readSVarint():i===7&&(t.advance=s.readVarint())}const Ov=wm;function Bv(i){let t=0,s=0;for(const _ of i)t+=_.w*_.h,s=Math.max(s,_.w);i.sort((_,x)=>x.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),s),h:1/0}];let d=0,g=0;for(const _ of i)for(let x=l.length-1;x>=0;x--){const S=l[x];if(!(_.w>S.w||_.h>S.h)){if(_.x=S.x,_.y=S.y,g=Math.max(g,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===S.w&&_.h===S.h){const I=l.pop();x<l.length&&(l[x]=I)}else _.h===S.h?(S.x+=_.w,S.w-=_.w):_.w===S.w?(S.y+=_.h,S.h-=_.h):(l.push({x:S.x+_.w,y:S.y,w:S.w-_.w,h:_.h}),S.y+=_.h,S.h-=_.h);break}}return{w:d,h:g,fill:t/(d*g)||0}}const Xr=1;class bm{constructor(t,{pixelRatio:s,version:l,stretchX:d,stretchY:g,content:_}){this.paddedRect=t,this.pixelRatio=s,this.stretchX=d,this.stretchY=g,this.content=_,this.version=l}get tl(){return[this.paddedRect.x+Xr,this.paddedRect.y+Xr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Xr,this.paddedRect.y+this.paddedRect.h-Xr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Xr)/this.pixelRatio,(this.paddedRect.h-2*Xr)/this.pixelRatio]}}class Nv{constructor(t,s){const l={},d={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,l,g),this.addImages(s,d,g);const{w:_,h:x}=Bv(g),S=new Ti({width:_||1,height:x||1});for(const I in t){const k=t[I],R=l[I].paddedRect;Ti.copy(k.data,S,{x:0,y:0},{x:R.x+Xr,y:R.y+Xr},k.data)}for(const I in s){const k=s[I],R=d[I].paddedRect,L=R.x+Xr,B=R.y+Xr,j=k.data.width,G=k.data.height;Ti.copy(k.data,S,{x:0,y:0},{x:L,y:B},k.data),Ti.copy(k.data,S,{x:0,y:G-1},{x:L,y:B-1},{width:j,height:1}),Ti.copy(k.data,S,{x:0,y:0},{x:L,y:B+G},{width:j,height:1}),Ti.copy(k.data,S,{x:j-1,y:0},{x:L-1,y:B},{width:1,height:G}),Ti.copy(k.data,S,{x:0,y:0},{x:L+j,y:B},{width:1,height:G})}this.image=S,this.iconPositions=l,this.patternPositions=d}addImages(t,s,l){for(const d in t){const g=t[d],_={x:0,y:0,w:g.data.width+2*Xr,h:g.data.height+2*Xr};l.push(_),s[d]=new bm(_,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,s){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),s),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),s)}patchUpdatedImage(t,s,l){if(!t||!s||t.version===s.version)return;t.version=s.version;const[d,g]=t.tl;l.update(s.data,void 0,{x:d,y:g})}}var Uo;Ke("ImagePosition",bm),Ke("ImageAtlas",Nv),c.ai=void 0,(Uo=c.ai||(c.ai={}))[Uo.none=0]="none",Uo[Uo.horizontal=1]="horizontal",Uo[Uo.vertical=2]="vertical",Uo[Uo.horizontalOnly=3]="horizontalOnly";const Ru=-17;class Du{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,s){const l=new Du;return l.scale=t||1,l.fontStack=s,l}static forImage(t){const s=new Du;return s.imageName=t,s}}class Vl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,s){const l=new Vl;for(let d=0;d<t.sections.length;d++){const g=t.sections[d];g.image?l.addImageSection(g):l.addTextSection(g,s)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let s="";for(let l=0;l<t.length;l++){const d=t.charCodeAt(l+1)||null,g=t.charCodeAt(l-1)||null;s+=d&&fd(d)&&!zu[t[l+1]]||g&&fd(g)&&!zu[t[l-1]]||!zu[t[l]]?t[l]:zu[t[l]]}return s}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&Ld[this.text.charCodeAt(l)];l++)t++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&Ld[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(t,s),this.sectionIndex=this.sectionIndex.slice(t,s)}substring(t,s){const l=new Vl;return l.text=this.text.substring(t,s),l.sectionIndex=this.sectionIndex.slice(t,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,s)=>Math.max(t,this.sections[s].scale),0)}addTextSection(t,s){this.text+=t.text,this.sections.push(Du.forText(t.scale,t.fontStack||s));const l=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(l)}addImageSection(t){const s=t.image?t.image.name:"";if(s.length===0)return void Mn("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Du.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Mn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Dd(i,t,s,l,d,g,_,x,S,I,k,R,L,B,j,G){const Q=Vl.fromFeature(i,d);let ne;R===c.ai.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:pe,processStyledBidirectionalText:oe}=Wr;if(pe&&Q.sections.length===1){ne=[];const Ie=pe(Q.toString(),Sm(Q,I,g,t,l,B,j));for(const He of Ie){const Qe=new Vl;Qe.text=He,Qe.sections=Q.sections;for(let Ge=0;Ge<He.length;Ge++)Qe.sectionIndex.push(0);ne.push(Qe)}}else if(oe){ne=[];const Ie=oe(Q.text,Q.sectionIndex,Sm(Q,I,g,t,l,B,j));for(const He of Ie){const Qe=new Vl;Qe.text=He[0],Qe.sectionIndex=He[1],Qe.sections=Q.sections,ne.push(Qe)}}else ne=function(Ie,He){const Qe=[],Ge=Ie.text;let $e=0;for(const Oe of He)Qe.push(Ie.substring($e,Oe)),$e=Oe;return $e<Ge.length&&Qe.push(Ie.substring($e,Ge.length)),Qe}(Q,Sm(Q,I,g,t,l,B,j));const me=[],_e={positionedLines:me,text:Q.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(Ie,He,Qe,Ge,$e,Oe,Xe,je,Re,ot,tt,xt){let en=0,rn=Ru,qn=0,fi=0;const Lr=je==="right"?1:je==="left"?0:.5;let Ln=0;for(const Gn of $e){Gn.trim();const Zn=Gn.getMaxScale(),Sr=(Zn-1)*$n,Br={positionedGlyphs:[],lineOffset:0};Ie.positionedLines[Ln]=Br;const Tr=Br.positionedGlyphs;let Yr=0;if(!Gn.length()){rn+=Oe,++Ln;continue}for(let Hn=0;Hn<Gn.length();Hn++){const Tt=Gn.getSection(Hn),Er=Gn.getSectionIndex(Hn),gr=Gn.getCharCode(Hn);let Wn=0,$i=null,cs=null,us=null,ao=$n;const qi=!(Re===c.ai.horizontal||!tt&&!ou(gr)||tt&&(Ld[gr]||(sr=gr,Ze.Arabic(sr)||Ze["Arabic Supplement"](sr)||Ze["Arabic Extended-A"](sr)||Ze["Arabic Presentation Forms-A"](sr)||Ze["Arabic Presentation Forms-B"](sr))));if(Tt.imageName){const Ii=Ge[Tt.imageName];if(!Ii)continue;us=Tt.imageName,Ie.iconsInText=Ie.iconsInText||!0,cs=Ii.paddedRect;const Qr=Ii.displaySize;Tt.scale=Tt.scale*$n/xt,$i={width:Qr[0],height:Qr[1],left:Xr,top:-Ov,advance:qi?Qr[1]:Qr[0]},Wn=Sr+($n-Qr[1]*Tt.scale),ao=$i.advance;const lo=qi?Qr[0]*Tt.scale-$n*Zn:Qr[1]*Tt.scale-$n*Zn;lo>0&&lo>Yr&&(Yr=lo)}else{const Ii=Qe[Tt.fontStack],Qr=Ii&&Ii[gr];if(Qr&&Qr.rect)cs=Qr.rect,$i=Qr.metrics;else{const lo=He[Tt.fontStack],Nu=lo&&lo[gr];if(!Nu)continue;$i=Nu.metrics}Wn=(Zn-Tt.scale)*$n}qi?(Ie.verticalizable=!0,Tr.push({glyph:gr,imageName:us,x:en,y:rn+Wn,vertical:qi,scale:Tt.scale,fontStack:Tt.fontStack,sectionIndex:Er,metrics:$i,rect:cs}),en+=ao*Tt.scale+ot):(Tr.push({glyph:gr,imageName:us,x:en,y:rn+Wn,vertical:qi,scale:Tt.scale,fontStack:Tt.fontStack,sectionIndex:Er,metrics:$i,rect:cs}),en+=$i.advance*Tt.scale+ot)}Tr.length!==0&&(qn=Math.max(en-ot,qn),iT(Tr,0,Tr.length-1,Lr,Yr)),en=0;const Jr=Oe*Zn+Yr;Br.lineOffset=Math.max(Yr,Sr),rn+=Jr,fi=Math.max(Jr,fi),++Ln}var sr;const mr=rn-Ru,{horizontalAlign:Fr,verticalAlign:Or}=Tm(Xe);(function(Gn,Zn,Sr,Br,Tr,Yr,Jr,Hn,Tt){const Er=(Zn-Sr)*Tr;let gr=0;gr=Yr!==Jr?-Hn*Br-Ru:(-Br*Tt+.5)*Jr;for(const Wn of Gn)for(const $i of Wn.positionedGlyphs)$i.x+=Er,$i.y+=gr})(Ie.positionedLines,Lr,Fr,Or,qn,fi,Oe,mr,$e.length),Ie.top+=-Or*mr,Ie.bottom=Ie.top+mr,Ie.left+=-Fr*qn,Ie.right=Ie.left+qn}(_e,t,s,l,ne,_,x,S,R,I,L,G),!function(Ie){for(const He of Ie)if(He.positionedGlyphs.length!==0)return!1;return!0}(me)&&_e}const Ld={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},nT={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function jv(i,t,s,l,d,g){if(t.imageName){const _=l[t.imageName];return _?_.displaySize[0]*t.scale*$n/g+d:0}{const _=s[t.fontStack],x=_&&_[i];return x?x.metrics.advance*t.scale+d:0}}function Uv(i,t,s,l){const d=Math.pow(i-t,2);return l?i<t?d/2:2*d:d+Math.abs(s)*s}function rT(i,t,s){let l=0;return i===10&&(l-=1e4),s&&(l+=150),i!==40&&i!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Vv(i,t,s,l,d,g){let _=null,x=Uv(t,s,d,g);for(const S of l){const I=Uv(t-S.x,s,d,g)+S.badness;I<=x&&(_=S,x=I)}return{index:i,x:t,priorBreak:_,badness:x}}function $v(i){return i?$v(i.priorBreak).concat(i.index):[]}function Sm(i,t,s,l,d,g,_){if(g!=="point")return[];if(!i)return[];const x=[],S=function(L,B,j,G,Q,ne){let pe=0;for(let oe=0;oe<L.length();oe++){const me=L.getSection(oe);pe+=jv(L.getCharCode(oe),me,G,Q,B,ne)}return pe/Math.max(1,Math.ceil(pe/j))}(i,t,s,l,d,_),I=i.text.indexOf("")>=0;let k=0;for(let L=0;L<i.length();L++){const B=i.getSection(L),j=i.getCharCode(L);if(Ld[j]||(k+=jv(j,B,l,d,t,_)),L<i.length()-1){const G=!((R=j)<11904||!(Ze["Bopomofo Extended"](R)||Ze.Bopomofo(R)||Ze["CJK Compatibility Forms"](R)||Ze["CJK Compatibility Ideographs"](R)||Ze["CJK Compatibility"](R)||Ze["CJK Radicals Supplement"](R)||Ze["CJK Strokes"](R)||Ze["CJK Symbols and Punctuation"](R)||Ze["CJK Unified Ideographs Extension A"](R)||Ze["CJK Unified Ideographs"](R)||Ze["Enclosed CJK Letters and Months"](R)||Ze["Halfwidth and Fullwidth Forms"](R)||Ze.Hiragana(R)||Ze["Ideographic Description Characters"](R)||Ze["Kangxi Radicals"](R)||Ze["Katakana Phonetic Extensions"](R)||Ze.Katakana(R)||Ze["Vertical Forms"](R)||Ze["Yi Radicals"](R)||Ze["Yi Syllables"](R)));(nT[j]||G||B.imageName)&&x.push(Vv(L+1,k,S,x,rT(j,i.getCharCode(L+1),G&&I),!1))}}var R;return $v(Vv(i.length(),k,S,x,0,!0))}function Tm(i){let t=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:t,verticalAlign:s}}function iT(i,t,s,l,d){if(!l&&!d)return;const g=i[s],_=(i[s].x+g.metrics.advance*g.scale)*l;for(let x=t;x<=s;x++)i[x].x-=_,i[x].y+=d}function sT(i,t,s){const{horizontalAlign:l,verticalAlign:d}=Tm(s),g=t[0]-i.displaySize[0]*l,_=t[1]-i.displaySize[1]*d;return{image:i,top:_,bottom:_+i.displaySize[1],left:g,right:g+i.displaySize[0]}}function qv(i,t,s,l,d,g){const _=i.image;let x;if(_.content){const Q=_.content,ne=_.pixelRatio||1;x=[Q[0]/ne,Q[1]/ne,_.displaySize[0]-Q[2]/ne,_.displaySize[1]-Q[3]/ne]}const S=t.left*g,I=t.right*g;let k,R,L,B;s==="width"||s==="both"?(B=d[0]+S-l[3],R=d[0]+I+l[1]):(B=d[0]+(S+I-_.displaySize[0])/2,R=B+_.displaySize[0]);const j=t.top*g,G=t.bottom*g;return s==="height"||s==="both"?(k=d[1]+j-l[0],L=d[1]+G+l[2]):(k=d[1]+(j+G-_.displaySize[1])/2,L=k+_.displaySize[1]),{image:_,top:k,right:R,bottom:L,left:B,collisionPadding:x}}const Lu=255,zs=128,Vo=Lu*zs;function Gv(i,t){const{expression:s}=t;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Jt(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=s;let g=0;for(;g<l.length&&l[g]<=i;)g++;g=Math.max(0,g-1);let _=g;for(;_<l.length&&l[_]<i+1;)_++;_=Math.min(l.length-1,_);const x=l[g],S=l[_];return s.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:x,maxZoom:S,minSize:s.evaluate(new Jt(x)),maxSize:s.evaluate(new Jt(S)),interpolationType:d}}}function Em(i,t,s){let l="never";const d=i.get(t);return d?l=d:i.get(s)&&(l="always"),l}const oT=jo.VectorTileFeature.types,aT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Fd(i,t,s,l,d,g,_,x,S,I,k,R,L){const B=x?Math.min(Vo,Math.round(x[0])):0,j=x?Math.min(Vo,Math.round(x[1])):0;i.emplaceBack(t,s,Math.round(32*l),Math.round(32*d),g,_,(B<<1)+(S?1:0),j,16*I,16*k,256*R,256*L)}function Im(i,t,s){i.emplaceBack(t.x,t.y,s),i.emplaceBack(t.x,t.y,s),i.emplaceBack(t.x,t.y,s),i.emplaceBack(t.x,t.y,s)}function lT(i){for(const t of i.sections)if(Jf(t.text))return!0;return!1}class Cm{constructor(t){this.layoutVertexArray=new wt,this.indexArray=new rr,this.programConfigurations=t,this.segments=new Qt,this.dynamicLayoutVertexArray=new _t,this.opacityVertexArray=new St,this.hasVisibleVertices=!1,this.placedSymbolArray=new ue}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,s,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,NS.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,jS.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,aT,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ke("SymbolBuffers",Cm);class km{constructor(t,s,l){this.layoutVertexArray=new t,this.layoutAttributes=s,this.indexArray=new l,this.segments=new Qt,this.collisionVertexArray=new Xt}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,US.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ke("CollisionBuffers",km);class $l{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=sm([]),this.placementViewportMatrix=sm([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Gv(this.zoom,s["text-size"]),this.iconSizeData=Gv(this.zoom,s["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),g=l.get("symbol-z-order");this.canOverlap=Em(l,"text-overlap","text-allow-overlap")!=="never"||Em(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>c.ai[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new Cm(new ls(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Cm(new ls(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new he,this.lineVertexArray=new ve,this.symbolInstances=new te,this.textAnchorOffsets=new Ee}calculateGlyphDependencies(t,s,l,d,g){for(let _=0;_<t.length;_++)if(s[t.charCodeAt(_)]=!0,(l||d)&&g){const x=zu[t.charAt(_)];x&&(s[x.charCodeAt(0)]=!0)}}populate(t,s,l){const d=this.layers[0],g=d.layout,_=g.get("text-font"),x=g.get("text-field"),S=g.get("icon-image"),I=(x.value.kind!=="constant"||x.value.value instanceof dr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),k=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,R=g.get("symbol-sort-key");if(this.features=[],!I&&!k)return;const L=s.iconDependencies,B=s.glyphDependencies,j=s.availableImages,G=new Jt(this.zoom);for(const{feature:Q,id:ne,index:pe,sourceLayerIndex:oe}of t){const me=d._featureFilter.needGeometry,_e=Oa(Q,me);if(!d._featureFilter.filter(G,_e,l))continue;let Ie,He;if(me||(_e.geometry=Fa(Q)),I){const Ge=d.getValueAndResolveTokens("text-field",_e,l,j),$e=dr.factory(Ge);lT($e)&&(this.hasRTLText=!0),(!this.hasRTLText||du()==="unavailable"||this.hasRTLText&&Wr.isParsed())&&(Ie=$S($e,d,_e))}if(k){const Ge=d.getValueAndResolveTokens("icon-image",_e,l,j);He=Ge instanceof nr?Ge:nr.fromString(Ge)}if(!Ie&&!He)continue;const Qe=this.sortFeaturesByKey?R.evaluate(_e,{},l):void 0;if(this.features.push({id:ne,text:Ie,icon:He,index:pe,sourceLayerIndex:oe,geometry:_e.geometry,properties:Q.properties,type:oT[Q.type],sortKey:Qe}),He&&(L[He.name]=!0),Ie){const Ge=_.evaluate(_e,{},l).join(","),$e=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.ai.vertical)>=0;for(const Oe of Ie.sections)if(Oe.image)L[Oe.image.name]=!0;else{const Xe=iu(Ie.toString()),je=Oe.fontStack||Ge,Re=B[je]=B[je]||{};this.calculateGlyphDependencies(Oe.text,Re,$e,this.allowVerticalPlacement,Xe)}}}g.get("symbol-placement")==="line"&&(this.features=function(Q){const ne={},pe={},oe=[];let me=0;function _e(Ge){oe.push(Q[Ge]),me++}function Ie(Ge,$e,Oe){const Xe=pe[Ge];return delete pe[Ge],pe[$e]=Xe,oe[Xe].geometry[0].pop(),oe[Xe].geometry[0]=oe[Xe].geometry[0].concat(Oe[0]),Xe}function He(Ge,$e,Oe){const Xe=ne[$e];return delete ne[$e],ne[Ge]=Xe,oe[Xe].geometry[0].shift(),oe[Xe].geometry[0]=Oe[0].concat(oe[Xe].geometry[0]),Xe}function Qe(Ge,$e,Oe){const Xe=Oe?$e[0][$e[0].length-1]:$e[0][0];return`${Ge}:${Xe.x}:${Xe.y}`}for(let Ge=0;Ge<Q.length;Ge++){const $e=Q[Ge],Oe=$e.geometry,Xe=$e.text?$e.text.toString():null;if(!Xe){_e(Ge);continue}const je=Qe(Xe,Oe),Re=Qe(Xe,Oe,!0);if(je in pe&&Re in ne&&pe[je]!==ne[Re]){const ot=He(je,Re,Oe),tt=Ie(je,Re,oe[ot].geometry);delete ne[je],delete pe[Re],pe[Qe(Xe,oe[tt].geometry,!0)]=tt,oe[ot].geometry=null}else je in pe?Ie(je,Re,Oe):Re in ne?He(je,Re,Oe):(_e(Ge),ne[je]=me-1,pe[Re]=me-1)}return oe.filter(Ge=>Ge.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Q,ne)=>Q.sortKey-ne.sortKey)}update(t,s,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,s,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,s,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,s){const l=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(s[t.segment+1]),g=t.dist(s[t.segment]);const _={};for(let x=t.segment+1;x<s.length;x++)_[x]={x:s[x].x,y:s[x].y,tileUnitDistanceFromAnchor:d},x<s.length-1&&(d+=s[x+1].dist(s[x]));for(let x=t.segment||0;x>=0;x--)_[x]={x:s[x].x,y:s[x].y,tileUnitDistanceFromAnchor:g},x>0&&(g+=s[x-1].dist(s[x]));for(let x=0;x<s.length;x++){const S=_[x];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,s,l,d,g,_,x,S,I,k,R,L){const B=t.indexArray,j=t.layoutVertexArray,G=t.segments.prepareSegment(4*s.length,j,B,this.canOverlap?_.sortKey:void 0),Q=this.glyphOffsetArray.length,ne=G.vertexLength,pe=this.allowVerticalPlacement&&x===c.ai.vertical?Math.PI/2:0,oe=_.text&&_.text.sections;for(let me=0;me<s.length;me++){const{tl:_e,tr:Ie,bl:He,br:Qe,tex:Ge,pixelOffsetTL:$e,pixelOffsetBR:Oe,minFontScaleX:Xe,minFontScaleY:je,glyphOffset:Re,isSDF:ot,sectionIndex:tt}=s[me],xt=G.vertexLength,en=Re[1];Fd(j,S.x,S.y,_e.x,en+_e.y,Ge.x,Ge.y,l,ot,$e.x,$e.y,Xe,je),Fd(j,S.x,S.y,Ie.x,en+Ie.y,Ge.x+Ge.w,Ge.y,l,ot,Oe.x,$e.y,Xe,je),Fd(j,S.x,S.y,He.x,en+He.y,Ge.x,Ge.y+Ge.h,l,ot,$e.x,Oe.y,Xe,je),Fd(j,S.x,S.y,Qe.x,en+Qe.y,Ge.x+Ge.w,Ge.y+Ge.h,l,ot,Oe.x,Oe.y,Xe,je),Im(t.dynamicLayoutVertexArray,S,pe),B.emplaceBack(xt,xt+1,xt+2),B.emplaceBack(xt+1,xt+2,xt+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Re[0]),me!==s.length-1&&tt===s[me+1].sectionIndex||t.programConfigurations.populatePaintArrays(j.length,_,_.index,{},L,oe&&oe[tt])}t.placedSymbolArray.emplaceBack(S.x,S.y,Q,this.glyphOffsetArray.length-Q,ne,I,k,S.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],x,0,!1,0,R)}_addCollisionDebugVertex(t,s,l,d,g,_){return s.emplaceBack(0,0),t.emplaceBack(l.x,l.y,d,g,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,s,l,d,g,_,x){const S=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),I=S.vertexLength,k=g.layoutVertexArray,R=g.collisionVertexArray,L=x.anchorX,B=x.anchorY;this._addCollisionDebugVertex(k,R,_,L,B,new N(t,s)),this._addCollisionDebugVertex(k,R,_,L,B,new N(l,s)),this._addCollisionDebugVertex(k,R,_,L,B,new N(l,d)),this._addCollisionDebugVertex(k,R,_,L,B,new N(t,d)),S.vertexLength+=4;const j=g.indexArray;j.emplaceBack(I,I+1),j.emplaceBack(I+1,I+2),j.emplaceBack(I+2,I+3),j.emplaceBack(I+3,I),S.primitiveLength+=4}addDebugCollisionBoxes(t,s,l,d){for(let g=t;g<s;g++){const _=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,d?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new km(_n,Pv.members,Un),this.iconCollisionBox=new km(_n,Pv.members,Un);for(let t=0;t<this.symbolInstances.length;t++){const s=this.symbolInstances.get(t);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(t,s,l,d,g,_,x,S,I){const k={};for(let R=s;R<l;R++){const L=t.get(R);k.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.textFeatureIndex=L.featureIndex;break}for(let R=d;R<g;R++){const L=t.get(R);k.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.verticalTextFeatureIndex=L.featureIndex;break}for(let R=_;R<x;R++){const L=t.get(R);k.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.iconFeatureIndex=L.featureIndex;break}for(let R=S;R<I;R++){const L=t.get(R);k.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.verticalIconFeatureIndex=L.featureIndex;break}return k}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,s){const l=t.placedSymbolArray.get(s),d=l.vertexStartIndex+4*l.numGlyphs;for(let g=l.vertexStartIndex;g<d;g+=4)t.indexArray.emplaceBack(g,g+1,g+2),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(t),l=Math.cos(t),d=[],g=[],_=[];for(let x=0;x<this.symbolInstances.length;++x){_.push(x);const S=this.symbolInstances.get(x);d.push(0|Math.round(s*S.anchorX+l*S.anchorY)),g.push(S.featureIndex)}return _.sort((x,S)=>d[x]-d[S]||g[S]-g[x]),_}addToSortKeyRanges(t,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,g,_)=>{d>=0&&_.indexOf(d)===g&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Zv,Hv;Ke("SymbolBucket",$l,{omit:["layers","collisionBoxArray","features","compareText"]}),$l.MAX_GLYPHS=65535,$l.addDynamicAttributes=Im;var Pm={get paint(){return Hv=Hv||new Sn({"icon-opacity":new ct(be.paint_symbol["icon-opacity"]),"icon-color":new ct(be.paint_symbol["icon-color"]),"icon-halo-color":new ct(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new ct(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ct(be.paint_symbol["icon-halo-blur"]),"icon-translate":new nt(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new nt(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new ct(be.paint_symbol["text-opacity"]),"text-color":new ct(be.paint_symbol["text-color"],{runtimeType:xr,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ct(be.paint_symbol["text-halo-color"]),"text-halo-width":new ct(be.paint_symbol["text-halo-width"]),"text-halo-blur":new ct(be.paint_symbol["text-halo-blur"]),"text-translate":new nt(be.paint_symbol["text-translate"]),"text-translate-anchor":new nt(be.paint_symbol["text-translate-anchor"])})},get layout(){return Zv=Zv||new Sn({"symbol-placement":new nt(be.layout_symbol["symbol-placement"]),"symbol-spacing":new nt(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new nt(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ct(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new nt(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new nt(be.layout_symbol["icon-allow-overlap"]),"icon-overlap":new nt(be.layout_symbol["icon-overlap"]),"icon-ignore-placement":new nt(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new nt(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new nt(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new ct(be.layout_symbol["icon-size"]),"icon-text-fit":new nt(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nt(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new ct(be.layout_symbol["icon-image"]),"icon-rotate":new ct(be.layout_symbol["icon-rotate"]),"icon-padding":new ct(be.layout_symbol["icon-padding"]),"icon-keep-upright":new nt(be.layout_symbol["icon-keep-upright"]),"icon-offset":new ct(be.layout_symbol["icon-offset"]),"icon-anchor":new ct(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new nt(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new nt(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new nt(be.layout_symbol["text-rotation-alignment"]),"text-field":new ct(be.layout_symbol["text-field"]),"text-font":new ct(be.layout_symbol["text-font"]),"text-size":new ct(be.layout_symbol["text-size"]),"text-max-width":new ct(be.layout_symbol["text-max-width"]),"text-line-height":new nt(be.layout_symbol["text-line-height"]),"text-letter-spacing":new ct(be.layout_symbol["text-letter-spacing"]),"text-justify":new ct(be.layout_symbol["text-justify"]),"text-radial-offset":new ct(be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new nt(be.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ct(be.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ct(be.layout_symbol["text-anchor"]),"text-max-angle":new nt(be.layout_symbol["text-max-angle"]),"text-writing-mode":new nt(be.layout_symbol["text-writing-mode"]),"text-rotate":new ct(be.layout_symbol["text-rotate"]),"text-padding":new nt(be.layout_symbol["text-padding"]),"text-keep-upright":new nt(be.layout_symbol["text-keep-upright"]),"text-transform":new ct(be.layout_symbol["text-transform"]),"text-offset":new ct(be.layout_symbol["text-offset"]),"text-allow-overlap":new nt(be.layout_symbol["text-allow-overlap"]),"text-overlap":new nt(be.layout_symbol["text-overlap"]),"text-ignore-placement":new nt(be.layout_symbol["text-ignore-placement"]),"text-optional":new nt(be.layout_symbol["text-optional"])})}};class Wv{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:ts,this.defaultValue=t}evaluate(t){if(t.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(t.formattedSection))return s.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ke("FormatSectionOverride",Wv,{omit:["defaultValue"]});class Od extends di{constructor(t){super(t,Pm)}recalculate(t,s){if(super.recalculate(t,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const g of l)d.indexOf(g)<0&&d.push(g);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,s,l,d){const g=this.layout.get(t).evaluate(s,{},l,d),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||Sl(_.value)||!g?g:function(x,S){return S.replace(/{([^{}]+)}/g,(I,k)=>x&&k in x?String(x[k]):"")}(s.properties,g)}createBucket(t){return new $l(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Pm.paint.overridableProperties){if(!Od.hasPaintOverride(this.layout,t))continue;const s=this.paint.get(t),l=new Wv(s),d=new Jc(l,s.property.specification);let g=null;g=s.value.kind==="constant"||s.value.kind==="source"?new Qc("source",d):new El("composite",d,s.value.zoomStops),this.paint._values[t]=new wr(s.property,g,s.parameters)}}_handleOverridablePaintPropertyUpdate(t,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&Od.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,s){const l=t.get("text-field"),d=Pm.paint.properties[s];let g=!1;const _=x=>{for(const S of x)if(d.overrides&&d.overrides.hasOverride(S))return void(g=!0)};if(l.value.kind==="constant"&&l.value.value instanceof dr)_(l.value.value.sections);else if(l.value.kind==="source"){const x=I=>{g||(I instanceof Ws&&sn(I.value)===W?_(I.value.sections):I instanceof bl?_(I.sections):I.eachChild(x))},S=l.value;S._styleExpression&&x(S._styleExpression.expression)}return g}}let Kv;var cT={get paint(){return Kv=Kv||new Sn({"background-color":new nt(be.paint_background["background-color"]),"background-pattern":new fu(be.paint_background["background-pattern"]),"background-opacity":new nt(be.paint_background["background-opacity"])})}};class uT extends di{constructor(t){super(t,cT)}}let Xv;var hT={get paint(){return Xv=Xv||new Sn({"raster-opacity":new nt(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new nt(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new nt(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new nt(be.paint_raster["raster-brightness-max"]),"raster-saturation":new nt(be.paint_raster["raster-saturation"]),"raster-contrast":new nt(be.paint_raster["raster-contrast"]),"raster-resampling":new nt(be.paint_raster["raster-resampling"]),"raster-fade-duration":new nt(be.paint_raster["raster-fade-duration"])})}};class dT extends di{constructor(t){super(t,hT)}}class pT extends di{constructor(t){super(t,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class fT{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Am=63710088e-1;class $o{constructor(t,s){if(isNaN(t)||isNaN(s))throw new Error(`Invalid LngLat object: (${t}, ${s})`);if(this.lng=+t,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $o(De(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const s=Math.PI/180,l=this.lat*s,d=t.lat*s,g=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((t.lng-this.lng)*s);return Am*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof $o)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new $o(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new $o(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Yv=2*Math.PI*Am;function Jv(i){return Yv*Math.cos(i*Math.PI/180)}function Qv(i){return(180+i)/360}function e0(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function t0(i,t){return i/Jv(t)}function n0(i){return 360*i-180}function Mm(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Bd{constructor(t,s,l=0){this.x=+t,this.y=+s,this.z=+l}static fromLngLat(t,s=0){const l=$o.convert(t);return new Bd(Qv(l.lng),e0(l.lat),t0(s,l.lat))}toLngLat(){return new $o(n0(this.x),Mm(this.y))}toAltitude(){return this.z*Jv(Mm(this.y))}meterInMercatorCoordinateUnits(){return 1/Yv*(t=Mm(this.y),1/Math.cos(t*Math.PI/180));var t}}function r0(i,t,s){var l=2*Math.PI*6378137/256/Math.pow(2,s);return[i*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class zm{constructor(t,s,l){if(t<0||t>25||l<0||l>=Math.pow(2,t)||s<0||s>=Math.pow(2,t))throw new Error(`x=${s}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=s,this.y=l,this.key=Fu(0,t,t,s,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,s,l){const d=(_=this.y,x=this.z,S=r0(256*(g=this.x),256*(_=Math.pow(2,x)-_-1),x),I=r0(256*(g+1),256*(_+1),x),S[0]+","+S[1]+","+I[0]+","+I[1]);var g,_,x,S,I;const k=function(R,L,B){let j,G="";for(let Q=R;Q>0;Q--)j=1<<Q-1,G+=(L&j?1:0)+(B&j?2:0);return G}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,k).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){const s=this.z-t.z;return s>0&&t.x===this.x>>s&&t.y===this.y>>s}getTilePoint(t){const s=Math.pow(2,this.z);return new N((t.x*s-this.x)*Dn,(t.y*s-this.y)*Dn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class i0{constructor(t,s){this.wrap=t,this.canonical=s,this.key=Fu(t,s.z,s.z,s.x,s.y)}}class Ei{constructor(t,s,l,d,g){if(t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=s,this.canonical=new zm(l,+d,+g),this.key=Fu(s,t,l,d,g)}clone(){return new Ei(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?new Ei(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ei(t,this.wrap,t,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(t,s){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?Fu(this.wrap*+s,t,this.canonical.z,this.canonical.x,this.canonical.y):Fu(this.wrap*+s,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const s=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>s&&t.canonical.y===this.canonical.y>>s}children(t){if(this.overscaledZ>=t)return[new Ei(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new Ei(s,this.wrap,s,l,d),new Ei(s,this.wrap,s,l+1,d),new Ei(s,this.wrap,s,l,d+1),new Ei(s,this.wrap,s,l+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ei(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ei(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new i0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Bd(t.x-this.wrap,t.y))}}function Fu(i,t,s,l,d){(i*=2)<0&&(i=-1*i-1);const g=1<<s;return(g*g*i+g*d+l).toString(36)+s.toString(36)+t.toString(36)}Ke("CanonicalTileID",zm),Ke("OverscaledTileID",Ei,{omit:["posMatrix"]});class s0{constructor(t,s,l,d=1,g=1,_=1,x=0){if(this.uid=t,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Mn(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const S=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=g,this.blueFactor=_,this.baseShift=x;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<S;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(S,I)]=this.data[this._idx(S-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,S)]=this.data[this._idx(I,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<S;I++)for(let k=0;k<S;k++){const R=this.get(I,k);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(t,s){const l=new Uint8Array(this.data.buffer),d=4*this._idx(t,s);return this.unpack(l[d],l[d+1],l[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,s){if(t<-1||t>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(t+1)}unpack(t,s,l){return t*this.redFactor+s*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Ti({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,s,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=s*this.dim,g=s*this.dim+this.dim,_=l*this.dim,x=l*this.dim+this.dim;switch(s){case-1:d=g-1;break;case 1:g=d+1}switch(l){case-1:_=x-1;break;case 1:x=_+1}const S=-s*this.dim,I=-l*this.dim;for(let k=_;k<x;k++)for(let R=d;R<g;R++)this.data[this._idx(R,k)]=t.data[this._idx(R+S,k+I)]}}Ke("DEMData",s0);class o0{constructor(t){this._stringToNumber={},this._numberToString=[];for(let s=0;s<t.length;s++){const l=t[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class a0{constructor(t,s,l,d,g){this.type="Feature",this._vectorTileFeature=t,t._z=s,t._x=l,t._y=d,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(t[s]=this[s]);return t}}class l0{constructor(t,s){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Lo(Dn,16,0),this.grid3D=new Lo(Dn,16,0),this.featureIndexArray=new ke,this.promoteId=s}insert(t,s,l,d,g,_){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,g);const S=_?this.grid3D:this.grid;for(let I=0;I<s.length;I++){const k=s[I],R=[1/0,1/0,-1/0,-1/0];for(let L=0;L<k.length;L++){const B=k[L];R[0]=Math.min(R[0],B.x),R[1]=Math.min(R[1],B.y),R[2]=Math.max(R[2],B.x),R[3]=Math.max(R[3],B.y)}R[0]<Dn&&R[1]<Dn&&R[2]>=0&&R[3]>=0&&S.insert(x,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new jo.VectorTile(new xm(this.rawTileData)).layers,this.sourceLayerCoder=new o0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,s,l,d){this.loadVTLayers();const g=t.params||{},_=Dn/t.tileSize/t.scale,x=tu(g.filter),S=t.queryGeometry,I=t.queryPadding*_,k=u0(S),R=this.grid.query(k.minX-I,k.minY-I,k.maxX+I,k.maxY+I),L=u0(t.cameraQueryGeometry),B=this.grid3D.query(L.minX-I,L.minY-I,L.maxX+I,L.maxY+I,(Q,ne,pe,oe)=>function(me,_e,Ie,He,Qe){for(const $e of me)if(_e<=$e.x&&Ie<=$e.y&&He>=$e.x&&Qe>=$e.y)return!0;const Ge=[new N(_e,Ie),new N(_e,Qe),new N(He,Qe),new N(He,Ie)];if(me.length>2){for(const $e of Ge)if(Fl(me,$e))return!0}for(let $e=0;$e<me.length-1;$e++)if(Z2(me[$e],me[$e+1],Ge))return!0;return!1}(t.cameraQueryGeometry,Q-I,ne-I,pe+I,oe+I));for(const Q of B)R.push(Q);R.sort(mT);const j={};let G;for(let Q=0;Q<R.length;Q++){const ne=R[Q];if(ne===G)continue;G=ne;const pe=this.featureIndexArray.get(ne);let oe=null;this.loadMatchingFeature(j,pe.bucketIndex,pe.sourceLayerIndex,pe.featureIndex,x,g.layers,g.availableImages,s,l,d,(me,_e,Ie)=>(oe||(oe=Fa(me)),_e.queryIntersectsFeature(S,me,Ie,oe,this.z,t.transform,_,t.pixelPosMatrix)))}return j}loadMatchingFeature(t,s,l,d,g,_,x,S,I,k,R){const L=this.bucketLayerIDs[s];if(_&&!function(Q,ne){for(let pe=0;pe<Q.length;pe++)if(ne.indexOf(Q[pe])>=0)return!0;return!1}(_,L))return;const B=this.sourceLayerCoder.decode(l),j=this.vtLayers[B].feature(d);if(g.needGeometry){const Q=Oa(j,!0);if(!g.filter(new Jt(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!g.filter(new Jt(this.tileID.overscaledZ),j))return;const G=this.getId(j,B);for(let Q=0;Q<L.length;Q++){const ne=L[Q];if(_&&_.indexOf(ne)<0)continue;const pe=S[ne];if(!pe)continue;let oe={};G&&k&&(oe=k.getState(pe.sourceLayer||"_geojsonTileLayer",G));const me=qe({},I[ne]);me.paint=c0(me.paint,pe.paint,j,oe,x),me.layout=c0(me.layout,pe.layout,j,oe,x);const _e=!R||R(j,pe,oe);if(!_e)continue;const Ie=new a0(j,this.z,this.x,this.y,G);Ie.layer=me;let He=t[ne];He===void 0&&(He=t[ne]=[]),He.push({featureIndex:d,feature:Ie,intersectionZ:_e})}}lookupSymbolFeatures(t,s,l,d,g,_,x,S){const I={};this.loadVTLayers();const k=tu(g);for(const R of t)this.loadMatchingFeature(I,l,d,R,k,_,x,S,s);return I}hasLayer(t){for(const s of this.bucketLayerIDs)for(const l of s)if(t===l)return!0;return!1}getId(t,s){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof l=="boolean"&&(l=Number(l))),l}}function c0(i,t,s,l,d){return it(i,(g,_)=>{const x=t instanceof Dl?t.get(_):null;return x&&x.evaluate?x.evaluate(s,l,d):x})}function u0(i){let t=1/0,s=1/0,l=-1/0,d=-1/0;for(const g of i)t=Math.min(t,g.x),s=Math.min(s,g.y),l=Math.max(l,g.x),d=Math.max(d,g.y);return{minX:t,minY:s,maxX:l,maxY:d}}function mT(i,t){return t-i}function h0(i,t,s,l,d){const g=[];for(let _=0;_<i.length;_++){const x=i[_];let S;for(let I=0;I<x.length-1;I++){let k=x[I],R=x[I+1];k.x<t&&R.x<t||(k.x<t?k=new N(t,k.y+(t-k.x)/(R.x-k.x)*(R.y-k.y))._round():R.x<t&&(R=new N(t,k.y+(t-k.x)/(R.x-k.x)*(R.y-k.y))._round()),k.y<s&&R.y<s||(k.y<s?k=new N(k.x+(s-k.y)/(R.y-k.y)*(R.x-k.x),s)._round():R.y<s&&(R=new N(k.x+(s-k.y)/(R.y-k.y)*(R.x-k.x),s)._round()),k.x>=l&&R.x>=l||(k.x>=l?k=new N(l,k.y+(l-k.x)/(R.x-k.x)*(R.y-k.y))._round():R.x>=l&&(R=new N(l,k.y+(l-k.x)/(R.x-k.x)*(R.y-k.y))._round()),k.y>=d&&R.y>=d||(k.y>=d?k=new N(k.x+(d-k.y)/(R.y-k.y)*(R.x-k.x),d)._round():R.y>=d&&(R=new N(k.x+(d-k.y)/(R.y-k.y)*(R.x-k.x),d)._round()),S&&k.equals(S[S.length-1])||(S=[k],g.push(S)),S.push(R)))))}}return g}Ke("FeatureIndex",l0,{omit:["rawTileData","sourceLayerCoder"]});class qo extends N{constructor(t,s,l,d){super(t,s),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new qo(this.x,this.y,this.angle,this.segment)}}function d0(i,t,s,l,d){if(t.segment===void 0||s===0)return!0;let g=t,_=t.segment+1,x=0;for(;x>-s/2;){if(_--,_<0)return!1;x-=i[_].dist(g),g=i[_]}x+=i[_].dist(i[_+1]),_++;const S=[];let I=0;for(;x<s/2;){const k=i[_],R=i[_+1];if(!R)return!1;let L=i[_-1].angleTo(k)-k.angleTo(R);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:x,angleDelta:L}),I+=L;x-S[0].distance>l;)I-=S.shift().angleDelta;if(I>d)return!1;_++,x+=k.dist(R)}return!0}function p0(i){let t=0;for(let s=0;s<i.length-1;s++)t+=i[s].dist(i[s+1]);return t}function f0(i,t,s){return i?.6*t*s:0}function m0(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function gT(i,t,s,l,d,g){const _=f0(s,d,g),x=m0(s,l)*g;let S=0;const I=p0(i)/2;for(let k=0;k<i.length-1;k++){const R=i[k],L=i[k+1],B=R.dist(L);if(S+B>I){const j=(I-S)/B,G=Gr.number(R.x,L.x,j),Q=Gr.number(R.y,L.y,j),ne=new qo(G,Q,L.angleTo(R),k);return ne._round(),!_||d0(i,ne,x,_,t)?ne:void 0}S+=B}}function yT(i,t,s,l,d,g,_,x,S){const I=f0(l,g,_),k=m0(l,d),R=k*_,L=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return t-R<t/4&&(t=R+t/4),g0(i,L?t/2*x%t:(k/2+2*g)*_*x%t,t,I,s,R,L,!1,S)}function g0(i,t,s,l,d,g,_,x,S){const I=g/2,k=p0(i);let R=0,L=t-s,B=[];for(let j=0;j<i.length-1;j++){const G=i[j],Q=i[j+1],ne=G.dist(Q),pe=Q.angleTo(G);for(;L+s<R+ne;){L+=s;const oe=(L-R)/ne,me=Gr.number(G.x,Q.x,oe),_e=Gr.number(G.y,Q.y,oe);if(me>=0&&me<S&&_e>=0&&_e<S&&L-I>=0&&L+I<=k){const Ie=new qo(me,_e,pe,j);Ie._round(),l&&!d0(i,Ie,g,l,d)||B.push(Ie)}}R+=ne}return x||B.length||_||(B=g0(i,R/2,s,l,d,g,_,!0,S)),B}Ke("Anchor",qo);const ql=Xr;function y0(i,t,s,l){const d=[],g=i.image,_=g.pixelRatio,x=g.paddedRect.w-2*ql,S=g.paddedRect.h-2*ql,I=i.right-i.left,k=i.bottom-i.top,R=g.stretchX||[[0,x]],L=g.stretchY||[[0,S]],B=(Oe,Xe)=>Oe+Xe[1]-Xe[0],j=R.reduce(B,0),G=L.reduce(B,0),Q=x-j,ne=S-G;let pe=0,oe=j,me=0,_e=G,Ie=0,He=Q,Qe=0,Ge=ne;if(g.content&&l){const Oe=g.content;pe=Nd(R,0,Oe[0]),me=Nd(L,0,Oe[1]),oe=Nd(R,Oe[0],Oe[2]),_e=Nd(L,Oe[1],Oe[3]),Ie=Oe[0]-pe,Qe=Oe[1]-me,He=Oe[2]-Oe[0]-oe,Ge=Oe[3]-Oe[1]-_e}const $e=(Oe,Xe,je,Re)=>{const ot=jd(Oe.stretch-pe,oe,I,i.left),tt=Ud(Oe.fixed-Ie,He,Oe.stretch,j),xt=jd(Xe.stretch-me,_e,k,i.top),en=Ud(Xe.fixed-Qe,Ge,Xe.stretch,G),rn=jd(je.stretch-pe,oe,I,i.left),qn=Ud(je.fixed-Ie,He,je.stretch,j),fi=jd(Re.stretch-me,_e,k,i.top),Lr=Ud(Re.fixed-Qe,Ge,Re.stretch,G),Ln=new N(ot,xt),sr=new N(rn,xt),mr=new N(rn,fi),Fr=new N(ot,fi),Or=new N(tt/_,en/_),Gn=new N(qn/_,Lr/_),Zn=t*Math.PI/180;if(Zn){const Tr=Math.sin(Zn),Yr=Math.cos(Zn),Jr=[Yr,-Tr,Tr,Yr];Ln._matMult(Jr),sr._matMult(Jr),Fr._matMult(Jr),mr._matMult(Jr)}const Sr=Oe.stretch+Oe.fixed,Br=Xe.stretch+Xe.fixed;return{tl:Ln,tr:sr,bl:Fr,br:mr,tex:{x:g.paddedRect.x+ql+Sr,y:g.paddedRect.y+ql+Br,w:je.stretch+je.fixed-Sr,h:Re.stretch+Re.fixed-Br},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Or,pixelOffsetBR:Gn,minFontScaleX:He/_/I,minFontScaleY:Ge/_/k,isSDF:s}};if(l&&(g.stretchX||g.stretchY)){const Oe=_0(R,Q,j),Xe=_0(L,ne,G);for(let je=0;je<Oe.length-1;je++){const Re=Oe[je],ot=Oe[je+1];for(let tt=0;tt<Xe.length-1;tt++)d.push($e(Re,Xe[tt],ot,Xe[tt+1]))}}else d.push($e({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:S+1}));return d}function Nd(i,t,s){let l=0;for(const d of i)l+=Math.max(t,Math.min(s,d[1]))-Math.max(t,Math.min(s,d[0]));return l}function _0(i,t,s){const l=[{fixed:-ql,stretch:0}];for(const[d,g]of i){const _=l[l.length-1];l.push({fixed:d-_.stretch,stretch:_.stretch}),l.push({fixed:d-_.stretch,stretch:_.stretch+(g-d)})}return l.push({fixed:t+ql,stretch:s}),l}function jd(i,t,s,l){return i/t*s+l}function Ud(i,t,s,l){return i-t*s/l}class Vd{constructor(t,s,l,d,g,_,x,S,I,k){if(this.boxStartIndex=t.length,I){let R=_.top,L=_.bottom;const B=_.collisionPadding;B&&(R-=B[1],L+=B[3]);let j=L-R;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{let R=_.top*x-S[0],L=_.bottom*x+S[2],B=_.left*x-S[3],j=_.right*x+S[1];const G=_.collisionPadding;if(G&&(B-=G[0]*x,R-=G[1]*x,j+=G[2]*x,L+=G[3]*x),k){const Q=new N(B,R),ne=new N(j,R),pe=new N(B,L),oe=new N(j,L),me=k*Math.PI/180;Q._rotate(me),ne._rotate(me),pe._rotate(me),oe._rotate(me),B=Math.min(Q.x,ne.x,pe.x,oe.x),j=Math.max(Q.x,ne.x,pe.x,oe.x),R=Math.min(Q.y,ne.y,pe.y,oe.y),L=Math.max(Q.y,ne.y,pe.y,oe.y)}t.emplaceBack(s.x,s.y,B,R,j,L,l,d,g)}this.boxEndIndex=t.length}}class _T{constructor(t=[],s=vT){if(this.data=t,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:s,compare:l}=this,d=s[t];for(;t>0;){const g=t-1>>1,_=s[g];if(l(d,_)>=0)break;s[t]=_,t=g}s[t]=d}_down(t){const{data:s,compare:l}=this,d=this.length>>1,g=s[t];for(;t<d;){let _=1+(t<<1),x=s[_];const S=_+1;if(S<this.length&&l(s[S],x)<0&&(_=S,x=s[S]),l(x,g)>=0)break;s[t]=x,t=_}s[t]=g}}function vT(i,t){return i<t?-1:i>t?1:0}function xT(i,t=1,s=!1){let l=1/0,d=1/0,g=-1/0,_=-1/0;const x=i[0];for(let B=0;B<x.length;B++){const j=x[B];(!B||j.x<l)&&(l=j.x),(!B||j.y<d)&&(d=j.y),(!B||j.x>g)&&(g=j.x),(!B||j.y>_)&&(_=j.y)}const S=Math.min(g-l,_-d);let I=S/2;const k=new _T([],wT);if(S===0)return new N(l,d);for(let B=l;B<g;B+=S)for(let j=d;j<_;j+=S)k.push(new Gl(B+I,j+I,I,i));let R=function(B){let j=0,G=0,Q=0;const ne=B[0];for(let pe=0,oe=ne.length,me=oe-1;pe<oe;me=pe++){const _e=ne[pe],Ie=ne[me],He=_e.x*Ie.y-Ie.x*_e.y;G+=(_e.x+Ie.x)*He,Q+=(_e.y+Ie.y)*He,j+=3*He}return new Gl(G/j,Q/j,0,B)}(i),L=k.length;for(;k.length;){const B=k.pop();(B.d>R.d||!R.d)&&(R=B,s&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,L)),B.max-R.d<=t||(I=B.h/2,k.push(new Gl(B.p.x-I,B.p.y-I,I,i)),k.push(new Gl(B.p.x+I,B.p.y-I,I,i)),k.push(new Gl(B.p.x-I,B.p.y+I,I,i)),k.push(new Gl(B.p.x+I,B.p.y+I,I,i)),L+=4)}return s&&(console.log(`num probes: ${L}`),console.log(`best distance: ${R.d}`)),R.p}function wT(i,t){return t.max-i.max}function Gl(i,t,s,l){this.p=new N(i,t),this.h=s,this.d=function(d,g){let _=!1,x=1/0;for(let S=0;S<g.length;S++){const I=g[S];for(let k=0,R=I.length,L=R-1;k<R;L=k++){const B=I[k],j=I[L];B.y>d.y!=j.y>d.y&&d.x<(j.x-B.x)*(d.y-B.y)/(j.y-B.y)+B.x&&(_=!_),x=Math.min(x,ev(d,B,j))}}return(_?1:-1)*Math.sqrt(x)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var fr;c.aq=void 0,(fr=c.aq||(c.aq={}))[fr.center=1]="center",fr[fr.left=2]="left",fr[fr.right=3]="right",fr[fr.top=4]="top",fr[fr.bottom=5]="bottom",fr[fr["top-left"]=6]="top-left",fr[fr["top-right"]=7]="top-right",fr[fr["bottom-left"]=8]="bottom-left",fr[fr["bottom-right"]=9]="bottom-right";const Go=7,Rm=Number.POSITIVE_INFINITY;function v0(i,t){return t[1]!==Rm?function(s,l,d){let g=0,_=0;switch(l=Math.abs(l),d=Math.abs(d),s){case"top-right":case"top-left":case"top":_=d-Go;break;case"bottom-right":case"bottom-left":case"bottom":_=-d+Go}switch(s){case"top-right":case"bottom-right":case"right":g=-l;break;case"top-left":case"bottom-left":case"left":g=l}return[g,_]}(i,t[0],t[1]):function(s,l){let d=0,g=0;l<0&&(l=0);const _=l/Math.SQRT2;switch(s){case"top-right":case"top-left":g=_-Go;break;case"bottom-right":case"bottom-left":g=-_+Go;break;case"bottom":g=-l+Go;break;case"top":g=l-Go}switch(s){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=l;break;case"right":d=-l}return[d,g]}(i,t[0])}function x0(i,t,s){var l;const d=i.layout,g=(l=d.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},s);if(g){const x=g.values,S=[];for(let I=0;I<x.length;I+=2){const k=S[I]=x[I],R=x[I+1].map(L=>L*$n);k.startsWith("top")?R[1]-=Go:k.startsWith("bottom")&&(R[1]+=Go),S[I+1]=R}return new li(S)}const _=d.get("text-variable-anchor");if(_){let x;x=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},s)*$n,Rm]:d.get("text-offset").evaluate(t,{},s).map(I=>I*$n);const S=[];for(const I of _)S.push(I,v0(I,x));return new li(S)}return null}function Dm(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function bT(i,t,s,l,d,g,_,x,S,I,k){let R=g.textMaxSize.evaluate(t,{});R===void 0&&(R=_);const L=i.layers[0].layout,B=L.get("icon-offset").evaluate(t,{},k),j=b0(s.horizontal),G=_/24,Q=i.tilePixelRatio*G,ne=i.tilePixelRatio*R/24,pe=i.tilePixelRatio*x,oe=i.tilePixelRatio*L.get("symbol-spacing"),me=L.get("text-padding")*i.tilePixelRatio,_e=function(Re,ot,tt,xt=1){const en=Re.get("icon-padding").evaluate(ot,{},tt),rn=en&&en.values;return[rn[0]*xt,rn[1]*xt,rn[2]*xt,rn[3]*xt]}(L,t,k,i.tilePixelRatio),Ie=L.get("text-max-angle")/180*Math.PI,He=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",Qe=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Ge=L.get("symbol-placement"),$e=oe/2,Oe=L.get("icon-text-fit");let Xe;l&&Oe!=="none"&&(i.allowVerticalPlacement&&s.vertical&&(Xe=qv(l,s.vertical,Oe,L.get("icon-text-fit-padding"),B,G)),j&&(l=qv(l,j,Oe,L.get("icon-text-fit-padding"),B,G)));const je=(Re,ot)=>{ot.x<0||ot.x>=Dn||ot.y<0||ot.y>=Dn||function(tt,xt,en,rn,qn,fi,Lr,Ln,sr,mr,Fr,Or,Gn,Zn,Sr,Br,Tr,Yr,Jr,Hn,Tt,Er,gr,Wn,$i){const cs=tt.addToLineVertexArray(xt,en);let us,ao,qi,Ii,Qr=0,lo=0,Nu=0,I0=0,Vm=-1,$m=-1;const co={};let C0=ro("");if(tt.allowVerticalPlacement&&rn.vertical){const Ir=Ln.layout.get("text-rotate").evaluate(Tt,{},Wn)+90;qi=new Vd(sr,xt,mr,Fr,Or,rn.vertical,Gn,Zn,Sr,Ir),Lr&&(Ii=new Vd(sr,xt,mr,Fr,Or,Lr,Tr,Yr,Sr,Ir))}if(qn){const Ir=Ln.layout.get("icon-rotate").evaluate(Tt,{}),Ci=Ln.layout.get("icon-text-fit")!=="none",Na=y0(qn,Ir,gr,Ci),ds=Lr?y0(Lr,Ir,gr,Ci):void 0;ao=new Vd(sr,xt,mr,Fr,Or,qn,Tr,Yr,!1,Ir),Qr=4*Na.length;const ja=tt.iconSizeData;let Rs=null;ja.kind==="source"?(Rs=[zs*Ln.layout.get("icon-size").evaluate(Tt,{})],Rs[0]>Vo&&Mn(`${tt.layerIds[0]}: Value for "icon-size" is >= ${Lu}. Reduce your "icon-size".`)):ja.kind==="composite"&&(Rs=[zs*Er.compositeIconSizes[0].evaluate(Tt,{},Wn),zs*Er.compositeIconSizes[1].evaluate(Tt,{},Wn)],(Rs[0]>Vo||Rs[1]>Vo)&&Mn(`${tt.layerIds[0]}: Value for "icon-size" is >= ${Lu}. Reduce your "icon-size".`)),tt.addSymbols(tt.icon,Na,Rs,Hn,Jr,Tt,c.ai.none,xt,cs.lineStartIndex,cs.lineLength,-1,Wn),Vm=tt.icon.placedSymbolArray.length-1,ds&&(lo=4*ds.length,tt.addSymbols(tt.icon,ds,Rs,Hn,Jr,Tt,c.ai.vertical,xt,cs.lineStartIndex,cs.lineLength,-1,Wn),$m=tt.icon.placedSymbolArray.length-1)}const k0=Object.keys(rn.horizontal);for(const Ir of k0){const Ci=rn.horizontal[Ir];if(!us){C0=ro(Ci.text);const ds=Ln.layout.get("text-rotate").evaluate(Tt,{},Wn);us=new Vd(sr,xt,mr,Fr,Or,Ci,Gn,Zn,Sr,ds)}const Na=Ci.positionedLines.length===1;if(Nu+=w0(tt,xt,Ci,fi,Ln,Sr,Tt,Br,cs,rn.vertical?c.ai.horizontal:c.ai.horizontalOnly,Na?k0:[Ir],co,Vm,Er,Wn),Na)break}rn.vertical&&(I0+=w0(tt,xt,rn.vertical,fi,Ln,Sr,Tt,Br,cs,c.ai.vertical,["vertical"],co,$m,Er,Wn));const ET=us?us.boxStartIndex:tt.collisionBoxArray.length,IT=us?us.boxEndIndex:tt.collisionBoxArray.length,CT=qi?qi.boxStartIndex:tt.collisionBoxArray.length,kT=qi?qi.boxEndIndex:tt.collisionBoxArray.length,PT=ao?ao.boxStartIndex:tt.collisionBoxArray.length,AT=ao?ao.boxEndIndex:tt.collisionBoxArray.length,MT=Ii?Ii.boxStartIndex:tt.collisionBoxArray.length,zT=Ii?Ii.boxEndIndex:tt.collisionBoxArray.length;let hs=-1;const qd=(Ir,Ci)=>Ir&&Ir.circleDiameter?Math.max(Ir.circleDiameter,Ci):Ci;hs=qd(us,hs),hs=qd(qi,hs),hs=qd(ao,hs),hs=qd(Ii,hs);const P0=hs>-1?1:0;P0&&(hs*=$i/$n),tt.glyphOffsetArray.length>=$l.MAX_GLYPHS&&Mn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Tt.sortKey!==void 0&&tt.addToSortKeyRanges(tt.symbolInstances.length,Tt.sortKey);const RT=x0(Ln,Tt,Wn),[DT,LT]=function(Ir,Ci){const Na=Ir.length,ds=Ci==null?void 0:Ci.values;if((ds==null?void 0:ds.length)>0)for(let ja=0;ja<ds.length;ja+=2){const Rs=ds[ja+1];Ir.emplaceBack(c.aq[ds[ja]],Rs[0],Rs[1])}return[Na,Ir.length]}(tt.textAnchorOffsets,RT);tt.symbolInstances.emplaceBack(xt.x,xt.y,co.right>=0?co.right:-1,co.center>=0?co.center:-1,co.left>=0?co.left:-1,co.vertical||-1,Vm,$m,C0,ET,IT,CT,kT,PT,AT,MT,zT,mr,Nu,I0,Qr,lo,P0,0,Gn,hs,DT,LT)}(i,ot,Re,s,l,d,Xe,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,Q,[me,me,me,me],He,S,pe,_e,Qe,B,t,g,I,k,_)};if(Ge==="line")for(const Re of h0(t.geometry,0,0,Dn,Dn)){const ot=yT(Re,oe,Ie,s.vertical||j,l,24,ne,i.overscaling,Dn);for(const tt of ot)j&&ST(i,j.text,$e,tt)||je(Re,tt)}else if(Ge==="line-center"){for(const Re of t.geometry)if(Re.length>1){const ot=gT(Re,Ie,s.vertical||j,l,24,ne);ot&&je(Re,ot)}}else if(t.type==="Polygon")for(const Re of dm(t.geometry,0)){const ot=xT(Re,16);je(Re[0],new qo(ot.x,ot.y,0))}else if(t.type==="LineString")for(const Re of t.geometry)je(Re,new qo(Re[0].x,Re[0].y,0));else if(t.type==="Point")for(const Re of t.geometry)for(const ot of Re)je([ot],new qo(ot.x,ot.y,0))}function w0(i,t,s,l,d,g,_,x,S,I,k,R,L,B,j){const G=function(pe,oe,me,_e,Ie,He,Qe,Ge){const $e=_e.layout.get("text-rotate").evaluate(He,{})*Math.PI/180,Oe=[];for(const Xe of oe.positionedLines)for(const je of Xe.positionedGlyphs){if(!je.rect)continue;const Re=je.rect||{};let ot=Ov+1,tt=!0,xt=1,en=0;const rn=(Ie||Ge)&&je.vertical,qn=je.metrics.advance*je.scale/2;if(Ge&&oe.verticalizable&&(en=Xe.lineOffset/2-(je.imageName?-($n-je.metrics.width*je.scale)/2:(je.scale-1)*$n)),je.imageName){const Hn=Qe[je.imageName];tt=Hn.sdf,xt=Hn.pixelRatio,ot=Xr/xt}const fi=Ie?[je.x+qn,je.y]:[0,0];let Lr=Ie?[0,0]:[je.x+qn+me[0],je.y+me[1]-en],Ln=[0,0];rn&&(Ln=Lr,Lr=[0,0]);const sr=je.metrics.isDoubleResolution?2:1,mr=(je.metrics.left-ot)*je.scale-qn+Lr[0],Fr=(-je.metrics.top-ot)*je.scale+Lr[1],Or=mr+Re.w/sr*je.scale/xt,Gn=Fr+Re.h/sr*je.scale/xt,Zn=new N(mr,Fr),Sr=new N(Or,Fr),Br=new N(mr,Gn),Tr=new N(Or,Gn);if(rn){const Hn=new N(-qn,qn-Ru),Tt=-Math.PI/2,Er=$n/2-qn,gr=new N(5-Ru-Er,-(je.imageName?Er:0)),Wn=new N(...Ln);Zn._rotateAround(Tt,Hn)._add(gr)._add(Wn),Sr._rotateAround(Tt,Hn)._add(gr)._add(Wn),Br._rotateAround(Tt,Hn)._add(gr)._add(Wn),Tr._rotateAround(Tt,Hn)._add(gr)._add(Wn)}if($e){const Hn=Math.sin($e),Tt=Math.cos($e),Er=[Tt,-Hn,Hn,Tt];Zn._matMult(Er),Sr._matMult(Er),Br._matMult(Er),Tr._matMult(Er)}const Yr=new N(0,0),Jr=new N(0,0);Oe.push({tl:Zn,tr:Sr,bl:Br,br:Tr,tex:Re,writingMode:oe.writingMode,glyphOffset:fi,sectionIndex:je.sectionIndex,isSDF:tt,pixelOffsetTL:Yr,pixelOffsetBR:Jr,minFontScaleX:0,minFontScaleY:0})}return Oe}(0,s,x,d,g,_,l,i.allowVerticalPlacement),Q=i.textSizeData;let ne=null;Q.kind==="source"?(ne=[zs*d.layout.get("text-size").evaluate(_,{})],ne[0]>Vo&&Mn(`${i.layerIds[0]}: Value for "text-size" is >= ${Lu}. Reduce your "text-size".`)):Q.kind==="composite"&&(ne=[zs*B.compositeTextSizes[0].evaluate(_,{},j),zs*B.compositeTextSizes[1].evaluate(_,{},j)],(ne[0]>Vo||ne[1]>Vo)&&Mn(`${i.layerIds[0]}: Value for "text-size" is >= ${Lu}. Reduce your "text-size".`)),i.addSymbols(i.text,G,ne,x,g,_,I,t,S.lineStartIndex,S.lineLength,L,j);for(const pe of k)R[pe]=i.text.placedSymbolArray.length-1;return 4*G.length}function b0(i){for(const t in i)return i[t];return null}function ST(i,t,s,l){const d=i.compareText;if(t in d){const g=d[t];for(let _=g.length-1;_>=0;_--)if(l.dist(g[_])<s)return!0}else d[t]=[];return d[t].push(l),!1}const S0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Lm{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(t,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const g=S0[15&l];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[x]=new Uint32Array(t,4,1);return new Lm(x,_,g,t)}constructor(t,s=64,l=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=S0.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,x=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-x%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+x+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=t)}add(t,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=s,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Fm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,s,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:x}=this,S=[0,g.length-1,0],I=[];for(;S.length;){const k=S.pop()||0,R=S.pop()||0,L=S.pop()||0;if(R-L<=x){for(let Q=L;Q<=R;Q++){const ne=_[2*Q],pe=_[2*Q+1];ne>=t&&ne<=l&&pe>=s&&pe<=d&&I.push(g[Q])}continue}const B=L+R>>1,j=_[2*B],G=_[2*B+1];j>=t&&j<=l&&G>=s&&G<=d&&I.push(g[B]),(k===0?t<=j:s<=G)&&(S.push(L),S.push(B-1),S.push(1-k)),(k===0?l>=j:d>=G)&&(S.push(B+1),S.push(R),S.push(1-k))}return I}within(t,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:g,nodeSize:_}=this,x=[0,d.length-1,0],S=[],I=l*l;for(;x.length;){const k=x.pop()||0,R=x.pop()||0,L=x.pop()||0;if(R-L<=_){for(let Q=L;Q<=R;Q++)E0(g[2*Q],g[2*Q+1],t,s)<=I&&S.push(d[Q]);continue}const B=L+R>>1,j=g[2*B],G=g[2*B+1];E0(j,G,t,s)<=I&&S.push(d[B]),(k===0?t-l<=j:s-l<=G)&&(x.push(L),x.push(B-1),x.push(1-k)),(k===0?t+l>=j:s+l>=G)&&(x.push(B+1),x.push(R),x.push(1-k))}return S}}function Fm(i,t,s,l,d,g){if(d-l<=s)return;const _=l+d>>1;T0(i,t,_,l,d,g),Fm(i,t,s,l,_-1,1-g),Fm(i,t,s,_+1,d,1-g)}function T0(i,t,s,l,d,g){for(;d>l;){if(d-l>600){const I=d-l+1,k=s-l+1,R=Math.log(I),L=.5*Math.exp(2*R/3),B=.5*Math.sqrt(R*L*(I-L)/I)*(k-I/2<0?-1:1);T0(i,t,s,Math.max(l,Math.floor(s-k*L/I+B)),Math.min(d,Math.floor(s+(I-k)*L/I+B)),g)}const _=t[2*s+g];let x=l,S=d;for(Ou(i,t,l,s),t[2*d+g]>_&&Ou(i,t,l,d);x<S;){for(Ou(i,t,x,S),x++,S--;t[2*x+g]<_;)x++;for(;t[2*S+g]>_;)S--}t[2*l+g]===_?Ou(i,t,l,S):(S++,Ou(i,t,S,d)),S<=s&&(l=S+1),s<=S&&(d=S-1)}}function Ou(i,t,s,l){Om(i,s,l),Om(t,2*s,2*l),Om(t,2*s+1,2*l+1)}function Om(i,t,s){const l=i[t];i[t]=i[s],i[s]=l}function E0(i,t,s,l){const d=i-s,g=t-l;return d*d+g*g}var Bm;c.bh=void 0,(Bm=c.bh||(c.bh={})).create="create",Bm.load="load",Bm.fullLoad="fullLoad";let $d=null,Bu=[];const Nm=1e3/60,jm="loadTime",Um="fullLoadTime",TT={mark(i){performance.mark(i)},frame(i){const t=i;$d!=null&&Bu.push(t-$d),$d=t},clearMetrics(){$d=null,Bu=[],performance.clearMeasures(jm),performance.clearMeasures(Um);for(const i in c.bh)performance.clearMarks(c.bh[i])},getPerformanceMetrics(){performance.measure(jm,c.bh.create,c.bh.load),performance.measure(Um,c.bh.create,c.bh.fullLoad);const i=performance.getEntriesByName(jm)[0].duration,t=performance.getEntriesByName(Um)[0].duration,s=Bu.length,l=1/(Bu.reduce((g,_)=>g+_,0)/s/1e3),d=Bu.filter(g=>g>Nm).reduce((g,_)=>g+(_-Nm)/Nm,0);return{loadTime:i,fullLoadTime:t,fps:l,percentDroppedFrames:d/(s+d)*100,totalFrames:s}}};c.$=function(i,t,s){var l,d,g,_,x,S,I,k,R,L,B,j,G=s[0],Q=s[1],ne=s[2];return t===i?(i[12]=t[0]*G+t[4]*Q+t[8]*ne+t[12],i[13]=t[1]*G+t[5]*Q+t[9]*ne+t[13],i[14]=t[2]*G+t[6]*Q+t[10]*ne+t[14],i[15]=t[3]*G+t[7]*Q+t[11]*ne+t[15]):(d=t[1],g=t[2],_=t[3],x=t[4],S=t[5],I=t[6],k=t[7],R=t[8],L=t[9],B=t[10],j=t[11],i[0]=l=t[0],i[1]=d,i[2]=g,i[3]=_,i[4]=x,i[5]=S,i[6]=I,i[7]=k,i[8]=R,i[9]=L,i[10]=B,i[11]=j,i[12]=l*G+x*Q+R*ne+t[12],i[13]=d*G+S*Q+L*ne+t[13],i[14]=g*G+I*Q+B*ne+t[14],i[15]=_*G+k*Q+j*ne+t[15]),i},c.A=Ol,c.B=Gr,c.C=class{constructor(i,t,s){this.receive=l=>{const d=l.data,g=d.id;if(g&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[g];const _=this.cancelCallbacks[g];delete this.cancelCallbacks[g],_&&_()}else tn()||d.mustQueue?(this.tasks[g]=d,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,d)},this.process=()=>{if(!this.taskQueue.length)return;const l=this.taskQueue.shift(),d=this.tasks[l];delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(l,d)},this.target=i,this.parent=t,this.mapId=s,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new fT(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=tn()?i:window}send(i,t,s,l,d=!1){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(this.callbacks[g]=s);const _=[],x={id:g,type:i,hasCallback:!!s,targetMapId:l,mustQueue:d,sourceMapId:this.mapId,data:Ps(t,_)};return this.target.postMessage(x,{transfer:_}),{cancel:()=>{s&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}processTask(i,t){if(t.type==="<response>"){const s=this.callbacks[i];delete this.callbacks[i],s&&(t.error?s(Fo(t.error)):s(null,Fo(t.data)))}else{let s=!1;const l=[],d=t.hasCallback?(x,S)=>{s=!0,delete this.cancelCallbacks[i];const I={id:i,type:"<response>",sourceMapId:this.mapId,error:x?Ps(x):null,data:Ps(S,l)};this.target.postMessage(I,{transfer:l})}:x=>{s=!0};let g=null;const _=Fo(t.data);if(this.parent[t.type])g=this.parent[t.type](t.sourceMapId,_,d);else if("getWorkerSource"in this.parent){const x=t.type.split(".");g=this.parent.getWorkerSource(t.sourceMapId,x[0],_.source)[x[1]](_,d)}else d(new Error(`Could not find function ${t.type}`));!s&&g&&g.cancel&&(this.cancelCallbacks[i]=g.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},c.D=nt,c.E=Gs,c.F=function(i,t){const s={};for(let l=0;l<t.length;l++){const d=t[l];d in i&&(s[d]=i[d])}return s},c.G=Qv,c.H=e0,c.I=bm,c.J=Y,c.K=se,c.L=$o,c.M=jt,c.N=Dn,c.O=Ei,c.P=N,c.Q=ln,c.R=Ti,c.S=Qt,c.T=_d,c.U=Bd,c.V=class extends to{},c.W=zm,c.X=function(i,t){const s=window.document.createElement("video");s.muted=!0,s.onloadstart=function(){t(null,s)};for(let l=0;l<i.length;l++){const d=window.document.createElement("source");Qi(i[l])||(s.crossOrigin="Anonymous"),d.src=i[l],s.appendChild(d)}return{cancel:()=>{}}},c.Y=Be,c.Z=function(){var i=new Ol(16);return Ol!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},c._=z,c.a=dt,c.a$=class extends O{},c.a0=function(i,t,s){var l=s[0],d=s[1],g=s[2];return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i[3]=t[3]*l,i[4]=t[4]*d,i[5]=t[5]*d,i[6]=t[6]*d,i[7]=t[7]*d,i[8]=t[8]*g,i[9]=t[9]*g,i[10]=t[10]*g,i[11]=t[11]*g,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},c.a1=iv,c.a2=function(){return Gt++},c.a3=K,c.a4=$l,c.a5=function(){Wr.isLoading()||Wr.isLoaded()||du()!=="deferred"||yd()},c.a6=tu,c.a7=Oa,c.a8=Jt,c.a9=a0,c.aA=Ma,c.aB=function(i){i=i.slice();const t=Object.create(null);for(let s=0;s<i.length;s++)t[i[s].id]=i[s];for(let s=0;s<i.length;s++)"ref"in i[s]&&(i[s]=oi(i[s],t[i[s].ref]));return i},c.aC=function(i){if(i.type==="custom")return new pT(i);switch(i.type){case"background":return new uT(i);case"circle":return new K2(i);case"fill":return new mS(i);case"fill-extrusion":return new AS(i);case"heatmap":return new Y2(i);case"hillshade":return new Q2(i);case"line":return new BS(i);case"raster":return new dT(i);case"symbol":return new Od(i)}},c.aD=Nn,c.aE=function(i,t){if(!i)return[{command:Mt.setStyle,args:[t]}];let s=[];try{if(!Ht(i.version,t.version))return[{command:Mt.setStyle,args:[t]}];Ht(i.center,t.center)||s.push({command:Mt.setCenter,args:[t.center]}),Ht(i.zoom,t.zoom)||s.push({command:Mt.setZoom,args:[t.zoom]}),Ht(i.bearing,t.bearing)||s.push({command:Mt.setBearing,args:[t.bearing]}),Ht(i.pitch,t.pitch)||s.push({command:Mt.setPitch,args:[t.pitch]}),Ht(i.sprite,t.sprite)||s.push({command:Mt.setSprite,args:[t.sprite]}),Ht(i.glyphs,t.glyphs)||s.push({command:Mt.setGlyphs,args:[t.glyphs]}),Ht(i.transition,t.transition)||s.push({command:Mt.setTransition,args:[t.transition]}),Ht(i.light,t.light)||s.push({command:Mt.setLight,args:[t.light]});const l={},d=[];(function(_,x,S,I){let k;for(k in x=x||{},_=_||{})Object.prototype.hasOwnProperty.call(_,k)&&(Object.prototype.hasOwnProperty.call(x,k)||To(k,S,I));for(k in x)Object.prototype.hasOwnProperty.call(x,k)&&(Object.prototype.hasOwnProperty.call(_,k)?Ht(_[k],x[k])||(_[k].type==="geojson"&&x[k].type==="geojson"&&ol(_,x,k)?S.push({command:Mt.setGeoJSONSourceData,args:[k,x[k].data]}):es(k,x,S,I)):Di(k,x,S))})(i.sources,t.sources,d,l);const g=[];i.layers&&i.layers.forEach(_=>{l[_.source]?s.push({command:Mt.removeLayer,args:[_.id]}):g.push(_)}),s=s.concat(d),function(_,x,S){x=x||[];const I=(_=_||[]).map(Ts),k=x.map(Ts),R=_.reduce(Zs,{}),L=x.reduce(Zs,{}),B=I.slice(),j=Object.create(null);let G,Q,ne,pe,oe,me,_e;for(G=0,Q=0;G<I.length;G++)ne=I[G],Object.prototype.hasOwnProperty.call(L,ne)?Q++:(S.push({command:Mt.removeLayer,args:[ne]}),B.splice(B.indexOf(ne,Q),1));for(G=0,Q=0;G<k.length;G++)ne=k[k.length-1-G],B[B.length-1-G]!==ne&&(Object.prototype.hasOwnProperty.call(R,ne)?(S.push({command:Mt.removeLayer,args:[ne]}),B.splice(B.lastIndexOf(ne,B.length-Q),1)):Q++,me=B[B.length-G],S.push({command:Mt.addLayer,args:[L[ne],me]}),B.splice(B.length-G,0,ne),j[ne]=!0);for(G=0;G<k.length;G++)if(ne=k[G],pe=R[ne],oe=L[ne],!j[ne]&&!Ht(pe,oe))if(Ht(pe.source,oe.source)&&Ht(pe["source-layer"],oe["source-layer"])&&Ht(pe.type,oe.type)){for(_e in Eo(pe.layout,oe.layout,S,ne,null,Mt.setLayoutProperty),Eo(pe.paint,oe.paint,S,ne,null,Mt.setPaintProperty),Ht(pe.filter,oe.filter)||S.push({command:Mt.setFilter,args:[ne,oe.filter]}),Ht(pe.minzoom,oe.minzoom)&&Ht(pe.maxzoom,oe.maxzoom)||S.push({command:Mt.setLayerZoomRange,args:[ne,oe.minzoom,oe.maxzoom]}),pe)Object.prototype.hasOwnProperty.call(pe,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Eo(pe[_e],oe[_e],S,ne,_e.slice(6),Mt.setPaintProperty):Ht(pe[_e],oe[_e])||S.push({command:Mt.setLayerProperty,args:[ne,_e,oe[_e]]}));for(_e in oe)Object.prototype.hasOwnProperty.call(oe,_e)&&!Object.prototype.hasOwnProperty.call(pe,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Eo(pe[_e],oe[_e],S,ne,_e.slice(6),Mt.setPaintProperty):Ht(pe[_e],oe[_e])||S.push({command:Mt.setLayerProperty,args:[ne,_e,oe[_e]]}))}else S.push({command:Mt.removeLayer,args:[ne]}),me=B[B.lastIndexOf(ne)+1],S.push({command:Mt.addLayer,args:[oe,me]})}(g,t.layers,s)}catch(l){console.warn("Unable to compute style diff:",l),s=[{command:Mt.setStyle,args:[t]}]}return s},c.aF=function(i){const t=[],s=i.id;return s===void 0&&t.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),t},c.aG=function i(t,s){if(Array.isArray(t)){if(!Array.isArray(s)||t.length!==s.length)return!1;for(let l=0;l<t.length;l++)if(!i(t[l],s[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&s!==null){if(typeof s!="object"||Object.keys(t).length!==Object.keys(s).length)return!1;for(const l in t)if(!i(t[l],s[l]))return!1;return!0}return t===s},c.aH=it,c.aI=An,c.aJ=za,c.aK=function(i){return i({pluginStatus:zr,pluginURL:As}),za.on("pluginStateChange",i),i},c.aL=class extends io{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},c.aM=Ll,c.aN=class extends io{constructor(i,t){super(i,t),this.current=em}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},c.aO=bd,c.aP=class extends io{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},c.aQ=class extends io{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},c.aR=Sd,c.aS=function(i,t,s,l,d,g,_){var x=1/(t-s),S=1/(l-d),I=1/(g-_);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*I,i[11]=0,i[12]=(t+s)*x,i[13]=(d+l)*S,i[14]=(_+g)*I,i[15]=1,i},c.aT=Ut,c.aU=W2,c.aV=class extends h{},c.aW=VS,c.aX=class extends y{},c.aY=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},c.aZ=cv,c.a_=Le,c.aa=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,d,g)=>{const _=d||g;return t[l]=!_||_.toLowerCase(),""}),t["max-age"]){const s=parseInt(t["max-age"],10);isNaN(s)?delete t["max-age"]:t["max-age"]=s}return t},c.ab=function(i,t){const s=[];for(const l in i)l in t||s.push(l);return s},c.ac=function(i){if(We==null){const t=i.navigator?i.navigator.userAgent:null;We=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return We},c.ad=Fe,c.ae=function(i,t,s){var l=Math.sin(s),d=Math.cos(s),g=t[0],_=t[1],x=t[2],S=t[3],I=t[4],k=t[5],R=t[6],L=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=g*d+I*l,i[1]=_*d+k*l,i[2]=x*d+R*l,i[3]=S*d+L*l,i[4]=I*d-g*l,i[5]=k*d-_*l,i[6]=R*d-x*l,i[7]=L*d-S*l,i},c.af=function(i){var t=new Ol(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},c.ag=Cd,c.ah=function(i,t){let s=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:d,minZoom:g,maxZoom:_}=i,x=d?Fe(Zr.interpolationFactor(d,t,g,_),0,1):0;i.kind==="camera"?l=Gr.number(i.minSize,i.maxSize,x):s=x}return{uSizeT:s,uSize:l}},c.aj=function(i,{uSize:t,uSizeT:s},{lowerSize:l,upperSize:d}){return i.kind==="source"?l/zs:i.kind==="composite"?Gr.number(l/zs,d/zs,s):t},c.ak=Im,c.al=function(i,t,s,l){const d=t.y-i.y,g=t.x-i.x,_=l.y-s.y,x=l.x-s.x,S=_*g-x*d;if(S===0)return null;const I=(x*(i.y-s.y)-_*(i.x-s.x))/S;return new N(i.x+I*g,i.y+I*d)},c.am=h0,c.an=J_,c.ao=sm,c.ap=$n,c.ar=Em,c.as=function(i,t){var s=t[0],l=t[1],d=t[2],g=t[3],_=t[4],x=t[5],S=t[6],I=t[7],k=t[8],R=t[9],L=t[10],B=t[11],j=t[12],G=t[13],Q=t[14],ne=t[15],pe=s*x-l*_,oe=s*S-d*_,me=s*I-g*_,_e=l*S-d*x,Ie=l*I-g*x,He=d*I-g*S,Qe=k*G-R*j,Ge=k*Q-L*j,$e=k*ne-B*j,Oe=R*Q-L*G,Xe=R*ne-B*G,je=L*ne-B*Q,Re=pe*je-oe*Xe+me*Oe+_e*$e-Ie*Ge+He*Qe;return Re?(i[0]=(x*je-S*Xe+I*Oe)*(Re=1/Re),i[1]=(d*Xe-l*je-g*Oe)*Re,i[2]=(G*He-Q*Ie+ne*_e)*Re,i[3]=(L*Ie-R*He-B*_e)*Re,i[4]=(S*$e-_*je-I*Ge)*Re,i[5]=(s*je-d*$e+g*Ge)*Re,i[6]=(Q*me-j*He-ne*oe)*Re,i[7]=(k*He-L*me+B*oe)*Re,i[8]=(_*Xe-x*$e+I*Qe)*Re,i[9]=(l*$e-s*Xe-g*Qe)*Re,i[10]=(j*Ie-G*me+ne*pe)*Re,i[11]=(R*me-k*Ie-B*pe)*Re,i[12]=(x*Ge-_*Oe-S*Qe)*Re,i[13]=(s*Oe-l*Ge+d*Qe)*Re,i[14]=(G*oe-j*_e-Q*pe)*Re,i[15]=(k*_e-R*oe+L*pe)*Re,i):null},c.at=Dm,c.au=Tm,c.av=Lm,c.aw=function(){const i={},t=be.$version;for(const s in be.$root){const l=be.$root[s];if(l.required){let d=null;d=s==="version"?t:l.type==="array"?[]:{},d!=null&&(i[s]=d)}}return i},c.ax=Mt,c.ay=pd,c.az=ur,c.b=function(i,t){const s=new Blob([new Uint8Array(i)],{type:"image/png"});createImageBitmap(s).then(l=>{t(null,l)}).catch(l=>{t(new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},c.b0=rr,c.b1=function(i,t){var s=i[0],l=i[1],d=i[2],g=i[3],_=i[4],x=i[5],S=i[6],I=i[7],k=i[8],R=i[9],L=i[10],B=i[11],j=i[12],G=i[13],Q=i[14],ne=i[15],pe=t[0],oe=t[1],me=t[2],_e=t[3],Ie=t[4],He=t[5],Qe=t[6],Ge=t[7],$e=t[8],Oe=t[9],Xe=t[10],je=t[11],Re=t[12],ot=t[13],tt=t[14],xt=t[15];return Math.abs(s-pe)<=Dr*Math.max(1,Math.abs(s),Math.abs(pe))&&Math.abs(l-oe)<=Dr*Math.max(1,Math.abs(l),Math.abs(oe))&&Math.abs(d-me)<=Dr*Math.max(1,Math.abs(d),Math.abs(me))&&Math.abs(g-_e)<=Dr*Math.max(1,Math.abs(g),Math.abs(_e))&&Math.abs(_-Ie)<=Dr*Math.max(1,Math.abs(_),Math.abs(Ie))&&Math.abs(x-He)<=Dr*Math.max(1,Math.abs(x),Math.abs(He))&&Math.abs(S-Qe)<=Dr*Math.max(1,Math.abs(S),Math.abs(Qe))&&Math.abs(I-Ge)<=Dr*Math.max(1,Math.abs(I),Math.abs(Ge))&&Math.abs(k-$e)<=Dr*Math.max(1,Math.abs(k),Math.abs($e))&&Math.abs(R-Oe)<=Dr*Math.max(1,Math.abs(R),Math.abs(Oe))&&Math.abs(L-Xe)<=Dr*Math.max(1,Math.abs(L),Math.abs(Xe))&&Math.abs(B-je)<=Dr*Math.max(1,Math.abs(B),Math.abs(je))&&Math.abs(j-Re)<=Dr*Math.max(1,Math.abs(j),Math.abs(Re))&&Math.abs(G-ot)<=Dr*Math.max(1,Math.abs(G),Math.abs(ot))&&Math.abs(Q-tt)<=Dr*Math.max(1,Math.abs(Q),Math.abs(tt))&&Math.abs(ne-xt)<=Dr*Math.max(1,Math.abs(ne),Math.abs(xt))},c.b2=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},c.b3=function(i,t,s){return i[0]=t[0]*s[0],i[1]=t[1]*s[1],i[2]=t[2]*s[2],i[3]=t[3]*s[3],i},c.b4=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},c.b5=De,c.b6=i0,c.b7=t0,c.b8=function(i,t,s,l,d){var g,_=1/Math.tan(t/2);return i[0]=_/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,d!=null&&d!==1/0?(i[10]=(d+l)*(g=1/(l-d)),i[14]=2*d*l*g):(i[10]=-1,i[14]=-2*l),i},c.b9=function(i,t,s){var l=Math.sin(s),d=Math.cos(s),g=t[4],_=t[5],x=t[6],S=t[7],I=t[8],k=t[9],R=t[10],L=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=g*d+I*l,i[5]=_*d+k*l,i[6]=x*d+R*l,i[7]=S*d+L*l,i[8]=I*d-g*l,i[9]=k*d-_*l,i[10]=R*d-x*l,i[11]=L*d-S*l,i},c.bA=V,c.bB=Av,c.bC=Tl,c.bD=Wr,c.ba=xe,c.bb=Ae,c.bc=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},c.bd=class extends La{},c.be=Am,c.bf=n0,c.bg=TT,c.bi=si,c.bj=function(i,t,s=!1){if(zr===au||zr===lu||zr===cu)throw new Error("setRTLTextPlugin cannot be called multiple times.");As=zn.resolveURL(i),zr=au,uu=t,hu(),s||yd()},c.bk=du,c.bl=function(i,t){const s={};for(let d=0;d<i.length;d++){const g=t&&t[i[d].id]||kl(i[d]);t&&(t[i[d].id]=g);let _=s[g];_||(_=s[g]=[]),_.push(i[d])}const l=[];for(const d in s)l.push(s[d]);return l},c.bm=Ke,c.bn=o0,c.bo=l0,c.bp=Nv,c.bq=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Dn/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],s=t.layout,l=t._unevaluatedLayout._values,d={layoutIconSize:l["icon-size"].possiblyEvaluate(new Jt(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Jt(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Jt(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:k}=i.bucket.textSizeData;d.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Jt(I),i.canonical),l["text-size"].possiblyEvaluate(new Jt(k),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:k}=i.bucket.iconSizeData;d.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Jt(I),i.canonical),l["icon-size"].possiblyEvaluate(new Jt(k),i.canonical)]}const g=s.get("text-line-height")*$n,_=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",x=s.get("text-keep-upright"),S=s.get("text-size");for(const I of i.bucket.features){const k=s.get("text-font").evaluate(I,{},i.canonical).join(","),R=S.evaluate(I,{},i.canonical),L=d.layoutTextSize.evaluate(I,{},i.canonical),B=d.layoutIconSize.evaluate(I,{},i.canonical),j={horizontal:{},vertical:void 0},G=I.text;let Q,ne=[0,0];if(G){const me=G.toString(),_e=s.get("text-letter-spacing").evaluate(I,{},i.canonical)*$n,Ie=su(me)?_e:0,He=s.get("text-anchor").evaluate(I,{},i.canonical),Qe=x0(t,I,i.canonical);if(!Qe){const je=s.get("text-radial-offset").evaluate(I,{},i.canonical);ne=je?v0(He,[je*$n,Rm]):s.get("text-offset").evaluate(I,{},i.canonical).map(Re=>Re*$n)}let Ge=_?"center":s.get("text-justify").evaluate(I,{},i.canonical);const $e=s.get("symbol-placement"),Oe=$e==="point"?s.get("text-max-width").evaluate(I,{},i.canonical)*$n:0,Xe=()=>{i.bucket.allowVerticalPlacement&&iu(me)&&(j.vertical=Dd(G,i.glyphMap,i.glyphPositions,i.imagePositions,k,Oe,g,He,"left",Ie,ne,c.ai.vertical,!0,$e,L,R))};if(!_&&Qe){const je=new Set;if(Ge==="auto")for(let ot=0;ot<Qe.values.length;ot+=2)je.add(Dm(Qe.values[ot]));else je.add(Ge);let Re=!1;for(const ot of je)if(!j.horizontal[ot])if(Re)j.horizontal[ot]=j.horizontal[0];else{const tt=Dd(G,i.glyphMap,i.glyphPositions,i.imagePositions,k,Oe,g,"center",ot,Ie,ne,c.ai.horizontal,!1,$e,L,R);tt&&(j.horizontal[ot]=tt,Re=tt.positionedLines.length===1)}Xe()}else{Ge==="auto"&&(Ge=Dm(He));const je=Dd(G,i.glyphMap,i.glyphPositions,i.imagePositions,k,Oe,g,He,Ge,Ie,ne,c.ai.horizontal,!1,$e,L,R);je&&(j.horizontal[Ge]=je),Xe(),iu(me)&&_&&x&&(j.vertical=Dd(G,i.glyphMap,i.glyphPositions,i.imagePositions,k,Oe,g,He,Ge,Ie,ne,c.ai.vertical,!1,$e,L,R))}}let pe=!1;if(I.icon&&I.icon.name){const me=i.imageMap[I.icon.name];me&&(Q=sT(i.imagePositions[I.icon.name],s.get("icon-offset").evaluate(I,{},i.canonical),s.get("icon-anchor").evaluate(I,{},i.canonical)),pe=!!me.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=pe:i.bucket.sdfIcons!==pe&&Mn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(me.pixelRatio!==i.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const oe=b0(j.horizontal)||j.vertical;i.bucket.iconsInText=!!oe&&oe.iconsInText,(oe||Q)&&bT(i.bucket,I,j,Q,i.imageMap,d,L,B,ne,pe,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},c.br=_m,c.bs=mm,c.bt=ym,c.bu=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},c.bv=xm,c.bw=jo,c.bx=function(i,t,s,l,d){return z(this,void 0,void 0,function*(){if(se())try{return yield jt(i,t,s,l,d)}catch{}return function(g,_,x,S,I){const k=g.width,R=g.height;Rt&&Pt||(Rt=new OffscreenCanvas(k,R),Pt=Rt.getContext("2d",{willReadFrequently:!0})),Rt.width=k,Rt.height=R,Pt.drawImage(g,0,0,k,R);const L=Pt.getImageData(_,x,S,I);return Pt.clearRect(0,0,k,R),L.data}(i,t,s,l,d)})},c.by=s0,c.bz=P,c.c=jn,c.d=function(i,t){const s=new Image;s.onload=()=>{t(null,s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=pt})},s.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const l=new Blob([new Uint8Array(i)],{type:"image/png"});s.src=i.byteLength?URL.createObjectURL(l):pt},c.e=qe,c.f=function(i,t){return ws(qe(i,{type:"json"}),t)},c.g=bn,c.h=zn,c.i=tn,c.j=Ss,c.k=bs,c.l=va,c.m=ws,c.n=function(i){return new xm(i).readFields(QS,[])},c.o=function(i,t,s){if(!i.length)return s(null,[]);let l=i.length;const d=new Array(i.length);let g=null;i.forEach((_,x)=>{t(_,(S,I)=>{S&&(g=S),d[x]=I,--l==0&&s(g,d)})})},c.p=Bv,c.q=Eu,c.r=Sn,c.s=Qi,c.t=Xf,c.u=Ze,c.v=be,c.w=Mn,c.x=Ml,c.y=os,c.z=function([i,t,s]){return t+=90,t*=Math.PI/180,s*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(s),y:i*Math.sin(t)*Math.sin(s),z:i*Math.cos(s)}}}),v(["./shared"],function(c){class z{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,F){for(const J of D){this._layerConfigs[J.id]=J;const ee=this._layers[J.id]=c.aC(J);ee._featureFilter=c.a6(ee.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of F)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const $=c.bl(Object.values(this._layerConfigs),this.keyCache);for(const J of $){const ee=J.map(Te=>this._layers[Te.id]),fe=ee[0];if(fe.visibility==="none")continue;const ae=fe.source||"";let re=this.familiesBySource[ae];re||(re=this.familiesBySource[ae]={});const de=fe.sourceLayer||"_geojsonTileLayer";let Se=re[de];Se||(Se=re[de]=[]),Se.push(ee)}}}class P{constructor(D){const F={},$=[];for(const ae in D){const re=D[ae],de=F[ae]={};for(const Se in re){const Te=re[+Se];if(!Te||Te.bitmap.width===0||Te.bitmap.height===0)continue;const Ce={x:0,y:0,w:Te.bitmap.width+2,h:Te.bitmap.height+2};$.push(Ce),de[Se]={rect:Ce,metrics:Te.metrics}}}const{w:J,h:ee}=c.p($),fe=new c.q({width:J||1,height:ee||1});for(const ae in D){const re=D[ae];for(const de in re){const Se=re[+de];if(!Se||Se.bitmap.width===0||Se.bitmap.height===0)continue;const Te=F[ae][de].rect;c.q.copy(Se.bitmap,fe,{x:0,y:0},{x:Te.x+1,y:Te.y+1},Se.bitmap)}}this.image=fe,this.positions=F}}c.bm("GlyphAtlas",P);class V{constructor(D){this.tileID=new c.O(D.tileID.overscaledZ,D.tileID.wrap,D.tileID.canonical.z,D.tileID.canonical.x,D.tileID.canonical.y),this.uid=D.uid,this.zoom=D.zoom,this.pixelRatio=D.pixelRatio,this.tileSize=D.tileSize,this.source=D.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=D.showCollisionBoxes,this.collectResourceTiming=!!D.collectResourceTiming,this.returnDependencies=!!D.returnDependencies,this.promoteId=D.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(D,F,$,J,ee){this.status="parsing",this.data=D,this.collisionBoxArray=new c.a3;const fe=new c.bn(Object.keys(D.layers).sort()),ae=new c.bo(this.tileID,this.promoteId);ae.bucketLayerIDs=[];const re={},de={featureIndex:ae,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$},Se=F.familiesBySource[this.source];for(const At in Se){const kt=D.layers[At];if(!kt)continue;kt.version===1&&c.w(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const hr=fe.encode(At),Kt=[];for(let Rn=0;Rn<kt.length;Rn++){const tr=kt.feature(Rn),ai=ae.getId(tr,At);Kt.push({feature:tr,id:ai,index:Rn,sourceLayerIndex:hr})}for(const Rn of Se[At]){const tr=Rn[0];tr.source!==this.source&&c.w(`layer.source = ${tr.source} does not equal this.source = ${this.source}`),tr.minzoom&&this.zoom<Math.floor(tr.minzoom)||tr.maxzoom&&this.zoom>=tr.maxzoom||tr.visibility!=="none"&&(U(Rn,this.zoom,$),(re[tr.id]=tr.createBucket({index:ae.bucketLayerIDs.length,layers:Rn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:hr,sourceID:this.source})).populate(Kt,de,this.tileID.canonical),ae.bucketLayerIDs.push(Rn.map(ai=>ai.id)))}}let Te,Ce,st,ft;const Ye=c.aH(de.glyphDependencies,At=>Object.keys(At).map(Number));this.inFlightDependencies.forEach(At=>At==null?void 0:At.cancel()),this.inFlightDependencies=[];const at=++this.dependencySentinel;Object.keys(Ye).length?this.inFlightDependencies.push(J.send("getGlyphs",{uid:this.uid,stacks:Ye,source:this.source,tileID:this.tileID,type:"glyphs"},(At,kt)=>{at===this.dependencySentinel&&(Te||(Te=At,Ce=kt,$t.call(this)))})):Ce={};const gt=Object.keys(de.iconDependencies);gt.length?this.inFlightDependencies.push(J.send("getImages",{icons:gt,source:this.source,tileID:this.tileID,type:"icons"},(At,kt)=>{at===this.dependencySentinel&&(Te||(Te=At,st=kt,$t.call(this)))})):st={};const Ot=Object.keys(de.patternDependencies);function $t(){if(Te)return ee(Te);if(Ce&&st&&ft){const At=new P(Ce),kt=new c.bp(st,ft);for(const hr in re){const Kt=re[hr];Kt instanceof c.a4?(U(Kt.layers,this.zoom,$),c.bq({bucket:Kt,glyphMap:Ce,glyphPositions:At.positions,imageMap:st,imagePositions:kt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Kt.hasPattern&&(Kt instanceof c.br||Kt instanceof c.bs||Kt instanceof c.bt)&&(U(Kt.layers,this.zoom,$),Kt.addFeatures(de,this.tileID.canonical,kt.patternPositions))}this.status="done",ee(null,{buckets:Object.values(re).filter(hr=>!hr.isEmpty()),featureIndex:ae,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:At.image,imageAtlas:kt,glyphMap:this.returnDependencies?Ce:null,iconMap:this.returnDependencies?st:null,glyphPositions:this.returnDependencies?At.positions:null})}}Ot.length?this.inFlightDependencies.push(J.send("getImages",{icons:Ot,source:this.source,tileID:this.tileID,type:"patterns"},(At,kt)=>{at===this.dependencySentinel&&(Te||(Te=At,ft=kt,$t.call(this)))})):ft={},$t.call(this)}}function U(W,D,F){const $=new c.a8(D);for(const J of W)J.recalculate($,F)}function N(W,D){const F=c.l(W.request,($,J,ee,fe)=>{if($)D($);else if(J)try{const ae=new c.bw.VectorTile(new c.bv(J));D(null,{vectorTile:ae,rawData:J,cacheControl:ee,expires:fe})}catch(ae){const re=new Uint8Array(J);let de=`Unable to parse the tile at ${W.request.url}, `;de+=re[0]===31&&re[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ae.messge}`,D(new Error(de))}});return()=>{F.cancel(),D()}}class le{constructor(D,F,$,J){this.actor=D,this.layerIndex=F,this.availableImages=$,this.loadVectorData=J||N,this.fetching={},this.loading={},this.loaded={}}loadTile(D,F){const $=D.uid;this.loading||(this.loading={});const J=!!(D&&D.request&&D.request.collectResourceTiming)&&new c.bu(D.request),ee=this.loading[$]=new V(D);ee.abort=this.loadVectorData(D,(fe,ae)=>{if(delete this.loading[$],fe||!ae)return ee.status="done",this.loaded[$]=ee,F(fe);const re=ae.rawData,de={};ae.expires&&(de.expires=ae.expires),ae.cacheControl&&(de.cacheControl=ae.cacheControl);const Se={};if(J){const Te=J.finish();Te&&(Se.resourceTiming=JSON.parse(JSON.stringify(Te)))}ee.vectorTile=ae.vectorTile,ee.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,(Te,Ce)=>{if(delete this.fetching[$],Te||!Ce)return F(Te);F(null,c.e({rawTileData:re.slice(0)},Ce,de,Se))}),this.loaded=this.loaded||{},this.loaded[$]=ee,this.fetching[$]={rawTileData:re,cacheControl:de,resourceTiming:Se}})}reloadTile(D,F){const $=this.loaded,J=D.uid;if($&&$[J]){const ee=$[J];ee.showCollisionBoxes=D.showCollisionBoxes,ee.status==="parsing"?ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,(fe,ae)=>{if(fe||!ae)return F(fe,ae);let re;if(this.fetching[J]){const{rawTileData:de,cacheControl:Se,resourceTiming:Te}=this.fetching[J];delete this.fetching[J],re=c.e({rawTileData:de.slice(0)},ae,Se,Te)}else re=ae;F(null,re)}):ee.status==="done"&&(ee.vectorTile?ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,F):F())}}abortTile(D,F){const $=this.loading,J=D.uid;$&&$[J]&&$[J].abort&&($[J].abort(),delete $[J]),F()}removeTile(D,F){const $=this.loaded,J=D.uid;$&&$[J]&&delete $[J],F()}}class ie{constructor(){this.loaded={}}loadTile(D,F){return c._(this,void 0,void 0,function*(){const{uid:$,encoding:J,rawImageData:ee,redFactor:fe,greenFactor:ae,blueFactor:re,baseShift:de}=D,Se=ee.width+2,Te=ee.height+2,Ce=c.a(ee)?new c.R({width:Se,height:Te},yield c.bx(ee,-1,-1,Se,Te)):ee,st=new c.by($,Ce,J,fe,ae,re,de);this.loaded=this.loaded||{},this.loaded[$]=st,F(null,st)})}removeTile(D){const F=this.loaded,$=D.uid;F&&F[$]&&delete F[$]}}function ge(W,D){if(W.length!==0){Me(W[0],D);for(var F=1;F<W.length;F++)Me(W[F],!D)}}function Me(W,D){for(var F=0,$=0,J=0,ee=W.length,fe=ee-1;J<ee;fe=J++){var ae=(W[J][0]-W[fe][0])*(W[fe][1]+W[J][1]),re=F+ae;$+=Math.abs(F)>=Math.abs(ae)?F-re+ae:ae-re+F,F=re}F+$>=0!=!!D&&W.reverse()}var X=c.bz(function W(D,F){var $,J=D&&D.type;if(J==="FeatureCollection")for($=0;$<D.features.length;$++)W(D.features[$],F);else if(J==="GeometryCollection")for($=0;$<D.geometries.length;$++)W(D.geometries[$],F);else if(J==="Feature")W(D.geometry,F);else if(J==="Polygon")ge(D.coordinates,F);else if(J==="MultiPolygon")for($=0;$<D.coordinates.length;$++)ge(D.coordinates[$],F);return D});const Y=c.bw.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},xe=c.bA,Ae=c.bw.VectorTileFeature,Fe=De;function De(W,D){this.options=D||{},this.features=W,this.length=W.length}function qe(W,D){this.id=typeof W.id=="number"?W.id:void 0,this.type=W.type,this.rawGeometry=W.type===1?[W.geometry]:W.geometry,this.properties=W.tags,this.extent=D||4096}De.prototype.feature=function(W){return new qe(this.features[W],this.options.extent)},qe.prototype.loadGeometry=function(){var W=this.rawGeometry;this.geometry=[];for(var D=0;D<W.length;D++){for(var F=W[D],$=[],J=0;J<F.length;J++)$.push(new xe(F[J][0],F[J][1]));this.geometry.push($)}return this.geometry},qe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var W=this.geometry,D=1/0,F=-1/0,$=1/0,J=-1/0,ee=0;ee<W.length;ee++)for(var fe=W[ee],ae=0;ae<fe.length;ae++){var re=fe[ae];D=Math.min(D,re.x),F=Math.max(F,re.x),$=Math.min($,re.y),J=Math.max(J,re.y)}return[D,$,F,J]},qe.prototype.toGeoJSON=Ae.prototype.toGeoJSON;var Gt=c.bB,it=Fe;function An(W){var D=new Gt;return function(F,$){for(var J in F.layers)$.writeMessage(3,Nn,F.layers[J])}(W,D),D.finish()}function Nn(W,D){var F;D.writeVarintField(15,W.version||1),D.writeStringField(1,W.name||""),D.writeVarintField(5,W.extent||4096);var $={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<W.length;F++)$.feature=W.feature(F),D.writeMessage(2,lr,$);var J=$.keys;for(F=0;F<J.length;F++)D.writeStringField(3,J[F]);var ee=$.values;for(F=0;F<ee.length;F++)D.writeMessage(4,We,ee[F])}function lr(W,D){var F=W.feature;F.id!==void 0&&D.writeVarintField(1,F.id),D.writeMessage(2,Mn,W),D.writeVarintField(3,F.type),D.writeMessage(4,tn,F)}function Mn(W,D){var F=W.feature,$=W.keys,J=W.values,ee=W.keycache,fe=W.valuecache;for(var ae in F.properties){var re=F.properties[ae],de=ee[ae];if(re!==null){de===void 0&&($.push(ae),ee[ae]=de=$.length-1),D.writeVarint(de);var Se=typeof re;Se!=="string"&&Se!=="boolean"&&Se!=="number"&&(re=JSON.stringify(re));var Te=Se+":"+re,Ce=fe[Te];Ce===void 0&&(J.push(re),fe[Te]=Ce=J.length-1),D.writeVarint(Ce)}}}function Qn(W,D){return(D<<3)+(7&W)}function er(W){return W<<1^W>>31}function tn(W,D){for(var F=W.loadGeometry(),$=W.type,J=0,ee=0,fe=F.length,ae=0;ae<fe;ae++){var re=F[ae],de=1;$===1&&(de=re.length),D.writeVarint(Qn(1,de));for(var Se=$===3?re.length-1:re.length,Te=0;Te<Se;Te++){Te===1&&$!==1&&D.writeVarint(Qn(2,Se-1));var Ce=re[Te].x-J,st=re[Te].y-ee;D.writeVarint(er(Ce)),D.writeVarint(er(st)),J+=Ce,ee+=st}$===3&&D.writeVarint(Qn(7,1))}}function We(W,D){var F=typeof W;F==="string"?D.writeStringField(1,W):F==="boolean"?D.writeBooleanField(7,W):F==="number"&&(W%1!=0?D.writeDoubleField(3,W):W<0?D.writeSVarintField(6,W):D.writeVarintField(5,W))}se.exports=An,se.exports.fromVectorTileJs=An,se.exports.fromGeojsonVt=function(W,D){D=D||{};var F={};for(var $ in W)F[$]=new it(W[$].features,D),F[$].name=$,F[$].version=D.version,F[$].extent=D.extent;return An({layers:F})},se.exports.GeoJSONWrapper=it;var dt=c.bz(se.exports);const pt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:W=>W},jt=Math.fround||(Rt=new Float32Array(1),W=>(Rt[0]=+W,Rt[0]));var Rt;const Pt=3,Zt=5,cr=6;class zn{constructor(D){this.options=Object.assign(Object.create(pt),D),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(D){const{log:F,minZoom:$,maxZoom:J}=this.options;F&&console.time("total time");const ee=`prepare ${D.length} points`;F&&console.time(ee),this.points=D;const fe=[];for(let re=0;re<D.length;re++){const de=D[re];if(!de.geometry)continue;const[Se,Te]=de.geometry.coordinates,Ce=jt(ur(Se)),st=jt(bn(Te));fe.push(Ce,st,1/0,re,-1,1),this.options.reduce&&fe.push(0)}let ae=this.trees[J+1]=this._createTree(fe);F&&console.timeEnd(ee);for(let re=J;re>=$;re--){const de=+Date.now();ae=this.trees[re]=this._createTree(this._cluster(ae,re)),F&&console.log("z%d: %d clusters in %dms",re,ae.numItems,+Date.now()-de)}return F&&console.timeEnd("total time"),this}getClusters(D,F){let $=((D[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,D[1]));let ee=D[2]===180?180:((D[2]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)$=-180,ee=180;else if($>ee){const Te=this.getClusters([$,J,180,fe],F),Ce=this.getClusters([-180,J,ee,fe],F);return Te.concat(Ce)}const ae=this.trees[this._limitZoom(F)],re=ae.range(ur($),bn(fe),ur(ee),bn(J)),de=ae.data,Se=[];for(const Te of re){const Ce=this.stride*Te;Se.push(de[Ce+Zt]>1?jn(de,Ce,this.clusterProps):this.points[de[Ce+Pt]])}return Se}getChildren(D){const F=this._getOriginId(D),$=this._getOriginZoom(D),J="No cluster with the specified id.",ee=this.trees[$];if(!ee)throw new Error(J);const fe=ee.data;if(F*this.stride>=fe.length)throw new Error(J);const ae=this.options.radius/(this.options.extent*Math.pow(2,$-1)),re=ee.within(fe[F*this.stride],fe[F*this.stride+1],ae),de=[];for(const Se of re){const Te=Se*this.stride;fe[Te+4]===D&&de.push(fe[Te+Zt]>1?jn(fe,Te,this.clusterProps):this.points[fe[Te+Pt]])}if(de.length===0)throw new Error(J);return de}getLeaves(D,F,$){const J=[];return this._appendLeaves(J,D,F=F||10,$=$||0,0),J}getTile(D,F,$){const J=this.trees[this._limitZoom(D)],ee=Math.pow(2,D),{extent:fe,radius:ae}=this.options,re=ae/fe,de=($-re)/ee,Se=($+1+re)/ee,Te={features:[]};return this._addTileFeatures(J.range((F-re)/ee,de,(F+1+re)/ee,Se),J.data,F,$,ee,Te),F===0&&this._addTileFeatures(J.range(1-re/ee,de,1,Se),J.data,ee,$,ee,Te),F===ee-1&&this._addTileFeatures(J.range(0,de,re/ee,Se),J.data,-1,$,ee,Te),Te.features.length?Te:null}getClusterExpansionZoom(D){let F=this._getOriginZoom(D)-1;for(;F<=this.options.maxZoom;){const $=this.getChildren(D);if(F++,$.length!==1)break;D=$[0].properties.cluster_id}return F}_appendLeaves(D,F,$,J,ee){const fe=this.getChildren(F);for(const ae of fe){const re=ae.properties;if(re&&re.cluster?ee+re.point_count<=J?ee+=re.point_count:ee=this._appendLeaves(D,re.cluster_id,$,J,ee):ee<J?ee++:D.push(ae),D.length===$)break}return ee}_createTree(D){const F=new c.av(D.length/this.stride|0,this.options.nodeSize,Float32Array);for(let $=0;$<D.length;$+=this.stride)F.add(D[$],D[$+1]);return F.finish(),F.data=D,F}_addTileFeatures(D,F,$,J,ee,fe){for(const ae of D){const re=ae*this.stride,de=F[re+Zt]>1;let Se,Te,Ce;if(de)Se=si(F,re,this.clusterProps),Te=F[re],Ce=F[re+1];else{const Ye=this.points[F[re+Pt]];Se=Ye.properties;const[at,gt]=Ye.geometry.coordinates;Te=ur(at),Ce=bn(gt)}const st={type:1,geometry:[[Math.round(this.options.extent*(Te*ee-$)),Math.round(this.options.extent*(Ce*ee-J))]],tags:Se};let ft;ft=de||this.options.generateId?F[re+Pt]:this.points[F[re+Pt]].id,ft!==void 0&&(st.id=ft),fe.features.push(st)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(Math.floor(+D),this.options.maxZoom+1))}_cluster(D,F){const{radius:$,extent:J,reduce:ee,minPoints:fe}=this.options,ae=$/(J*Math.pow(2,F)),re=D.data,de=[],Se=this.stride;for(let Te=0;Te<re.length;Te+=Se){if(re[Te+2]<=F)continue;re[Te+2]=F;const Ce=re[Te],st=re[Te+1],ft=D.within(re[Te],re[Te+1],ae),Ye=re[Te+Zt];let at=Ye;for(const gt of ft){const Ot=gt*Se;re[Ot+2]>F&&(at+=re[Ot+Zt])}if(at>Ye&&at>=fe){let gt,Ot=Ce*Ye,$t=st*Ye,At=-1;const kt=((Te/Se|0)<<5)+(F+1)+this.points.length;for(const hr of ft){const Kt=hr*Se;if(re[Kt+2]<=F)continue;re[Kt+2]=F;const Rn=re[Kt+Zt];Ot+=re[Kt]*Rn,$t+=re[Kt+1]*Rn,re[Kt+4]=kt,ee&&(gt||(gt=this._map(re,Te,!0),At=this.clusterProps.length,this.clusterProps.push(gt)),ee(gt,this._map(re,Kt)))}re[Te+4]=kt,de.push(Ot/at,$t/at,1/0,kt,-1,at),ee&&de.push(At)}else{for(let gt=0;gt<Se;gt++)de.push(re[Te+gt]);if(at>1)for(const gt of ft){const Ot=gt*Se;if(!(re[Ot+2]<=F)){re[Ot+2]=F;for(let $t=0;$t<Se;$t++)de.push(re[Ot+$t])}}}}return de}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,F,$){if(D[F+Zt]>1){const fe=this.clusterProps[D[F+cr]];return $?Object.assign({},fe):fe}const J=this.points[D[F+Pt]].properties,ee=this.options.map(J);return $&&ee===J?Object.assign({},ee):ee}}function jn(W,D,F){return{type:"Feature",id:W[D+Pt],properties:si(W,D,F),geometry:{type:"Point",coordinates:[($=W[D],360*($-.5)),_a(W[D+1])]}};var $}function si(W,D,F){const $=W[D+Zt],J=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$,ee=W[D+cr],fe=ee===-1?{}:Object.assign({},F[ee]);return Object.assign(fe,{cluster:!0,cluster_id:W[D+Pt],point_count:$,point_count_abbreviated:J})}function ur(W){return W/360+.5}function bn(W){const D=Math.sin(W*Math.PI/180),F=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return F<0?0:F>1?1:F}function _a(W){const D=(180-360*W)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function ws(W,D,F,$){for(var J,ee=$,fe=F-D>>1,ae=F-D,re=W[D],de=W[D+1],Se=W[F],Te=W[F+1],Ce=D+3;Ce<F;Ce+=3){var st=va(W[Ce],W[Ce+1],re,de,Se,Te);if(st>ee)J=Ce,ee=st;else if(st===ee){var ft=Math.abs(Ce-fe);ft<ae&&(J=Ce,ae=ft)}}ee>$&&(J-D>3&&ws(W,D,J,$),W[J+2]=ee,F-J>3&&ws(W,J,F,$))}function va(W,D,F,$,J,ee){var fe=J-F,ae=ee-$;if(fe!==0||ae!==0){var re=((W-F)*fe+(D-$)*ae)/(fe*fe+ae*ae);re>1?(F=J,$=ee):re>0&&(F+=fe*re,$+=ae*re)}return(fe=W-F)*fe+(ae=D-$)*ae}function Qi(W,D,F,$){var J={id:W===void 0?null:W,type:D,geometry:F,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ee){var fe=ee.geometry,ae=ee.type;if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")So(ee,fe);else if(ae==="Polygon"||ae==="MultiLineString")for(var re=0;re<fe.length;re++)So(ee,fe[re]);else if(ae==="MultiPolygon")for(re=0;re<fe.length;re++)for(var de=0;de<fe[re].length;de++)So(ee,fe[re][de])}(J),J}function So(W,D){for(var F=0;F<D.length;F+=3)W.minX=Math.min(W.minX,D[F]),W.minY=Math.min(W.minY,D[F+1]),W.maxX=Math.max(W.maxX,D[F]),W.maxY=Math.max(W.maxY,D[F+1])}function qs(W,D,F,$){if(D.geometry){var J=D.geometry.coordinates,ee=D.geometry.type,fe=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2),ae=[],re=D.id;if(F.promoteId?re=D.properties[F.promoteId]:F.generateId&&(re=$||0),ee==="Point")bs(J,ae);else if(ee==="MultiPoint")for(var de=0;de<J.length;de++)bs(J[de],ae);else if(ee==="LineString")Ss(J,ae,fe,!1);else if(ee==="MultiLineString"){if(F.lineMetrics){for(de=0;de<J.length;de++)Ss(J[de],ae=[],fe,!1),W.push(Qi(re,"LineString",ae,D.properties));return}Gs(J,ae,fe,!1)}else if(ee==="Polygon")Gs(J,ae,fe,!0);else{if(ee!=="MultiPolygon"){if(ee==="GeometryCollection"){for(de=0;de<D.geometry.geometries.length;de++)qs(W,{id:re,geometry:D.geometry.geometries[de],properties:D.properties},F,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(de=0;de<J.length;de++){var Se=[];Gs(J[de],Se,fe,!0),ae.push(Se)}}W.push(Qi(re,ee,ae,D.properties))}}function bs(W,D){D.push(be(W[0])),D.push(Ar(W[1])),D.push(0)}function Ss(W,D,F,$){for(var J,ee,fe=0,ae=0;ae<W.length;ae++){var re=be(W[ae][0]),de=Ar(W[ae][1]);D.push(re),D.push(de),D.push(0),ae>0&&(fe+=$?(J*de-re*ee)/2:Math.sqrt(Math.pow(re-J,2)+Math.pow(de-ee,2))),J=re,ee=de}var Se=D.length-3;D[2]=1,ws(D,0,Se,F),D[Se+2]=1,D.size=Math.abs(fe),D.start=0,D.end=D.size}function Gs(W,D,F,$){for(var J=0;J<W.length;J++){var ee=[];Ss(W[J],ee,F,$),D.push(ee)}}function be(W){return W/360+.5}function Ar(W){var D=Math.sin(W*Math.PI/180),F=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return F<0?0:F>1?1:F}function oi(W,D,F,$,J,ee,fe,ae){if($/=D,ee>=(F/=D)&&fe<$)return W;if(fe<F||ee>=$)return null;for(var re=[],de=0;de<W.length;de++){var Se=W[de],Te=Se.geometry,Ce=Se.type,st=J===0?Se.minX:Se.minY,ft=J===0?Se.maxX:Se.maxY;if(st>=F&&ft<$)re.push(Se);else if(!(ft<F||st>=$)){var Ye=[];if(Ce==="Point"||Ce==="MultiPoint")Ht(Te,Ye,F,$,J);else if(Ce==="LineString")Mt(Te,Ye,F,$,J,!1,ae.lineMetrics);else if(Ce==="MultiLineString")To(Te,Ye,F,$,J,!1);else if(Ce==="Polygon")To(Te,Ye,F,$,J,!0);else if(Ce==="MultiPolygon")for(var at=0;at<Te.length;at++){var gt=[];To(Te[at],gt,F,$,J,!0),gt.length&&Ye.push(gt)}if(Ye.length){if(ae.lineMetrics&&Ce==="LineString"){for(at=0;at<Ye.length;at++)re.push(Qi(Se.id,Ce,Ye[at],Se.tags));continue}Ce!=="LineString"&&Ce!=="MultiLineString"||(Ye.length===1?(Ce="LineString",Ye=Ye[0]):Ce="MultiLineString"),Ce!=="Point"&&Ce!=="MultiPoint"||(Ce=Ye.length===3?"Point":"MultiPoint"),re.push(Qi(Se.id,Ce,Ye,Se.tags))}}}return re.length?re:null}function Ht(W,D,F,$,J){for(var ee=0;ee<W.length;ee+=3){var fe=W[ee+J];fe>=F&&fe<=$&&(D.push(W[ee]),D.push(W[ee+1]),D.push(W[ee+2]))}}function Mt(W,D,F,$,J,ee,fe){for(var ae,re,de=Di(W),Se=J===0?ol:Eo,Te=W.start,Ce=0;Ce<W.length-3;Ce+=3){var st=W[Ce],ft=W[Ce+1],Ye=W[Ce+2],at=W[Ce+3],gt=W[Ce+4],Ot=J===0?st:ft,$t=J===0?at:gt,At=!1;fe&&(ae=Math.sqrt(Math.pow(st-at,2)+Math.pow(ft-gt,2))),Ot<F?$t>F&&(re=Se(de,st,ft,at,gt,F),fe&&(de.start=Te+ae*re)):Ot>$?$t<$&&(re=Se(de,st,ft,at,gt,$),fe&&(de.start=Te+ae*re)):es(de,st,ft,Ye),$t<F&&Ot>=F&&(re=Se(de,st,ft,at,gt,F),At=!0),$t>$&&Ot<=$&&(re=Se(de,st,ft,at,gt,$),At=!0),!ee&&At&&(fe&&(de.end=Te+ae*re),D.push(de),de=Di(W)),fe&&(Te+=ae)}var kt=W.length-3;st=W[kt],ft=W[kt+1],Ye=W[kt+2],(Ot=J===0?st:ft)>=F&&Ot<=$&&es(de,st,ft,Ye),kt=de.length-3,ee&&kt>=3&&(de[kt]!==de[0]||de[kt+1]!==de[1])&&es(de,de[0],de[1],de[2]),de.length&&D.push(de)}function Di(W){var D=[];return D.size=W.size,D.start=W.start,D.end=W.end,D}function To(W,D,F,$,J,ee){for(var fe=0;fe<W.length;fe++)Mt(W[fe],D,F,$,J,ee,!1)}function es(W,D,F,$){W.push(D),W.push(F),W.push($)}function ol(W,D,F,$,J,ee){var fe=(ee-D)/($-D);return W.push(ee),W.push(F+(J-F)*fe),W.push(1),fe}function Eo(W,D,F,$,J,ee){var fe=(ee-F)/(J-F);return W.push(D+($-D)*fe),W.push(ee),W.push(1),fe}function Ts(W,D){for(var F=[],$=0;$<W.length;$++){var J,ee=W[$],fe=ee.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")J=Zs(ee.geometry,D);else if(fe==="MultiLineString"||fe==="Polygon"){J=[];for(var ae=0;ae<ee.geometry.length;ae++)J.push(Zs(ee.geometry[ae],D))}else if(fe==="MultiPolygon")for(J=[],ae=0;ae<ee.geometry.length;ae++){for(var re=[],de=0;de<ee.geometry[ae].length;de++)re.push(Zs(ee.geometry[ae][de],D));J.push(re)}F.push(Qi(ee.id,fe,J,ee.tags))}return F}function Zs(W,D){var F=[];F.size=W.size,W.start!==void 0&&(F.start=W.start,F.end=W.end);for(var $=0;$<W.length;$+=3)F.push(W[$]+D,W[$+1],W[$+2]);return F}function Be(W,D){if(W.transformed)return W;var F,$,J,ee=1<<W.z,fe=W.x,ae=W.y;for(F=0;F<W.features.length;F++){var re=W.features[F],de=re.geometry,Se=re.type;if(re.geometry=[],Se===1)for($=0;$<de.length;$+=2)re.geometry.push(Li(de[$],de[$+1],D,ee,fe,ae));else for($=0;$<de.length;$++){var Te=[];for(J=0;J<de[$].length;J+=2)Te.push(Li(de[$][J],de[$][J+1],D,ee,fe,ae));re.geometry.push(Te)}}return W.transformed=!0,W}function Li(W,D,F,$,J,ee){return[Math.round(F*(W*$-J)),Math.round(F*(D*$-ee))]}function hn(W,D,F,$,J){for(var ee=D===J.maxZoom?0:J.tolerance/((1<<D)*J.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:F,y:$,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ae=0;ae<W.length;ae++){fe.numFeatures++,Hs(fe,W[ae],ee,J);var re=W[ae].minX,de=W[ae].minY,Se=W[ae].maxX,Te=W[ae].maxY;re<fe.minX&&(fe.minX=re),de<fe.minY&&(fe.minY=de),Se>fe.maxX&&(fe.maxX=Se),Te>fe.maxY&&(fe.maxY=Te)}return fe}function Hs(W,D,F,$){var J=D.geometry,ee=D.type,fe=[];if(ee==="Point"||ee==="MultiPoint")for(var ae=0;ae<J.length;ae+=3)fe.push(J[ae]),fe.push(J[ae+1]),W.numPoints++,W.numSimplified++;else if(ee==="LineString")ts(fe,J,W,F,!1,!1);else if(ee==="MultiLineString"||ee==="Polygon")for(ae=0;ae<J.length;ae++)ts(fe,J[ae],W,F,ee==="Polygon",ae===0);else if(ee==="MultiPolygon")for(var re=0;re<J.length;re++){var de=J[re];for(ae=0;ae<de.length;ae++)ts(fe,de[ae],W,F,!0,ae===0)}if(fe.length){var Se=D.tags||null;if(ee==="LineString"&&$.lineMetrics){for(var Te in Se={},D.tags)Se[Te]=D.tags[Te];Se.mapbox_clip_start=J.start/J.size,Se.mapbox_clip_end=J.end/J.size}var Ce={geometry:fe,type:ee==="Polygon"||ee==="MultiPolygon"?3:ee==="LineString"||ee==="MultiLineString"?2:1,tags:Se};D.id!==null&&(Ce.id=D.id),W.features.push(Ce)}}function ts(W,D,F,$,J,ee){var fe=$*$;if($>0&&D.size<(J?fe:$))F.numPoints+=D.length/3;else{for(var ae=[],re=0;re<D.length;re+=3)($===0||D[re+2]>fe)&&(F.numSimplified++,ae.push(D[re]),ae.push(D[re+1])),F.numPoints++;J&&function(de,Se){for(var Te=0,Ce=0,st=de.length,ft=st-2;Ce<st;ft=Ce,Ce+=2)Te+=(de[Ce]-de[ft])*(de[Ce+1]+de[ft+1]);if(Te>0===Se)for(Ce=0,st=de.length;Ce<st/2;Ce+=2){var Ye=de[Ce],at=de[Ce+1];de[Ce]=de[st-2-Ce],de[Ce+1]=de[st-1-Ce],de[st-2-Ce]=Ye,de[st-1-Ce]=at}}(ae,ee),W.push(ae)}}function Ue(W,D){var F=(D=this.options=function(J,ee){for(var fe in ee)J[fe]=ee[fe];return J}(Object.create(this.options),D)).debug;if(F&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var $=function(J,ee){var fe=[];if(J.type==="FeatureCollection")for(var ae=0;ae<J.features.length;ae++)qs(fe,J.features[ae],ee,ae);else qs(fe,J.type==="Feature"?J:{geometry:J},ee);return fe}(W,D);this.tiles={},this.tileCoords=[],F&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),$=function(J,ee){var fe=ee.buffer/ee.extent,ae=J,re=oi(J,1,-1-fe,fe,0,-1,2,ee),de=oi(J,1,1-fe,2+fe,0,-1,2,ee);return(re||de)&&(ae=oi(J,1,-fe,1+fe,0,-1,2,ee)||[],re&&(ae=Ts(re,1).concat(ae)),de&&(ae=ae.concat(Ts(de,-1)))),ae}($,D),$.length&&this.splitTile($,0,0,0),F&&($.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function vt(W,D,F){return 32*((1<<W)*F+D)+W}function mt(W,D){return D?W.properties[D]:W.id}function xr(W,D){if(W==null)return!0;if(W.type==="Feature")return mt(W,D)!=null;if(W.type==="FeatureCollection"){const F=new Set;for(const $ of W.features){const J=mt($,D);if(J==null||F.has(J))return!1;F.add(J)}return!0}return!1}function Fi(W,D){const F=new Map;if(W!=null)if(W.type==="Feature")F.set(mt(W,D),W);else for(const $ of W.features)F.set(mt($,D),$);return F}Ue.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ue.prototype.splitTile=function(W,D,F,$,J,ee,fe){for(var ae=[W,D,F,$],re=this.options,de=re.debug;ae.length;){$=ae.pop(),F=ae.pop(),D=ae.pop(),W=ae.pop();var Se=1<<D,Te=vt(D,F,$),Ce=this.tiles[Te];if(!Ce&&(de>1&&console.time("creation"),Ce=this.tiles[Te]=hn(W,D,F,$,re),this.tileCoords.push({z:D,x:F,y:$}),de)){de>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,F,$,Ce.numFeatures,Ce.numPoints,Ce.numSimplified),console.timeEnd("creation"));var st="z"+D;this.stats[st]=(this.stats[st]||0)+1,this.total++}if(Ce.source=W,J){if(D===re.maxZoom||D===J)continue;var ft=1<<J-D;if(F!==Math.floor(ee/ft)||$!==Math.floor(fe/ft))continue}else if(D===re.indexMaxZoom||Ce.numPoints<=re.indexMaxPoints)continue;if(Ce.source=null,W.length!==0){de>1&&console.time("clipping");var Ye,at,gt,Ot,$t,At,kt=.5*re.buffer/re.extent,hr=.5-kt,Kt=.5+kt,Rn=1+kt;Ye=at=gt=Ot=null,$t=oi(W,Se,F-kt,F+Kt,0,Ce.minX,Ce.maxX,re),At=oi(W,Se,F+hr,F+Rn,0,Ce.minX,Ce.maxX,re),W=null,$t&&(Ye=oi($t,Se,$-kt,$+Kt,1,Ce.minY,Ce.maxY,re),at=oi($t,Se,$+hr,$+Rn,1,Ce.minY,Ce.maxY,re),$t=null),At&&(gt=oi(At,Se,$-kt,$+Kt,1,Ce.minY,Ce.maxY,re),Ot=oi(At,Se,$+hr,$+Rn,1,Ce.minY,Ce.maxY,re),At=null),de>1&&console.timeEnd("clipping"),ae.push(Ye||[],D+1,2*F,2*$),ae.push(at||[],D+1,2*F,2*$+1),ae.push(gt||[],D+1,2*F+1,2*$),ae.push(Ot||[],D+1,2*F+1,2*$+1)}}},Ue.prototype.getTile=function(W,D,F){var $=this.options,J=$.extent,ee=$.debug;if(W<0||W>24)return null;var fe=1<<W,ae=vt(W,D=(D%fe+fe)%fe,F);if(this.tiles[ae])return Be(this.tiles[ae],J);ee>1&&console.log("drilling down to z%d-%d-%d",W,D,F);for(var re,de=W,Se=D,Te=F;!re&&de>0;)de--,Se=Math.floor(Se/2),Te=Math.floor(Te/2),re=this.tiles[vt(de,Se,Te)];return re&&re.source?(ee>1&&console.log("found parent tile z%d-%d-%d",de,Se,Te),ee>1&&console.time("drilling down"),this.splitTile(re.source,de,Se,Te,W,D,F),ee>1&&console.timeEnd("drilling down"),this.tiles[ae]?Be(this.tiles[ae],J):null):null};class yt extends le{constructor(D,F,$,J){super(D,F,$),this._dataUpdateable=new Map,this.loadGeoJSON=(ee,fe)=>{const{promoteId:ae}=ee;if(ee.request)return c.f(ee.request,(re,de,Se,Te)=>{this._dataUpdateable=xr(de,ae)?Fi(de,ae):void 0,fe(re,de,Se,Te)});if(typeof ee.data=="string")try{const re=JSON.parse(ee.data);this._dataUpdateable=xr(re,ae)?Fi(re,ae):void 0,fe(null,re)}catch{fe(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`))}else ee.dataDiff?this._dataUpdateable?(function(re,de,Se){var Te,Ce,st,ft;if(de.removeAll&&re.clear(),de.remove)for(const Ye of de.remove)re.delete(Ye);if(de.add)for(const Ye of de.add){const at=mt(Ye,Se);at!=null&&re.set(at,Ye)}if(de.update)for(const Ye of de.update){let at=re.get(Ye.id);if(at==null)continue;const gt=!Ye.removeAllProperties&&(((Te=Ye.removeProperties)===null||Te===void 0?void 0:Te.length)>0||((Ce=Ye.addOrUpdateProperties)===null||Ce===void 0?void 0:Ce.length)>0);if((Ye.newGeometry||Ye.removeAllProperties||gt)&&(at=Object.assign({},at),re.set(Ye.id,at),gt&&(at.properties=Object.assign({},at.properties))),Ye.newGeometry&&(at.geometry=Ye.newGeometry),Ye.removeAllProperties)at.properties={};else if(((st=Ye.removeProperties)===null||st===void 0?void 0:st.length)>0)for(const Ot of Ye.removeProperties)Object.prototype.hasOwnProperty.call(at.properties,Ot)&&delete at.properties[Ot];if(((ft=Ye.addOrUpdateProperties)===null||ft===void 0?void 0:ft.length)>0)for(const{key:Ot,value:$t}of Ye.addOrUpdateProperties)at.properties[Ot]=$t}}(this._dataUpdateable,ee.dataDiff,ae),fe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):fe(new Error(`Cannot update existing geojson data in ${ee.source}`)):fe(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,J&&(this.loadGeoJSON=J)}loadGeoJSONTile(D,F){const $=D.tileID.canonical;if(!this._geoJSONIndex)return F(null,null);const J=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!J)return F(null,null);const ee=new class{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.N,this.length=ae.length,this._features=ae}feature(ae){return new class{constructor(re){this._feature=re,this.extent=c.N,this.type=re.type,this.properties=re.tags,"id"in re&&!isNaN(re.id)&&(this.id=parseInt(re.id,10))}loadGeometry(){if(this._feature.type===1){const re=[];for(const de of this._feature.geometry)re.push([new c.P(de[0],de[1])]);return re}{const re=[];for(const de of this._feature.geometry){const Se=[];for(const Te of de)Se.push(new c.P(Te[0],Te[1]));re.push(Se)}return re}}toGeoJSON(re,de,Se){return Y.call(this,re,de,Se)}}(this._features[ae])}}(J.features);let fe=dt(ee);fe.byteOffset===0&&fe.byteLength===fe.buffer.byteLength||(fe=new Uint8Array(fe)),F(null,{vectorTile:ee,rawData:fe.buffer})}loadData(D,F){var $;($=this._pendingRequest)===null||$===void 0||$.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const J=!!(D&&D.request&&D.request.collectResourceTiming)&&new c.bu(D.request);this._pendingCallback=F,this._pendingRequest=this.loadGeoJSON(D,(ee,fe)=>{if(delete this._pendingCallback,delete this._pendingRequest,ee||!fe)return F(ee);if(typeof fe!="object")return F(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));{X(fe,!0);try{if(D.filter){const re=c.bC(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(re.result==="error")throw new Error(re.value.map(Se=>`${Se.key}: ${Se.message}`).join(", "));fe={type:"FeatureCollection",features:fe.features.filter(Se=>re.value.evaluate({zoom:0},Se))}}this._geoJSONIndex=D.cluster?new zn(function({superclusterOptions:re,clusterProperties:de}){if(!de||!re)return re;const Se={},Te={},Ce={accumulated:null,zoom:0},st={properties:null},ft=Object.keys(de);for(const Ye of ft){const[at,gt]=de[Ye],Ot=c.bC(gt),$t=c.bC(typeof at=="string"?[at,["accumulated"],["get",Ye]]:at);Se[Ye]=Ot.value,Te[Ye]=$t.value}return re.map=Ye=>{st.properties=Ye;const at={};for(const gt of ft)at[gt]=Se[gt].evaluate(Ce,st);return at},re.reduce=(Ye,at)=>{st.properties=at;for(const gt of ft)Ce.accumulated=Ye[gt],Ye[gt]=Te[gt].evaluate(Ce,st)},re}(D)).load(fe.features):function(re,de){return new Ue(re,de)}(fe,D.geojsonVtOptions)}catch(re){return F(re)}this.loaded={};const ae={};if(J){const re=J.finish();re&&(ae.resourceTiming={},ae.resourceTiming[D.source]=JSON.parse(JSON.stringify(re)))}F(null,ae)}})}reloadTile(D,F){const $=this.loaded;return $&&$[D.uid]?super.reloadTile(D,F):this.loadTile(D,F)}removeSource(D,F){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),F()}getClusterExpansionZoom(D,F){try{F(null,this._geoJSONIndex.getClusterExpansionZoom(D.clusterId))}catch($){F($)}}getClusterChildren(D,F){try{F(null,this._geoJSONIndex.getChildren(D.clusterId))}catch($){F($)}}getClusterLeaves(D,F){try{F(null,this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset))}catch($){F($)}}}class ns{constructor(D){this.self=D,this.actor=new c.C(D,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:le,geojson:yt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(F,$)=>{if(this.workerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.workerSourceTypes[F]=$},this.self.registerRTLTextPlugin=F=>{if(c.bD.isParsed())throw new Error("RTL text plugin already registered.");c.bD.applyArabicShaping=F.applyArabicShaping,c.bD.processBidirectionalText=F.processBidirectionalText,c.bD.processStyledBidirectionalText=F.processStyledBidirectionalText}}setReferrer(D,F){this.referrer=F}setImages(D,F,$){this.availableImages[D]=F;for(const J in this.workerSources[D]){const ee=this.workerSources[D][J];for(const fe in ee)ee[fe].availableImages=F}$()}setLayers(D,F,$){this.getLayerIndex(D).replace(F),$()}updateLayers(D,F,$){this.getLayerIndex(D).update(F.layers,F.removedIds),$()}loadTile(D,F,$){this.getWorkerSource(D,F.type,F.source).loadTile(F,$)}loadDEMTile(D,F,$){this.getDEMWorkerSource(D,F.source).loadTile(F,$)}reloadTile(D,F,$){this.getWorkerSource(D,F.type,F.source).reloadTile(F,$)}abortTile(D,F,$){this.getWorkerSource(D,F.type,F.source).abortTile(F,$)}removeTile(D,F,$){this.getWorkerSource(D,F.type,F.source).removeTile(F,$)}removeDEMTile(D,F){this.getDEMWorkerSource(D,F.source).removeTile(F)}removeSource(D,F,$){if(!this.workerSources[D]||!this.workerSources[D][F.type]||!this.workerSources[D][F.type][F.source])return;const J=this.workerSources[D][F.type][F.source];delete this.workerSources[D][F.type][F.source],J.removeSource!==void 0?J.removeSource(F,$):$()}loadWorkerSource(D,F,$){try{this.self.importScripts(F.url),$()}catch(J){$(J.toString())}}syncRTLPluginState(D,F,$){try{c.bD.setState(F);const J=c.bD.getPluginURL();if(c.bD.isLoaded()&&!c.bD.isParsed()&&J!=null){this.self.importScripts(J);const ee=c.bD.isParsed();$(ee?void 0:new Error(`RTL Text Plugin failed to import scripts from ${J}`),ee)}}catch(J){$(J.toString())}}getAvailableImages(D){let F=this.availableImages[D];return F||(F=[]),F}getLayerIndex(D){let F=this.layerIndexes[D];return F||(F=this.layerIndexes[D]=new z),F}getWorkerSource(D,F,$){return this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][F]||(this.workerSources[D][F]={}),this.workerSources[D][F][$]||(this.workerSources[D][F][$]=new this.workerSourceTypes[F]({send:(J,ee,fe)=>{this.actor.send(J,ee,fe,D)}},this.getLayerIndex(D),this.getAvailableImages(D))),this.workerSources[D][F][$]}getDEMWorkerSource(D,F){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][F]||(this.demWorkerSources[D][F]=new ie),this.demWorkerSources[D][F]}}return c.i()&&(self.worker=new ns(self)),ns}),v(["./shared"],function(c){var z="3.6.2";class P{static testProp(n){if(!P.docStyle)return n[0];for(let a=0;a<n.length;a++)if(n[a]in P.docStyle)return n[a];return n[0]}static create(n,a,h){const p=window.document.createElement(n);return a!==void 0&&(p.className=a),h&&h.appendChild(p),p}static createNS(n,a){return window.document.createElementNS(n,a)}static disableDrag(){P.docStyle&&P.selectProp&&(P.userSelect=P.docStyle[P.selectProp],P.docStyle[P.selectProp]="none")}static enableDrag(){P.docStyle&&P.selectProp&&(P.docStyle[P.selectProp]=P.userSelect)}static setTransform(n,a){n.style[P.transformProp]=a}static addEventListener(n,a,h,p={}){n.addEventListener(a,h,"passive"in p?p:p.capture)}static removeEventListener(n,a,h,p={}){n.removeEventListener(a,h,"passive"in p?p:p.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",P.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",P.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",P.suppressClickInternal,!0)},0)}static mousePos(n,a){const h=n.getBoundingClientRect();return new c.P(a.clientX-h.left-n.clientLeft,a.clientY-h.top-n.clientTop)}static touchPos(n,a){const h=n.getBoundingClientRect(),p=[];for(let y=0;y<a.length;y++)p.push(new c.P(a[y].clientX-h.left-n.clientLeft,a[y].clientY-h.top-n.clientTop));return p}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}P.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,P.selectProp=P.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),P.transformProp=P.testProp(["transform","WebkitTransform"]);const V={supported:!1,testSupport:function(m){!le&&N&&(ie?ge(m):U=m)}};let U,N,le=!1,ie=!1;function ge(m){const n=m.createTexture();m.bindTexture(m.TEXTURE_2D,n);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,N),m.isContextLost())return;V.supported=!0}catch{}m.deleteTexture(n),le=!0}var Me,X;typeof document<"u"&&(N=document.createElement("img"),N.onload=function(){U&&ge(U),U=null,ie=!0},N.onerror=function(){le=!0,U=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let n,a,h,p;m.resetRequestQueue=()=>{n=[],a=0,h=0,p={}},m.addThrottleControl=C=>{const A=h++;return p[A]=C,A},m.removeThrottleControl=C=>{delete p[C],b()},m.getImage=(C,A,M=!0)=>{V.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*");const O={requestParameters:C,supportImageRefresh:M,callback:A,cancelled:!1,completed:!1,cancel:()=>{O.completed||O.cancelled||(O.cancelled=!0,O.innerRequest&&(O.innerRequest.cancel(),a--),b())}};return n.push(O),b(),O};const y=C=>{const{requestParameters:A,supportImageRefresh:M,callback:O}=C;return c.e(A,{type:"image"}),(M!==!1||c.i()||c.g(A.url)||A.headers&&!Object.keys(A.headers).reduce((H,Z)=>H&&Z==="accept",!0)?c.m:E)(A,(H,Z,K,q)=>{w(C,O,H,Z,K,q)})},w=(C,A,M,O,H,Z)=>{M?A(M):O instanceof HTMLImageElement||c.a(O)?A(null,O):O&&((K,q)=>{typeof createImageBitmap=="function"?c.b(K,q):c.d(K,q)})(O,(K,q)=>{K!=null?A(K):q!=null&&A(null,q,{cacheControl:H,expires:Z})}),C.cancelled||(C.completed=!0,a--,b())},b=()=>{const C=(()=>{const A=Object.keys(p);let M=!1;if(A.length>0){for(const O of A)if(M=p[O](),M)break}return M})()?c.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let A=a;A<C&&n.length>0;A++){const M=n.shift();if(M.cancelled){A--;continue}const O=y(M);a++,M.innerRequest=O}},E=(C,A)=>{const M=new Image,O=C.url;let H=!1;const Z=C.credentials;return Z&&Z==="include"?M.crossOrigin="use-credentials":(Z&&Z==="same-origin"||!c.s(O))&&(M.crossOrigin="anonymous"),M.fetchPriority="high",M.onload=()=>{A(null,M),M.onerror=M.onload=null},M.onerror=()=>{H||A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),M.onerror=M.onload=null},M.src=O,{cancel:()=>{H=!0,M.src=""}}}}(Me||(Me={})),Me.resetRequestQueue(),function(m){m.Glyphs="Glyphs",m.Image="Image",m.Source="Source",m.SpriteImage="SpriteImage",m.SpriteJSON="SpriteJSON",m.Style="Style",m.Tile="Tile",m.Unknown="Unknown"}(X||(X={}));class Y{constructor(n){this._transformRequestFn=n}transformRequest(n,a){return this._transformRequestFn&&this._transformRequestFn(n,a)||{url:n}}normalizeSpriteURL(n,a,h){const p=function(y){const w=y.match(se);if(!w)throw new Error(`Unable to parse URL "${y}"`);return{protocol:w[1],authority:w[2],path:w[3]||"/",params:w[4]?w[4].split("&"):[]}}(n);return p.path+=`${a}${h}`,function(y){const w=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${w}`}(p)}setTransformRequest(n){this._transformRequestFn=n}}const se=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xe(m){var n=new c.A(3);return n[0]=m[0],n[1]=m[1],n[2]=m[2],n}var Ae,Fe=function(m,n,a){return m[0]=n[0]-a[0],m[1]=n[1]-a[1],m[2]=n[2]-a[2],m};Ae=new c.A(3),c.A!=Float32Array&&(Ae[0]=0,Ae[1]=0,Ae[2]=0);var De=function(m){var n=m[0],a=m[1];return n*n+a*a};function qe(m){const n=[];if(typeof m=="string")n.push({id:"default",url:m});else if(m&&m.length>0){const a=[];for(const{id:h,url:p}of m){const y=`${h}${p}`;a.indexOf(y)===-1&&(a.push(y),n.push({id:h,url:p}))}}return n}function Gt(m,n,a,h,p){if(h)return void m(h);if(p!==Object.values(n).length||p!==Object.values(a).length)return;const y={};for(const w in n){y[w]={};const b=c.h.getImageCanvasContext(a[w]),E=n[w];for(const C in E){const{width:A,height:M,x:O,y:H,sdf:Z,pixelRatio:K,stretchX:q,stretchY:ue,content:ye}=E[C];y[w][C]={data:null,pixelRatio:K,sdf:Z,stretchX:q,stretchY:ue,content:ye,spriteData:{width:A,height:M,x:O,y:H,context:b}}}}m(null,y)}(function(){var m=new c.A(2);c.A!=Float32Array&&(m[0]=0,m[1]=0)})();class it{constructor(n,a,h,p){this.context=n,this.format=h,this.texture=n.gl.createTexture(),this.update(a,p)}update(n,a,h){const{width:p,height:y}=n,w=!(this.size&&this.size[0]===p&&this.size[1]===y||h),{context:b}=this,{gl:E}=b;if(this.useMipmap=!!(a&&a.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!a||a.premultiply!==!1)),w)this.size=[p,y],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||c.a(n)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,n):E.texImage2D(E.TEXTURE_2D,0,this.format,p,y,0,this.format,E.UNSIGNED_BYTE,n.data);else{const{x:C,y:A}=h||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||c.a(n)?E.texSubImage2D(E.TEXTURE_2D,0,C,A,E.RGBA,E.UNSIGNED_BYTE,n):E.texSubImage2D(E.TEXTURE_2D,0,C,A,p,y,E.RGBA,E.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(n,a,h){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),h!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=y.LINEAR),n!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,h||n),this.filter=n),a!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,a),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function An(m){const{userImage:n}=m;return!!(n&&n.render&&n.render())&&(m.data.replace(new Uint8Array(n.data.buffer)),!0)}class Nn extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:a,callback:h}of this.requestors)this._notify(a,h);this.requestors=[]}}getImage(n){const a=this.images[n];if(a&&!a.data&&a.spriteData){const h=a.spriteData;a.data=new c.R({width:h.width,height:h.height},h.context.getImageData(h.x,h.y,h.width,h.height).data),a.spriteData=null}return a}addImage(n,a){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,a)&&(this.images[n]=a)}_validate(n,a){let h=!0;const p=a.data||a.spriteData;return this._validateStretch(a.stretchX,p&&p.width)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "stretchX" value`))),h=!1),this._validateStretch(a.stretchY,p&&p.height)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "stretchY" value`))),h=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${n}" has invalid "content" value`))),h=!1),h}_validateStretch(n,a){if(!n)return!0;let h=0;for(const p of n){if(p[0]<h||p[1]<p[0]||a<p[1])return!1;h=p[1]}return!0}_validateContent(n,a){if(!n)return!0;if(n.length!==4)return!1;const h=a.spriteData,p=h&&h.width||a.data.width,y=h&&h.height||a.data.height;return!(n[0]<0||p<n[0]||n[1]<0||y<n[1]||n[2]<0||p<n[2]||n[3]<0||y<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,a,h=!0){const p=this.getImage(n);if(h&&(p.data.width!==a.data.width||p.data.height!==a.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=p.version+1,this.images[n]=a,this.updatedImages[n]=!0}removeImage(n){const a=this.images[n];delete this.images[n],delete this.patterns[n],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,a){let h=!0;if(!this.isLoaded())for(const p of n)this.images[p]||(h=!1);this.isLoaded()||h?this._notify(n,a):this.requestors.push({ids:n,callback:a})}_notify(n,a){const h={};for(const p of n){let y=this.getImage(p);y||(this.fire(new c.k("styleimagemissing",{id:p})),y=this.getImage(p)),y?h[p]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:c.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}a(null,h)}getPixelSize(){const{width:n,height:a}=this.atlasImage;return{width:n,height:a}}getPattern(n){const a=this.patterns[n],h=this.getImage(n);if(!h)return null;if(a&&a.position.version===h.version)return a.position;if(a)a.position.version=h.version;else{const p={w:h.data.width+2,h:h.data.height+2,x:0,y:0},y=new c.I(p,h);this.patterns[n]={bin:p,position:y}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const a=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new it(n,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const y in this.patterns)n.push(this.patterns[y].bin);const{w:a,h}=c.p(n),p=this.atlasImage;p.resize({width:a||1,height:h||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],b=w.x+1,E=w.y+1,C=this.getImage(y).data,A=C.width,M=C.height;c.R.copy(C,p,{x:0,y:0},{x:b,y:E},{width:A,height:M}),c.R.copy(C,p,{x:0,y:M-1},{x:b,y:E-1},{width:A,height:1}),c.R.copy(C,p,{x:0,y:0},{x:b,y:E+M},{width:A,height:1}),c.R.copy(C,p,{x:A-1,y:0},{x:b-1,y:E},{width:1,height:M}),c.R.copy(C,p,{x:0,y:0},{x:b+A,y:E},{width:1,height:M})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const a of n){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const h=this.getImage(a);h||c.w(`Image with ID: "${a}" was not found`),An(h)&&this.updateImage(a,h)}}}const lr=1e20;function Mn(m,n,a,h,p,y,w,b,E){for(let C=n;C<n+h;C++)Qn(m,a*y+C,y,p,w,b,E);for(let C=a;C<a+p;C++)Qn(m,C*y+n,1,h,w,b,E)}function Qn(m,n,a,h,p,y,w){y[0]=0,w[0]=-lr,w[1]=lr,p[0]=m[n];for(let b=1,E=0,C=0;b<h;b++){p[b]=m[n+b*a];const A=b*b;do{const M=y[E];C=(p[b]-p[M]+A-M*M)/(b-M)/2}while(C<=w[E]&&--E>-1);E++,y[E]=b,w[E]=C,w[E+1]=lr}for(let b=0,E=0;b<h;b++){for(;w[E+1]<b;)E++;const C=y[E],A=b-C;m[n+b*a]=p[C]+A*A}}class er{constructor(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}}setURL(n){this.url=n}getGlyphs(n,a){const h=[];for(const p in n)for(const y of n[p])h.push({stack:p,id:y});c.o(h,({stack:p,id:y},w)=>{let b=this.entries[p];b||(b=this.entries[p]={glyphs:{},requests:{},ranges:{}});let E=b.glyphs[y];if(E!==void 0)return void w(null,{stack:p,id:y,glyph:E});if(E=this._tinySDF(b,p,y),E)return b.glyphs[y]=E,void w(null,{stack:p,id:y,glyph:E});const C=Math.floor(y/256);if(256*C>65535)return void w(new Error("glyphs > 65535 not supported"));if(b.ranges[C])return void w(null,{stack:p,id:y,glyph:E});if(!this.url)return void w(new Error("glyphsUrl is not set"));let A=b.requests[C];A||(A=b.requests[C]=[],er.loadGlyphRange(p,C,this.url,this.requestManager,(M,O)=>{if(O){for(const H in O)this._doesCharSupportLocalGlyph(+H)||(b.glyphs[+H]=O[+H]);b.ranges[C]=!0}for(const H of A)H(M,O);delete b.requests[C]})),A.push((M,O)=>{M?w(M):O&&w(null,{stack:p,id:y,glyph:O[y]||null})})},(p,y)=>{if(p)a(p);else if(y){const w={};for(const{stack:b,id:E,glyph:C}of y)(w[b]||(w[b]={}))[E]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};a(null,w)}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(c.u["CJK Unified Ideographs"](n)||c.u["Hangul Syllables"](n)||c.u.Hiragana(n)||c.u.Katakana(n))}_tinySDF(n,a,h){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(h))return;let y=n.tinySDF;if(!y){let b="400";/bold/i.test(a)?b="900":/medium/i.test(a)?b="500":/light/i.test(a)&&(b="200"),y=n.tinySDF=new er.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:p,fontWeight:b})}const w=y.draw(String.fromCharCode(h));return{id:h,bitmap:new c.q({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}er.loadGlyphRange=function(m,n,a,h,p){const y=256*n,w=y+255,b=h.transformRequest(a.replace("{fontstack}",m).replace("{range}",`${y}-${w}`),X.Glyphs);c.l(b,(E,C)=>{if(E)p(E);else if(C){const A={};for(const M of c.n(C))A[M.id]=M;p(null,A)}})},er.TinySDF=class{constructor({fontSize:m=24,buffer:n=3,radius:a=8,cutoff:h=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=h,this.radius=a;const b=this.size=m+4*n,E=this._createCanvas(b),C=this.ctx=E.getContext("2d",{willReadFrequently:!0});C.font=`${w} ${y} ${m}px ${p}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(m){const n=document.createElement("canvas");return n.width=n.height=m,n}draw(m){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(m),w=Math.ceil(a),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-p))),E=Math.min(this.size-this.buffer,w+Math.ceil(h)),C=b+2*this.buffer,A=E+2*this.buffer,M=Math.max(C*A,0),O=new Uint8ClampedArray(M),H={data:O,width:C,height:A,glyphWidth:b,glyphHeight:E,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(b===0||E===0)return H;const{ctx:Z,buffer:K,gridInner:q,gridOuter:ue}=this;Z.clearRect(K,K,b,E),Z.fillText(m,K,K+w);const ye=Z.getImageData(K,K,b,E);ue.fill(lr,0,M),q.fill(0,0,M);for(let te=0;te<E;te++)for(let he=0;he<b;he++){const ve=ye.data[4*(te*b+he)+3]/255;if(ve===0)continue;const we=(te+K)*C+he+K;if(ve===1)ue[we]=0,q[we]=lr;else{const Ee=.5-ve;ue[we]=Ee>0?Ee*Ee:0,q[we]=Ee<0?Ee*Ee:0}}Mn(ue,0,0,C,A,C,this.f,this.v,this.z),Mn(q,K,K,b,E,C,this.f,this.v,this.z);for(let te=0;te<M;te++){const he=Math.sqrt(ue[te])-Math.sqrt(q[te]);O[te]=Math.round(255-255*(he/this.radius+this.cutoff))}return H}};class tn{constructor(){this.specification=c.v.light.position}possiblyEvaluate(n,a){return c.z(n.expression.evaluate(a))}interpolate(n,a,h){return{x:c.B.number(n.x,a.x,h),y:c.B.number(n.y,a.y,h),z:c.B.number(n.z,a.z,h)}}}let We;class dt extends c.E{constructor(n){super(),We=We||new c.r({anchor:new c.D(c.v.light.anchor),position:new tn,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(We),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,a={}){if(!this._validate(c.t,n,a))for(const h in n){const p=n[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),p):this._transitionable.setValue(h,p)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,h){return(!h||h.validate!==!1)&&c.x(this,n.call(c.y,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}}class pt{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,a){const h=n.join(",")+String(a);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(n,a)),this.dashEntry[h]}getDashRanges(n,a,h){const p=[];let y=n.length%2==1?-n[n.length-1]*h:0,w=n[0]*h,b=!0;p.push({left:y,right:w,isDash:b,zeroLength:n[0]===0});let E=n[0];for(let C=1;C<n.length;C++){b=!b;const A=n[C];y=E*h,E+=A,w=E*h,p.push({left:y,right:w,isDash:b,zeroLength:A===0})}return p}addRoundDash(n,a,h){const p=a/2;for(let y=-h;y<=h;y++){const w=this.width*(this.nextRow+h+y);let b=0,E=n[b];for(let C=0;C<this.width;C++){C/E.right>1&&(E=n[++b]);const A=Math.abs(C-E.left),M=Math.abs(C-E.right),O=Math.min(A,M);let H;const Z=y/h*(p+1);if(E.isDash){const K=p-Math.abs(Z);H=Math.sqrt(O*O+K*K)}else H=p-Math.sqrt(O*O+Z*Z);this.data[w+C]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(n){for(let b=n.length-1;b>=0;--b){const E=n[b],C=n[b+1];E.zeroLength?n.splice(b,1):C&&C.isDash===E.isDash&&(C.left=E.left,n.splice(b,1))}const a=n[0],h=n[n.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const p=this.width*this.nextRow;let y=0,w=n[y];for(let b=0;b<this.width;b++){b/w.right>1&&(w=n[++y]);const E=Math.abs(b-w.left),C=Math.abs(b-w.right),A=Math.min(E,C);this.data[p+b]=Math.max(0,Math.min(255,(w.isDash?A:-A)+128))}}addDash(n,a){const h=a?7:0,p=2*h+1;if(this.nextRow+p>this.height)return c.w("LineAtlas out of space"),null;let y=0;for(let b=0;b<n.length;b++)y+=n[b];if(y!==0){const b=this.width/y,E=this.getDashRanges(n,this.width,b);a?this.addRoundDash(E,b,h):this.addRegularDash(E)}const w={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:y};return this.nextRow+=p,this.dirty=!0,w}bind(n){const a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}class jt{constructor(n,a,h){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=h;const p=this.workerPool.acquire(h);for(let y=0;y<p.length;y++){const w=new c.C(p[y],a,h);w.name=`Worker ${y}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,a,h){c.o(this.actors,(p,y)=>{p.send(n,a,y)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}}function Rt(m,n,a){const h=function(p,y){if(p)return a(p);if(y){const w=c.F(c.e(y,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(w.vectorLayers=y.vector_layers,w.vectorLayerIds=w.vectorLayers.map(b=>b.id)),a(null,w)}};return m.url?c.f(n.transformRequest(m.url,X.Source),h):c.h.frame(()=>h(null,m))}class Pt{constructor(n,a){n&&(a?this.setSouthWest(n).setNorthEast(a):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof c.L?new c.L(n.lng,n.lat):c.L.convert(n),this}setSouthWest(n){return this._sw=n instanceof c.L?new c.L(n.lng,n.lat):c.L.convert(n),this}extend(n){const a=this._sw,h=this._ne;let p,y;if(n instanceof c.L)p=n,y=n;else{if(!(n instanceof Pt))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Pt.convert(n)):this.extend(c.L.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(c.L.convert(n)):this;if(p=n._sw,y=n._ne,!p||!y)return this}return a||h?(a.lng=Math.min(p.lng,a.lng),a.lat=Math.min(p.lat,a.lat),h.lng=Math.max(y.lng,h.lng),h.lat=Math.max(y.lat,h.lat)):(this._sw=new c.L(p.lng,p.lat),this._ne=new c.L(y.lng,y.lat)),this}getCenter(){return new c.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.L(this.getWest(),this.getNorth())}getSouthEast(){return new c.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:a,lat:h}=c.L.convert(n);let p=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&p}static convert(n){return n instanceof Pt?n:n&&new Pt(n)}static fromLngLat(n,a=0){const h=360*a/40075017,p=h/Math.cos(Math.PI/180*n.lat);return new Pt(new c.L(n.lng-p,n.lat-h),new c.L(n.lng+p,n.lat+h))}}class Zt{constructor(n,a,h){this.bounds=Pt.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=h||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const a=Math.pow(2,n.z),h=Math.floor(c.G(this.bounds.getWest())*a),p=Math.floor(c.H(this.bounds.getNorth())*a),y=Math.ceil(c.G(this.bounds.getEast())*a),w=Math.ceil(c.H(this.bounds.getSouth())*a);return n.x>=h&&n.x<y&&n.y>=p&&n.y<w}}class cr extends c.E{constructor(n,a,h,p){if(super(),this.load=()=>{this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,(y,w)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),y?this.fire(new c.j(y)):w&&(c.e(this,w),w.bounds&&(this.tileBounds=new Zt(w.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>c.e({},this._options),this.id=n,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.F(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(n,a){const h=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(h,X.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(w,b){return delete n.request,n.aborted?a(null):w&&w.status!==404?a(w):(b&&b.resourceTiming&&(n.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&n.setExpiryData(b),n.loadVectorData(b,this.map.painter),a(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=a:n.request=n.actor.send("reloadTile",p,y.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",p,y.bind(this)))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class zn extends c.E{constructor(n,a,h,p){super(),this.id=n,this.dispatcher=h,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.F(a,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,(n,a)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new c.j(n)):a&&(c.e(this,a),a.bounds&&(this.tileBounds=new Zt(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}serialize(){return c.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,a){const h=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.request=Me.getImage(this.map._requestManager.transformRequest(h,X.Tile),(p,y,w)=>{if(delete n.request,n.aborted)n.state="unloaded",a(null);else if(p)n.state="errored",a(p);else if(y){this.map._refreshExpiredTiles&&w&&n.setExpiryData(w);const b=this.map.painter.context,E=b.gl;n.texture=this.map.painter.getTileTexture(y.width),n.texture?n.texture.update(y,{useMipmap:!0}):(n.texture=new it(b,y,E.RGBA,{useMipmap:!0}),n.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&E.texParameterf(E.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),n.state="loaded",a(null)}},this.map._refreshExpiredTiles)}abortTile(n,a){n.request&&(n.request.cancel(),delete n.request),a()}unloadTile(n,a){n.texture&&this.map.painter.saveTileTexture(n.texture),a()}hasTransition(){return!1}}class jn extends zn{constructor(n,a,h,p){super(n,a,h,p),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(n,a){const h=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(h,X.Tile);function y(w,b){w&&(n.state="errored",a(w)),b&&(n.dem=b,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded",a(null))}n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.request=Me.getImage(p,(w,b,E)=>c._(this,void 0,void 0,function*(){if(delete n.request,n.aborted)n.state="unloaded",a(null);else if(w)n.state="errored",a(w);else if(b){this.map._refreshExpiredTiles&&n.setExpiryData(E);const C=c.a(b)&&c.J()?b:yield function(M){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.K()){const O=M.width+2,H=M.height+2;try{return new c.R({width:O,height:H},yield c.M(M,-1,-1,O,H))}catch{}}return c.h.getImageData(M,1)})}(b),A={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:C,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",A,y))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(n){const a=n.canonical,h=Math.pow(2,a.z),p=(a.x-1+h)%h,y=a.x===0?n.wrap-1:n.wrap,w=(a.x+1+h)%h,b=a.x+1===h?n.wrap+1:n.wrap,E={};return E[new c.O(n.overscaledZ,y,a.z,p,a.y).key]={backfilled:!1},E[new c.O(n.overscaledZ,b,a.z,w,a.y).key]={backfilled:!1},a.y>0&&(E[new c.O(n.overscaledZ,y,a.z,p,a.y-1).key]={backfilled:!1},E[new c.O(n.overscaledZ,n.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},E[new c.O(n.overscaledZ,b,a.z,w,a.y-1).key]={backfilled:!1}),a.y+1<h&&(E[new c.O(n.overscaledZ,y,a.z,p,a.y+1).key]={backfilled:!1},E[new c.O(n.overscaledZ,n.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},E[new c.O(n.overscaledZ,b,a.z,w,a.y+1).key]={backfilled:!1}),E}unloadTile(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})}}class si extends c.E{constructor(n,a,h,p){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>c.e({},this._options,{type:this.type,data:this._data}),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=h.getActor(),this.setEventedParent(p),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const y=c.N/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*y,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*y,extent:c.N,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.N,radius:(a.clusterRadius||50)*y,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},a),this}getClusterChildren(n,a){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},a),this}getClusterLeaves(n,a,h,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:a,offset:h},p),this}_updateWorkerData(n){const a=c.e({},this.workerOptions);n?a.dataDiff=n:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(c.h.resolveURL(this._data),X.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,a,(h,p)=>{if(this._pendingLoads--,this._removed||p&&p.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let y=null;if(p&&p.resourceTiming&&p.resourceTiming[this.id]&&(y=p.resourceTiming[this.id].slice(0)),h)return void this.fire(new c.j(h));const w={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&c.e(w,{resourceTiming:y}),this.fire(new c.k("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(n,a){const h=n.actor?"reloadTile":"loadTile";n.actor=this.actor;const p={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(h,p,(y,w)=>(delete n.request,n.unloadVectorData(),n.aborted?a(null):y?a(y):(n.loadVectorData(w,this.map.painter,h==="reloadTile"),a(null))))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0}unloadTile(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var ur=c.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class bn extends c.E{constructor(n,a,h,p){super(),this.load=(y,w)=>{this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Me.getImage(this.map._requestManager.transformRequest(this.url,X.Image),(b,E)=>{this._request=null,this._loaded=!0,b?this.fire(new c.j(b)):E&&(this.image=E,y&&(this.coordinates=y),w&&w(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const y=this.map.painter.context,w=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,ur.members)),this.boundsSegments||(this.boundsSegments=c.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new it(y,this.image,w.RGBA),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE));let b=!1;for(const E in this.tiles){const C=this.tiles[E];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture,b=!0)}b&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=n,this.dispatcher=h,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=a}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(n){this.coordinates=n;const a=n.map(c.U.fromLngLat);this.tileID=function(p){let y=1/0,w=1/0,b=-1/0,E=-1/0;for(const O of p)y=Math.min(y,O.x),w=Math.min(w,O.y),b=Math.max(b,O.x),E=Math.max(E,O.y);const C=Math.max(b-y,E-w),A=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),M=Math.pow(2,A);return new c.W(A,Math.floor((y+b)/2*M),Math.floor((w+E)/2*M))}(a),this.minzoom=this.maxzoom=this.tileID.z;const h=a.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new c.V,this._boundsArray.emplaceBack(h[0].x,h[0].y,0,0),this._boundsArray.emplaceBack(h[1].x,h[1].y,c.N,0),this._boundsArray.emplaceBack(h[3].x,h[3].y,0,c.N),this._boundsArray.emplaceBack(h[2].x,h[2].y,c.N,c.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(n,a){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},a(null)):(n.state="errored",a(null))}hasTransition(){return!1}}class _a extends bn{constructor(n,a,h,p){super(n,a,h,p),this.load=()=>{this._loaded=!1;const y=this.options;this.urls=[];for(const w of y.urls)this.urls.push(this.map._requestManager.transformRequest(w,X.Source).url);c.X(this.urls,(w,b)=>{this._loaded=!0,w?this.fire(new c.j(w)):b&&(this.video=b,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,w=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,ur.members)),this.boundsSegments||(this.boundsSegments=c.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE),w.texSubImage2D(w.TEXTURE_2D,0,0,0,w.RGBA,w.UNSIGNED_BYTE,this.video)):(this.texture=new it(y,this.video,w.RGBA),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE));let b=!1;for(const E in this.tiles){const C=this.tiles[E];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture,b=!0)}b&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=a}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const a=this.video.seekable;n<a.start(0)||n>a.end(0)?this.fire(new c.j(new c.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class ws extends bn{constructor(n,a,h,p){super(n,a,h,p),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const w=this.map.painter.context,b=w.gl;this.boundsBuffer||(this.boundsBuffer=w.createVertexBuffer(this._boundsArray,ur.members)),this.boundsSegments||(this.boundsSegments=c.S.simpleSegment(0,0,4,2)),this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new it(w,this.canvas,b.RGBA,{premultiply:!0});let E=!1;for(const C in this.tiles){const A=this.tiles[C];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,E=!0)}E&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(w=>typeof w!="number"))||this.fire(new c.j(new c.Y(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.Y(`sources.${n}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.Y(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.Y(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.Y(`sources.${n}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const va={},Qi=m=>{switch(m){case"geojson":return si;case"image":return bn;case"raster":return zn;case"raster-dem":return jn;case"vector":return cr;case"video":return _a;case"canvas":return ws}return va[m]};function So(m,n){const a=c.Z();return c.$(a,a,[1,1,0]),c.a0(a,a,[.5*m.width,.5*m.height,1]),c.a1(a,a,m.calculatePosMatrix(n.toUnwrapped()))}function qs(m,n,a,h,p,y){const w=function(M,O,H){if(M)for(const Z of M){const K=O[Z];if(K&&K.source===H&&K.type==="fill-extrusion")return!0}else for(const Z in O){const K=O[Z];if(K.source===H&&K.type==="fill-extrusion")return!0}return!1}(p&&p.layers,n,m.id),b=y.maxPitchScaleFactor(),E=m.tilesIn(h,b,w);E.sort(bs);const C=[];for(const M of E)C.push({wrappedTileID:M.tileID.wrapped().key,queryResults:M.tile.queryRenderedFeatures(n,a,m._state,M.queryGeometry,M.cameraQueryGeometry,M.scale,p,y,b,So(m.transform,M.tileID))});const A=function(M){const O={},H={};for(const Z of M){const K=Z.queryResults,q=Z.wrappedTileID,ue=H[q]=H[q]||{};for(const ye in K){const te=K[ye],he=ue[ye]=ue[ye]||{},ve=O[ye]=O[ye]||[];for(const we of te)he[we.featureIndex]||(he[we.featureIndex]=!0,ve.push(we))}}return O}(C);for(const M in A)A[M].forEach(O=>{const H=O.feature,Z=m.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=Z});return A}function bs(m,n){const a=m.tileID,h=n.tileID;return a.overscaledZ-h.overscaledZ||a.canonical.y-h.canonical.y||a.wrap-h.wrap||a.canonical.x-h.canonical.x}class Ss{constructor(n,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=c.a2(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const a=n+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,a,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(p,y){const w={};if(!y)return w;for(const b of p){const E=b.layerIds.map(C=>y.getLayer(C)).filter(Boolean);if(E.length!==0){b.layers=E,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(C=>E.filter(A=>A.id===C)[0]));for(const C of E)w[C.id]=b}}return w}(n.buckets,a.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const y=this.buckets[p];if(y instanceof c.a4){if(this.hasSymbolBuckets=!0,!h)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const y=this.buckets[p];if(y instanceof c.a4&&y.hasRTLText){this.hasRTLText=!0,c.a5();break}}this.queryPadding=0;for(const p in this.buckets){const y=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(p).queryRadius(y))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new c.a3}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const h in this.buckets){const p=this.buckets[h];p.uploadPending()&&p.upload(n)}const a=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new it(n,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new it(n,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,a,h,p,y,w,b,E,C,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:y,scale:w,tileSize:this.tileSize,pixelPosMatrix:A,transform:E,params:b,queryPadding:this.queryPadding*C},n,a,h):{}}querySourceFeatures(n,a){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const p=h.loadVTLayers(),y=a&&a.sourceLayer?a.sourceLayer:"",w=p._geojsonTileLayer||p[y];if(!w)return;const b=c.a6(a&&a.filter),{z:E,x:C,y:A}=this.tileID.canonical,M={z:E,x:C,y:A};for(let O=0;O<w.length;O++){const H=w.feature(O);if(b.needGeometry){const q=c.a7(H,!0);if(!b.filter(new c.a8(this.tileID.overscaledZ),q,this.tileID.canonical))continue}else if(!b.filter(new c.a8(this.tileID.overscaledZ),H))continue;const Z=h.getId(H,y),K=new c.a9(H,E,C,A,Z);K.tile=M,n.push(K)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const a=this.expirationTime;if(n.cacheControl){const h=c.aa(n.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const h=Date.now();let p=!1;if(this.expirationTime>h)p=!1;else if(a)if(this.expirationTime<a)p=!0;else{const y=this.expirationTime-a;y?this.expirationTime=h+Math.max(y,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!a.style.hasLayer(p))continue;const y=this.buckets[p],w=y.layers[0].sourceLayer||"_geojsonTileLayer",b=h[w],E=n[w];if(!b||!E||Object.keys(E).length===0)continue;y.update(E,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const C=a&&a.style&&a.style.getLayer(p);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=c.h.now()+n}setDependencies(n,a){const h={};for(const p of a)h[p]=!0;this.dependencies[n]=h}hasDependency(n,a){for(const h of n){const p=this.dependencies[h];if(p){for(const y of a)if(p[y])return!0}}return!1}}class Gs{constructor(n,a){this.max=n,this.onRemove=a,this.reset()}reset(){for(const n in this.data)for(const a of this.data[n])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(n,a,h){const p=n.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const y={value:a,timeout:void 0};if(h!==void 0&&(y.timeout=setTimeout(()=>{this.remove(n,y)},h)),this.data[p].push(y),this.order.push(p),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value}getByKey(n){const a=this.data[n];return a?a[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,a){if(!this.has(n))return this;const h=n.wrapped().key,p=a===void 0?0:this.data[h].indexOf(a),y=this.data[h][p];return this.data[h].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(y.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(n){const a=[];for(const h in this.data)for(const p of this.data[h])n(p.value)||a.push(p);for(const h of a)this.remove(h.value.tileID,h)}}class be{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,a,h){const p=String(a);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][p]=this.stateChanges[n][p]||{},c.e(this.stateChanges[n][p],h),this.deletedStates[n]===null){this.deletedStates[n]={};for(const y in this.state[n])y!==p&&(this.deletedStates[n][y]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][p]===null){this.deletedStates[n][p]={};for(const y in this.state[n][p])h[y]||(this.deletedStates[n][p][y]=null)}else for(const y in h)this.deletedStates[n]&&this.deletedStates[n][p]&&this.deletedStates[n][p][y]===null&&delete this.deletedStates[n][p][y]}removeFeatureState(n,a,h){if(this.deletedStates[n]===null)return;const p=String(a);if(this.deletedStates[n]=this.deletedStates[n]||{},h&&a!==void 0)this.deletedStates[n][p]!==null&&(this.deletedStates[n][p]=this.deletedStates[n][p]||{},this.deletedStates[n][p][h]=null);else if(a!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][p])for(h in this.deletedStates[n][p]={},this.stateChanges[n][p])this.deletedStates[n][p][h]=null;else this.deletedStates[n][p]=null;else this.deletedStates[n]=null}getState(n,a){const h=String(a),p=c.e({},(this.state[n]||{})[h],(this.stateChanges[n]||{})[h]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const y=this.deletedStates[n][a];if(y===null)return{};for(const w in y)delete p[w]}return p}initializeTileState(n,a){n.setFeatureState(this.state,a)}coalesceChanges(n,a){const h={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const y={};for(const w in this.stateChanges[p])this.state[p][w]||(this.state[p][w]={}),c.e(this.state[p][w],this.stateChanges[p][w]),y[w]=this.state[p][w];h[p]=y}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const y={};if(this.deletedStates[p]===null)for(const w in this.state[p])y[w]={},this.state[p][w]={};else for(const w in this.deletedStates[p]){if(this.deletedStates[p][w]===null)this.state[p][w]={};else for(const b of Object.keys(this.deletedStates[p][w]))delete this.state[p][w][b];y[w]=this.state[p][w]}h[p]=h[p]||{},c.e(h[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const p in n)n[p].setFeatureState(h,a)}}class Ar extends c.E{constructor(n,a,h){super(),this.id=n,this.dispatcher=h,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((p,y,w,b)=>{const E=new(Qi(y.type))(p,y,w,b);if(E.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${E.id}`);return E})(n,a,h,this),this._tiles={},this._cache=new Gs(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new be,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const a=this._tiles[n];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,a){return this._source.loadTile(n,a)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){this._source.abortTile&&this._source.abortTile(n,()=>{}),this._source.fire(new c.k("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const h=this._tiles[a];h.upload(n),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(oi).map(n=>n.key)}getRenderableIds(n){const a=[];for(const h in this._tiles)this._isIdRenderable(h,n)&&a.push(this._tiles[h]);return n?a.sort((h,p)=>{const y=h.tileID,w=p.tileID,b=new c.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),E=new c.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-w.overscaledZ||E.y-b.y||E.x-b.x}).map(h=>h.tileID.key):a.map(h=>h.tileID).sort(oi).map(h=>h.key)}hasRenderableParent(n){const a=this.findLoadedParent(n,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(n,a){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(a||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,a){const h=this._tiles[n];h&&(h.state!=="loading"&&(h.state=a),this._loadTile(h,this._tileLoaded.bind(this,h,n,a)))}_tileLoaded(n,a,h,p){if(p)return n.state="errored",void(p.status!==404?this._source.fire(new c.j(p,{tile:n})):this.update(this.transform,this.terrain));n.timeAdded=c.h.now(),h==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(a,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const a=this.getRenderableIds();for(let p=0;p<a.length;p++){const y=a[p];if(n.neighboringTiles&&n.neighboringTiles[y]){const w=this.getTileByID(y);h(n,w),h(w,n)}}function h(p,y){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let w=y.tileID.canonical.x-p.tileID.canonical.x;const b=y.tileID.canonical.y-p.tileID.canonical.y,E=Math.pow(2,p.tileID.canonical.z),C=y.tileID.key;w===0&&b===0||Math.abs(b)>1||(Math.abs(w)>1&&(Math.abs(w+E)===1?w+=E:Math.abs(w-E)===1&&(w-=E)),y.dem&&p.dem&&(p.dem.backfillBorder(y.dem,w,b),p.neighboringTiles&&p.neighboringTiles[C]&&(p.neighboringTiles[C].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,a,h,p){for(const y in this._tiles){let w=this._tiles[y];if(p[y]||!w.hasData()||w.tileID.overscaledZ<=a||w.tileID.overscaledZ>h)continue;let b=w.tileID;for(;w&&w.tileID.overscaledZ>a+1;){const C=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[C.key],w&&w.hasData()&&(b=C)}let E=b;for(;E.overscaledZ>a;)if(E=E.scaledTo(E.overscaledZ-1),n[E.key]){p[b.key]=b;break}}}findLoadedParent(n,a){if(n.key in this._loadedParentTiles){const h=this._loadedParentTiles[n.key];return h&&h.tileID.overscaledZ>=a?h:null}for(let h=n.overscaledZ-1;h>=a;h--){const p=n.scaledTo(h),y=this._getLoadedTile(p);if(y)return y}}_getLoadedTile(n){const a=this._tiles[n.key];return a&&a.hasData()?a:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const a=Math.ceil(n.width/this._source.tileSize)+1,h=Math.ceil(n.height/this._source.tileSize)+1,p=Math.floor(a*h*(this._maxTileCacheZoomLevels===null?c.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(y)}handleWrapJump(n){const a=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,a){const h={};for(const p in this._tiles){const y=this._tiles[p];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+a),h[y.tileID.key]=y}this._tiles=h;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(n,a){if(this.transform=n,this.terrain=a,!this._sourceLoaded||this._paused)return;let h;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(A=>new c.O(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y)):(h=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(h=h.filter(A=>this._source.hasTile(A)))):h=[];const p=n.coveringZoomLevel(this._source),y=Math.max(p-Ar.maxOverzooming,this._source.minzoom),w=Math.max(p+Ar.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const A={};for(const M of h)if(M.canonical.z>this._source.minzoom){const O=M.scaledTo(M.canonical.z-1);A[O.key]=O;const H=M.scaledTo(Math.max(this._source.minzoom,Math.min(M.canonical.z,5)));A[H.key]=H}h=h.concat(Object.values(A))}const b=h.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(h,p);if(Ht(this._source.type)){const A={},M={},O=Object.keys(E),H=c.h.now();for(const Z of O){const K=E[Z],q=this._tiles[Z];if(!q||q.fadeEndTime!==0&&q.fadeEndTime<=H)continue;const ue=this.findLoadedParent(K,y);ue&&(this._addTile(ue.tileID),A[ue.tileID.key]=ue.tileID),M[Z]=K}this._retainLoadedChildren(M,p,w,E);for(const Z in A)E[Z]||(this._coveredTiles[Z]=!0,E[Z]=A[Z]);if(a){const Z={},K={};for(const q of h)this._tiles[q.key].hasData()?Z[q.key]=q:K[q.key]=q;for(const q in K){const ue=K[q].children(this._source.maxzoom);this._tiles[ue[0].key]&&this._tiles[ue[1].key]&&this._tiles[ue[2].key]&&this._tiles[ue[3].key]&&(Z[ue[0].key]=E[ue[0].key]=ue[0],Z[ue[1].key]=E[ue[1].key]=ue[1],Z[ue[2].key]=E[ue[2].key]=ue[2],Z[ue[3].key]=E[ue[3].key]=ue[3],delete K[q])}for(const q in K){const ue=this.findLoadedParent(K[q],this._source.minzoom);if(ue){Z[ue.tileID.key]=E[ue.tileID.key]=ue.tileID;for(const ye in Z)Z[ye].isChildOf(ue.tileID)&&delete Z[ye]}}for(const q in this._tiles)Z[q]||(this._coveredTiles[q]=!0)}}for(const A in E)this._tiles[A].clearFadeHold();const C=c.ab(this._tiles,E);for(const A of C){const M=this._tiles[A];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(A)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,a){const h={},p={},y=Math.max(a-Ar.maxOverzooming,this._source.minzoom),w=Math.max(a+Ar.maxUnderzooming,this._source.minzoom),b={};for(const E of n){const C=this._addTile(E);h[E.key]=E,C.hasData()||a<this._source.maxzoom&&(b[E.key]=E)}this._retainLoadedChildren(b,a,w,h);for(const E of n){let C=this._tiles[E.key];if(C.hasData())continue;if(a+1>this._source.maxzoom){const M=E.children(this._source.maxzoom)[0],O=this.getTile(M);if(O&&O.hasData()){h[M.key]=M;continue}}else{const M=E.children(this._source.maxzoom);if(h[M[0].key]&&h[M[1].key]&&h[M[2].key]&&h[M[3].key])continue}let A=C.wasRequested();for(let M=E.overscaledZ-1;M>=y;--M){const O=E.scaledTo(M);if(p[O.key])break;if(p[O.key]=!0,C=this.getTile(O),!C&&A&&(C=this._addTile(O)),C){const H=C.hasData();if((A||H)&&(h[O.key]=O),A=C.wasRequested(),H)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const a=[];let h,p=this._tiles[n].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){h=this._loadedParentTiles[p.key];break}a.push(p.key);const y=p.scaledTo(p.overscaledZ-1);if(h=this._getLoadedTile(y),h)break;p=y}for(const y of a)this._loadedParentTiles[y]=h}}_addTile(n){let a=this._tiles[n.key];if(a)return a;a=this._cache.getAndRemove(n),a&&(this._setTileReloadTimer(n.key,a),a.tileID=n,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,a)));const h=a;return a||(a=new Ss(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(a,this._tileLoaded.bind(this,a,n.key,a.state))),a.uses++,this._tiles[n.key]=a,h||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(n,a){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const h=a.getExpiryTimeout();h&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},h))}_removeTile(n){const a=this._tiles[n];a&&(a.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,a,h){const p=[],y=this.transform;if(!y)return p;const w=h?y.getCameraQueryGeometry(n):n,b=n.map(Z=>y.pointCoordinate(Z,this.terrain)),E=w.map(Z=>y.pointCoordinate(Z,this.terrain)),C=this.getIds();let A=1/0,M=1/0,O=-1/0,H=-1/0;for(const Z of E)A=Math.min(A,Z.x),M=Math.min(M,Z.y),O=Math.max(O,Z.x),H=Math.max(H,Z.y);for(let Z=0;Z<C.length;Z++){const K=this._tiles[C[Z]];if(K.holdingForFade())continue;const q=K.tileID,ue=Math.pow(2,y.zoom-K.tileID.overscaledZ),ye=a*K.queryPadding*c.N/K.tileSize/ue,te=[q.getTilePoint(new c.U(A,M)),q.getTilePoint(new c.U(O,H))];if(te[0].x-ye<c.N&&te[0].y-ye<c.N&&te[1].x+ye>=0&&te[1].y+ye>=0){const he=b.map(we=>q.getTilePoint(we)),ve=E.map(we=>q.getTilePoint(we));p.push({tile:K,tileID:q,queryGeometry:he,cameraQueryGeometry:ve,scale:ue})}}return p}getVisibleCoordinates(n){const a=this.getRenderableIds(n).map(h=>this._tiles[h].tileID);for(const h of a)h.posMatrix=this.transform.calculatePosMatrix(h.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Ht(this._source.type)){const n=c.h.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=n)return!0}return!1}setFeatureState(n,a,h){this._state.updateState(n=n||"_geojsonTileLayer",a,h)}removeFeatureState(n,a,h){this._state.removeFeatureState(n=n||"_geojsonTileLayer",a,h)}getFeatureState(n,a){return this._state.getState(n=n||"_geojsonTileLayer",a)}setDependencies(n,a,h){const p=this._tiles[n];p&&p.setDependencies(a,h)}reloadTilesForDependencies(n,a){for(const h in this._tiles)this._tiles[h].hasDependency(n,a)&&this._reloadTile(h,"reloading");this._cache.filter(h=>!h.hasDependency(n,a))}}function oi(m,n){const a=Math.abs(2*m.wrap)-+(m.wrap<0),h=Math.abs(2*n.wrap)-+(n.wrap<0);return m.overscaledZ-n.overscaledZ||h-a||n.canonical.y-m.canonical.y||n.canonical.x-m.canonical.x}function Ht(m){return m==="raster"||m==="image"||m==="video"}Ar.maxOverzooming=10,Ar.maxUnderzooming=3;const Mt="mapboxgl_preloaded_worker_pool";class Di{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Di.workerCount;)this.workers.push(new Worker(c.c.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Mt]}numActive(){return Object.keys(this.active).length}}const To=Math.floor(c.h.hardwareConcurrency/2);let es;function ol(){return es||(es=new Di),es}Di.workerCount=c.ac(globalThis)?Math.max(Math.min(To,3),1):1;class Eo{constructor(n,a){this.reset(n,a)}reset(n,a){this.points=n||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=c.ad(n,0,1);let a=1,h=this._distances[a];const p=n*this.paddedLength+this.padding;for(;h<p&&a<this._distances.length;)h=this._distances[++a];const y=a-1,w=this._distances[y],b=h-w,E=b>0?(p-w)/b:0;return this.points[y].mult(1-E).add(this.points[a].mult(E))}}function Ts(m,n){let a=!0;return m==="always"||m!=="never"&&n!=="never"||(a=!1),a}class Zs{constructor(n,a,h){const p=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/h),this.yCellCount=Math.ceil(a/h);for(let w=0;w<this.xCellCount*this.yCellCount;w++)p.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,a,h,p,y){this._forEachCell(a,h,p,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y)}insertCircle(n,a,h,p){this._forEachCell(a-p,h-p,a+p,h+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(h),this.circles.push(p)}_insertBoxCell(n,a,h,p,y,w){this.boxCells[y].push(w)}_insertCircleCell(n,a,h,p,y,w){this.circleCells[y].push(w)}_query(n,a,h,p,y,w,b){if(h<0||n>this.width||p<0||a>this.height)return[];const E=[];if(n<=0&&a<=0&&this.width<=h&&this.height<=p){if(y)return[{key:null,x1:n,y1:a,x2:h,y2:p}];for(let C=0;C<this.boxKeys.length;C++)E.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const A=this.circles[3*C],M=this.circles[3*C+1],O=this.circles[3*C+2];E.push({key:this.circleKeys[C],x1:A-O,y1:M-O,x2:A+O,y2:M+O})}}else this._forEachCell(n,a,h,p,this._queryCell,E,{hitTest:y,overlapMode:w,seenUids:{box:{},circle:{}}},b);return E}query(n,a,h,p){return this._query(n,a,h,p,!1,null)}hitTest(n,a,h,p,y,w){return this._query(n,a,h,p,!0,y,w).length>0}hitTestCircle(n,a,h,p,y){const w=n-h,b=n+h,E=a-h,C=a+h;if(b<0||w>this.width||C<0||E>this.height)return!1;const A=[];return this._forEachCell(w,E,b,C,this._queryCellCircle,A,{hitTest:!0,overlapMode:p,circle:{x:n,y:a,radius:h},seenUids:{box:{},circle:{}}},y),A.length>0}_queryCell(n,a,h,p,y,w,b,E){const{seenUids:C,hitTest:A,overlapMode:M}=b,O=this.boxCells[y];if(O!==null){const Z=this.bboxes;for(const K of O)if(!C.box[K]){C.box[K]=!0;const q=4*K,ue=this.boxKeys[K];if(n<=Z[q+2]&&a<=Z[q+3]&&h>=Z[q+0]&&p>=Z[q+1]&&(!E||E(ue))&&(!A||!Ts(M,ue.overlapMode))&&(w.push({key:ue,x1:Z[q],y1:Z[q+1],x2:Z[q+2],y2:Z[q+3]}),A))return!0}}const H=this.circleCells[y];if(H!==null){const Z=this.circles;for(const K of H)if(!C.circle[K]){C.circle[K]=!0;const q=3*K,ue=this.circleKeys[K];if(this._circleAndRectCollide(Z[q],Z[q+1],Z[q+2],n,a,h,p)&&(!E||E(ue))&&(!A||!Ts(M,ue.overlapMode))){const ye=Z[q],te=Z[q+1],he=Z[q+2];if(w.push({key:ue,x1:ye-he,y1:te-he,x2:ye+he,y2:te+he}),A)return!0}}}return!1}_queryCellCircle(n,a,h,p,y,w,b,E){const{circle:C,seenUids:A,overlapMode:M}=b,O=this.boxCells[y];if(O!==null){const Z=this.bboxes;for(const K of O)if(!A.box[K]){A.box[K]=!0;const q=4*K,ue=this.boxKeys[K];if(this._circleAndRectCollide(C.x,C.y,C.radius,Z[q+0],Z[q+1],Z[q+2],Z[q+3])&&(!E||E(ue))&&!Ts(M,ue.overlapMode))return w.push(!0),!0}}const H=this.circleCells[y];if(H!==null){const Z=this.circles;for(const K of H)if(!A.circle[K]){A.circle[K]=!0;const q=3*K,ue=this.circleKeys[K];if(this._circlesCollide(Z[q],Z[q+1],Z[q+2],C.x,C.y,C.radius)&&(!E||E(ue))&&!Ts(M,ue.overlapMode))return w.push(!0),!0}}}_forEachCell(n,a,h,p,y,w,b,E){const C=this._convertToXCellCoord(n),A=this._convertToYCellCoord(a),M=this._convertToXCellCoord(h),O=this._convertToYCellCoord(p);for(let H=C;H<=M;H++)for(let Z=A;Z<=O;Z++)if(y.call(this,n,a,h,p,this.xCellCount*Z+H,w,b,E))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,a,h,p,y,w){const b=p-n,E=y-a,C=h+w;return C*C>b*b+E*E}_circleAndRectCollide(n,a,h,p,y,w,b){const E=(w-p)/2,C=Math.abs(n-(p+E));if(C>E+h)return!1;const A=(b-y)/2,M=Math.abs(a-(y+A));if(M>A+h)return!1;if(C<=E||M<=A)return!0;const O=C-E,H=M-A;return O*O+H*H<=h*h}}function Be(m,n,a,h,p){const y=c.Z();return n?(c.a0(y,y,[1/p,1/p,1]),a||c.ae(y,y,h.angle)):c.a1(y,h.labelPlaneMatrix,m),y}function Li(m,n,a,h,p){if(n){const y=c.af(m);return c.a0(y,y,[p,p,1]),a||c.ae(y,y,-h.angle),y}return h.glCoordMatrix}function hn(m,n,a){let h;a?(h=[m.x,m.y,a(m.x,m.y),1],c.ag(h,h,n)):(h=[m.x,m.y,0,1],J(h,h,n));const p=h[3];return{point:new c.P(h[0]/p,h[1]/p),signedDistanceFromCamera:p}}function Hs(m,n){return .5+m/n*.5}function ts(m,n){const a=m[0]/m[3],h=m[1]/m[3];return a>=-n[0]&&a<=n[0]&&h>=-n[1]&&h<=n[1]}function Ue(m,n,a,h,p,y,w,b,E,C){const A=h?m.textSizeData:m.iconSizeData,M=c.ah(A,a.transform.zoom),O=[256/a.width*2+1,256/a.height*2+1],H=h?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;H.clear();const Z=m.lineVertexArray,K=h?m.text.placedSymbolArray:m.icon.placedSymbolArray,q=a.transform.width/a.transform.height;let ue=!1;for(let ye=0;ye<K.length;ye++){const te=K.get(ye);if(te.hidden||te.writingMode===c.ai.vertical&&!ue){$(te.numGlyphs,H);continue}let he;if(ue=!1,C?(he=[te.anchorX,te.anchorY,C(te.anchorX,te.anchorY),1],c.ag(he,he,n)):(he=[te.anchorX,te.anchorY,0,1],J(he,he,n)),!ts(he,O)){$(te.numGlyphs,H);continue}const ve=Hs(a.transform.cameraToCenterDistance,he[3]),we=c.aj(A,M,te),Ee=w?we/ve:we*ve,ze=new c.P(te.anchorX,te.anchorY),ke=hn(ze,p,C).point,Le={projections:{},offsets:{}},Je=xr(te,Ee,!1,b,n,p,y,m.glyphOffsetArray,Z,H,ke,ze,Le,q,E,C);ue=Je.useVertical,(Je.notEnoughRoom||ue||Je.needsFlipping&&xr(te,Ee,!0,b,n,p,y,m.glyphOffsetArray,Z,H,ke,ze,Le,q,E,C).notEnoughRoom)&&$(te.numGlyphs,H)}h?m.text.dynamicLayoutVertexBuffer.updateData(H):m.icon.dynamicLayoutVertexBuffer.updateData(H)}function vt(m,n,a,h,p,y,w,b,E,C,A,M,O){const H=b.glyphStartIndex+b.numGlyphs,Z=b.lineStartIndex,K=b.lineStartIndex+b.lineLength,q=n.getoffsetX(b.glyphStartIndex),ue=n.getoffsetX(H-1),ye=D(m*q,a,h,p,y,w,b.segment,Z,K,E,C,A,M,O);if(!ye)return null;const te=D(m*ue,a,h,p,y,w,b.segment,Z,K,E,C,A,M,O);return te?{first:ye,last:te}:null}function mt(m,n,a,h){return m===c.ai.horizontal&&Math.abs(a.y-n.y)>Math.abs(a.x-n.x)*h?{useVertical:!0}:(m===c.ai.vertical?n.y<a.y:n.x>a.x)?{needsFlipping:!0}:null}function xr(m,n,a,h,p,y,w,b,E,C,A,M,O,H,Z,K){const q=n/24,ue=m.lineOffsetX*q,ye=m.lineOffsetY*q;let te;if(m.numGlyphs>1){const he=m.glyphStartIndex+m.numGlyphs,ve=m.lineStartIndex,we=m.lineStartIndex+m.lineLength,Ee=vt(q,b,ue,ye,a,A,M,m,E,y,O,Z,K);if(!Ee)return{notEnoughRoom:!0};const ze=hn(Ee.first.point,w,K).point,ke=hn(Ee.last.point,w,K).point;if(h&&!a){const Le=mt(m.writingMode,ze,ke,H);if(Le)return Le}te=[Ee.first];for(let Le=m.glyphStartIndex+1;Le<he-1;Le++)te.push(D(q*b.getoffsetX(Le),ue,ye,a,A,M,m.segment,ve,we,E,y,O,Z,K));te.push(Ee.last)}else{if(h&&!a){const ve=hn(M,p,K).point,we=m.lineStartIndex+m.segment+1,Ee=new c.P(E.getx(we),E.gety(we)),ze=hn(Ee,p,K),ke=ze.signedDistanceFromCamera>0?ze.point:Fi(M,Ee,ve,1,p,K),Le=mt(m.writingMode,ve,ke,H);if(Le)return Le}const he=D(q*b.getoffsetX(m.glyphStartIndex),ue,ye,a,A,M,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,E,y,O,Z,K);if(!he)return{notEnoughRoom:!0};te=[he]}for(const he of te)c.ak(C,he.point,he.angle);return{}}function Fi(m,n,a,h,p,y){const w=hn(m.add(m.sub(n)._unit()),p,y).point,b=a.sub(w);return a.add(b._mult(h/b.mag()))}function yt(m,n){const{projectionCache:a,lineVertexArray:h,labelPlaneMatrix:p,tileAnchorPoint:y,distanceFromAnchor:w,getElevation:b,previousVertex:E,direction:C,absOffsetX:A}=n;if(a.projections[m])return a.projections[m];const M=new c.P(h.getx(m),h.gety(m)),O=hn(M,p,b);if(O.signedDistanceFromCamera>0)return a.projections[m]=O.point,O.point;const H=m-C;return Fi(w===0?y:new c.P(h.getx(H),h.gety(H)),M,E,A-w+1,p,b)}function ns(m,n,a){return m._unit()._perp()._mult(n*a)}function W(m,n,a,h,p,y,w,b){const{projectionCache:E,direction:C}=b;if(E.offsets[m])return E.offsets[m];const A=a.add(n);if(m+C<h||m+C>=p)return E.offsets[m]=A,A;const M=yt(m+C,b),O=ns(M.sub(a),w,C),H=a.add(O),Z=M.add(O);return E.offsets[m]=c.al(y,A,H,Z)||A,E.offsets[m]}function D(m,n,a,h,p,y,w,b,E,C,A,M,O,H){const Z=h?m-n:m+n;let K=Z>0?1:-1,q=0;h&&(K*=-1,q=Math.PI),K<0&&(q+=Math.PI);let ue,ye,te=K>0?b+w:b+w+1,he=p,ve=p,we=0,Ee=0;const ze=Math.abs(Z),ke=[];let Le;for(;we+Ee<=ze;){if(te+=K,te<b||te>=E)return null;we+=Ee,ve=he,ye=ue;const Ve={projectionCache:M,lineVertexArray:C,labelPlaneMatrix:A,tileAnchorPoint:y,distanceFromAnchor:we,getElevation:H,previousVertex:ve,direction:K,absOffsetX:ze};if(he=yt(te,Ve),a===0)ke.push(ve),Le=he.sub(ve);else{let ut;const et=he.sub(ve);ut=et.mag()===0?ns(yt(te+K,Ve).sub(he),a,K):ns(et,a,K),ye||(ye=ve.add(ut)),ue=W(te,ut,he,b,E,ye,a,Ve),ke.push(ye),Le=ue.sub(ye)}Ee=Le.mag()}const Je=Le._mult((ze-we)/Ee)._add(ye||ve),bt=q+Math.atan2(he.y-ve.y,he.x-ve.x);return ke.push(Je),{point:Je,angle:O?bt:0,path:ke}}const F=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $(m,n){for(let a=0;a<m;a++){const h=n.length;n.resize(h+4),n.float32.set(F,3*h)}}function J(m,n,a){const h=n[0],p=n[1];return m[0]=a[0]*h+a[4]*p+a[12],m[1]=a[1]*h+a[5]*p+a[13],m[3]=a[3]*h+a[7]*p+a[15],m}const ee=100;class fe{constructor(n,a=new Zs(n.width+200,n.height+200,25),h=new Zs(n.width+200,n.height+200,25)){this.transform=n,this.grid=a,this.ignoredGrid=h,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+ee,this.screenBottomBoundary=n.height+ee,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,a,h,p,y,w){const b=this.projectAndGetPerspectiveRatio(p,n.anchorPointX,n.anchorPointY,w),E=h*b.perspectiveRatio,C=n.x1*E+b.point.x,A=n.y1*E+b.point.y,M=n.x2*E+b.point.x,O=n.y2*E+b.point.y;return!this.isInsideGrid(C,A,M,O)||a!=="always"&&this.grid.hitTest(C,A,M,O,a,y)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[C,A,M,O],offscreen:this.isOffscreen(C,A,M,O)}}placeCollisionCircles(n,a,h,p,y,w,b,E,C,A,M,O,H,Z){const K=[],q=new c.P(a.anchorX,a.anchorY),ue=hn(q,w,Z),ye=Hs(this.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),te=(A?y/ye:y*ye)/c.ap,he=hn(q,b,Z).point,ve=vt(te,p,a.lineOffsetX*te,a.lineOffsetY*te,!1,he,q,a,h,b,{projections:{},offsets:{}},!1,Z);let we=!1,Ee=!1,ze=!0;if(ve){const ke=.5*O*ye+H,Le=new c.P(-100,-100),Je=new c.P(this.screenRightBoundary,this.screenBottomBoundary),bt=new Eo,Ve=ve.first,ut=ve.last;let et=[];for(let _t=Ve.path.length-1;_t>=1;_t--)et.push(Ve.path[_t]);for(let _t=1;_t<ut.path.length;_t++)et.push(ut.path[_t]);const Vt=2.5*ke;if(E){const _t=et.map(St=>hn(St,E,Z));et=_t.some(St=>St.signedDistanceFromCamera<=0)?[]:_t.map(St=>St.point)}let wt=[];if(et.length>0){const _t=et[0].clone(),St=et[0].clone();for(let _n=1;_n<et.length;_n++)_t.x=Math.min(_t.x,et[_n].x),_t.y=Math.min(_t.y,et[_n].y),St.x=Math.max(St.x,et[_n].x),St.y=Math.max(St.y,et[_n].y);wt=_t.x>=Le.x&&St.x<=Je.x&&_t.y>=Le.y&&St.y<=Je.y?[et]:St.x<Le.x||_t.x>Je.x||St.y<Le.y||_t.y>Je.y?[]:c.am([et],Le.x,Le.y,Je.x,Je.y)}for(const _t of wt){bt.reset(_t,.25*ke);let St=0;St=bt.length<=.5*ke?1:Math.ceil(bt.paddedLength/Vt)+1;for(let _n=0;_n<St;_n++){const Xt=_n/Math.max(St-1,1),rr=bt.lerp(Xt),Un=rr.x+ee,Tn=rr.y+ee;K.push(Un,Tn,ke,0);const Kr=Un-ke,Qt=Tn-ke,Bi=Un+ke,Ni=Tn+ke;if(ze=ze&&this.isOffscreen(Kr,Qt,Bi,Ni),Ee=Ee||this.isInsideGrid(Kr,Qt,Bi,Ni),n!=="always"&&this.grid.hitTestCircle(Un,Tn,ke,n,M)&&(we=!0,!C))return{circles:[],offscreen:!1,collisionDetected:we}}}}return{circles:!C&&we||!Ee||ye<this.perspectiveRatioCutoff?[]:K,offscreen:ze,collisionDetected:we}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let h=1/0,p=1/0,y=-1/0,w=-1/0;for(const A of n){const M=new c.P(A.x+ee,A.y+ee);h=Math.min(h,M.x),p=Math.min(p,M.y),y=Math.max(y,M.x),w=Math.max(w,M.y),a.push(M)}const b=this.grid.query(h,p,y,w).concat(this.ignoredGrid.query(h,p,y,w)),E={},C={};for(const A of b){const M=A.key;if(E[M.bucketInstanceId]===void 0&&(E[M.bucketInstanceId]={}),E[M.bucketInstanceId][M.featureIndex])continue;const O=[new c.P(A.x1,A.y1),new c.P(A.x2,A.y1),new c.P(A.x2,A.y2),new c.P(A.x1,A.y2)];c.an(a,O)&&(E[M.bucketInstanceId][M.featureIndex]=!0,C[M.bucketInstanceId]===void 0&&(C[M.bucketInstanceId]=[]),C[M.bucketInstanceId].push(M.featureIndex))}return C}insertCollisionBox(n,a,h,p,y,w){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:w,overlapMode:a},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,a,h,p,y,w){const b=h?this.ignoredGrid:this.grid,E={bucketInstanceId:p,featureIndex:y,collisionGroupID:w,overlapMode:a};for(let C=0;C<n.length;C+=4)b.insertCircle(E,n[C],n[C+1],n[C+2])}projectAndGetPerspectiveRatio(n,a,h,p){let y;return p?(y=[a,h,p(a,h),1],c.ag(y,y,n)):(y=[a,h,0,1],J(y,y,n)),{point:new c.P((y[0]/y[3]+1)/2*this.transform.width+ee,(-y[1]/y[3]+1)/2*this.transform.height+ee),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}}isOffscreen(n,a,h,p){return h<ee||n>=this.screenRightBoundary||p<ee||a>this.screenBottomBoundary}isInsideGrid(n,a,h,p){return h>=0&&n<this.gridRightBoundary&&p>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const n=c.ao([]);return c.$(n,n,[-100,-100,0]),n}}function ae(m,n,a){return n*(c.N/(m.tileSize*Math.pow(2,a-m.tileID.overscaledZ)))}class re{constructor(n,a,h,p){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):p&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class de{constructor(n,a,h,p,y){this.text=new re(n?n.text:null,a,h,y),this.icon=new re(n?n.icon:null,a,p,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Se{constructor(n,a,h){this.text=n,this.icon=a,this.skipFade=h}}class Te{constructor(){this.invProjMatrix=c.Z(),this.viewportMatrix=c.Z(),this.circles=[]}}class Ce{constructor(n,a,h,p,y){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=h,this.bucketIndex=p,this.tileID=y}}class st{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:h=>h.collisionGroupID===a}}return this.collisionGroups[n]}}function ft(m,n,a,h,p){const{horizontalAlign:y,verticalAlign:w}=c.au(m);return new c.P(-(y-.5)*n+h[0]*p,-(w-.5)*a+h[1]*p)}function Ye(m,n,a,h,p,y){const{x1:w,x2:b,y1:E,y2:C,anchorPointX:A,anchorPointY:M}=m,O=new c.P(n,a);return h&&O._rotate(p?y:-y),{x1:w+O.x,y1:E+O.y,x2:b+O.x,y2:C+O.y,anchorPointX:A,anchorPointY:M}}class at{constructor(n,a,h,p,y){this.transform=n.clone(),this.terrain=a,this.collisionIndex=new fe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new st(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,a,h,p){const y=h.getBucket(a),w=h.latestFeatureIndex;if(!y||!w||a.id!==y.layerIds[0])return;const b=h.collisionBoxArray,E=y.layers[0].layout,C=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),A=h.tileSize/c.N,M=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),O=E.get("text-pitch-alignment")==="map",H=E.get("text-rotation-alignment")==="map",Z=ae(h,1,this.transform.zoom),K=Be(M,O,H,this.transform,Z);let q=null;if(O){const ye=Li(M,O,H,this.transform,Z);q=c.a1([],this.transform.labelPlaneMatrix,ye)}this.retainedQueryData[y.bucketInstanceId]=new Ce(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,h.tileID);const ue={bucket:y,layout:E,posMatrix:M,textLabelPlaneMatrix:K,labelToScreenMatrix:q,scale:C,textPixelRatio:A,holdingForFade:h.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:c.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(p)for(const ye of y.sortKeyRanges){const{sortKey:te,symbolInstanceStart:he,symbolInstanceEnd:ve}=ye;n.push({sortKey:te,symbolInstanceStart:he,symbolInstanceEnd:ve,parameters:ue})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:ue})}attemptAnchorPlacement(n,a,h,p,y,w,b,E,C,A,M,O,H,Z,K,q){const ue=c.aq[n.textAnchor],ye=[n.textOffset0,n.textOffset1],te=ft(ue,h,p,ye,y),he=this.collisionIndex.placeCollisionBox(Ye(a,te.x,te.y,w,b,this.transform.angle),M,E,C,A.predicate,q);if((!K||this.collisionIndex.placeCollisionBox(Ye(K,te.x,te.y,w,b,this.transform.angle),M,E,C,A.predicate,q).box.length!==0)&&he.box.length>0){let ve;if(this.prevPlacement&&this.prevPlacement.variableOffsets[O.crossTileID]&&this.prevPlacement.placements[O.crossTileID]&&this.prevPlacement.placements[O.crossTileID].text&&(ve=this.prevPlacement.variableOffsets[O.crossTileID].anchor),O.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[O.crossTileID]={textOffset:ye,width:h,height:p,anchor:ue,textBoxScale:y,prevAnchor:ve},this.markUsedJustification(H,ue,O,Z),H.allowVerticalPlacement&&(this.markUsedOrientation(H,Z,O),this.placedOrientations[O.crossTileID]=Z),{shift:te,placedGlyphBoxes:he}}}placeLayerBucketPart(n,a,h){const{bucket:p,layout:y,posMatrix:w,textLabelPlaneMatrix:b,labelToScreenMatrix:E,textPixelRatio:C,holdingForFade:A,collisionBoxArray:M,partiallyEvaluatedTextSize:O,collisionGroup:H}=n.parameters,Z=y.get("text-optional"),K=y.get("icon-optional"),q=c.ar(y,"text-overlap","text-allow-overlap"),ue=q==="always",ye=c.ar(y,"icon-overlap","icon-allow-overlap"),te=ye==="always",he=y.get("text-rotation-alignment")==="map",ve=y.get("text-pitch-alignment")==="map",we=y.get("icon-text-fit")!=="none",Ee=y.get("symbol-z-order")==="viewport-y",ze=ue&&(te||!p.hasIconData()||K),ke=te&&(ue||!p.hasTextData()||Z);!p.collisionArrays&&M&&p.deserializeCollisionBoxes(M);const Le=this.retainedQueryData[p.bucketInstanceId].tileID,Je=this.terrain?(Ve,ut)=>this.terrain.getElevation(Le,Ve,ut):null,bt=(Ve,ut)=>{var et,Vt;if(a[Ve.crossTileID])return;if(A)return void(this.placements[Ve.crossTileID]=new Se(!1,!1,!1));let wt=!1,_t=!1,St=!0,_n=null,Xt={box:null,offscreen:null},rr={box:null,offscreen:null},Un=null,Tn=null,Kr=null,Qt=0,Bi=0,Ni=0;ut.textFeatureIndex?Qt=ut.textFeatureIndex:Ve.useRuntimeCollisionCircles&&(Qt=Ve.featureIndex),ut.verticalTextFeatureIndex&&(Bi=ut.verticalTextFeatureIndex);const Ms=ut.textBox;if(Ms){const pr=vn=>{let Vn=c.ai.horizontal;if(p.allowVerticalPlacement&&!vn&&this.prevPlacement){const Rr=this.prevPlacement.placedOrientations[Ve.crossTileID];Rr&&(this.placedOrientations[Ve.crossTileID]=Rr,Vn=Rr,this.markUsedOrientation(p,Vn,Ve))}return Vn},ir=(vn,Vn)=>{if(p.allowVerticalPlacement&&Ve.numVerticalGlyphVertices>0&&ut.verticalTextBox){for(const Rr of p.writingModes)if(Rr===c.ai.vertical?(Xt=Vn(),rr=Xt):Xt=vn(),Xt&&Xt.box&&Xt.box.length)break}else Xt=vn()},br=Ve.textAnchorOffsetStartIndex,ro=Ve.textAnchorOffsetEndIndex;if(ro===br){const vn=(Vn,Rr)=>{const xn=this.collisionIndex.placeCollisionBox(Vn,q,C,w,H.predicate,Je);return xn&&xn.box&&xn.box.length&&(this.markUsedOrientation(p,Rr,Ve),this.placedOrientations[Ve.crossTileID]=Rr),xn};ir(()=>vn(Ms,c.ai.horizontal),()=>{const Vn=ut.verticalTextBox;return p.allowVerticalPlacement&&Ve.numVerticalGlyphVertices>0&&Vn?vn(Vn,c.ai.vertical):{box:null,offscreen:null}}),pr(Xt&&Xt.box&&Xt.box.length)}else{let vn=c.aq[(Vt=(et=this.prevPlacement)===null||et===void 0?void 0:et.variableOffsets[Ve.crossTileID])===null||Vt===void 0?void 0:Vt.anchor];const Vn=(xn,io,Ll)=>{const bd=xn.x2-xn.x1,Sd=xn.y2-xn.y1,em=Ve.textBoxScale,wu=we&&ye==="never"?io:null;let ji={box:[],offscreen:!1},so=q==="never"?1:2,Ui="never";vn&&so++;for(let pi=0;pi<so;pi++){for(let Vi=br;Vi<ro;Vi++){const bu=p.textAnchorOffsets.get(Vi);if(vn&&bu.textAnchor!==vn)continue;const ls=this.attemptAnchorPlacement(bu,xn,bd,Sd,em,he,ve,C,w,H,Ui,Ve,p,Ll,wu,Je);if(ls&&(ji=ls.placedGlyphBoxes,ji&&ji.box&&ji.box.length))return wt=!0,_n=ls.shift,ji}vn?vn=null:Ui=q}return ji};ir(()=>Vn(Ms,ut.iconBox,c.ai.horizontal),()=>{const xn=ut.verticalTextBox;return p.allowVerticalPlacement&&!(Xt&&Xt.box&&Xt.box.length)&&Ve.numVerticalGlyphVertices>0&&xn?Vn(xn,ut.verticalIconBox,c.ai.vertical):{box:null,offscreen:null}}),Xt&&(wt=Xt.box,St=Xt.offscreen);const Rr=pr(Xt&&Xt.box);if(!wt&&this.prevPlacement){const xn=this.prevPlacement.variableOffsets[Ve.crossTileID];xn&&(this.variableOffsets[Ve.crossTileID]=xn,this.markUsedJustification(p,xn.anchor,Ve,Rr))}}}if(Un=Xt,wt=Un&&Un.box&&Un.box.length>0,St=Un&&Un.offscreen,Ve.useRuntimeCollisionCircles){const pr=p.text.placedSymbolArray.get(Ve.centerJustifiedTextSymbolIndex),ir=c.aj(p.textSizeData,O,pr),br=y.get("text-padding");Tn=this.collisionIndex.placeCollisionCircles(q,pr,p.lineVertexArray,p.glyphOffsetArray,ir,w,b,E,h,ve,H.predicate,Ve.collisionCircleDiameter,br,Je),Tn.circles.length&&Tn.collisionDetected&&!h&&c.w("Collisions detected, but collision boxes are not shown"),wt=ue||Tn.circles.length>0&&!Tn.collisionDetected,St=St&&Tn.offscreen}if(ut.iconFeatureIndex&&(Ni=ut.iconFeatureIndex),ut.iconBox){const pr=ir=>{const br=we&&_n?Ye(ir,_n.x,_n.y,he,ve,this.transform.angle):ir;return this.collisionIndex.placeCollisionBox(br,ye,C,w,H.predicate,Je)};rr&&rr.box&&rr.box.length&&ut.verticalIconBox?(Kr=pr(ut.verticalIconBox),_t=Kr.box.length>0):(Kr=pr(ut.iconBox),_t=Kr.box.length>0),St=St&&Kr.offscreen}const no=Z||Ve.numHorizontalGlyphVertices===0&&Ve.numVerticalGlyphVertices===0,No=K||Ve.numIconVertices===0;if(no||No?No?no||(_t=_t&&wt):wt=_t&&wt:_t=wt=_t&&wt,wt&&Un&&Un.box&&this.collisionIndex.insertCollisionBox(Un.box,q,y.get("text-ignore-placement"),p.bucketInstanceId,rr&&rr.box&&Bi?Bi:Qt,H.ID),_t&&Kr&&this.collisionIndex.insertCollisionBox(Kr.box,ye,y.get("icon-ignore-placement"),p.bucketInstanceId,Ni,H.ID),Tn&&(wt&&this.collisionIndex.insertCollisionCircles(Tn.circles,q,y.get("text-ignore-placement"),p.bucketInstanceId,Qt,H.ID),h)){const pr=p.bucketInstanceId;let ir=this.collisionCircleArrays[pr];ir===void 0&&(ir=this.collisionCircleArrays[pr]=new Te);for(let br=0;br<Tn.circles.length;br+=4)ir.circles.push(Tn.circles[br+0]),ir.circles.push(Tn.circles[br+1]),ir.circles.push(Tn.circles[br+2]),ir.circles.push(Tn.collisionDetected?1:0)}if(Ve.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ve.crossTileID]=new Se(wt||ze,_t||ke,St||p.justReloaded),a[Ve.crossTileID]=!0};if(Ee){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ve=p.getSortedSymbolIndexes(this.transform.angle);for(let ut=Ve.length-1;ut>=0;--ut){const et=Ve[ut];bt(p.symbolInstances.get(et),p.collisionArrays[et])}}else for(let Ve=n.symbolInstanceStart;Ve<n.symbolInstanceEnd;Ve++)bt(p.symbolInstances.get(Ve),p.collisionArrays[Ve]);if(h&&p.bucketInstanceId in this.collisionCircleArrays){const Ve=this.collisionCircleArrays[p.bucketInstanceId];c.as(Ve.invProjMatrix,w),Ve.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(n,a,h,p){let y;y=p===c.ai.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[c.at(a)];const w=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const b of w)b>=0&&(n.text.placedSymbolArray.get(b).crossTileID=y>=0&&b!==y?0:h.crossTileID)}markUsedOrientation(n,a,h){const p=a===c.ai.horizontal||a===c.ai.horizontalOnly?a:0,y=a===c.ai.vertical?a:0,w=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const b of w)n.text.placedSymbolArray.get(b).placedOrientation=p;h.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let h=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const p=a?a.symbolFadeChange(n):1,y=a?a.opacities:{},w=a?a.variableOffsets:{},b=a?a.placedOrientations:{};for(const E in this.placements){const C=this.placements[E],A=y[E];A?(this.opacities[E]=new de(A,p,C.text,C.icon),h=h||C.text!==A.text.placed||C.icon!==A.icon.placed):(this.opacities[E]=new de(null,p,C.text,C.icon,C.skipFade),h=h||C.text||C.icon)}for(const E in y){const C=y[E];if(!this.opacities[E]){const A=new de(C,p,!1,!1);A.isHidden()||(this.opacities[E]=A,h=h||C.text.placed||C.icon.placed)}}for(const E in w)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=w[E]);for(const E in b)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=b[E]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)}updateLayerOpacities(n,a){const h={};for(const p of a){const y=p.getBucket(n);y&&p.latestFeatureIndex&&n.id===y.layerIds[0]&&this.updateBucketOpacities(y,h,p.collisionBoxArray)}}updateBucketOpacities(n,a,h){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const p=n.layers[0],y=p.layout,w=new de(null,0,!1,!1,!0),b=y.get("text-allow-overlap"),E=y.get("icon-allow-overlap"),C=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),A=y.get("text-rotation-alignment")==="map",M=y.get("text-pitch-alignment")==="map",O=y.get("icon-text-fit")!=="none",H=new de(null,0,b&&(E||!n.hasIconData()||y.get("icon-optional")),E&&(b||!n.hasTextData()||y.get("text-optional")),!0);!n.collisionArrays&&h&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(h);const Z=(K,q,ue)=>{for(let ye=0;ye<q/4;ye++)K.opacityVertexArray.emplaceBack(ue);K.hasVisibleVertices=K.hasVisibleVertices||ue!==ai};for(let K=0;K<n.symbolInstances.length;K++){const q=n.symbolInstances.get(K),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:ye,crossTileID:te}=q;let he=this.opacities[te];a[te]?he=w:he||(he=H,this.opacities[te]=he),a[te]=!0;const ve=q.numIconVertices>0,we=this.placedOrientations[q.crossTileID],Ee=we===c.ai.vertical,ze=we===c.ai.horizontal||we===c.ai.horizontalOnly;if(ue>0||ye>0){const ke=tr(he.text);Z(n.text,ue,Ee?ai:ke),Z(n.text,ye,ze?ai:ke);const Le=he.text.isHidden();[q.rightJustifiedTextSymbolIndex,q.centerJustifiedTextSymbolIndex,q.leftJustifiedTextSymbolIndex].forEach(Ve=>{Ve>=0&&(n.text.placedSymbolArray.get(Ve).hidden=Le||Ee?1:0)}),q.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(q.verticalPlacedTextSymbolIndex).hidden=Le||ze?1:0);const Je=this.variableOffsets[q.crossTileID];Je&&this.markUsedJustification(n,Je.anchor,q,we);const bt=this.placedOrientations[q.crossTileID];bt&&(this.markUsedJustification(n,"left",q,bt),this.markUsedOrientation(n,bt,q))}if(ve){const ke=tr(he.icon),Le=!(O&&q.verticalPlacedIconSymbolIndex&&Ee);q.placedIconSymbolIndex>=0&&(Z(n.icon,q.numIconVertices,Le?ke:ai),n.icon.placedSymbolArray.get(q.placedIconSymbolIndex).hidden=he.icon.isHidden()),q.verticalPlacedIconSymbolIndex>=0&&(Z(n.icon,q.numVerticalIconVertices,Le?ai:ke),n.icon.placedSymbolArray.get(q.verticalPlacedIconSymbolIndex).hidden=he.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const ke=n.collisionArrays[K];if(ke){let Le=new c.P(0,0);if(ke.textBox||ke.verticalTextBox){let bt=!0;if(C){const Ve=this.variableOffsets[te];Ve?(Le=ft(Ve.anchor,Ve.width,Ve.height,Ve.textOffset,Ve.textBoxScale),A&&Le._rotate(M?this.transform.angle:-this.transform.angle)):bt=!1}ke.textBox&&gt(n.textCollisionBox.collisionVertexArray,he.text.placed,!bt||Ee,Le.x,Le.y),ke.verticalTextBox&&gt(n.textCollisionBox.collisionVertexArray,he.text.placed,!bt||ze,Le.x,Le.y)}const Je=!!(!ze&&ke.verticalIconBox);ke.iconBox&&gt(n.iconCollisionBox.collisionVertexArray,he.icon.placed,Je,O?Le.x:0,O?Le.y:0),ke.verticalIconBox&&gt(n.iconCollisionBox.collisionVertexArray,he.icon.placed,!Je,O?Le.x:0,O?Le.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const K=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=K.invProjMatrix,n.placementViewportMatrix=K.viewportMatrix,n.collisionCircleArray=K.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,a){const h=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*h>n}setStale(){this.stale=!0}}function gt(m,n,a,h,p){m.emplaceBack(n?1:0,a?1:0,h||0,p||0),m.emplaceBack(n?1:0,a?1:0,h||0,p||0),m.emplaceBack(n?1:0,a?1:0,h||0,p||0),m.emplaceBack(n?1:0,a?1:0,h||0,p||0)}const Ot=Math.pow(2,25),$t=Math.pow(2,24),At=Math.pow(2,17),kt=Math.pow(2,16),hr=Math.pow(2,9),Kt=Math.pow(2,8),Rn=Math.pow(2,1);function tr(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const n=m.placed?1:0,a=Math.floor(127*m.opacity);return a*Ot+n*$t+a*At+n*kt+a*hr+n*Kt+a*Rn+n}const ai=0;class Bh{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,a,h,p,y){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(a.getBucketParts(w,p,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((b,E)=>b.sortKey-E.sortKey));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,y())return!0;return!1}}class Io{constructor(n,a,h,p,y,w,b,E){this.placement=new at(n,a,w,b,E),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(n,a,h){const p=c.h.now(),y=()=>!this._forceFullPlacement&&c.h.now()-p>2;for(;this._currentPlacementIndex>=0;){const w=a[n[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=b)&&(!w.maxzoom||w.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new Bh(w)),this._inProgressLayer.continuePlacement(h[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Co=512/c.N/2;class Of{constructor(n,a,h){this.tileID=n,this.bucketInstanceId=h,this._symbolsByKey={};const p=new Map;for(let y=0;y<a.length;y++){const w=a.get(y),b=w.key,E=p.get(b);E?E.push(w):p.set(b,[w])}for(const[y,w]of p){const b={positions:w.map(E=>({x:Math.floor(E.anchorX*Co),y:Math.floor(E.anchorY*Co)})),crossTileIDs:w.map(E=>E.crossTileID)};if(b.positions.length>128){const E=new c.av(b.positions.length,16,Uint16Array);for(const{x:C,y:A}of b.positions)E.add(C,A);E.finish(),delete b.positions,b.index=E}this._symbolsByKey[y]=b}}getScaledCoordinates(n,a){const{x:h,y:p,z:y}=this.tileID.canonical,{x:w,y:b,z:E}=a.canonical,C=Co/Math.pow(2,E-y),A=(b*c.N+n.anchorY)*C,M=p*c.N*Co;return{x:Math.floor((w*c.N+n.anchorX)*C-h*c.N*Co),y:Math.floor(A-M)}}findMatches(n,a,h){const p=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let y=0;y<n.length;y++){const w=n.get(y);if(w.crossTileID)continue;const b=this._symbolsByKey[w.key];if(!b)continue;const E=this.getScaledCoordinates(w,a);if(b.index){const C=b.index.range(E.x-p,E.y-p,E.x+p,E.y+p).sort();for(const A of C){const M=b.crossTileIDs[A];if(!h[M]){h[M]=!0,w.crossTileID=M;break}}}else if(b.positions)for(let C=0;C<b.positions.length;C++){const A=b.positions[C],M=b.crossTileIDs[C];if(Math.abs(A.x-E.x)<=p&&Math.abs(A.y-E.y)<=p&&!h[M]){h[M]=!0,w.crossTileID=M;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class Ut{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Dc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const a=Math.round((n-this.lng)/360);if(a!==0)for(const h in this.indexes){const p=this.indexes[h],y={};for(const w in p){const b=p[w];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+a),y[b.tileID.key]=b}this.indexes[h]=y}this.lng=n}addBucket(n,a,h){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let y=0;y<a.symbolInstances.length;y++)a.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const p=this.usedCrossTileIDs[n.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>n.overscaledZ)for(const b in w){const E=w[b];E.tileID.isChildOf(n)&&E.findMatches(a.symbolInstances,n,p)}else{const b=w[n.scaledTo(Number(y)).key];b&&b.findMatches(a.symbolInstances,n,p)}}for(let y=0;y<a.symbolInstances.length;y++){const w=a.symbolInstances.get(y);w.crossTileID||(w.crossTileID=h.generate(),p[w.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Of(n,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(n,a){for(const h of a.getCrossTileIDsLists())for(const p of h)delete this.usedCrossTileIDs[n][p]}removeStaleBuckets(n){let a=!1;for(const h in this.indexes){const p=this.indexes[h];for(const y in p)n[p[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,p[y]),delete p[y],a=!0)}return a}}class al{constructor(){this.layerIndexes={},this.crossTileIDs=new Ut,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,a,h){let p=this.layerIndexes[n.id];p===void 0&&(p=this.layerIndexes[n.id]=new Dc);let y=!1;const w={};p.handleWrapJump(h);for(const b of a){const E=b.getBucket(n);E&&n.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(b.tileID,E,this.crossTileIDs)&&(y=!0),w[E.bucketInstanceId]=!0)}return p.removeStaleBuckets(w)&&(y=!0),y}pruneUnusedLayers(n){const a={};n.forEach(h=>{a[h]=!0});for(const h in this.layerIndexes)a[h]||delete this.layerIndexes[h]}}const dr=(m,n)=>c.x(m,n&&n.filter(a=>a.identifier!=="source.canvas")),qr=c.F(c.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Bf=c.F(c.ax,["setCenter","setZoom","setBearing","setPitch"]),li=c.aw();class nr extends c.E{constructor(n,a={}){super(),this.map=n,this.dispatcher=new jt(ol(),this,n._getMapId()),this.imageManager=new Nn,this.imageManager.setEventedParent(this),this.glyphManager=new er(n._requestManager,a.localIdeographFontFamily),this.lineAtlas=new pt(256,512),this.crossTileSymbolIndex=new al,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.az());const h=this;this._rtlTextPluginCallback=nr.registerForPluginStateChange(p=>{h.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(y,w)=>{if(c.aA(y),w&&w.every(b=>b))for(const b in h.sourceCaches){const E=h.sourceCaches[b].getSource().type;E!=="vector"&&E!=="geojson"||h.sourceCaches[b].reload()}})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const y=this.sourceCaches[p.sourceId];if(!y)return;const w=y.getSource();if(w&&w.vectorLayerIds)for(const b in this._layers){const E=this._layers[b];E.source===w.id&&this._validateLayer(E)}})}loadURL(n,a={},h){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const p=this.map._requestManager.transformRequest(n,X.Style);this._request=c.f(p,(y,w)=>{this._request=null,y?this.fire(new c.j(y)):w&&this._load(w,a,h)})}loadJSON(n,a={},h){this.fire(new c.k("dataloading",{dataType:"style"})),this._request=c.h.frame(()=>{this._request=null,a.validate=a.validate!==!1,this._load(n,a,h)})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(li,{validate:!1})}_load(n,a,h){var p;const y=a.transformStyle?a.transformStyle(h,n):n;if(!a.validate||!dr(this,c.y(y))){this._loaded=!0,this.stylesheet=y;for(const w in y.sources)this.addSource(w,y.sources[w],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new dt(this.stylesheet.light),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const n=c.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",n),this._order=n.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of n){const h=c.aC(a);h.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=h}}_loadSprite(n,a=!1,h=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(p,y,w,b){const E=qe(p),C=E.length,A=w>1?"@2x":"",M={},O={},H={};for(const{id:Z,url:K}of E){const q=y.transformRequest(y.normalizeSpriteURL(K,A,".json"),X.SpriteJSON),ue=`${Z}_${q.url}`;M[ue]=c.f(q,(he,ve)=>{delete M[ue],O[Z]=ve,Gt(b,O,H,he,C)});const ye=y.transformRequest(y.normalizeSpriteURL(K,A,".png"),X.SpriteImage),te=`${Z}_${ye.url}`;M[te]=Me.getImage(ye,(he,ve)=>{delete M[te],H[Z]=ve,Gt(b,O,H,he,C)})}return{cancel(){for(const Z of Object.values(M))Z.cancel()}}}(n,this.map._requestManager,this.map.getPixelRatio(),(p,y)=>{if(this._spriteRequest=null,p)this.fire(new c.j(p));else if(y)for(const w in y){this._spritesImagesIds[w]=[];const b=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(E=>!(E in y)):[];for(const E of b)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in y[w]){const C=w==="default"?E:`${w}:${E}`;this._spritesImagesIds[w].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,y[w][E],!1):this.imageManager.addImage(C,y[w][E]),a&&(this._changedImages[C]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),h&&h(p)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(n){const a=this.sourceCaches[n.source];if(!a)return;const h=n.sourceLayer;if(!h)return;const p=a.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(h)===-1)&&this.fire(new c.j(new Error(`Source layer "${h}" does not exist on source "${p.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n){const a=this._serializedAllLayers();if(!n||n.length===0)return Object.values(a);const h=[];for(const p of n)a[p]&&h.push(a[p]);return h}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const a=Object.keys(this._layers);for(const h of a){const p=this._layers[h];p.type!=="custom"&&(n[h]=p.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const a=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(p.length||y.length)&&this._updateWorkerLayers(p,y);for(const w in this._updatedSources){const b=this._updatedSources[w];if(b==="reload")this._reloadSource(w);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}const h={};for(const p in this.sourceCaches){const y=this.sourceCaches[p];h[p]=y.used,y.used=!1}for(const p of this._order){const y=this._layers[p];y.recalculate(n,this._availableImages),!y.isHidden(n.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const p in h){const y=this.sourceCaches[p];h[p]!==y.used&&y.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(n),this.z=n.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,a){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(n),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,a={}){this._checkLoaded();const h=this.serialize();if(n=a.transformStyle?a.transformStyle(h,n):n,dr(this,c.y(n)))return!1;(n=c.aD(n)).layers=c.aB(n.layers);const p=c.aE(h,n).filter(w=>!(w.command in Bf));if(p.length===0)return!1;const y=p.filter(w=>!(w.command in qr));if(y.length>0)throw new Error(`Unimplemented: ${y.map(w=>w.command).join(", ")}.`);for(const w of p)w.command!=="setTransition"&&this[w.command].apply(this,w.args);return this.stylesheet=n,this._serializedLayers=null,!0}addImage(n,a){if(this.getImage(n))return this.fire(new c.j(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,a),this._afterImageUpdated(n)}updateImage(n,a){this.imageManager.updateImage(n,a)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new c.j(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,a,h={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.y.source,`sources.${n}`,a,null,h))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const p=this.sourceCaches[n]=new Ar(n,a,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:n})),p.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===n)return this.fire(new c.j(new Error(`Source "${n}" cannot be removed while layer "${h}" is using it.`)));const a=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,a){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const h=this.sourceCaches[n].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(a),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,a,h={}){this._checkLoaded();const p=n.id;if(this.getLayer(p))return void this.fire(new c.j(new Error(`Layer "${p}" already exists on this map.`)));let y;if(n.type==="custom"){if(dr(this,c.aF(n)))return;y=c.aC(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(p,n.source),n=c.aD(n),n=c.e(n,{source:p})),this._validate(c.y.layer,`layers.${p}`,n,{arrayIndex:-1},h))return;y=c.aC(n),this._validateLayer(y),y.setEventedParent(this,{layer:{id:p}})}const w=a?this._order.indexOf(a):this._order.length;if(a&&w===-1)this.fire(new c.j(new Error(`Cannot add layer "${p}" before non-existing layer "${a}".`)));else{if(this._order.splice(w,0,p),this._layerOrderChanged=!0,this._layers[p]=y,this._removedLayers[p]&&y.source&&y.type!=="custom"){const b=this._removedLayers[p];delete this._removedLayers[p],b.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(n,a){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new c.j(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===a)return;const h=this._order.indexOf(n);this._order.splice(h,1);const p=a?this._order.indexOf(a):this._order.length;a&&p===-1?this.fire(new c.j(new Error(`Cannot move layer "${n}" before non-existing layer "${a}".`))):(this._order.splice(p,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const a=this._layers[n];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${n}".`)));a.setEventedParent(null);const h=this._order.indexOf(n);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=a,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],a.onRemove&&a.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,a,h){this._checkLoaded();const p=this.getLayer(n);p?p.minzoom===a&&p.maxzoom===h||(a!=null&&(p.minzoom=a),h!=null&&(p.maxzoom=h),this._updateLayer(p)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,a,h={}){this._checkLoaded();const p=this.getLayer(n);if(p){if(!c.aG(p.filter,a))return a==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(c.y.filter,`layers.${p.id}.filter`,a,null,h)||(p.filter=c.aD(a),this._updateLayer(p)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return c.aD(this.getLayer(n).filter)}setLayoutProperty(n,a,h,p={}){this._checkLoaded();const y=this.getLayer(n);y?c.aG(y.getLayoutProperty(a),h)||(y.setLayoutProperty(a,h,p),this._updateLayer(y)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,a){const h=this.getLayer(n);if(h)return h.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,a,h,p={}){this._checkLoaded();const y=this.getLayer(n);y?c.aG(y.getPaintProperty(a),h)||(y.setPaintProperty(a,h,p)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new c.j(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,a){return this.getLayer(n).getPaintProperty(a)}setFeatureState(n,a){this._checkLoaded();const h=n.source,p=n.sourceLayer,y=this.sourceCaches[h];if(y===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const w=y.getSource().type;w==="geojson"&&p?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||p?(n.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(p,n.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,a){this._checkLoaded();const h=n.source,p=this.sourceCaches[h];if(p===void 0)return void this.fire(new c.j(new Error(`The source '${h}' does not exist in the map's style.`)));const y=p.getSource().type,w=y==="vector"?n.sourceLayer:void 0;y!=="vector"||w?a&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(w,n.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const a=n.source,h=n.sourceLayer,p=this.sourceCaches[a];if(p!==void 0)return p.getSource().type!=="vector"||h?(n.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),p.getFeatureState(h,n.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=c.aH(this.sourceCaches,y=>y.serialize()),a=this._serializeByIds(this._order),h=this.map.getTerrain()||void 0,p=this.stylesheet;return c.aI({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:n,layers:a,terrain:h},y=>y!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const a=w=>this._layers[w].type==="fill-extrusion",h={},p=[];for(let w=this._order.length-1;w>=0;w--){const b=this._order[w];if(a(b)){h[b]=w;for(const E of n){const C=E[b];if(C)for(const A of C)p.push(A)}}}p.sort((w,b)=>b.intersectionZ-w.intersectionZ);const y=[];for(let w=this._order.length-1;w>=0;w--){const b=this._order[w];if(a(b))for(let E=p.length-1;E>=0;E--){const C=p[E].feature;if(h[C.layer.id]<w)break;y.push(C),p.pop()}else for(const E of n){const C=E[b];if(C)for(const A of C)y.push(A.feature)}}return y}queryRenderedFeatures(n,a,h){a&&a.filter&&this._validate(c.y.filter,"queryRenderedFeatures.filter",a.filter,null,a);const p={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const b of a.layers){const E=this._layers[b];if(!E)return this.fire(new c.j(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];p[E.source]=!0}}const y=[];a.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const b in this.sourceCaches)a.layers&&!p[b]||y.push(qs(this.sourceCaches[b],this._layers,w,n,a,h));return this.placement&&y.push(function(b,E,C,A,M,O,H){const Z={},K=O.queryRenderedSymbols(A),q=[];for(const ue of Object.keys(K).map(Number))q.push(H[ue]);q.sort(bs);for(const ue of q){const ye=ue.featureIndex.lookupSymbolFeatures(K[ue.bucketInstanceId],E,ue.bucketIndex,ue.sourceLayerIndex,M.filter,M.layers,M.availableImages,b);for(const te in ye){const he=Z[te]=Z[te]||[],ve=ye[te];ve.sort((we,Ee)=>{const ze=ue.featureSortOrder;if(ze){const ke=ze.indexOf(we.featureIndex);return ze.indexOf(Ee.featureIndex)-ke}return Ee.featureIndex-we.featureIndex});for(const we of ve)he.push(we)}}for(const ue in Z)Z[ue].forEach(ye=>{const te=ye.feature,he=C[b[ue].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=he});return Z}(this._layers,w,this.sourceCaches,n,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(n,a){a&&a.filter&&this._validate(c.y.filter,"querySourceFeatures.filter",a.filter,null,a);const h=this.sourceCaches[n];return h?function(p,y){const w=p.getRenderableIds().map(C=>p.getTileByID(C)),b=[],E={};for(let C=0;C<w.length;C++){const A=w[C],M=A.tileID.canonical.key;E[M]||(E[M]=!0,A.querySourceFeatures(b,y))}return b}(h,a):[]}addSourceType(n,a,h){return Qi(n)?h(new Error(`A source type called "${n}" already exists.`)):(((p,y)=>{va[p]=y})(n,a),a.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:a.workerSourceURL},h):h(null,null))}getLight(){return this.light.getLight()}setLight(n,a={}){this._checkLoaded();const h=this.light.getLight();let p=!1;for(const w in n)if(!c.aG(n[w],h[w])){p=!0;break}if(!p)return;const y={now:c.h.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,a),this.light.updateTransitions(y)}_validate(n,a,h,p,y={}){return(!y||y.validate!==!1)&&dr(this,n.call(c.y,c.e({key:a,style:this.serialize(),value:h,styleSpec:c.v},p)))}_remove(n=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const h=this.sourceCaches[a];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const a in this.sourceCaches)this.sourceCaches[a].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,a,h,p,y=!1){let w=!1,b=!1;const E={};for(const C of this._order){const A=this._layers[C];if(A.type!=="symbol")continue;if(!E[A.source]){const O=this.sourceCaches[A.source];E[A.source]=O.getRenderableIds(!0).map(H=>O.getTileByID(H)).sort((H,Z)=>Z.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(Z.tileID)?-1:1))}const M=this.crossTileSymbolIndex.addLayer(A,E[A.source],n.center.lng);w=w||M}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.h.now(),n.zoom))&&(this.pauseablePlacement=new Io(n,this.map.terrain,this._order,y,a,h,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.h.now()),b=!0),w&&this.pauseablePlacement.placement.setStale()),b||w)for(const C of this._order){const A=this._layers[C];A.type==="symbol"&&this.placement.updateLayerOpacities(A,E[A.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.h.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,a,h){this.imageManager.getImages(a.icons,h),this._updateTilesForChangedImages();const p=this.sourceCaches[a.source];p&&p.setDependencies(a.tileID.key,a.type,a.icons)}getGlyphs(n,a,h){this.glyphManager.getGlyphs(a.stacks,h);const p=this.sourceCaches[a.source];p&&p.setDependencies(a.tileID.key,a.type,[""])}getResource(n,a,h){return c.m(a,h)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,a={}){this._checkLoaded(),n&&this._validate(c.y.glyphs,"glyphs",n,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,a,h={},p){this._checkLoaded();const y=[{id:n,url:a}],w=[...qe(this.stylesheet.sprite),...y];this._validate(c.y.sprite,"sprite",w,null,h)||(this.stylesheet.sprite=w,this._loadSprite(y,!0,p))}removeSprite(n){this._checkLoaded();const a=qe(this.stylesheet.sprite);if(a.find(h=>h.id===n)){if(this._spritesImagesIds[n])for(const h of this._spritesImagesIds[n])this.imageManager.removeImage(h),this._changedImages[h]=!0;a.splice(a.findIndex(h=>h.id===n),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return qe(this.stylesheet.sprite)}setSprite(n,a={},h){this._checkLoaded(),n&&this._validate(c.y.sprite,"sprite",n,null,a)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,h):(this._unloadSprite(),h&&h(null)))}}nr.registerForPluginStateChange=c.aK;var ll=c.Q([{name:"a_pos",type:"Int16",components:2}]),ko="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const sn={prelude:Dt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Dt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Dt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Dt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Dt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Dt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Dt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Dt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Dt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Dt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Dt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Dt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Dt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Dt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Dt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Dt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Dt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Dt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Dt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Dt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Dt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Dt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Dt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ko),terrainDepth:Dt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ko),terrainCoords:Dt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ko)};function Dt(m,n){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=n.match(/attribute ([\w]+) ([\w]+)/g),p=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=y?y.concat(p):p,b={};return{fragmentSource:m=m.replace(a,(E,C,A,M,O)=>(b[O]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${O}
varying ${A} ${M} ${O};
#else
uniform ${A} ${M} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${A} ${M} ${O} = u_${O};
#endif
`)),vertexSource:n=n.replace(a,(E,C,A,M,O)=>{const H=M==="float"?"vec2":"vec4",Z=O.match(/color/)?"color":H;return b[O]?C==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${A} ${H} a_${O};
varying ${A} ${M} ${O};
#else
uniform ${A} ${M} u_${O};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${A} ${M} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${Z}(a_${O}, u_${O}_t);
#else
    ${A} ${M} ${O} = u_${O};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${A} ${H} a_${O};
#else
uniform ${A} ${M} u_${O};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${A} ${M} ${O} = a_${O};
#else
    ${A} ${M} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${A} ${M} ${O} = unpack_mix_${Z}(a_${O}, u_${O}_t);
#else
    ${A} ${M} ${O} = u_${O};
#endif
`}),staticAttributes:h,staticUniforms:w}}class Ws{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,a,h,p,y,w,b,E,C){this.context=n;let A=this.boundPaintVertexBuffers.length!==p.length;for(let M=0;!A&&M<p.length;M++)this.boundPaintVertexBuffers[M]!==p[M]&&(A=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==h||A||this.boundIndexBuffer!==y||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==C?this.freshBind(a,h,p,y,w,b,E,C):(n.bindVertexArray.set(this.vao),b&&b.bind(),y&&y.dynamicDraw&&y.bind(),E&&E.bind(),C&&C.bind())}freshBind(n,a,h,p,y,w,b,E){const C=n.numAttributes,A=this.context,M=A.gl;this.vao&&this.destroy(),this.vao=A.createVertexArray(),A.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=p,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=E,a.enableAttributes(M,n);for(const O of h)O.enableAttributes(M,n);w&&w.enableAttributes(M,n),b&&b.enableAttributes(M,n),E&&E.enableAttributes(M,n),a.bind(),a.setVertexAttribPointers(M,n,y);for(const O of h)O.bind(),O.setVertexAttribPointers(M,n,y);w&&(w.bind(),w.setVertexAttribPointers(M,n,y)),p&&p.bind(),b&&(b.bind(),b.setVertexAttribPointers(M,n,y)),E&&(E.bind(),E.setVertexAttribPointers(M,n,y)),A.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function dn(m){const n=[];for(let a=0;a<m.length;a++){if(m[a]===null)continue;const h=m[a].split(" ");n.push(h.pop())}return n}class cl{constructor(n,a,h,p,y,w){const b=n.gl;this.program=b.createProgram();const E=dn(a.staticAttributes),C=h?h.getBinderAttributes():[],A=E.concat(C),M=sn.prelude.staticUniforms?dn(sn.prelude.staticUniforms):[],O=a.staticUniforms?dn(a.staticUniforms):[],H=h?h.getBinderUniforms():[],Z=M.concat(O).concat(H),K=[];for(const we of Z)K.indexOf(we)<0&&K.push(we);const q=h?h.defines():[];y&&q.push("#define OVERDRAW_INSPECTOR;"),w&&q.push("#define TERRAIN3D;");const ue=q.concat(sn.prelude.fragmentSource,a.fragmentSource).join(`
`),ye=q.concat(sn.prelude.vertexSource,a.vertexSource).join(`
`),te=b.createShader(b.FRAGMENT_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(te,ue),b.compileShader(te),!b.getShaderParameter(te,b.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${b.getShaderInfoLog(te)}`);b.attachShader(this.program,te);const he=b.createShader(b.VERTEX_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(he,ye),b.compileShader(he),!b.getShaderParameter(he,b.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${b.getShaderInfoLog(he)}`);b.attachShader(this.program,he),this.attributes={};const ve={};this.numAttributes=A.length;for(let we=0;we<this.numAttributes;we++)A[we]&&(b.bindAttribLocation(this.program,we,A[we]),this.attributes[A[we]]=we);if(b.linkProgram(this.program),!b.getProgramParameter(this.program,b.LINK_STATUS))throw new Error(`Program failed to link: ${b.getProgramInfoLog(this.program)}`);b.deleteShader(he),b.deleteShader(te);for(let we=0;we<K.length;we++){const Ee=K[we];if(Ee&&!ve[Ee]){const ze=b.getUniformLocation(this.program,Ee);ze&&(ve[Ee]=ze)}}this.fixedUniforms=p(n,ve),this.terrainUniforms=((we,Ee)=>({u_depth:new c.aL(we,Ee.u_depth),u_terrain:new c.aL(we,Ee.u_terrain),u_terrain_dim:new c.aM(we,Ee.u_terrain_dim),u_terrain_matrix:new c.aN(we,Ee.u_terrain_matrix),u_terrain_unpack:new c.aO(we,Ee.u_terrain_unpack),u_terrain_exaggeration:new c.aM(we,Ee.u_terrain_exaggeration)}))(n,ve),this.binderUniforms=h?h.getUniforms(n,ve):[]}draw(n,a,h,p,y,w,b,E,C,A,M,O,H,Z,K,q,ue,ye){const te=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(h),n.setStencilMode(p),n.setColorMode(y),n.setCullFace(w),E){n.activeTexture.set(te.TEXTURE2),te.bindTexture(te.TEXTURE_2D,E.depthTexture),n.activeTexture.set(te.TEXTURE3),te.bindTexture(te.TEXTURE_2D,E.texture);for(const ve in this.terrainUniforms)this.terrainUniforms[ve].set(E[ve])}for(const ve in this.fixedUniforms)this.fixedUniforms[ve].set(b[ve]);K&&K.setUniforms(n,this.binderUniforms,H,{zoom:Z});let he=0;switch(a){case te.LINES:he=2;break;case te.TRIANGLES:he=3;break;case te.LINE_STRIP:he=1}for(const ve of O.get()){const we=ve.vaos||(ve.vaos={});(we[C]||(we[C]=new Ws)).bind(n,this,A,K?K.getPaintVertexBuffers():[],M,ve.vertexOffset,q,ue,ye),te.drawElements(a,ve.primitiveLength*he,te.UNSIGNED_SHORT,ve.primitiveOffset*he*2)}}}function ci(m,n,a){const h=1/ae(a,1,n.transform.tileZoom),p=Math.pow(2,a.tileID.overscaledZ),y=a.tileSize*Math.pow(2,n.transform.tileZoom)/p,w=y*(a.tileID.canonical.x+a.tileID.wrap*p),b=y*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[h,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[w>>16,b>>16],u_pixel_coord_lower:[65535&w,65535&b]}}const Lc=(m,n,a,h)=>{const p=n.style.light,y=p.properties.get("position"),w=[y.x,y.y,y.z],b=function(){var C=new c.A(9);return c.A!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C}();p.properties.get("anchor")==="viewport"&&function(C,A){var M=Math.sin(A),O=Math.cos(A);C[0]=O,C[1]=M,C[2]=0,C[3]=-M,C[4]=O,C[5]=0,C[6]=0,C[7]=0,C[8]=1}(b,-n.transform.angle),function(C,A,M){var O=A[0],H=A[1],Z=A[2];C[0]=O*M[0]+H*M[3]+Z*M[6],C[1]=O*M[1]+H*M[4]+Z*M[7],C[2]=O*M[2]+H*M[5]+Z*M[8]}(w,w,b);const E=p.properties.get("color");return{u_matrix:m,u_lightpos:w,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+a,u_opacity:h}},Es=(m,n,a,h,p,y,w)=>c.e(Lc(m,n,a,h),ci(y,n,w),{u_height_factor:-Math.pow(2,p.overscaledZ)/w.tileSize/8}),Nh=m=>({u_matrix:m}),Fc=(m,n,a,h)=>c.e(Nh(m),ci(a,n,h)),ul=(m,n)=>({u_matrix:m,u_world:n}),hl=(m,n,a,h,p)=>c.e(Fc(m,n,a,h),{u_world:p}),Is=(m,n,a,h)=>{const p=m.transform;let y,w;if(h.paint.get("circle-pitch-alignment")==="map"){const b=ae(a,1,p.zoom);y=!0,w=[b,b]}else y=!1,w=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(h.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(n.posMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:w}},Oc=(m,n,a)=>{const h=ae(a,1,n.zoom),p=Math.pow(2,n.zoom-a.tileID.overscaledZ),y=a.tileID.overscaleFactor();return{u_matrix:m,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:h,u_extrude_scale:[n.pixelsToGLUnits[0]/(h*p),n.pixelsToGLUnits[1]/(h*p)],u_overscale_factor:y}},xa=(m,n,a=1)=>({u_matrix:m,u_color:n,u_overlay:0,u_overlay_scale:a}),jh=m=>({u_matrix:m}),Nf=(m,n,a,h)=>({u_matrix:m,u_extrude_scale:ae(n,1,a),u_intensity:h});function Bc(m,n){const a=Math.pow(2,n.canonical.z),h=n.canonical.y;return[new c.U(0,h/a).toLngLat().lat,new c.U(0,(h+1)/a).toLngLat().lat]}const Nc=(m,n,a,h)=>{const p=m.transform;return{u_matrix:dl(m,n,a,h),u_ratio:1/ae(n,1,p.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Uh=(m,n,a,h,p)=>c.e(Nc(m,n,a,p),{u_image:0,u_image_height:h}),jf=(m,n,a,h,p)=>{const y=m.transform,w=$h(n,y);return{u_matrix:dl(m,n,a,p),u_texsize:n.imageAtlasTexture.size,u_ratio:1/ae(n,1,y.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[w,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Vh=(m,n,a,h,p,y)=>{const w=m.lineAtlas,b=$h(n,m.transform),E=a.layout.get("line-cap")==="round",C=w.getDash(h.from,E),A=w.getDash(h.to,E),M=C.width*p.fromScale,O=A.width*p.toScale;return c.e(Nc(m,n,a,y),{u_patternscale_a:[b/M,-C.height/2],u_patternscale_b:[b/O,-A.height/2],u_sdfgamma:w.width/(256*Math.min(M,O)*m.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:A.y,u_mix:p.t})};function $h(m,n){return 1/ae(m,1,n.tileZoom)}function dl(m,n,a,h){return m.translatePosMatrix(h?h.posMatrix:n.tileID.posMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const qh=(m,n,a,h,p)=>{return{u_matrix:m,u_tl_parent:n,u_scale_parent:a,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(w=p.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(y=p.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:Gh(p.paint.get("raster-hue-rotate"))};var y,w};function Gh(m){m*=Math.PI/180;const n=Math.sin(m),a=Math.cos(m);return[(2*a+1)/3,(-Math.sqrt(3)*n-a+1)/3,(Math.sqrt(3)*n-a+1)/3]}const jc=(m,n,a,h,p,y,w,b,E,C)=>{const A=p.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:A.cameraToCenterDistance,u_pitch:A.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:A.width/A.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:w,u_coord_matrix:b,u_is_text:+E,u_pitch_with_map:+h,u_texsize:C,u_texture:0}},Uc=(m,n,a,h,p,y,w,b,E,C,A)=>{const M=p.transform;return c.e(jc(m,n,a,h,p,y,w,b,E,C),{u_gamma_scale:h?Math.cos(M._pitch)*M.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+A})},Ks=(m,n,a,h,p,y,w,b,E,C)=>c.e(Uc(m,n,a,h,p,y,w,b,!0,E,!0),{u_texsize_icon:C,u_texture_icon:1}),pl=(m,n,a)=>({u_matrix:m,u_opacity:n,u_color:a}),ui=(m,n,a,h,p,y)=>c.e(function(w,b,E,C){const A=E.imageManager.getPattern(w.from.toString()),M=E.imageManager.getPattern(w.to.toString()),{width:O,height:H}=E.imageManager.getPixelSize(),Z=Math.pow(2,C.tileID.overscaledZ),K=C.tileSize*Math.pow(2,E.transform.tileZoom)/Z,q=K*(C.tileID.canonical.x+C.tileID.wrap*Z),ue=K*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:A.tl,u_pattern_br_a:A.br,u_pattern_tl_b:M.tl,u_pattern_br_b:M.br,u_texsize:[O,H],u_mix:b.t,u_pattern_size_a:A.displaySize,u_pattern_size_b:M.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/ae(C,1,E.transform.tileZoom),u_pixel_coord_upper:[q>>16,ue>>16],u_pixel_coord_lower:[65535&q,65535&ue]}}(h,y,a,p),{u_matrix:m,u_opacity:n}),fl={fillExtrusion:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_lightpos:new c.aP(m,n.u_lightpos),u_lightintensity:new c.aM(m,n.u_lightintensity),u_lightcolor:new c.aP(m,n.u_lightcolor),u_vertical_gradient:new c.aM(m,n.u_vertical_gradient),u_opacity:new c.aM(m,n.u_opacity)}),fillExtrusionPattern:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_lightpos:new c.aP(m,n.u_lightpos),u_lightintensity:new c.aM(m,n.u_lightintensity),u_lightcolor:new c.aP(m,n.u_lightcolor),u_vertical_gradient:new c.aM(m,n.u_vertical_gradient),u_height_factor:new c.aM(m,n.u_height_factor),u_image:new c.aL(m,n.u_image),u_texsize:new c.aQ(m,n.u_texsize),u_pixel_coord_upper:new c.aQ(m,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,n.u_pixel_coord_lower),u_scale:new c.aP(m,n.u_scale),u_fade:new c.aM(m,n.u_fade),u_opacity:new c.aM(m,n.u_opacity)}),fill:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix)}),fillPattern:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_image:new c.aL(m,n.u_image),u_texsize:new c.aQ(m,n.u_texsize),u_pixel_coord_upper:new c.aQ(m,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,n.u_pixel_coord_lower),u_scale:new c.aP(m,n.u_scale),u_fade:new c.aM(m,n.u_fade)}),fillOutline:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_world:new c.aQ(m,n.u_world)}),fillOutlinePattern:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_world:new c.aQ(m,n.u_world),u_image:new c.aL(m,n.u_image),u_texsize:new c.aQ(m,n.u_texsize),u_pixel_coord_upper:new c.aQ(m,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,n.u_pixel_coord_lower),u_scale:new c.aP(m,n.u_scale),u_fade:new c.aM(m,n.u_fade)}),circle:(m,n)=>({u_camera_to_center_distance:new c.aM(m,n.u_camera_to_center_distance),u_scale_with_map:new c.aL(m,n.u_scale_with_map),u_pitch_with_map:new c.aL(m,n.u_pitch_with_map),u_extrude_scale:new c.aQ(m,n.u_extrude_scale),u_device_pixel_ratio:new c.aM(m,n.u_device_pixel_ratio),u_matrix:new c.aN(m,n.u_matrix)}),collisionBox:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_camera_to_center_distance:new c.aM(m,n.u_camera_to_center_distance),u_pixels_to_tile_units:new c.aM(m,n.u_pixels_to_tile_units),u_extrude_scale:new c.aQ(m,n.u_extrude_scale),u_overscale_factor:new c.aM(m,n.u_overscale_factor)}),collisionCircle:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_inv_matrix:new c.aN(m,n.u_inv_matrix),u_camera_to_center_distance:new c.aM(m,n.u_camera_to_center_distance),u_viewport_size:new c.aQ(m,n.u_viewport_size)}),debug:(m,n)=>({u_color:new c.aR(m,n.u_color),u_matrix:new c.aN(m,n.u_matrix),u_overlay:new c.aL(m,n.u_overlay),u_overlay_scale:new c.aM(m,n.u_overlay_scale)}),clippingMask:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix)}),heatmap:(m,n)=>({u_extrude_scale:new c.aM(m,n.u_extrude_scale),u_intensity:new c.aM(m,n.u_intensity),u_matrix:new c.aN(m,n.u_matrix)}),heatmapTexture:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_world:new c.aQ(m,n.u_world),u_image:new c.aL(m,n.u_image),u_color_ramp:new c.aL(m,n.u_color_ramp),u_opacity:new c.aM(m,n.u_opacity)}),hillshade:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_image:new c.aL(m,n.u_image),u_latrange:new c.aQ(m,n.u_latrange),u_light:new c.aQ(m,n.u_light),u_shadow:new c.aR(m,n.u_shadow),u_highlight:new c.aR(m,n.u_highlight),u_accent:new c.aR(m,n.u_accent)}),hillshadePrepare:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_image:new c.aL(m,n.u_image),u_dimension:new c.aQ(m,n.u_dimension),u_zoom:new c.aM(m,n.u_zoom),u_unpack:new c.aO(m,n.u_unpack)}),line:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_ratio:new c.aM(m,n.u_ratio),u_device_pixel_ratio:new c.aM(m,n.u_device_pixel_ratio),u_units_to_pixels:new c.aQ(m,n.u_units_to_pixels)}),lineGradient:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_ratio:new c.aM(m,n.u_ratio),u_device_pixel_ratio:new c.aM(m,n.u_device_pixel_ratio),u_units_to_pixels:new c.aQ(m,n.u_units_to_pixels),u_image:new c.aL(m,n.u_image),u_image_height:new c.aM(m,n.u_image_height)}),linePattern:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_texsize:new c.aQ(m,n.u_texsize),u_ratio:new c.aM(m,n.u_ratio),u_device_pixel_ratio:new c.aM(m,n.u_device_pixel_ratio),u_image:new c.aL(m,n.u_image),u_units_to_pixels:new c.aQ(m,n.u_units_to_pixels),u_scale:new c.aP(m,n.u_scale),u_fade:new c.aM(m,n.u_fade)}),lineSDF:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_ratio:new c.aM(m,n.u_ratio),u_device_pixel_ratio:new c.aM(m,n.u_device_pixel_ratio),u_units_to_pixels:new c.aQ(m,n.u_units_to_pixels),u_patternscale_a:new c.aQ(m,n.u_patternscale_a),u_patternscale_b:new c.aQ(m,n.u_patternscale_b),u_sdfgamma:new c.aM(m,n.u_sdfgamma),u_image:new c.aL(m,n.u_image),u_tex_y_a:new c.aM(m,n.u_tex_y_a),u_tex_y_b:new c.aM(m,n.u_tex_y_b),u_mix:new c.aM(m,n.u_mix)}),raster:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_tl_parent:new c.aQ(m,n.u_tl_parent),u_scale_parent:new c.aM(m,n.u_scale_parent),u_buffer_scale:new c.aM(m,n.u_buffer_scale),u_fade_t:new c.aM(m,n.u_fade_t),u_opacity:new c.aM(m,n.u_opacity),u_image0:new c.aL(m,n.u_image0),u_image1:new c.aL(m,n.u_image1),u_brightness_low:new c.aM(m,n.u_brightness_low),u_brightness_high:new c.aM(m,n.u_brightness_high),u_saturation_factor:new c.aM(m,n.u_saturation_factor),u_contrast_factor:new c.aM(m,n.u_contrast_factor),u_spin_weights:new c.aP(m,n.u_spin_weights)}),symbolIcon:(m,n)=>({u_is_size_zoom_constant:new c.aL(m,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aL(m,n.u_is_size_feature_constant),u_size_t:new c.aM(m,n.u_size_t),u_size:new c.aM(m,n.u_size),u_camera_to_center_distance:new c.aM(m,n.u_camera_to_center_distance),u_pitch:new c.aM(m,n.u_pitch),u_rotate_symbol:new c.aL(m,n.u_rotate_symbol),u_aspect_ratio:new c.aM(m,n.u_aspect_ratio),u_fade_change:new c.aM(m,n.u_fade_change),u_matrix:new c.aN(m,n.u_matrix),u_label_plane_matrix:new c.aN(m,n.u_label_plane_matrix),u_coord_matrix:new c.aN(m,n.u_coord_matrix),u_is_text:new c.aL(m,n.u_is_text),u_pitch_with_map:new c.aL(m,n.u_pitch_with_map),u_texsize:new c.aQ(m,n.u_texsize),u_texture:new c.aL(m,n.u_texture)}),symbolSDF:(m,n)=>({u_is_size_zoom_constant:new c.aL(m,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aL(m,n.u_is_size_feature_constant),u_size_t:new c.aM(m,n.u_size_t),u_size:new c.aM(m,n.u_size),u_camera_to_center_distance:new c.aM(m,n.u_camera_to_center_distance),u_pitch:new c.aM(m,n.u_pitch),u_rotate_symbol:new c.aL(m,n.u_rotate_symbol),u_aspect_ratio:new c.aM(m,n.u_aspect_ratio),u_fade_change:new c.aM(m,n.u_fade_change),u_matrix:new c.aN(m,n.u_matrix),u_label_plane_matrix:new c.aN(m,n.u_label_plane_matrix),u_coord_matrix:new c.aN(m,n.u_coord_matrix),u_is_text:new c.aL(m,n.u_is_text),u_pitch_with_map:new c.aL(m,n.u_pitch_with_map),u_texsize:new c.aQ(m,n.u_texsize),u_texture:new c.aL(m,n.u_texture),u_gamma_scale:new c.aM(m,n.u_gamma_scale),u_device_pixel_ratio:new c.aM(m,n.u_device_pixel_ratio),u_is_halo:new c.aL(m,n.u_is_halo)}),symbolTextAndIcon:(m,n)=>({u_is_size_zoom_constant:new c.aL(m,n.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aL(m,n.u_is_size_feature_constant),u_size_t:new c.aM(m,n.u_size_t),u_size:new c.aM(m,n.u_size),u_camera_to_center_distance:new c.aM(m,n.u_camera_to_center_distance),u_pitch:new c.aM(m,n.u_pitch),u_rotate_symbol:new c.aL(m,n.u_rotate_symbol),u_aspect_ratio:new c.aM(m,n.u_aspect_ratio),u_fade_change:new c.aM(m,n.u_fade_change),u_matrix:new c.aN(m,n.u_matrix),u_label_plane_matrix:new c.aN(m,n.u_label_plane_matrix),u_coord_matrix:new c.aN(m,n.u_coord_matrix),u_is_text:new c.aL(m,n.u_is_text),u_pitch_with_map:new c.aL(m,n.u_pitch_with_map),u_texsize:new c.aQ(m,n.u_texsize),u_texsize_icon:new c.aQ(m,n.u_texsize_icon),u_texture:new c.aL(m,n.u_texture),u_texture_icon:new c.aL(m,n.u_texture_icon),u_gamma_scale:new c.aM(m,n.u_gamma_scale),u_device_pixel_ratio:new c.aM(m,n.u_device_pixel_ratio),u_is_halo:new c.aL(m,n.u_is_halo)}),background:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_opacity:new c.aM(m,n.u_opacity),u_color:new c.aR(m,n.u_color)}),backgroundPattern:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_opacity:new c.aM(m,n.u_opacity),u_image:new c.aL(m,n.u_image),u_pattern_tl_a:new c.aQ(m,n.u_pattern_tl_a),u_pattern_br_a:new c.aQ(m,n.u_pattern_br_a),u_pattern_tl_b:new c.aQ(m,n.u_pattern_tl_b),u_pattern_br_b:new c.aQ(m,n.u_pattern_br_b),u_texsize:new c.aQ(m,n.u_texsize),u_mix:new c.aM(m,n.u_mix),u_pattern_size_a:new c.aQ(m,n.u_pattern_size_a),u_pattern_size_b:new c.aQ(m,n.u_pattern_size_b),u_scale_a:new c.aM(m,n.u_scale_a),u_scale_b:new c.aM(m,n.u_scale_b),u_pixel_coord_upper:new c.aQ(m,n.u_pixel_coord_upper),u_pixel_coord_lower:new c.aQ(m,n.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aM(m,n.u_tile_units_to_pixels)}),terrain:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_texture:new c.aL(m,n.u_texture),u_ele_delta:new c.aM(m,n.u_ele_delta)}),terrainDepth:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_ele_delta:new c.aM(m,n.u_ele_delta)}),terrainCoords:(m,n)=>({u_matrix:new c.aN(m,n.u_matrix),u_texture:new c.aL(m,n.u_texture),u_terrain_coords_id:new c.aM(m,n.u_terrain_coords_id),u_ele_delta:new c.aM(m,n.u_ele_delta)})};class ml{constructor(n,a,h){this.context=n;const p=n.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const wa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class gl{constructor(n,a,h,p){this.length=a.length,this.attributes=h,this.itemSize=a.bytesPerElement,this.dynamicDraw=p,this.context=n;const y=n.gl;this.buffer=y.createBuffer(),n.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,a){for(let h=0;h<this.attributes.length;h++){const p=a.attributes[this.attributes[h].name];p!==void 0&&n.enableVertexAttribArray(p)}}setVertexAttribPointers(n,a,h){for(let p=0;p<this.attributes.length;p++){const y=this.attributes[p],w=a.attributes[y.name];w!==void 0&&n.vertexAttribPointer(w,y.components,n[wa[y.type]],!1,this.itemSize,y.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Po=new WeakMap;function Cs(m){var n;if(Po.has(m))return Po.get(m);{const a=(n=m.getParameter(m.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return Po.set(m,a),a}}class Et{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yl extends Et{getDefault(){return c.aT.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Gr extends Et{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Zr extends Et{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Vc extends Et{getDefault(){return[!0,!0,!0,!0]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class _l extends Et{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class vl extends Et{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class $c extends Et{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const a=this.current;(n.func!==a.func||n.ref!==a.ref||n.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class qc extends Et{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class xl extends Et{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=n,this.dirty=!1}}class Gc extends Et{getDefault(){return[0,1]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Zc extends Et{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=n,this.dirty=!1}}class wl extends Et{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Zh extends Et{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.BLEND):a.disable(a.BLEND),this.current=n,this.dirty=!1}}class Hh extends Et{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Ao extends Et{getDefault(){return c.aT.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Uf extends Et{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Vf extends Et{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=n,this.dirty=!1}}class $f extends Et{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class qf extends Et{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Gf extends Et{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Zf extends Et{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Hc extends Et{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class bl extends Et{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Wc extends Et{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Kc extends Et{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Mo extends Et{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Wh extends Et{getDefault(){return null}set(n){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Kh extends Et{getDefault(){return null}set(n){var a;if(n===this.current&&!this.dirty)return;const h=this.gl;Cs(h)?h.bindVertexArray(n):(a=h.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class Xc extends Et{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Xs extends Et{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Xh extends Et{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class ks extends Et{constructor(n,a){super(n),this.context=n,this.parent=a}getDefault(){return null}}class zo extends ks{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Yh extends ks{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Yc extends ks{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Lt{constructor(n,a,h,p,y){this.context=n,this.width=a,this.height=h;const w=n.gl,b=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new zo(n,b),p)this.depthAttachment=y?new Yc(n,b):new Yh(n,b);else if(y)throw new Error("Stencil cannot be setted without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){const h=this.depthAttachment.get();h&&n.deleteRenderbuffer(h)}n.deleteFramebuffer(this.framebuffer)}}class on{constructor(n,a,h){this.blendFunction=n,this.blendColor=a,this.mask=h}}on.Replace=[1,0],on.disabled=new on(on.Replace,c.aT.transparent,[!1,!1,!1,!1]),on.unblended=new on(on.Replace,c.aT.transparent,[!0,!0,!0,!0]),on.alphaBlended=new on([1,771],c.aT.transparent,[!0,!0,!0,!0]);class Hf{constructor(n){var a,h;if(this.gl=n,this.clearColor=new yl(this),this.clearDepth=new Gr(this),this.clearStencil=new Zr(this),this.colorMask=new Vc(this),this.depthMask=new _l(this),this.stencilMask=new vl(this),this.stencilFunc=new $c(this),this.stencilOp=new qc(this),this.stencilTest=new xl(this),this.depthRange=new Gc(this),this.depthTest=new Zc(this),this.depthFunc=new wl(this),this.blend=new Zh(this),this.blendFunc=new Hh(this),this.blendColor=new Ao(this),this.blendEquation=new Uf(this),this.cullFace=new Vf(this),this.cullFaceSide=new $f(this),this.frontFace=new qf(this),this.program=new Gf(this),this.activeTexture=new Zf(this),this.viewport=new Hc(this),this.bindFramebuffer=new bl(this),this.bindRenderbuffer=new Wc(this),this.bindTexture=new Kc(this),this.bindVertexBuffer=new Mo(this),this.bindElementBuffer=new Wh(this),this.bindVertexArray=new Kh(this),this.pixelStoreUnpack=new Xc(this),this.pixelStoreUnpackPremultiplyAlpha=new Xs(this),this.pixelStoreUnpackFlipY=new Xh(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Cs(n)){this.HALF_FLOAT=n.HALF_FLOAT;const p=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=n.RGBA16F)!==null&&a!==void 0?a:p==null?void 0:p.RGBA16F_EXT,this.RGB16F=(h=n.RGB16F)!==null&&h!==void 0?h:p==null?void 0:p.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const p=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=p==null?void 0:p.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,a){return new ml(this,n,a)}createVertexBuffer(n,a,h){return new gl(this,n,a,h)}createRenderbuffer(n,a,h){const p=this.gl,y=p.createRenderbuffer();return this.bindRenderbuffer.set(y),p.renderbufferStorage(p.RENDERBUFFER,n,a,h),this.bindRenderbuffer.set(null),y}createFramebuffer(n,a,h,p){return new Lt(this,n,a,h,p)}clear({color:n,depth:a,stencil:h}){const p=this.gl;let y=0;n&&(y|=p.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(y|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),h!==void 0&&(y|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),p.clear(y)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){c.aG(n.blendFunction,on.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Cs(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var a;return Cs(this.gl)?this.gl.deleteVertexArray(n):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class It{constructor(n,a,h){this.func=n,this.mask=a,this.range=h}}It.ReadOnly=!1,It.ReadWrite=!0,It.disabled=new It(519,It.ReadOnly,[0,1]);const Ys=7680;class an{constructor(n,a,h,p,y,w){this.test=n,this.ref=a,this.mask=h,this.fail=p,this.depthFail=y,this.pass=w}}an.disabled=new an({func:519,mask:0},0,0,Ys,Ys,Ys);class nn{constructor(n,a,h){this.enable=n,this.mode=a,this.frontFace=h}}let ba;function Jh(m,n,a,h,p,y,w){const b=m.context,E=b.gl,C=m.useProgram("collisionBox"),A=[];let M=0,O=0;for(let te=0;te<h.length;te++){const he=h[te],ve=n.getTile(he),we=ve.getBucket(a);if(!we)continue;let Ee=he.posMatrix;p[0]===0&&p[1]===0||(Ee=m.translatePosMatrix(he.posMatrix,ve,p,y));const ze=w?we.textCollisionBox:we.iconCollisionBox,ke=we.collisionCircleArray;if(ke.length>0){const Le=c.Z(),Je=Ee;c.aU(Le,we.placementInvProjMatrix,m.transform.glCoordMatrix),c.aU(Le,Le,we.placementViewportMatrix),A.push({circleArray:ke,circleOffset:O,transform:Je,invTransform:Le,coord:he}),M+=ke.length/4,O=M}ze&&C.draw(b,E.LINES,It.disabled,an.disabled,m.colorModeForRenderPass(),nn.disabled,Oc(Ee,m.transform,ve),m.style.map.terrain&&m.style.map.terrain.getTerrainData(he),a.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,null,m.transform.zoom,null,null,ze.collisionVertexBuffer)}if(!w||!A.length)return;const H=m.useProgram("collisionCircle"),Z=new c.aV;Z.resize(4*M),Z._trim();let K=0;for(const te of A)for(let he=0;he<te.circleArray.length/4;he++){const ve=4*he,we=te.circleArray[ve+0],Ee=te.circleArray[ve+1],ze=te.circleArray[ve+2],ke=te.circleArray[ve+3];Z.emplace(K++,we,Ee,ze,ke,0),Z.emplace(K++,we,Ee,ze,ke,1),Z.emplace(K++,we,Ee,ze,ke,2),Z.emplace(K++,we,Ee,ze,ke,3)}(!ba||ba.length<2*M)&&(ba=function(te){const he=2*te,ve=new c.aX;ve.resize(he),ve._trim();for(let we=0;we<he;we++){const Ee=6*we;ve.uint16[Ee+0]=4*we+0,ve.uint16[Ee+1]=4*we+1,ve.uint16[Ee+2]=4*we+2,ve.uint16[Ee+3]=4*we+2,ve.uint16[Ee+4]=4*we+3,ve.uint16[Ee+5]=4*we+0}return ve}(M));const q=b.createIndexBuffer(ba,!0),ue=b.createVertexBuffer(Z,c.aW.members,!0);for(const te of A){const he={u_matrix:te.transform,u_inv_matrix:te.invTransform,u_camera_to_center_distance:(ye=m.transform).cameraToCenterDistance,u_viewport_size:[ye.width,ye.height]};H.draw(b,E.TRIANGLES,It.disabled,an.disabled,m.colorModeForRenderPass(),nn.disabled,he,m.style.map.terrain&&m.style.map.terrain.getTerrainData(te.coord),a.id,ue,q,c.S.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,m.transform.zoom,null,null,null)}var ye;ue.destroy(),q.destroy()}nn.disabled=new nn(!1,1029,2305),nn.backCCW=new nn(!0,1029,2305);const Jc=c.ao(new Float32Array(16));function Sl(m,n,a,h,p,y){const{horizontalAlign:w,verticalAlign:b}=c.au(m);return new c.P((-(w-.5)*n/p+h[0])*y,(-(b-.5)*a/p+h[1])*y)}function Tl(m,n,a,h,p,y,w,b,E,C,A){const M=m.text.placedSymbolArray,O=m.text.dynamicLayoutVertexArray,H=m.icon.dynamicLayoutVertexArray,Z={};O.clear();for(let K=0;K<M.length;K++){const q=M.get(K),ue=q.hidden||!q.crossTileID||m.allowVerticalPlacement&&!q.placedOrientation?null:h[q.crossTileID];if(ue){const ye=new c.P(q.anchorX,q.anchorY),te=hn(ye,a?w:y,A),he=Hs(p.cameraToCenterDistance,te.signedDistanceFromCamera);let ve=c.aj(m.textSizeData,E,q)*he/c.ap;a&&(ve*=m.tilePixelRatio/b);const{width:we,height:Ee,anchor:ze,textOffset:ke,textBoxScale:Le}=ue,Je=Sl(ze,we,Ee,ke,Le,ve),bt=a?hn(ye.add(Je),y,A).point:te.point.add(n?Je.rotate(-p.angle):Je),Ve=m.allowVerticalPlacement&&q.placedOrientation===c.ai.vertical?Math.PI/2:0;for(let ut=0;ut<q.numGlyphs;ut++)c.ak(O,bt,Ve);C&&q.associatedIconIndex>=0&&(Z[q.associatedIconIndex]={shiftedAnchor:bt,angle:Ve})}else $(q.numGlyphs,O)}if(C){H.clear();const K=m.icon.placedSymbolArray;for(let q=0;q<K.length;q++){const ue=K.get(q);if(ue.hidden)$(ue.numGlyphs,H);else{const ye=Z[q];if(ye)for(let te=0;te<ue.numGlyphs;te++)c.ak(H,ye.shiftedAnchor,ye.angle);else $(ue.numGlyphs,H)}}m.icon.dynamicLayoutVertexBuffer.updateData(H)}m.text.dynamicLayoutVertexBuffer.updateData(O)}function Qc(m,n,a){return a.iconsInText&&n?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function El(m,n,a,h,p,y,w,b,E,C,A,M){const O=m.context,H=O.gl,Z=m.transform,K=b==="map",q=E==="map",ue=b!=="viewport"&&a.layout.get("symbol-placement")!=="point",ye=K&&!q&&!ue,te=!a.layout.get("symbol-sort-key").isConstant();let he=!1;const ve=m.depthModeForSublayer(0,It.ReadOnly),we=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ee=[];for(const ze of h){const ke=n.getTile(ze),Le=ke.getBucket(a);if(!Le)continue;const Je=p?Le.text:Le.icon;if(!Je||!Je.segments.get().length||!Je.hasVisibleVertices)continue;const bt=Je.programConfigurations.get(a.id),Ve=p||Le.sdfIcons,ut=p?Le.textSizeData:Le.iconSizeData,et=q||Z.pitch!==0,Vt=m.useProgram(Qc(Ve,p,Le),bt),wt=c.ah(ut,Z.zoom),_t=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ze);let St,_n,Xt,rr,Un=[0,0],Tn=null;if(p)_n=ke.glyphAtlasTexture,Xt=H.LINEAR,St=ke.glyphAtlasTexture.size,Le.iconsInText&&(Un=ke.imageAtlasTexture.size,Tn=ke.imageAtlasTexture,rr=et||m.options.rotating||m.options.zooming||ut.kind==="composite"||ut.kind==="camera"?H.LINEAR:H.NEAREST);else{const vn=a.layout.get("icon-size").constantOr(0)!==1||Le.iconsNeedLinear;_n=ke.imageAtlasTexture,Xt=Ve||m.options.rotating||m.options.zooming||vn||et?H.LINEAR:H.NEAREST,St=ke.imageAtlasTexture.size}const Kr=ae(ke,1,m.transform.zoom),Qt=Be(ze.posMatrix,q,K,m.transform,Kr),Bi=Li(ze.posMatrix,q,K,m.transform,Kr),Ni=we&&Le.hasTextData(),Ms=a.layout.get("icon-text-fit")!=="none"&&Ni&&Le.hasIconData();if(ue){const vn=m.style.map.terrain?(Rr,xn)=>m.style.map.terrain.getElevation(ze,Rr,xn):null,Vn=a.layout.get("text-rotation-alignment")==="map";Ue(Le,ze.posMatrix,m,p,Qt,Bi,q,C,Vn,vn)}const no=m.translatePosMatrix(ze.posMatrix,ke,y,w),No=ue||p&&we||Ms?Jc:Qt,pr=m.translatePosMatrix(Bi,ke,y,w,!0),ir=Ve&&a.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let br;br=Ve?Le.iconsInText?Ks(ut.kind,wt,ye,q,m,no,No,pr,St,Un):Uc(ut.kind,wt,ye,q,m,no,No,pr,p,St,!0):jc(ut.kind,wt,ye,q,m,no,No,pr,p,St);const ro={program:Vt,buffers:Je,uniformValues:br,atlasTexture:_n,atlasTextureIcon:Tn,atlasInterpolation:Xt,atlasInterpolationIcon:rr,isSDF:Ve,hasHalo:ir};if(te&&Le.canOverlap){he=!0;const vn=Je.segments.get();for(const Vn of vn)Ee.push({segments:new c.S([Vn]),sortKey:Vn.sortKey,state:ro,terrainData:_t})}else Ee.push({segments:Je.segments,sortKey:0,state:ro,terrainData:_t})}he&&Ee.sort((ze,ke)=>ze.sortKey-ke.sortKey);for(const ze of Ee){const ke=ze.state;if(O.activeTexture.set(H.TEXTURE0),ke.atlasTexture.bind(ke.atlasInterpolation,H.CLAMP_TO_EDGE),ke.atlasTextureIcon&&(O.activeTexture.set(H.TEXTURE1),ke.atlasTextureIcon&&ke.atlasTextureIcon.bind(ke.atlasInterpolationIcon,H.CLAMP_TO_EDGE)),ke.isSDF){const Le=ke.uniformValues;ke.hasHalo&&(Le.u_is_halo=1,eu(ke.buffers,ze.segments,a,m,ke.program,ve,A,M,Le,ze.terrainData)),Le.u_is_halo=0}eu(ke.buffers,ze.segments,a,m,ke.program,ve,A,M,ke.uniformValues,ze.terrainData)}}function eu(m,n,a,h,p,y,w,b,E,C){const A=h.context;p.draw(A,A.gl.TRIANGLES,y,w,b,nn.disabled,E,C,a.id,m.layoutVertexBuffer,m.indexBuffer,n,a.paint,h.transform.zoom,m.programConfigurations.get(a.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Sa(m,n,a,h,p){if(!a||!h||!h.imageAtlas)return;const y=h.imageAtlas.patternPositions;let w=y[a.to.toString()],b=y[a.from.toString()];if(!w&&b&&(w=b),!b&&w&&(b=w),!w||!b){const E=p.getPaintProperty(n);w=y[E],b=y[E]}w&&b&&m.setConstantPatternPositions(w,b)}function Ta(m,n,a,h,p,y,w){const b=m.context.gl,E="fill-pattern",C=a.paint.get(E),A=C&&C.constantOr(1),M=a.getCrossfadeParameters();let O,H,Z,K,q;w?(H=A&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",O=b.LINES):(H=A?"fillPattern":"fill",O=b.TRIANGLES);const ue=C.constantOr(null);for(const ye of h){const te=n.getTile(ye);if(A&&!te.patternsLoaded())continue;const he=te.getBucket(a);if(!he)continue;const ve=he.programConfigurations.get(a.id),we=m.useProgram(H,ve),Ee=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ye);A&&(m.context.activeTexture.set(b.TEXTURE0),te.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),ve.updatePaintBuffers(M)),Sa(ve,E,ue,te,a);const ze=Ee?ye:null,ke=m.translatePosMatrix(ze?ze.posMatrix:ye.posMatrix,te,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(w){K=he.indexBuffer2,q=he.segments2;const Le=[b.drawingBufferWidth,b.drawingBufferHeight];Z=H==="fillOutlinePattern"&&A?hl(ke,m,M,te,Le):ul(ke,Le)}else K=he.indexBuffer,q=he.segments,Z=A?Fc(ke,m,M,te):Nh(ke);we.draw(m.context,O,p,m.stencilModeForClipping(ye),y,nn.disabled,Z,Ee,a.id,he.layoutVertexBuffer,K,q,a.paint,m.transform.zoom,ve)}}function Ea(m,n,a,h,p,y,w){const b=m.context,E=b.gl,C="fill-extrusion-pattern",A=a.paint.get(C),M=A.constantOr(1),O=a.getCrossfadeParameters(),H=a.paint.get("fill-extrusion-opacity"),Z=A.constantOr(null);for(const K of h){const q=n.getTile(K),ue=q.getBucket(a);if(!ue)continue;const ye=m.style.map.terrain&&m.style.map.terrain.getTerrainData(K),te=ue.programConfigurations.get(a.id),he=m.useProgram(M?"fillExtrusionPattern":"fillExtrusion",te);M&&(m.context.activeTexture.set(E.TEXTURE0),q.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),te.updatePaintBuffers(O)),Sa(te,C,Z,q,a);const ve=m.translatePosMatrix(K.posMatrix,q,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),we=a.paint.get("fill-extrusion-vertical-gradient"),Ee=M?Es(ve,m,we,H,K,O,q):Lc(ve,m,we,H);he.draw(b,b.gl.TRIANGLES,p,y,w,nn.backCCW,Ee,ye,a.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,a.paint,m.transform.zoom,te,m.style.map.terrain&&ue.centroidVertexBuffer)}}function Wf(m,n,a,h,p,y,w){const b=m.context,E=b.gl,C=a.fbo;if(!C)return;const A=m.useProgram("hillshade"),M=m.style.map.terrain&&m.style.map.terrain.getTerrainData(n);b.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,C.colorAttachment.get()),A.draw(b,E.TRIANGLES,p,y,w,nn.disabled,((O,H,Z,K)=>{const q=Z.paint.get("hillshade-shadow-color"),ue=Z.paint.get("hillshade-highlight-color"),ye=Z.paint.get("hillshade-accent-color");let te=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(te-=O.transform.angle);const he=!O.options.moving;return{u_matrix:K?K.posMatrix:O.transform.calculatePosMatrix(H.tileID.toUnwrapped(),he),u_image:0,u_latrange:Bc(0,H.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),te],u_shadow:q,u_highlight:ue,u_accent:ye}})(m,a,h,M?n:null),M,h.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function tu(m,n,a,h,p,y){const w=m.context,b=w.gl,E=n.dem;if(E&&E.data){const C=E.dim,A=E.stride,M=E.getPixels();if(w.activeTexture.set(b.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||m.getTileTexture(A),n.demTexture){const H=n.demTexture;H.update(M,{premultiply:!1}),H.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else n.demTexture=new it(w,M,b.RGBA,{premultiply:!1}),n.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);w.activeTexture.set(b.TEXTURE0);let O=n.fbo;if(!O){const H=new it(w,{width:C,height:C,data:null},b.RGBA);H.bind(b.LINEAR,b.CLAMP_TO_EDGE),O=n.fbo=w.createFramebuffer(C,C,!0,!1),O.colorAttachment.set(H.texture)}w.bindFramebuffer.set(O.framebuffer),w.viewport.set([0,0,C,C]),m.useProgram("hillshadePrepare").draw(w,b.TRIANGLES,h,p,y,nn.disabled,((H,Z)=>{const K=Z.stride,q=c.Z();return c.aS(q,0,c.N,-c.N,0,0,1),c.$(q,q,[0,-c.N,0]),{u_matrix:q,u_image:1,u_dimension:[K,K],u_zoom:H.overscaledZ,u_unpack:Z.getUnpackVector()}})(n.tileID,E),null,a.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Kf(m,n,a,h,p,y){const w=h.paint.get("raster-fade-duration");if(!y&&w>0){const b=c.h.now(),E=(b-m.timeAdded)/w,C=n?(b-n.timeAdded)/w:-1,A=a.getSource(),M=p.coveringZoomLevel({tileSize:A.tileSize,roundZoom:A.roundZoom}),O=!n||Math.abs(n.tileID.overscaledZ-M)>Math.abs(m.tileID.overscaledZ-M),H=O&&m.refreshedUponExpiration?1:c.ad(O?E:1-C,0,1);return m.refreshedUponExpiration&&E>=1&&(m.refreshedUponExpiration=!1),n?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const Qh=new c.aT(1,0,0,1),Il=new c.aT(0,1,0,1),nu=new c.aT(0,0,1,1),ed=new c.aT(1,0,1,1),td=new c.aT(0,1,1,1);function Ia(m,n,a,h){kl(m,0,n+a/2,m.transform.width,a,h)}function Cl(m,n,a,h){kl(m,n-a/2,0,a,m.transform.height,h)}function kl(m,n,a,h,p,y){const w=m.context,b=w.gl;b.enable(b.SCISSOR_TEST),b.scissor(n*m.pixelRatio,a*m.pixelRatio,h*m.pixelRatio,p*m.pixelRatio),w.clear({color:y}),b.disable(b.SCISSOR_TEST)}function nd(m,n,a){const h=m.context,p=h.gl,y=a.posMatrix,w=m.useProgram("debug"),b=It.disabled,E=an.disabled,C=m.colorModeForRenderPass(),A="$debug",M=m.style.map.terrain&&m.style.map.terrain.getTerrainData(a);h.activeTexture.set(p.TEXTURE0);const O=n.getTileByID(a.key).latestRawTileData,H=Math.floor((O&&O.byteLength||0)/1024),Z=n.getTile(a).tileSize,K=512/Math.min(Z,512)*(a.overscaledZ/m.transform.zoom)*.5;let q=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(q+=` => ${a.overscaledZ}`),function(ue,ye){ue.initDebugOverlayCanvas();const te=ue.debugOverlayCanvas,he=ue.context.gl,ve=ue.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,te.width,te.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold 36px Open Sans, sans-serif",ve.fillText(ye,5,5),ve.strokeText(ye,5,5),ue.debugOverlayTexture.update(te),ue.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(m,`${q} ${H}kB`),w.draw(h,p.TRIANGLES,b,E,on.alphaBlended,nn.disabled,xa(y,c.aT.transparent,K),null,A,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),w.draw(h,p.LINE_STRIP,b,E,C,nn.disabled,xa(y,c.aT.red),M,A,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function pn(m,n,a){const h=m.context,p=h.gl,y=m.colorModeForRenderPass(),w=new It(p.LEQUAL,It.ReadWrite,m.depthRangeFor3D),b=m.useProgram("terrain"),E=n.getTerrainMesh();h.bindFramebuffer.set(null),h.viewport.set([0,0,m.width,m.height]);for(const C of a){const A=m.renderToTexture.getTexture(C),M=n.getTerrainData(C.tileID);h.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,A.texture);const O={u_matrix:m.transform.calculatePosMatrix(C.tileID.toUnwrapped()),u_texture:0,u_ele_delta:n.getMeshFrameDelta(m.transform.zoom)};b.draw(h,p.TRIANGLES,w,an.disabled,y,nn.backCCW,O,M,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class Js{constructor(n,a){this.context=new Hf(n),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.Z(),renderTime:0},this.setup(),this.numSublayers=Ar.maxUnderzooming+Ar.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new al}resize(n,a,h){if(this.width=Math.floor(n*h),this.height=Math.floor(a*h),this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const n=this.context,a=new c.a_;a.emplaceBack(0,0),a.emplaceBack(c.N,0),a.emplaceBack(0,c.N),a.emplaceBack(c.N,c.N),this.tileExtentBuffer=n.createVertexBuffer(a,ll.members),this.tileExtentSegments=c.S.simpleSegment(0,0,4,2);const h=new c.a_;h.emplaceBack(0,0),h.emplaceBack(c.N,0),h.emplaceBack(0,c.N),h.emplaceBack(c.N,c.N),this.debugBuffer=n.createVertexBuffer(h,ll.members),this.debugSegments=c.S.simpleSegment(0,0,4,5);const p=new c.V;p.emplaceBack(0,0,0,0),p.emplaceBack(c.N,0,c.N,0),p.emplaceBack(0,c.N,0,c.N),p.emplaceBack(c.N,c.N,c.N,c.N),this.rasterBoundsBuffer=n.createVertexBuffer(p,ur.members),this.rasterBoundsSegments=c.S.simpleSegment(0,0,4,2);const y=new c.a_;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,ll.members),this.viewportSegments=c.S.simpleSegment(0,0,4,2);const w=new c.a$;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);const b=new c.b0;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(b);const E=this.context.gl;this.stencilClearMode=new an({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=c.Z();c.aS(h,0,this.width,this.height,0,0,1),c.a0(h,h,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,It.disabled,this.stencilClearMode,on.disabled,nn.disabled,jh(h),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,a){if(this.currentStencilSource===n.source||!n.isTileClipped()||!a||!a.length)return;this.currentStencilSource=n.source;const h=this.context,p=h.gl;this.nextStencilID+a.length>256&&this.clearStencil(),h.setColorMode(on.disabled),h.setDepthMode(It.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of a){const b=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);y.draw(h,p.TRIANGLES,It.disabled,new an({func:p.ALWAYS,mask:0},b,255,p.KEEP,p.KEEP,p.REPLACE),on.disabled,nn.disabled,jh(w.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,a=this.context.gl;return new an({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(n){const a=this.context.gl;return new an({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(n){const a=this.context.gl,h=n.sort((w,b)=>b.overscaledZ-w.overscaledZ),p=h[h.length-1].overscaledZ,y=h[0].overscaledZ-p+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let b=0;b<y;b++)w[b+p]=new an({func:a.GEQUAL,mask:255},b+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=y,[w,h]}return[{[p]:an.disabled},h]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new on([n.CONSTANT_COLOR,n.ONE],new c.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?on.unblended:on.alphaBlended}depthModeForSublayer(n,a,h){if(!this.opaquePassEnabledForLayer())return It.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new It(h||this.context.gl.LEQUAL,a,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,a){this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(c.h.now()),this.imageManager.beginFrame();const h=this.style._order,p=this.style.sourceCaches,y={},w={},b={};for(const E in p){const C=p[E];C.used&&C.prepare(this.context),y[E]=C.getVisibleCoordinates(),w[E]=y[E].slice().reverse(),b[E]=C.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<h.length;E++)if(this.style._layers[h[E]].is3D()){this.opaquePassCutoff=E;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const E=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!c.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||E.length)&&(c.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(C,A){const M=C.context,O=M.gl,H=on.unblended,Z=new It(O.LEQUAL,It.ReadWrite,[0,1]),K=A.getTerrainMesh(),q=A.sourceCache.getRenderableTiles(),ue=C.useProgram("terrainDepth");M.bindFramebuffer.set(A.getFramebuffer("depth").framebuffer),M.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),M.clear({color:c.aT.transparent,depth:1});for(const ye of q){const te=A.getTerrainData(ye.tileID),he={u_matrix:C.transform.calculatePosMatrix(ye.tileID.toUnwrapped()),u_ele_delta:A.getMeshFrameDelta(C.transform.zoom)};ue.draw(M,O.TRIANGLES,Z,an.disabled,H,nn.backCCW,he,te,"terrain",K.vertexBuffer,K.indexBuffer,K.segments)}M.bindFramebuffer.set(null),M.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain),function(C,A){const M=C.context,O=M.gl,H=on.unblended,Z=new It(O.LEQUAL,It.ReadWrite,[0,1]),K=A.getTerrainMesh(),q=A.getCoordsTexture(),ue=A.sourceCache.getRenderableTiles(),ye=C.useProgram("terrainCoords");M.bindFramebuffer.set(A.getFramebuffer("coords").framebuffer),M.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),M.clear({color:c.aT.transparent,depth:1}),A.coordsIndex=[];for(const te of ue){const he=A.getTerrainData(te.tileID);M.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,q.texture);const ve={u_matrix:C.transform.calculatePosMatrix(te.tileID.toUnwrapped()),u_terrain_coords_id:(255-A.coordsIndex.length)/255,u_texture:0,u_ele_delta:A.getMeshFrameDelta(C.transform.zoom)};ye.draw(M,O.TRIANGLES,Z,an.disabled,H,nn.backCCW,ve,he,"terrain",K.vertexBuffer,K.indexBuffer,K.segments),A.coordsIndex.push(te.tileID.key)}M.bindFramebuffer.set(null),M.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const E of h){const C=this.style._layers[E];if(!C.hasOffscreenPass()||C.isHidden(this.transform.zoom))continue;const A=w[C.source];(C.type==="custom"||A.length)&&this.renderLayer(this,p[C.source],C,A)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aT.black:c.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[h[this.currentLayer]],C=p[E.source],A=y[E.source];this._renderTileClippingMasks(E,A),this.renderLayer(this,C,E,A)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){const E=this.style._layers[h[this.currentLayer]],C=p[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const A=(E.type==="symbol"?b:w)[E.source];this._renderTileClippingMasks(E,y[E.source]),this.renderLayer(this,C,E,A)}if(this.options.showTileBoundaries){const E=function(C,A){let M=null;const O=Object.values(C._layers).flatMap(q=>q.source&&!q.isHidden(A)?[C.sourceCaches[q.source]]:[]),H=O.filter(q=>q.getSource().type==="vector"),Z=O.filter(q=>q.getSource().type!=="vector"),K=q=>{(!M||M.getSource().maxzoom<q.getSource().maxzoom)&&(M=q)};return H.forEach(q=>K(q)),M||Z.forEach(q=>K(q)),M}(this.style,this.transform.zoom);E&&function(C,A,M){for(let O=0;O<M.length;O++)nd(C,A,M[O])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const C=E.transform.padding;Ia(E,E.transform.height-(C.top||0),3,Qh),Ia(E,C.bottom||0,3,Il),Cl(E,C.left||0,3,nu),Cl(E,E.transform.width-(C.right||0),3,ed);const A=E.transform.centerPoint;(function(M,O,H,Z){kl(M,O-1,H-10,2,20,Z),kl(M,O-10,H-1,20,2,Z)})(E,A.x,E.transform.height-A.y,td)}(this),this.context.setDefault()}renderLayer(n,a,h,p){if(!h.isHidden(this.transform.zoom)&&(h.type==="background"||h.type==="custom"||(p||[]).length))switch(this.id=h.id,h.type){case"symbol":(function(y,w,b,E,C){if(y.renderPass!=="translucent")return;const A=an.disabled,M=y.colorModeForRenderPass();(b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(O,H,Z,K,q,ue,ye){const te=H.transform,he=q==="map",ve=ue==="map";for(const we of O){const Ee=K.getTile(we),ze=Ee.getBucket(Z);if(!ze||!ze.text||!ze.text.segments.get().length)continue;const ke=c.ah(ze.textSizeData,te.zoom),Le=ae(Ee,1,H.transform.zoom),Je=Be(we.posMatrix,ve,he,H.transform,Le),bt=Z.layout.get("icon-text-fit")!=="none"&&ze.hasIconData();if(ke){const Ve=Math.pow(2,te.zoom-Ee.tileID.overscaledZ);Tl(ze,he,ve,ye,te,Je,we.posMatrix,Ve,ke,bt,H.style.map.terrain?(ut,et)=>H.style.map.terrain.getElevation(we,ut,et):null)}}}(E,y,b,w,b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),C),b.paint.get("icon-opacity").constantOr(1)!==0&&El(y,w,b,E,!1,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),b.layout.get("icon-rotation-alignment"),b.layout.get("icon-pitch-alignment"),b.layout.get("icon-keep-upright"),A,M),b.paint.get("text-opacity").constantOr(1)!==0&&El(y,w,b,E,!0,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.layout.get("text-keep-upright"),A,M),w.map.showCollisionBoxes&&(Jh(y,w,b,E,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),!0),Jh(y,w,b,E,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),!1))})(n,a,h,p,this.style.placement.variableOffsets);break;case"circle":(function(y,w,b,E){if(y.renderPass!=="translucent")return;const C=b.paint.get("circle-opacity"),A=b.paint.get("circle-stroke-width"),M=b.paint.get("circle-stroke-opacity"),O=!b.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(A.constantOr(1)===0||M.constantOr(1)===0))return;const H=y.context,Z=H.gl,K=y.depthModeForSublayer(0,It.ReadOnly),q=an.disabled,ue=y.colorModeForRenderPass(),ye=[];for(let te=0;te<E.length;te++){const he=E[te],ve=w.getTile(he),we=ve.getBucket(b);if(!we)continue;const Ee=we.programConfigurations.get(b.id),ze=y.useProgram("circle",Ee),ke=we.layoutVertexBuffer,Le=we.indexBuffer,Je=y.style.map.terrain&&y.style.map.terrain.getTerrainData(he),bt={programConfiguration:Ee,program:ze,layoutVertexBuffer:ke,indexBuffer:Le,uniformValues:Is(y,he,ve,b),terrainData:Je};if(O){const Ve=we.segments.get();for(const ut of Ve)ye.push({segments:new c.S([ut]),sortKey:ut.sortKey,state:bt})}else ye.push({segments:we.segments,sortKey:0,state:bt})}O&&ye.sort((te,he)=>te.sortKey-he.sortKey);for(const te of ye){const{programConfiguration:he,program:ve,layoutVertexBuffer:we,indexBuffer:Ee,uniformValues:ze,terrainData:ke}=te.state;ve.draw(H,Z.TRIANGLES,K,q,ue,nn.disabled,ze,ke,b.id,we,Ee,te.segments,b.paint,y.transform.zoom,he)}})(n,a,h,p);break;case"heatmap":(function(y,w,b,E){if(b.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const C=y.context,A=C.gl,M=an.disabled,O=new on([A.ONE,A.ONE],c.aT.transparent,[!0,!0,!0,!0]);(function(H,Z,K){const q=H.gl;H.activeTexture.set(q.TEXTURE1),H.viewport.set([0,0,Z.width/4,Z.height/4]);let ue=K.heatmapFbo;if(ue)q.bindTexture(q.TEXTURE_2D,ue.colorAttachment.get()),H.bindFramebuffer.set(ue.framebuffer);else{const ye=q.createTexture();q.bindTexture(q.TEXTURE_2D,ye),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),ue=K.heatmapFbo=H.createFramebuffer(Z.width/4,Z.height/4,!1,!1),function(te,he,ve,we){var Ee,ze;const ke=te.gl,Le=(Ee=te.HALF_FLOAT)!==null&&Ee!==void 0?Ee:ke.UNSIGNED_BYTE,Je=(ze=te.RGBA16F)!==null&&ze!==void 0?ze:ke.RGBA;ke.texImage2D(ke.TEXTURE_2D,0,Je,he.width/4,he.height/4,0,ke.RGBA,Le,null),we.colorAttachment.set(ve)}(H,Z,ye,ue)}})(C,y,b),C.clear({color:c.aT.transparent});for(let H=0;H<E.length;H++){const Z=E[H];if(w.hasRenderableParent(Z))continue;const K=w.getTile(Z),q=K.getBucket(b);if(!q)continue;const ue=q.programConfigurations.get(b.id),ye=y.useProgram("heatmap",ue),{zoom:te}=y.transform;ye.draw(C,A.TRIANGLES,It.disabled,M,O,nn.disabled,Nf(Z.posMatrix,K,te,b.paint.get("heatmap-intensity")),null,b.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,b.paint,y.transform.zoom,ue)}C.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(C,A){const M=C.context,O=M.gl,H=A.heatmapFbo;if(!H)return;M.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,H.colorAttachment.get()),M.activeTexture.set(O.TEXTURE1);let Z=A.colorRampTexture;Z||(Z=A.colorRampTexture=new it(M,A.colorRamp,O.RGBA)),Z.bind(O.LINEAR,O.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(M,O.TRIANGLES,It.disabled,an.disabled,C.colorModeForRenderPass(),nn.disabled,((K,q,ue,ye)=>{const te=c.Z();c.aS(te,0,K.width,K.height,0,0,1);const he=K.context.gl;return{u_matrix:te,u_world:[he.drawingBufferWidth,he.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:q.paint.get("heatmap-opacity")}})(C,A),null,A.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,A.paint,C.transform.zoom)}(y,b))})(n,a,h,p);break;case"line":(function(y,w,b,E){if(y.renderPass!=="translucent")return;const C=b.paint.get("line-opacity"),A=b.paint.get("line-width");if(C.constantOr(1)===0||A.constantOr(1)===0)return;const M=y.depthModeForSublayer(0,It.ReadOnly),O=y.colorModeForRenderPass(),H=b.paint.get("line-dasharray"),Z=b.paint.get("line-pattern"),K=Z.constantOr(1),q=b.paint.get("line-gradient"),ue=b.getCrossfadeParameters(),ye=K?"linePattern":H?"lineSDF":q?"lineGradient":"line",te=y.context,he=te.gl;let ve=!0;for(const we of E){const Ee=w.getTile(we);if(K&&!Ee.patternsLoaded())continue;const ze=Ee.getBucket(b);if(!ze)continue;const ke=ze.programConfigurations.get(b.id),Le=y.context.program.get(),Je=y.useProgram(ye,ke),bt=ve||Je.program!==Le,Ve=y.style.map.terrain&&y.style.map.terrain.getTerrainData(we),ut=Z.constantOr(null);if(ut&&Ee.imageAtlas){const wt=Ee.imageAtlas,_t=wt.patternPositions[ut.to.toString()],St=wt.patternPositions[ut.from.toString()];_t&&St&&ke.setConstantPatternPositions(_t,St)}const et=Ve?we:null,Vt=K?jf(y,Ee,b,ue,et):H?Vh(y,Ee,b,H,ue,et):q?Uh(y,Ee,b,ze.lineClipsArray.length,et):Nc(y,Ee,b,et);if(K)te.activeTexture.set(he.TEXTURE0),Ee.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),ke.updatePaintBuffers(ue);else if(H&&(bt||y.lineAtlas.dirty))te.activeTexture.set(he.TEXTURE0),y.lineAtlas.bind(te);else if(q){const wt=ze.gradients[b.id];let _t=wt.texture;if(b.gradientVersion!==wt.version){let St=256;if(b.stepInterpolant){const _n=w.getSource().maxzoom,Xt=we.canonical.z===_n?Math.ceil(1<<y.transform.maxZoom-we.canonical.z):1;St=c.ad(c.aY(ze.maxLineLength/c.N*1024*Xt),256,te.maxTextureSize)}wt.gradient=c.aZ({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:St,image:wt.gradient||void 0,clips:ze.lineClipsArray}),wt.texture?wt.texture.update(wt.gradient):wt.texture=new it(te,wt.gradient,he.RGBA),wt.version=b.gradientVersion,_t=wt.texture}te.activeTexture.set(he.TEXTURE0),_t.bind(b.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}Je.draw(te,he.TRIANGLES,M,y.stencilModeForClipping(we),O,nn.disabled,Vt,Ve,b.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,b.paint,y.transform.zoom,ke,ze.layoutVertexBuffer2),ve=!1}})(n,a,h,p);break;case"fill":(function(y,w,b,E){const C=b.paint.get("fill-color"),A=b.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const M=y.colorModeForRenderPass(),O=b.paint.get("fill-pattern"),H=y.opaquePassEnabledForLayer()&&!O.constantOr(1)&&C.constantOr(c.aT.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===H){const Z=y.depthModeForSublayer(1,y.renderPass==="opaque"?It.ReadWrite:It.ReadOnly);Ta(y,w,b,E,Z,M,!1)}if(y.renderPass==="translucent"&&b.paint.get("fill-antialias")){const Z=y.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,It.ReadOnly);Ta(y,w,b,E,Z,M,!0)}})(n,a,h,p);break;case"fill-extrusion":(function(y,w,b,E){const C=b.paint.get("fill-extrusion-opacity");if(C!==0&&y.renderPass==="translucent"){const A=new It(y.context.gl.LEQUAL,It.ReadWrite,y.depthRangeFor3D);if(C!==1||b.paint.get("fill-extrusion-pattern").constantOr(1))Ea(y,w,b,E,A,an.disabled,on.disabled),Ea(y,w,b,E,A,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const M=y.colorModeForRenderPass();Ea(y,w,b,E,A,an.disabled,M)}}})(n,a,h,p);break;case"hillshade":(function(y,w,b,E){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const C=y.context,A=y.depthModeForSublayer(0,It.ReadOnly),M=y.colorModeForRenderPass(),[O,H]=y.renderPass==="translucent"?y.stencilConfigForOverlap(E):[{},E];for(const Z of H){const K=w.getTile(Z);K.needsHillshadePrepare!==void 0&&K.needsHillshadePrepare&&y.renderPass==="offscreen"?tu(y,K,b,A,an.disabled,M):y.renderPass==="translucent"&&Wf(y,Z,K,b,A,O[Z.overscaledZ],M)}C.viewport.set([0,0,y.width,y.height])})(n,a,h,p);break;case"raster":(function(y,w,b,E){if(y.renderPass!=="translucent"||b.paint.get("raster-opacity")===0||!E.length)return;const C=y.context,A=C.gl,M=w.getSource(),O=y.useProgram("raster"),H=y.colorModeForRenderPass(),[Z,K]=M instanceof bn?[{},E]:y.stencilConfigForOverlap(E),q=K[K.length-1].overscaledZ,ue=!y.options.moving;for(const ye of K){const te=y.depthModeForSublayer(ye.overscaledZ-q,b.paint.get("raster-opacity")===1?It.ReadWrite:It.ReadOnly,A.LESS),he=w.getTile(ye);he.registerFadeDuration(b.paint.get("raster-fade-duration"));const ve=w.findLoadedParent(ye,0),we=Kf(he,ve,w,b,y.transform,y.style.map.terrain);let Ee,ze;const ke=b.paint.get("raster-resampling")==="nearest"?A.NEAREST:A.LINEAR;C.activeTexture.set(A.TEXTURE0),he.texture.bind(ke,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(A.TEXTURE1),ve?(ve.texture.bind(ke,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST),Ee=Math.pow(2,ve.tileID.overscaledZ-he.tileID.overscaledZ),ze=[he.tileID.canonical.x*Ee%1,he.tileID.canonical.y*Ee%1]):he.texture.bind(ke,A.CLAMP_TO_EDGE,A.LINEAR_MIPMAP_NEAREST);const Le=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ye),Je=Le?ye:null,bt=Je?Je.posMatrix:y.transform.calculatePosMatrix(ye.toUnwrapped(),ue),Ve=qh(bt,ze||[0,0],Ee||1,we,b);M instanceof bn?O.draw(C,A.TRIANGLES,te,an.disabled,H,nn.disabled,Ve,Le,b.id,M.boundsBuffer,y.quadTriangleIndexBuffer,M.boundsSegments):O.draw(C,A.TRIANGLES,te,Z[ye.overscaledZ],H,nn.disabled,Ve,Le,b.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(n,a,h,p);break;case"background":(function(y,w,b,E){const C=b.paint.get("background-color"),A=b.paint.get("background-opacity");if(A===0)return;const M=y.context,O=M.gl,H=y.transform,Z=H.tileSize,K=b.paint.get("background-pattern");if(y.isPatternMissing(K))return;const q=!K&&C.a===1&&A===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==q)return;const ue=an.disabled,ye=y.depthModeForSublayer(0,q==="opaque"?It.ReadWrite:It.ReadOnly),te=y.colorModeForRenderPass(),he=y.useProgram(K?"backgroundPattern":"background"),ve=E||H.coveringTiles({tileSize:Z,terrain:y.style.map.terrain});K&&(M.activeTexture.set(O.TEXTURE0),y.imageManager.bind(y.context));const we=b.getCrossfadeParameters();for(const Ee of ve){const ze=E?Ee.posMatrix:y.transform.calculatePosMatrix(Ee.toUnwrapped()),ke=K?ui(ze,A,y,K,{tileID:Ee,tileSize:Z},we):pl(ze,A,C),Le=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ee);he.draw(M,O.TRIANGLES,ye,ue,te,nn.disabled,ke,Le,b.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(n,0,h,p);break;case"custom":(function(y,w,b){const E=y.context,C=b.implementation;if(y.renderPass==="offscreen"){const A=C.prerender;A&&(y.setCustomLayerDefaults(),E.setColorMode(y.colorModeForRenderPass()),A.call(C,E.gl,y.transform.customLayerMatrix()),E.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),E.setColorMode(y.colorModeForRenderPass()),E.setStencilMode(an.disabled);const A=C.renderingMode==="3d"?new It(y.context.gl.LEQUAL,It.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,It.ReadOnly);E.setDepthMode(A),C.render(E.gl,y.transform.customLayerMatrix()),E.setDirty(),y.setBaseState(),E.bindFramebuffer.set(null)}})(n,0,h)}}translatePosMatrix(n,a,h,p,y){if(!h[0]&&!h[1])return n;const w=y?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(w){const C=Math.sin(w),A=Math.cos(w);h=[h[0]*A-h[1]*C,h[0]*C+h[1]*A]}const b=[y?h[0]:ae(a,h[0],this.transform.zoom),y?h[1]:ae(a,h[1],this.transform.zoom),0],E=new Float32Array(16);return c.$(E,n,b),E}saveTileTexture(n){const a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const a=this._tileTextures[n];return a&&a.length>0?a.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const a=this.imageManager.getPattern(n.from.toString()),h=this.imageManager.getPattern(n.to.toString());return!a||!h}useProgram(n,a){this.cache=this.cache||{};const h=n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[h]||(this.cache[h]=new cl(this.context,sn[n],a,fl[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[h]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new it(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:a}=this.context.gl;return this.width!==n||this.height!==a}}class Mr{constructor(n,a){this.points=n,this.planes=a}static fromInvProjectionMatrix(n,a,h){const p=Math.pow(2,h),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const E=1/(b=c.ag([],b,n))[3]/a*p;return c.b3(b,b,[E,E,1/b[3],E])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const E=function(O,H){var Z=H[0],K=H[1],q=H[2],ue=Z*Z+K*K+q*q;return ue>0&&(ue=1/Math.sqrt(ue)),O[0]=H[0]*ue,O[1]=H[1]*ue,O[2]=H[2]*ue,O}([],function(O,H,Z){var K=H[0],q=H[1],ue=H[2],ye=Z[0],te=Z[1],he=Z[2];return O[0]=q*he-ue*te,O[1]=ue*ye-K*he,O[2]=K*te-q*ye,O}([],Fe([],y[b[0]],y[b[1]]),Fe([],y[b[2]],y[b[1]]))),C=-((A=E)[0]*(M=y[b[1]])[0]+A[1]*M[1]+A[2]*M[2]);var A,M;return E.concat(C)});return new Mr(y,w)}}class Ro{constructor(n,a){this.min=n,this.max=a,this.center=function(h,p,y){return h[0]=.5*p[0],h[1]=.5*p[1],h[2]=.5*p[2],h}([],function(h,p,y){return h[0]=p[0]+y[0],h[1]=p[1]+y[1],h[2]=p[2]+y[2],h}([],this.min,this.max))}quadrant(n){const a=[n%2==0,n<2],h=xe(this.min),p=xe(this.max);for(let y=0;y<a.length;y++)h[y]=a[y]?this.min[y]:this.center[y],p[y]=a[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new Ro(h,p)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let h=!0;for(let p=0;p<n.planes.length;p++){const y=n.planes[p];let w=0;for(let b=0;b<a.length;b++)c.b4(y,a[b])>=0&&w++;if(w===0)return 0;w!==a.length&&(h=!1)}if(h)return 2;for(let p=0;p<3;p++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let b=0;b<n.points.length;b++){const E=n.points[b][p]-this.min[p];y=Math.min(y,E),w=Math.max(w,E)}if(w<0||y>this.max[p]-this.min[p])return 0}return 1}}class Ca{constructor(n=0,a=0,h=0,p=0){if(isNaN(n)||n<0||isNaN(a)||a<0||isNaN(h)||h<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=h,this.right=p}interpolate(n,a,h){return a.top!=null&&n.top!=null&&(this.top=c.B.number(n.top,a.top,h)),a.bottom!=null&&n.bottom!=null&&(this.bottom=c.B.number(n.bottom,a.bottom,h)),a.left!=null&&n.left!=null&&(this.left=c.B.number(n.left,a.left,h)),a.right!=null&&n.right!=null&&(this.right=c.B.number(n.right,a.right,h)),this}getCenter(n,a){const h=c.ad((this.left+n-this.right)/2,0,n),p=c.ad((this.top+a-this.bottom)/2,0,a);return new c.P(h,p)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Ca(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Pl{constructor(n,a,h,p,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||!!y,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=h??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ca,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const n=new Pl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this._minEleveationForCurrentTile=n._minEleveationForCurrentTile,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const a=-c.b5(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var h=new c.A(4);return c.A!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h}(),function(h,p,y){var w=p[0],b=p[1],E=p[2],C=p[3],A=Math.sin(y),M=Math.cos(y);h[0]=w*M+E*A,h[1]=b*M+C*A,h[2]=w*-A+E*M,h[3]=b*-A+C*M}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const a=c.ad(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,a,h){this._unmodified=!1,this._edgeInsets.interpolate(n,a,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(n){const a=[new c.b6(0,n)];if(this._renderWorldCopies){const h=this.pointCoordinate(new c.P(0,0)),p=this.pointCoordinate(new c.P(this.width,0)),y=this.pointCoordinate(new c.P(this.width,this.height)),w=this.pointCoordinate(new c.P(0,this.height)),b=Math.floor(Math.min(h.x,p.x,y.x,w.x)),E=Math.floor(Math.max(h.x,p.x,y.x,w.x)),C=1;for(let A=b-C;A<=E+C;A++)A!==0&&a.push(new c.b6(A,n))}return a}coveringTiles(n){var a,h;let p=this.coveringZoomLevel(n);const y=p;if(n.minzoom!==void 0&&p<n.minzoom)return[];n.maxzoom!==void 0&&p>n.maxzoom&&(p=n.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),b=c.U.fromLngLat(this.center),E=Math.pow(2,p),C=[E*w.x,E*w.y,0],A=[E*b.x,E*b.y,0],M=Mr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let O=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(O=p);const H=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,Z=te=>({aabb:new Ro([te*E,0,0],[(te+1)*E,E,0]),zoom:0,x:0,y:0,wrap:te,fullyVisible:!1}),K=[],q=[],ue=p,ye=n.reparseOverscaled?y:p;if(this._renderWorldCopies)for(let te=1;te<=3;te++)K.push(Z(-te)),K.push(Z(te));for(K.push(Z(0));K.length>0;){const te=K.pop(),he=te.x,ve=te.y;let we=te.fullyVisible;if(!we){const Je=te.aabb.intersects(M);if(Je===0)continue;we=Je===2}const Ee=n.terrain?C:A,ze=te.aabb.distanceX(Ee),ke=te.aabb.distanceY(Ee),Le=Math.max(Math.abs(ze),Math.abs(ke));if(te.zoom===ue||Le>H+(1<<ue-te.zoom)-2&&te.zoom>=O){const Je=ue-te.zoom,bt=C[0]-.5-(he<<Je),Ve=C[1]-.5-(ve<<Je);q.push({tileID:new c.O(te.zoom===ue?ye:te.zoom,te.wrap,te.zoom,he,ve),distanceSq:De([A[0]-.5-he,A[1]-.5-ve]),tileDistanceToCamera:Math.sqrt(bt*bt+Ve*Ve)})}else for(let Je=0;Je<4;Je++){const bt=(he<<1)+Je%2,Ve=(ve<<1)+(Je>>1),ut=te.zoom+1;let et=te.aabb.quadrant(Je);if(n.terrain){const Vt=new c.O(ut,te.wrap,ut,bt,Ve),wt=n.terrain.getMinMaxElevation(Vt),_t=(a=wt.minElevation)!==null&&a!==void 0?a:this.elevation,St=(h=wt.maxElevation)!==null&&h!==void 0?h:this.elevation;et=new Ro([et.min[0],et.min[1],_t],[et.max[0],et.max[1],St])}K.push({aabb:et,zoom:ut,x:bt,y:Ve,wrap:te.wrap,fullyVisible:we})}}return q.sort((te,he)=>te.distanceSq-he.distanceSq).map(te=>te.tileID)}resize(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const a=c.ad(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.P(c.G(n.lng)*this.worldSize,c.H(a)*this.worldSize)}unproject(n){return new c.U(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const a=this.pointLocation(this.centerPoint,n),h=n.getElevationForLngLatZoom(a,this.tileZoom);if(!(this.elevation-h))return;const p=this.getCameraPosition(),y=c.U.fromLngLat(p.lngLat,p.altitude),w=c.U.fromLngLat(a,h),b=y.x-w.x,E=y.y-w.y,C=y.z-w.z,A=Math.sqrt(b*b+E*E+C*C),M=this.scaleZoom(this.cameraToCenterDistance/A/this.tileSize);this._elevation=h,this._center=a,this.zoom=M}setLocationAtPoint(n,a){const h=this.pointCoordinate(a),p=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(n),w=new c.U(y.x-(h.x-p.x),y.y-(h.y-p.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,a){return a?this.coordinatePoint(this.locationCoordinate(n),a.getElevationForLngLatZoom(n,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,a){return this.coordinateLocation(this.pointCoordinate(n,a))}locationCoordinate(n){return c.U.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,a){if(a){const O=a.pointCoordinate(n);if(O!=null)return O}const h=[n.x,n.y,0,1],p=[n.x,n.y,1,1];c.ag(h,h,this.pixelMatrixInverse),c.ag(p,p,this.pixelMatrixInverse);const y=h[3],w=p[3],b=h[1]/y,E=p[1]/w,C=h[2]/y,A=p[2]/w,M=C===A?0:(0-C)/(A-C);return new c.U(c.B.number(h[0]/y,p[0]/w,M)/this.worldSize,c.B.number(b,E,M)/this.worldSize)}coordinatePoint(n,a=0,h=this.pixelMatrix){const p=[n.x*this.worldSize,n.y*this.worldSize,a,1];return c.ag(p,p,h),new c.P(p[0]/p[3],p[1]/p[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new Pt().extend(this.pointLocation(new c.P(0,n))).extend(this.pointLocation(new c.P(this.width,n))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Pt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(n,a=!1){const h=n.key,p=a?this._alignedPosMatrixCache:this._posMatrixCache;if(p[h])return p[h];const y=n.canonical,w=this.worldSize/this.zoomScale(y.z),b=y.x+Math.pow(2,y.z)*n.wrap,E=c.ao(new Float64Array(16));return c.$(E,E,[b*w,y.y*w,0]),c.a0(E,E,[w/c.N,w/c.N,1]),c.a1(E,a?this.alignedProjMatrix:this.projMatrix,E),p[h]=new Float32Array(E),p[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n,a,h,p,y=-90,w=90,b=-180,E=180;const C=this.size,A=this._unmodified;if(this.latRange){const H=this.latRange;y=c.H(H[1])*this.worldSize,w=c.H(H[0])*this.worldSize,n=w-y<C.y?C.y/(w-y):0}if(this.lngRange){const H=this.lngRange;b=c.b5(c.G(H[0])*this.worldSize,0,this.worldSize),E=c.b5(c.G(H[1])*this.worldSize,0,this.worldSize),E<b&&(E+=this.worldSize),a=E-b<C.x?C.x/(E-b):0}const M=this.point,O=Math.max(a||0,n||0);if(O)return this.center=this.unproject(new c.P(a?(E+b)/2:M.x,n?(w+y)/2:M.y)),this.zoom+=this.scaleZoom(O),this._unmodified=A,void(this._constraining=!1);if(this.latRange){const H=M.y,Z=C.y/2;H-Z<y&&(p=y+Z),H+Z>w&&(p=w-Z)}if(this.lngRange){const H=(b+E)/2,Z=c.b5(M.x,H-this.worldSize/2,H+this.worldSize/2),K=C.x/2;Z-K<b&&(h=b+K),Z+K>E&&(h=E-K)}h===void 0&&p===void 0||(this.center=this.unproject(new c.P(h!==void 0?h:M.x,p!==void 0?p:M.y)).wrap()),this._unmodified=A,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,a=this.point.x,h=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b7(1,this.center.lat)*this.worldSize;let p=c.ao(new Float64Array(16));c.a0(p,p,[this.width/2,-this.height/2,1]),c.$(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=c.ao(new Float64Array(16)),c.a0(p,p,[1,-1,1]),c.$(p,p,[-1,-1,0]),c.a0(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this._minEleveationForCurrentTile),b=y-w*this._pixelPerMeter/Math.cos(this._pitch),E=w<0?b:y,C=Math.PI/2+this._pitch,A=this._fov*(.5+n.y/this.height),M=Math.sin(A)*E/Math.sin(c.ad(Math.PI-C-A,.01,Math.PI-.01)),O=this.getHorizon(),H=2*Math.atan(O/this.cameraToCenterDistance)*(.5+n.y/(2*O)),Z=Math.sin(H)*E/Math.sin(c.ad(Math.PI-C-H,.01,Math.PI-.01)),K=Math.min(M,Z),q=1.01*(Math.cos(Math.PI/2-this._pitch)*K+E),ue=this.height/50;p=new Float64Array(16),c.b8(p,this._fov,this.width/this.height,ue,q),p[8]=2*-n.x/this.width,p[9]=2*n.y/this.height,c.a0(p,p,[1,-1,1]),c.$(p,p,[0,0,-this.cameraToCenterDistance]),c.b9(p,p,this._pitch),c.ae(p,p,this.angle),c.$(p,p,[-a,-h,0]),this.mercatorMatrix=c.a0([],p,[this.worldSize,this.worldSize,this.worldSize]),c.a0(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.a1(new Float64Array(16),this.labelPlaneMatrix,p),c.$(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=c.as([],p),this.pixelMatrix3D=c.a1(new Float64Array(16),this.labelPlaneMatrix,p);const ye=this.width%2/2,te=this.height%2/2,he=Math.cos(this.angle),ve=Math.sin(this.angle),we=a-Math.round(a)+he*ye+ve*te,Ee=h-Math.round(h)+he*te+ve*ye,ze=new Float64Array(p);if(c.$(ze,ze,[we>.5?we-1:we,Ee>.5?Ee-1:Ee,0]),this.alignedProjMatrix=ze,p=c.as(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new c.P(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return c.ag(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,n))}getCameraQueryGeometry(n){const a=this.getCameraPoint();if(n.length===1)return[n[0],a];{let h=a.x,p=a.y,y=a.x,w=a.y;for(const b of n)h=Math.min(h,b.x),p=Math.min(p,b.y),y=Math.max(y,b.x),w=Math.max(w,b.y);return[new c.P(h,p),new c.P(y,p),new c.P(y,w),new c.P(h,w),new c.P(h,p)]}}}function Qs(m,n){let a,h=!1,p=null,y=null;const w=()=>{p=null,h&&(m.apply(y,a),p=setTimeout(w,n),h=!1)};return(...b)=>(h=!0,y=this,a=b,p||w(),p)}class ka{constructor(n){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let h;return a.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(h=p)}),(h&&h[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:h,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,a)}catch{}},this._updateHash=Qs(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const a=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,p=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,p),w=Math.round(a.lng*y)/y,b=Math.round(a.lat*y)/y,E=this._map.getBearing(),C=this._map.getPitch();let A="";if(A+=n?`/${w}/${b}/${h}`:`${h}/${b}/${w}`,(E||C)&&(A+="/"+Math.round(10*E)/10),C&&(A+=`/${Math.round(C)}`),this._hashName){const M=this._hashName;let O=!1;const H=window.location.hash.slice(1).split("&").map(Z=>{const K=Z.split("=")[0];return K===M?(O=!0,`${K}=${A}`):Z}).filter(Z=>Z);return O||H.push(`${M}=${A}`),`#${H.join("&")}`}return`#${A}`}}const Do={linearity:.3,easing:c.ba(0,0,.3,1)},rd=c.e({deceleration:2500,maxSpeed:1400},Do),id=c.e({deceleration:20,maxSpeed:1400},Do),sd=c.e({deceleration:1e3,maxSpeed:360},Do),od=c.e({deceleration:1e3,maxSpeed:90},Do);class ad{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.h.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,a=c.h.now();for(;n.length>0&&a-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)a.zoom+=y.zoomDelta||0,a.bearing+=y.bearingDelta||0,a.pitch+=y.pitchDelta||0,y.panDelta&&a.pan._add(y.panDelta),y.around&&(a.around=y.around),y.pinchAround&&(a.pinchAround=y.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(a.pan.mag()){const y=Pa(a.pan.mag(),h,c.e({},rd,n||{}));p.offset=a.pan.mult(y.amount/a.pan.mag()),p.center=this._map.transform.center,Oi(p,y)}if(a.zoom){const y=Pa(a.zoom,h,id);p.zoom=this._map.transform.zoom+y.amount,Oi(p,y)}if(a.bearing){const y=Pa(a.bearing,h,sd);p.bearing=this._map.transform.bearing+c.ad(y.amount,-179,179),Oi(p,y)}if(a.pitch){const y=Pa(a.pitch,h,od);p.pitch=this._map.transform.pitch+y.amount,Oi(p,y)}if(p.zoom||p.bearing){const y=a.pinchAround===void 0?a.around:a.pinchAround;p.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),c.e(p,{noMoveStart:!0})}}function Oi(m,n){(!m.duration||m.duration<n.duration)&&(m.duration=n.duration,m.easing=n.easing)}function Pa(m,n,a){const{maxSpeed:h,linearity:p,deceleration:y}=a,w=c.ad(m*p/(n/1e3),-h,h),b=Math.abs(w)/(y*p);return{easing:a.easing,duration:1e3*b,amount:w*(b/2)}}class Hr extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,h,p={}){const y=P.mousePos(a.getCanvasContainer(),h),w=a.unproject(y);super(n,c.e({point:y,lngLat:w,originalEvent:h},p)),this._defaultPrevented=!1,this.target=a}}class Aa extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,h){const p=n==="touchend"?h.changedTouches:h.touches,y=P.touchPos(a.getCanvasContainer(),p),w=y.map(E=>a.unproject(E)),b=y.reduce((E,C,A,M)=>E.add(C.div(M.length)),new c.P(0,0));super(n,{points:y,point:b,lngLats:w,lngLat:a.unproject(b),originalEvent:h}),this._defaultPrevented=!1}}class ld extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,h){super(n,{originalEvent:h}),this._defaultPrevented=!1}}class cd{constructor(n,a){this._map=n,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new ld(n.type,this._map,n))}mousedown(n,a){return this._mousedownPos=a,this._firePreventable(new Hr(n.type,this._map,n))}mouseup(n){this._map.fire(new Hr(n.type,this._map,n))}click(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Hr(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Hr(n.type,this._map,n))}mouseover(n){this._map.fire(new Hr(n.type,this._map,n))}mouseout(n){this._map.fire(new Hr(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Aa(n.type,this._map,n))}touchmove(n){this._map.fire(new Aa(n.type,this._map,n))}touchend(n){this._map.fire(new Aa(n.type,this._map,n))}touchcancel(n){this._map.fire(new Aa(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ud{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Hr(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Hr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Hr(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class rs{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(c.P.convert(n),this._map.terrain)}}class hd{constructor(n,a){this._map=n,this._tr=new rs(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(P.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(n,a){if(!this._active)return;const h=a;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=h,this._box||(this._box=P.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const y=Math.min(p.x,h.x),w=Math.max(p.x,h.x),b=Math.min(p.y,h.y),E=Math.max(p.y,h.y);P.setTransform(this._box,`translate(${y}px,${b}px)`),this._box.style.width=w-y+"px",this._box.style.height=E-b+"px"}mouseupWindow(n,a){if(!this._active||n.button!==0)return;const h=this._startPos,p=a;if(this.reset(),P.suppressClick(),h.x!==p.x||h.y!==p.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:n})),{cameraAnimation:y=>y.fitScreenCoordinates(h,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(P.remove(this._box),this._box=null),P.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,a){return this._map.fire(new c.k(n,{originalEvent:a}))}}function hi(m,n){if(m.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${n.length}`);const a={};for(let h=0;h<m.length;h++)a[m[h].identifier]=n[h];return a}class is{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,a,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),h.length===this.numTouches&&(this.centroid=function(p){const y=new c.P(0,0);for(const w of p)y._add(w);return y.div(p.length)}(a),this.touches=hi(h,a)))}touchmove(n,a,h){if(this.aborted||!this.centroid)return;const p=hi(h,a);for(const y in this.touches){const w=p[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(n,a,h){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Al{constructor(n){this.singleTap=new is(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,a,h){this.singleTap.touchstart(n,a,h)}touchmove(n,a,h){this.singleTap.touchmove(n,a,h)}touchend(n,a,h){const p=this.singleTap.touchend(n,a,h);if(p){const y=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(p)<30;if(y&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class ss{constructor(n){this._tr=new rs(n),this._zoomIn=new Al({numTouches:1,numTaps:2}),this._zoomOut=new Al({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,a,h){this._zoomIn.touchstart(n,a,h),this._zoomOut.touchstart(n,a,h)}touchmove(n,a,h){this._zoomIn.touchmove(n,a,h),this._zoomOut.touchmove(n,a,h)}touchend(n,a,h){const p=this._zoomIn.touchend(n,a,h),y=this._zoomOut.touchend(n,a,h),w=this._tr;return p?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(p)},{originalEvent:n})}):y?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(y)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class os{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const a=this._moveFunction(...n);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(n,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,a){if(!this.isEnabled())return;const h=this._lastPoint;if(!h)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const p=a.length?a[0]:a;return!this._moved&&p.dist(h)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(h,p))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&P.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Xf={0:1,2:2};class ru{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const a=P.mouseButton(n);this._eventButton=a}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(a,h){const p=Xf[h];return a.buttons===void 0||(a.buttons&p)!==p}(n,this._eventButton)}isValidEndEvent(n){return P.mouseButton(n)===this._eventButton}}class dd{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const Ml=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=function(n){n.preventDefault()}},Lo=({enable:m,clickTolerance:n,bearingDegreesPerPixelMoved:a=.8})=>{const h=new ru({checkCorrectEvent:p=>P.mouseButton(p)===0&&p.ctrlKey||P.mouseButton(p)===2});return new os({clickTolerance:n,move:(p,y)=>({bearingDelta:(y.x-p.x)*a}),moveStateManager:h,enable:m,assignEvents:Ml})},as=({enable:m,clickTolerance:n,pitchDegreesPerPixelMoved:a=-.5})=>{const h=new ru({checkCorrectEvent:p=>P.mouseButton(p)===0&&p.ctrlKey||P.mouseButton(p)===2});return new os({clickTolerance:n,move:(p,y)=>({pitchDelta:(y.y-p.y)*a}),moveStateManager:h,enable:m,assignEvents:Ml})};class Ke{constructor(n,a){this._minTouches=n.cooperativeGestures?2:1,this._clickTolerance=n.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(n,a,h){return this._calculateTransform(n,a,h)}touchmove(n,a,h){if(this._map._cooperativeGestures&&(this._minTouches===2&&h.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(n,!1,h.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(h.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,h)}touchend(n,a,h){this._calculateTransform(n,a,h),this._active&&h.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,a,h){h.length>0&&(this._active=!0);const p=hi(h,a),y=new c.P(0,0),w=new c.P(0,0);let b=0;for(const C in p){const A=p[C],M=this._touches[C];M&&(y._add(A),w._add(A.sub(M)),b++,p[C]=A)}if(this._touches=p,b<this._minTouches||!w.mag())return;const E=w.div(b);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(b),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,a,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([a[0],a[1]]))}touchmove(n,a,h){if(!this._firstTwoTouches)return;n.preventDefault();const[p,y]=this._firstTwoTouches,w=Ps(h,a,p),b=Ps(h,a,y);if(!w||!b)return;const E=this._aroundCenter?null:w.add(b).div(2);return this._move([w,b],E,n)}touchend(n,a,h){if(!this._firstTwoTouches)return;const[p,y]=this._firstTwoTouches,w=Ps(h,a,p),b=Ps(h,a,y);w&&b||(this._active&&P.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ps(m,n,a){for(let h=0;h<m.length;h++)if(m[h].identifier===a)return n[h]}function Fo(m,n){return Math.log(m/n)/Math.LN2}class pd extends zl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,a){const h=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Fo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fo(this._distance,h),pinchAround:a}}}function Ze(m,n){return 180*m.angleWith(n)/Math.PI}class iu extends zl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,a){const h=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ze(this._vector,h),pinchAround:a}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const a=25/(Math.PI*this._minDiameter)*360,h=Ze(n,this._startVector);return Math.abs(h)<a}}function su(m){return Math.abs(m.y)>Math.abs(m.x)}class Yf extends zl{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,a,h){super.touchstart(n,a,h),this._currentTouchCount=h.length}_start(n){this._lastPoints=n,su(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,a,h){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=n[0].sub(this._lastPoints[0]),y=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,y,h.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(p.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(n,a,h){if(this._valid!==void 0)return this._valid;const p=n.mag()>=2,y=a.mag()>=2;if(!p&&!y)return;if(!p||!y)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const w=n.y>0==a.y>0;return su(n)&&su(a)&&w}}const ou={panStep:100,bearingStep:15,pitchStep:10};class fd{constructor(n){this._tr=new rs(n);const a=ou;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let a=0,h=0,p=0,y=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:n.shiftKey?h=-1:(n.preventDefault(),y=-1);break;case 39:n.shiftKey?h=1:(n.preventDefault(),y=1);break;case 38:n.shiftKey?p=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?p=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(h=0,p=0),{cameraAnimation:b=>{const E=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:md,zoom:a?Math.round(E.zoom)+a*(n.shiftKey?2:1):E.zoom,bearing:E.bearing+h*this._bearingStep,pitch:E.pitch+p*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:E.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function md(m){return m*(2-m)}const gd=4.000244140625;class Jf{constructor(n,a){this._onTimeout=h=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},this._map=n,this._tr=new rs(n),this._el=n.getCanvasContainer(),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!n[this._map._metaKey])return;n.preventDefault()}let a=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const h=c.h.now(),p=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,a!==0&&a%gd==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(p*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=P.mousePos(this._el,n),h=this._tr;this._around=c.L.convert(this._aroundCenter?h.center:h.unproject(a)),this._aroundPoint=h.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>gd?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&E!==0&&(E=1/E);const C=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(C*E))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,h=this._startZoom,p=this._easing;let y,w=!1;if(this._type==="wheel"&&h&&p){const b=Math.min((c.h.now()-this._lastWheelEventTime)/200,1),E=p(b);y=c.B.number(h,a,E),b<1?this._frameId||(this._frameId=!0):w=!0}else y=a,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:y-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let a=c.bb;if(this._prevEase){const h=this._prevEase,p=(c.h.now()-h.start)/h.duration,y=h.easing(p+.01)-h.easing(p),w=.27/Math.sqrt(y*y+1e-4)*.01,b=Math.sqrt(.0729-w*w);a=c.ba(w,b,.25,1)}return this._prevEase={start:c.h.now(),duration:n,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class au{constructor(n,a){this._clickZoom=n,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class lu{constructor(n){this._tr=new rs(n),this.reset()}reset(){this._active=!1}dblclick(n,a){return n.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cu{constructor(){this._tap=new Al({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,a,h){if(!this._swipePoint)if(this._tapTime){const p=a[0],y=n.timeStamp-this._tapTime<500,w=this._tapPoint.dist(p)<30;y&&w?h.length>0&&(this._swipePoint=p,this._swipeTouch=h[0].identifier):this.reset()}else this._tap.touchstart(n,a,h)}touchmove(n,a,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const p=a[0],y=p.y-this._swipePoint.y;return this._swipePoint=p,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,a,h)}touchend(n,a,h){if(this._tapTime)this._swipePoint&&h.length===0&&this.reset();else{const p=this._tap.touchend(n,a,h);p&&(this._tapTime=n.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uu{constructor(n,a,h){this._el=n,this._mousePan=a,this._touchPan=h}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class zr{constructor(n,a,h){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class As{constructor(n,a,h,p){this._el=n,this._touchZoom=a,this._touchRotate=h,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ma=m=>m.zoom||m.drag||m.pitch||m.rotate;class hu extends c.k{}function za(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class du{constructor(n,a){this.handleWindowEvent=p=>{this.handleEvent(p,`${p.type}Window`)},this.handleEvent=(p,y)=>{if(p.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=p.type==="renderFrame"?void 0:p,b={needsRenderFrame:!1},E={},C={},A=p.touches,M=A?this._getMapTouches(A):void 0,O=M?P.touchPos(this._el,M):P.mousePos(this._el,p);for(const{handlerName:K,handler:q,allowed:ue}of this._handlers){if(!q.isEnabled())continue;let ye;this._blockedByActive(C,ue,K)?q.reset():q[y||p.type]&&(ye=q[y||p.type](p,O,M),this.mergeHandlerResult(b,E,ye,K,w),ye&&ye.needsRenderFrame&&this._triggerRenderFrame()),(ye||q.isActive())&&(C[K]=q)}const H={};for(const K in this._previousActiveHandlers)C[K]||(H[K]=w);this._previousActiveHandlers=C,(Object.keys(H).length||za(b))&&(this._changes.push([b,E,H]),this._triggerRenderFrame()),(Object.keys(C).length||za(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=b;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ad(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,y,w]of this._listeners)P.addEventListener(p,y,p===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[n,a,h]of this._listeners)P.removeEventListener(n,a,n===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(n){const a=this._map,h=a.getCanvasContainer();this._add("mapEvent",new cd(a,n));const p=a.boxZoom=new hd(a,n);this._add("boxZoom",p),n.interactive&&n.boxZoom&&p.enable();const y=new ss(a),w=new lu(a);a.doubleClickZoom=new au(w,y),this._add("tapZoom",y),this._add("clickZoom",w),n.interactive&&n.doubleClickZoom&&a.doubleClickZoom.enable();const b=new cu;this._add("tapDragZoom",b);const E=a.touchPitch=new Yf(a);this._add("touchPitch",E),n.interactive&&n.touchPitch&&a.touchPitch.enable(n.touchPitch);const C=Lo(n),A=as(n);a.dragRotate=new zr(n,C,A),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",A,["mouseRotate"]),n.interactive&&n.dragRotate&&a.dragRotate.enable();const M=(({enable:ue,clickTolerance:ye})=>{const te=new ru({checkCorrectEvent:he=>P.mouseButton(he)===0&&!he.ctrlKey});return new os({clickTolerance:ye,move:(he,ve)=>({around:ve,panDelta:ve.sub(he)}),activateOnStart:!0,moveStateManager:te,enable:ue,assignEvents:Ml})})(n),O=new Ke(n,a);a.dragPan=new uu(h,M,O),this._add("mousePan",M),this._add("touchPan",O,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&a.dragPan.enable(n.dragPan);const H=new iu,Z=new pd;a.touchZoomRotate=new As(h,Z,H,b),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",Z,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&a.touchZoomRotate.enable(n.touchZoomRotate);const K=a.scrollZoom=new Jf(a,()=>this._triggerRenderFrame());this._add("scrollZoom",K,["mousePan"]),n.interactive&&n.scrollZoom&&a.scrollZoom.enable(n.scrollZoom);const q=a.keyboard=new fd(a);this._add("keyboard",q),n.interactive&&n.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new ud(a))}_add(n,a,h){this._handlers.push({handlerName:n,handler:a,allowed:h}),this._handlersById[n]=a}stop(n){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ma(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,a,h){for(const p in n)if(p!==h&&(!a||a.indexOf(p)<0))return!0;return!1}_getMapTouches(n){const a=[];for(const h of n)this._el.contains(h.target)&&a.push(h);return a}mergeHandlerResult(n,a,h,p,y){if(!h)return;c.e(n,h);const w={handlerName:p,originalEvent:h.originalEvent||y};h.zoomDelta!==void 0&&(a.zoom=w),h.panDelta!==void 0&&(a.drag=w),h.pitchDelta!==void 0&&(a.pitch=w),h.bearingDelta!==void 0&&(a.rotate=w)}_applyChanges(){const n={},a={},h={};for(const[p,y,w]of this._changes)p.panDelta&&(n.panDelta=(n.panDelta||new c.P(0,0))._add(p.panDelta)),p.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(n.around=p.around),p.pinchAround!==void 0&&(n.pinchAround=p.pinchAround),p.noInertia&&(n.noInertia=p.noInertia),c.e(a,y),c.e(h,w);this._updateMapTransform(n,a,h),this._changes=[]}_updateMapTransform(n,a,h){const p=this._map,y=p._getTransformForUpdate(),w=p.terrain;if(!(za(n)||w&&this._terrainMovement))return this._fireEvents(a,h,!0);let{panDelta:b,zoomDelta:E,bearingDelta:C,pitchDelta:A,around:M,pinchAround:O}=n;O!==void 0&&(M=O),p._stop(!0),M=M||p.transform.centerPoint;const H=y.pointLocation(b?M.sub(b):M);C&&(y.bearing+=C),A&&(y.pitch+=A),E&&(y.zoom+=E),w?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(b)):y.setLocationAtPoint(H,M):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(H,M),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,y.recalculateZoom(p.terrain)})):y.setLocationAtPoint(H,M),p._applyUpdatedTransform(y),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,h,!0)}_fireEvents(n,a,h){const p=Ma(this._eventsInProgress),y=Ma(n),w={};for(const A in n){const{originalEvent:M}=n[A];this._eventsInProgress[A]||(w[`${A}start`]=M),this._eventsInProgress[A]=n[A]}!p&&y&&this._fireEvent("movestart",y.originalEvent);for(const A in w)this._fireEvent(A,w[A]);y&&this._fireEvent("move",y.originalEvent);for(const A in n){const{originalEvent:M}=n[A];this._fireEvent(A,M)}const b={};let E;for(const A in this._eventsInProgress){const{handlerName:M,originalEvent:O}=this._eventsInProgress[A];this._handlersById[M].isActive()||(delete this._eventsInProgress[A],E=a[M]||O,b[`${A}end`]=E)}for(const A in b)this._fireEvent(A,b[A]);const C=Ma(this._eventsInProgress);if(h&&(p||y)&&!C){this._updatingCamera=!0;const A=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),M=O=>O!==0&&-this._bearingSnap<O&&O<this._bearingSnap;!A||!A.essential&&c.h.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:E})),M(this._map.getBearing())&&this._map.resetNorth()):(M(A.bearing||this._map.getBearing())&&(A.bearing=0),A.freezeElevation=!0,this._map.easeTo(A,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(n,a){this._map.fire(new c.k(n,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new hu("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class yd extends c.E{constructor(n,a){super(),this._renderFrameCallback=()=>{const h=Math.min((c.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.L(this.transform.center.lng,this.transform.center.lat)}setCenter(n,a){return this.jumpTo({center:n},a)}panBy(n,a,h){return n=c.P.convert(n).mult(-1),this.panTo(this.transform.center,c.e({offset:n},a),h)}panTo(n,a,h){return this.easeTo(c.e({center:n},a),h)}getZoom(){return this.transform.zoom}setZoom(n,a){return this.jumpTo({zoom:n},a),this}zoomTo(n,a,h){return this.easeTo(c.e({zoom:n},a),h)}zoomIn(n,a){return this.zoomTo(this.getZoom()+1,n,a),this}zoomOut(n,a){return this.zoomTo(this.getZoom()-1,n,a),this}getBearing(){return this.transform.bearing}setBearing(n,a){return this.jumpTo({bearing:n},a),this}getPadding(){return this.transform.padding}setPadding(n,a){return this.jumpTo({padding:n},a),this}rotateTo(n,a,h){return this.easeTo(c.e({bearing:n},a),h)}resetNorth(n,a){return this.rotateTo(0,c.e({duration:1e3},n),a),this}resetNorthPitch(n,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},n),a),this}snapToNorth(n,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,a):this}getPitch(){return this.transform.pitch}setPitch(n,a){return this.jumpTo({pitch:n},a),this}cameraForBounds(n,a){n=Pt.convert(n);const h=a&&a.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),h,a)}_cameraForBoxAndBearing(n,a,h,p){const y={top:0,bottom:0,right:0,left:0};if(typeof(p=c.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const ve=p.padding;p.padding={top:ve,bottom:ve,right:ve,left:ve}}p.padding=c.e(y,p.padding);const w=this.transform,b=w.padding,E=w.project(c.L.convert(n)),C=w.project(c.L.convert(a)),A=E.rotate(-h*Math.PI/180),M=C.rotate(-h*Math.PI/180),O=new c.P(Math.max(A.x,M.x),Math.max(A.y,M.y)),H=new c.P(Math.min(A.x,M.x),Math.min(A.y,M.y)),Z=O.sub(H),K=(w.width-(b.left+b.right+p.padding.left+p.padding.right))/Z.x,q=(w.height-(b.top+b.bottom+p.padding.top+p.padding.bottom))/Z.y;if(q<0||K<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ue=Math.min(w.scaleZoom(w.scale*Math.min(K,q)),p.maxZoom),ye=c.P.convert(p.offset),te=new c.P((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(h*Math.PI/180),he=ye.add(te).mult(w.scale/w.zoomScale(ue));return{center:w.unproject(E.add(C).div(2).sub(he)),zoom:ue,bearing:h}}fitBounds(n,a,h){return this._fitInternal(this.cameraForBounds(n,a),a,h)}fitScreenCoordinates(n,a,h,p,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(n)),this.transform.pointLocation(c.P.convert(a)),h,p),p,y)}_fitInternal(n,a,h){return n?(delete(a=c.e(n,a)).padding,a.linear?this.easeTo(a,h):this.flyTo(a,h)):this}jumpTo(n,a){this.stop();const h=this._getTransformForUpdate();let p=!1,y=!1,w=!1;return"zoom"in n&&h.zoom!==+n.zoom&&(p=!0,h.zoom=+n.zoom),n.center!==void 0&&(h.center=c.L.convert(n.center)),"bearing"in n&&h.bearing!==+n.bearing&&(y=!0,h.bearing=+n.bearing),"pitch"in n&&h.pitch!==+n.pitch&&(w=!0,h.pitch=+n.pitch),n.padding==null||h.isPaddingEqual(n.padding)||(h.padding=n.padding),this._applyUpdatedTransform(h),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),p&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),y&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),w&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(n,a,h,p=0){const y=c.U.fromLngLat(n,a),w=c.U.fromLngLat(h,p),b=w.x-y.x,E=w.y-y.y,C=w.z-y.z,A=Math.hypot(b,E,C);if(A===0)throw new Error("Can't calculate camera options with same From and To");const M=Math.hypot(b,E),O=this.transform.scaleZoom(this.transform.cameraToCenterDistance/A/this.transform.tileSize),H=180*Math.atan2(b,-E)/Math.PI;let Z=180*Math.acos(M/A)/Math.PI;return Z=C<0?90-Z:90+Z,{center:w.toLngLat(),zoom:O,pitch:Z,bearing:H}}easeTo(n,a){this._stop(!1,n.easeId),((n=c.e({offset:[0,0],duration:500,easing:c.bb},n)).animate===!1||!n.essential&&c.h.prefersReducedMotion)&&(n.duration=0);const h=this._getTransformForUpdate(),p=this.getZoom(),y=this.getBearing(),w=this.getPitch(),b=this.getPadding(),E="zoom"in n?+n.zoom:p,C="bearing"in n?this._normalizeBearing(n.bearing,y):y,A="pitch"in n?+n.pitch:w,M="padding"in n?n.padding:h.padding,O=c.P.convert(n.offset);let H=h.centerPoint.add(O);const Z=h.pointLocation(H),K=c.L.convert(n.center||Z);this._normalizeCenter(K);const q=h.project(Z),ue=h.project(K).sub(q),ye=h.zoomScale(E-p);let te,he;n.around&&(te=c.L.convert(n.around),he=h.locationPoint(te));const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||E!==p,this._rotating=this._rotating||y!==C,this._pitching=this._pitching||A!==w,this._padding=!h.isPaddingEqual(M),this._easeId=n.easeId,this._prepareEase(a,n.noMoveStart,ve),this.terrain&&this._prepareElevation(K),this._ease(we=>{if(this._zooming&&(h.zoom=c.B.number(p,E,we)),this._rotating&&(h.bearing=c.B.number(y,C,we)),this._pitching&&(h.pitch=c.B.number(w,A,we)),this._padding&&(h.interpolatePadding(b,M,we),H=h.centerPoint.add(O)),this.terrain&&!n.freezeElevation&&this._updateElevation(we),te)h.setLocationAtPoint(te,he);else{const Ee=h.zoomScale(h.zoom-p),ze=E>p?Math.min(2,ye):Math.max(.5,ye),ke=Math.pow(ze,1-we),Le=h.unproject(q.add(ue.mult(we*ke)).mult(Ee));h.setLocationAtPoint(h.renderWorldCopies?Le.wrap():Le,H)}this._applyUpdatedTransform(h),this._fireMoveEvents(a)},we=>{this.terrain&&this._finalizeElevation(),this._afterEase(a,we)},n),this}_prepareEase(n,a,h={}){this._moving=!0,a||h.moving||this.fire(new c.k("movestart",n)),this._zooming&&!h.zooming&&this.fire(new c.k("zoomstart",n)),this._rotating&&!h.rotating&&this.fire(new c.k("rotatestart",n)),this._pitching&&!h.pitching&&this.fire(new c.k("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&a!==this._elevationTarget){const h=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(h-(a-(h*n+this._elevationStart))/(1-n)),this._elevationTarget=a}this.transform.elevation=c.B.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(n){if(!this.transformCameraUpdate)return;const a=n.clone(),{center:h,zoom:p,pitch:y,bearing:w,elevation:b}=this.transformCameraUpdate(a);h&&(a.center=h),p!==void 0&&(a.zoom=p),y!==void 0&&(a.pitch=y),w!==void 0&&(a.bearing=w),b!==void 0&&(a.elevation=b),this.transform.apply(a)}_fireMoveEvents(n){this.fire(new c.k("move",n)),this._zooming&&this.fire(new c.k("zoom",n)),this._rotating&&this.fire(new c.k("rotate",n)),this._pitching&&this.fire(new c.k("pitch",n))}_afterEase(n,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const h=this._zooming,p=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new c.k("zoomend",n)),p&&this.fire(new c.k("rotateend",n)),y&&this.fire(new c.k("pitchend",n)),this.fire(new c.k("moveend",n))}flyTo(n,a){if(!n.essential&&c.h.prefersReducedMotion){const et=c.F(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(et,a)}this.stop(),n=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.bb},n);const h=this._getTransformForUpdate(),p=this.getZoom(),y=this.getBearing(),w=this.getPitch(),b=this.getPadding(),E="zoom"in n?c.ad(+n.zoom,h.minZoom,h.maxZoom):p,C="bearing"in n?this._normalizeBearing(n.bearing,y):y,A="pitch"in n?+n.pitch:w,M="padding"in n?n.padding:h.padding,O=h.zoomScale(E-p),H=c.P.convert(n.offset);let Z=h.centerPoint.add(H);const K=h.pointLocation(Z),q=c.L.convert(n.center||K);this._normalizeCenter(q);const ue=h.project(K),ye=h.project(q).sub(ue);let te=n.curve;const he=Math.max(h.width,h.height),ve=he/O,we=ye.mag();if("minZoom"in n){const et=c.ad(Math.min(n.minZoom,p,E),h.minZoom,h.maxZoom),Vt=he/h.zoomScale(et-p);te=Math.sqrt(Vt/we*2)}const Ee=te*te;function ze(et){const Vt=(ve*ve-he*he+(et?-1:1)*Ee*Ee*we*we)/(2*(et?ve:he)*Ee*we);return Math.log(Math.sqrt(Vt*Vt+1)-Vt)}function ke(et){return(Math.exp(et)-Math.exp(-et))/2}function Le(et){return(Math.exp(et)+Math.exp(-et))/2}const Je=ze(!1);let bt=function(et){return Le(Je)/Le(Je+te*et)},Ve=function(et){return he*((Le(Je)*(ke(Vt=Je+te*et)/Le(Vt))-ke(Je))/Ee)/we;var Vt},ut=(ze(!0)-Je)/te;if(Math.abs(we)<1e-6||!isFinite(ut)){if(Math.abs(he-ve)<1e-6)return this.easeTo(n,a);const et=ve<he?-1:1;ut=Math.abs(Math.log(ve/he))/te,Ve=function(){return 0},bt=function(Vt){return Math.exp(et*te*Vt)}}return n.duration="duration"in n?+n.duration:1e3*ut/("screenSpeed"in n?+n.screenSpeed/te:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=y!==C,this._pitching=A!==w,this._padding=!h.isPaddingEqual(M),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(q),this._ease(et=>{const Vt=et*ut,wt=1/bt(Vt);h.zoom=et===1?E:p+h.scaleZoom(wt),this._rotating&&(h.bearing=c.B.number(y,C,et)),this._pitching&&(h.pitch=c.B.number(w,A,et)),this._padding&&(h.interpolatePadding(b,M,et),Z=h.centerPoint.add(H)),this.terrain&&!n.freezeElevation&&this._updateElevation(et);const _t=et===1?q:h.unproject(ue.add(ye.mult(Ve(Vt))).mult(wt));h.setLocationAtPoint(h.renderWorldCopies?_t.wrap():_t,Z),this._applyUpdatedTransform(h),this._fireMoveEvents(a)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(a)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,a)}if(!n){const h=this.handlers;h&&h.stop(!1)}return this}_ease(n,a,h){h.animate===!1||h.duration===0?(n(1),a()):(this._easeStart=c.h.now(),this._easeOptions=h,this._onEaseFrame=n,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,a){n=c.b5(n,-180,180);const h=Math.abs(n-a);return Math.abs(n-360-a)<h&&(n-=360),Math.abs(n+360-a)<h&&(n+=360),n}_normalizeCenter(n){const a=this.transform;if(!a.renderWorldCopies||a.lngRange)return;const h=n.lng-a.center.lng;n.lng+=h>180?-360:h<-180?360:0}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(c.L.convert(n),this.transform.tileZoom)-this.transform.elevation:null}}class Wr{constructor(n={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options&&this.options.compact,this._container=P.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=P.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=P.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){P.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,a){const h=this._map._getUIString(`AttributionControl.${a}`);n.title=h,n.setAttribute("aria-label",h)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const a=this._map.style.sourceCaches;for(const p in a){const y=a[p];if(y.used||y.usedForTerrain){const w=y.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n=n.filter(p=>String(p).trim()),n.sort((p,y)=>p.length-y.length),n=n.filter((p,y)=>{for(let w=y+1;w<n.length;w++)if(n[w].indexOf(p)>=0)return!1;return!0});const h=n.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,n.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Jt{constructor(n={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const h=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact"):h.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=P.create("div","maplibregl-ctrl");const a=P.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){P.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Rl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a}remove(n){const a=this._currentlyRunning,h=a?this._queue.concat(a):this._queue;for(const p of h)if(p.id===n)return void(p.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const h of a)if(!h.cancelled&&(h.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const pu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var _d=c.Q([{name:"a_pos3d",type:"Int16",components:3}]);class vd extends c.E{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,a){this.sourceCache.update(n,a),this._renderableTilesKeys=[];const h={};for(const p of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))h[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.posMatrix=new Float64Array(16),c.aS(p.posMatrix,0,c.N,0,c.N,0,1),this._tiles[p.key]=new Ss(p,this.tileSize));for(const p in this._tiles)h[p]||delete this._tiles[p]}freeRtt(n){for(const a in this._tiles){const h=this._tiles[a];(!n||h.tileID.equals(n)||h.tileID.isChildOf(n)||n.isChildOf(h.tileID))&&(h.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const a={};for(const h of this._renderableTilesKeys){const p=this._tiles[h].tileID;if(p.canonical.equals(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16),c.aS(y.posMatrix,0,c.N,0,c.N,0,1),a[h]=y}else if(p.canonical.isChildOf(n.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=p.canonical.z-n.canonical.z,b=p.canonical.x-(p.canonical.x>>w<<w),E=p.canonical.y-(p.canonical.y>>w<<w),C=c.N>>w;c.aS(y.posMatrix,0,C,0,C,0,1),c.$(y.posMatrix,y.posMatrix,[-b*C,-E*C,0]),a[h]=y}else if(n.canonical.isChildOf(p.canonical)){const y=n.clone();y.posMatrix=new Float64Array(16);const w=n.canonical.z-p.canonical.z,b=n.canonical.x-(n.canonical.x>>w<<w),E=n.canonical.y-(n.canonical.y>>w<<w),C=c.N>>w;c.aS(y.posMatrix,0,c.N,0,c.N,0,1),c.$(y.posMatrix,y.posMatrix,[b*C,E*C,0]),c.a0(y.posMatrix,y.posMatrix,[1/2**w,1/2**w,0]),a[h]=y}}return a}getSourceTile(n,a){const h=this.sourceCache._source;let p=n.overscaledZ-this.deltaZoom;if(p>h.maxzoom&&(p=h.maxzoom),p<h.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(p).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!y||!y.dem)&&a)for(;p>=h.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(n.scaledTo(p--).key);return y}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=n)}}class xd{constructor(n,a,h){this.painter=n,this.sourceCache=new vd(a),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,a,h,p=c.N){var y;if(!(a>=0&&a<p&&h>=0&&h<p))return 0;const w=this.getTerrainData(n),b=(y=w.tile)===null||y===void 0?void 0:y.dem;if(!b)return 0;const E=function(Z,K,q){var ue=K[0],ye=K[1];return Z[0]=q[0]*ue+q[4]*ye+q[12],Z[1]=q[1]*ue+q[5]*ye+q[13],Z}([],[a/p*c.N,h/p*c.N],w.u_terrain_matrix),C=[E[0]*b.dim,E[1]*b.dim],A=Math.floor(C[0]),M=Math.floor(C[1]),O=C[0]-A,H=C[1]-M;return b.get(A,M)*(1-O)*(1-H)+b.get(A+1,M)*O*(1-H)+b.get(A,M+1)*(1-O)*H+b.get(A+1,M+1)*O*H}getElevationForLngLatZoom(n,a){const{tileID:h,mercatorX:p,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(n,a);return this.getElevation(h,p%c.N,y%c.N,c.N)}getElevation(n,a,h,p=c.N){return this.getDEMElevation(n,a,h,p)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const p=this.painter.context,y=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new it(p,y,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new it(p,new c.R({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ao([])}const a=this.sourceCache.getSourceTile(n,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const p=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new it(p,a.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),a.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const h=a&&a+a.tileID.key+n.key;if(h&&!this._demMatrixCache[h]){const p=this.sourceCache.sourceCache._source.maxzoom;let y=n.canonical.z-a.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=p?y=n.canonical.z-p:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=n.canonical.x-(n.canonical.x>>y<<y),b=n.canonical.y-(n.canonical.y>>y<<y),E=c.bc(new Float64Array(16),[1/(c.N<<y),1/(c.N<<y),0]);c.$(E,E,[w*c.N,b*c.N,0]),this._demMatrixCache[n.key]={matrix:E,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(n){const a=this.painter,h=a.width/devicePixelRatio,p=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new it(a.context,{width:h,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new it(a.context,{width:h,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(h,p,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,h,p))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,w=0;y<this._coordsTextureSize;y++)for(let b=0;b<this._coordsTextureSize;b++,w+=4)a[w+0]=255&b,a[w+1]=255&y,a[w+2]=b>>8<<4|y>>8,a[w+3]=0;const h=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),p=new it(n,h,n.gl.RGBA,{premultiply:!1});return p.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(n){const a=new Uint8Array(4),h=this.painter.context,p=h.gl;h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,a),h.bindFramebuffer.set(null);const y=a[0]+(a[2]>>4<<8),w=a[1]+((15&a[2])<<8),b=this.coordsIndex[255-a[3]],E=b&&this.sourceCache.getTileByID(b);if(!E)return null;const C=this._coordsTextureSize,A=(1<<E.tileID.canonical.z)*C;return new c.U(this._allowMercatorOverflow(n,(E.tileID.canonical.x*C+y)/A),(E.tileID.canonical.y*C+w)/A,this.getElevation(E.tileID,y,w,C))}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,a=new c.bd,h=new c.b0,p=this.meshSize,y=c.N/p,w=p*p;for(let M=0;M<=p;M++)for(let O=0;O<=p;O++)a.emplaceBack(O*y,M*y,0);for(let M=0;M<w;M+=p+1)for(let O=0;O<p;O++)h.emplaceBack(O+M,p+O+M+1,p+O+M+2),h.emplaceBack(O+M,p+O+M+2,O+M+1);const b=a.length,E=b+2*(p+1);for(const M of[0,1])for(let O=0;O<=p;O++)for(const H of[0,1])a.emplaceBack(O*y,M*c.N,H);for(let M=0;M<2*p;M+=2)h.emplaceBack(E+M,E+M+1,E+M+3),h.emplaceBack(E+M,E+M+3,E+M+2),h.emplaceBack(b+M,b+M+3,b+M+1),h.emplaceBack(b+M,b+M+2,b+M+3);const C=a.length,A=C+2*(p+1);for(const M of[0,1])for(let O=0;O<=p;O++)for(const H of[0,1])a.emplaceBack(M*c.N,O*y,H);for(let M=0;M<2*p;M+=2)h.emplaceBack(C+M,C+M+1,C+M+3),h.emplaceBack(C+M,C+M+3,C+M+2),h.emplaceBack(A+M,A+M+3,A+M+1),h.emplaceBack(A+M,A+M+2,A+M+3);return this._mesh={indexBuffer:n.createIndexBuffer(h),vertexBuffer:n.createVertexBuffer(a,_d.members),segments:c.S.simpleSegment(0,0,a.length,h.length)},this._mesh}getMeshFrameDelta(n){return 2*Math.PI*c.be/Math.pow(2,n)/5}getMinTileElevationForLngLatZoom(n,a){var h;const{tileID:p}=this._getOverscaledTileIDFromLngLatZoom(n,a);return(h=this.getMinMaxElevation(p).minElevation)!==null&&h!==void 0?h:0}getMinMaxElevation(n){const a=this.getTerrainData(n).tile,h={minElevation:null,maxElevation:null};return a&&a.dem&&(h.minElevation=a.dem.min*this.exaggeration,h.maxElevation=a.dem.max*this.exaggeration),h}_getOverscaledTileIDFromLngLatZoom(n,a){const h=c.U.fromLngLat(n.wrap()),p=(1<<a)*c.N,y=h.x*p,w=h.y*p,b=Math.floor(y/c.N),E=Math.floor(w/c.N);return{tileID:new c.O(a,0,a,b,E),mercatorX:y,mercatorY:w}}_allowMercatorOverflow(n,a){const h=n.x<this.painter.width/2;let p=c.bf(a);const y=this.painter.transform.center.lng;return h&&Math.sign(p)>0&&Math.sign(y)<0||!h&&Math.sign(p)<0&&Math.sign(y)>0?(p=360*Math.sign(y)+p,c.G(p)):a}}class Qf{constructor(n,a,h){this._context=n,this._size=a,this._tileSize=h,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),h=new it(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return h.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(h.texture),{id:n,fbo:a,texture:h,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>n.id!==a),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const wr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Dl{constructor(n,a){this.painter=n,this.terrain=a,this.pool=new Qf(n.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(h=>!n._layers[h].isHidden(a)),this._coordsDescendingInv={};for(const h in n.sourceCaches){this._coordsDescendingInv[h]={};const p=n.sourceCaches[h].getVisibleCoordinates();for(const y of p){const w=this.terrain.sourceCache.getTerrainCoords(y);for(const b in w)this._coordsDescendingInv[h][b]||(this._coordsDescendingInv[h][b]=[]),this._coordsDescendingInv[h][b].push(w[b])}}this._coordsDescendingInvStr={};for(const h of n._order){const p=n._layers[h],y=p.source;if(wr[p.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const w in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][w]=this._coordsDescendingInv[y][w].map(b=>b.key).sort().join()}}for(const h of this._renderableTiles)for(const p in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[p][h.tileID.key];y&&y!==h.rttCoords[p]&&(h.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const a=n.type,h=this.painter,p=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(wr[a]&&(this._prevType&&wr[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(n.id),!p))return!0;if(wr[this._prevType]||wr[a]&&p){this._prevType=a;const y=this._stacks.length-1,w=this._stacks[y]||[];for(const b of this._renderableTiles){if(this.pool.isFull()&&(pn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(b),b.rtt[y]){const C=this.pool.getObjectForId(b.rtt[y].id);if(C.stamp===b.rtt[y].stamp){this.pool.useObject(C);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),b.rtt[y]={id:E.id,stamp:E.stamp},h.context.bindFramebuffer.set(E.fbo.framebuffer),h.context.clear({color:c.aT.transparent,stencil:0}),h.currentStencilSource=void 0;for(let C=0;C<w.length;C++){const A=h.style._layers[w[C]],M=A.source?this._coordsDescendingInv[A.source][b.tileID.key]:[b.tileID];h.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),h._renderTileClippingMasks(A,M),h.renderLayer(h,h.style.sourceCaches[A.source],A,M),A.source&&(b.rttCoords[A.source]=this._coordsDescendingInvStr[A.source][b.tileID.key])}}return pn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),wr[a]}return!1}}const nt=z,ct={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Ra=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},fu={showCompass:!0,showZoom:!0,visualizePitch:!1};class mu{constructor(n,a,h=!1){this.mousedown=w=>{this.startMouse(c.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),P.mousePos(this.element,w)),P.addEventListener(window,"mousemove",this.mousemove),P.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,P.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=P.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),P.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),P.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=P.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const p=n.dragRotate._mouseRotate.getClickTolerance(),y=n.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=Lo({clickTolerance:p,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:b,bearingDegreesPerPixelMoved:E=.8})=>{const C=new dd;return new os({clickTolerance:b,move:(A,M)=>({bearingDelta:(M.x-A.x)*E}),moveStateManager:C,enable:w,assignEvents:Ra})})({clickTolerance:p,enable:!0}),this.map=n,h&&(this.mousePitch=as({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:b,pitchDegreesPerPixelMoved:E=-.5})=>{const C=new dd;return new os({clickTolerance:b,move:(A,M)=>({pitchDelta:(M.y-A.y)*E}),moveStateManager:C,enable:w,assignEvents:Ra})})({clickTolerance:y,enable:!0})),P.addEventListener(a,"mousedown",this.mousedown),P.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),P.addEventListener(a,"touchcancel",this.reset)}startMouse(n,a){this.mouseRotate.dragStart(n,a),this.mousePitch&&this.mousePitch.dragStart(n,a),P.disableDrag()}startTouch(n,a){this.touchRotate.dragStart(n,a),this.touchPitch&&this.touchPitch.dragStart(n,a),P.disableDrag()}moveMouse(n,a){const h=this.map,{bearingDelta:p}=this.mouseRotate.dragMove(n,a)||{};if(p&&h.setBearing(h.getBearing()+p),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(n,a)||{};y&&h.setPitch(h.getPitch()+y)}}moveTouch(n,a){const h=this.map,{bearingDelta:p}=this.touchRotate.dragMove(n,a)||{};if(p&&h.setBearing(h.getBearing()+p),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(n,a)||{};y&&h.setPitch(h.getPitch()+y)}}off(){const n=this.element;P.removeEventListener(n,"mousedown",this.mousedown),P.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),P.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),P.removeEventListener(window,"touchend",this.touchend),P.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){P.enableDrag(),P.removeEventListener(window,"mousemove",this.mousemove),P.removeEventListener(window,"mouseup",this.mouseup),P.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),P.removeEventListener(window,"touchend",this.touchend)}}let Sn;function gu(m,n,a){if(m=new c.L(m.lng,m.lat),n){const h=new c.L(m.lng-360,m.lat),p=new c.L(m.lng+360,m.lat),y=a.locationPoint(m).distSqr(n);a.locationPoint(h).distSqr(n)<y?m=h:a.locationPoint(p).distSqr(n)<y&&(m=p)}for(;Math.abs(m.lng-a.center.lng)>180;){const h=a.locationPoint(m);if(h.x>=0&&h.y>=0&&h.x<=a.width&&h.y<=a.height)break;m.lng>a.center.lng?m.lng-=360:m.lng+=360}return m}const di={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function wd(m,n,a){const h=m.classList;for(const p in di)h.remove(`maplibregl-${a}-anchor-${p}`);h.add(`maplibregl-${a}-anchor-${n}`)}class eo extends c.E{constructor(n){if(super(),this._onKeyPress=a=>{const h=a.code,p=a.charCode||a.keyCode;h!=="Space"&&h!=="Enter"&&p!==32&&p!==13||this.togglePopup()},this._onMapClick=a=>{const h=a.originalEvent.target,p=this._element;this._popup&&(h===p||p.contains(h))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!h)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=gu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),a&&a.type!=="moveend"||(this._pos=this._pos.round()),P.setTransform(this._element,`${di[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${p}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const w=this._map.unproject(this._pos),b=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=w.distanceTo(this._lngLat)>20*b?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=a=>{if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=c.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=P.create("div"),this._element.setAttribute("aria-label","Map marker");const a=P.createNS("http://www.w3.org/2000/svg","svg"),h=41,p=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${h}px`),a.setAttributeNS(null,"width",`${p}px`),a.setAttributeNS(null,"viewBox",`0 0 ${p} ${h}`);const y=P.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const w=P.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const b=P.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ue of E){const ye=P.createNS("http://www.w3.org/2000/svg","ellipse");ye.setAttributeNS(null,"opacity","0.04"),ye.setAttributeNS(null,"cx","10.5"),ye.setAttributeNS(null,"cy","5.80029008"),ye.setAttributeNS(null,"rx",ue.rx),ye.setAttributeNS(null,"ry",ue.ry),b.appendChild(ye)}const C=P.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill",this._color);const A=P.createNS("http://www.w3.org/2000/svg","path");A.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),C.appendChild(A);const M=P.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"opacity","0.25"),M.setAttributeNS(null,"fill","#000000");const O=P.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),M.appendChild(O);const H=P.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const Z=P.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");const K=P.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#000000"),K.setAttributeNS(null,"opacity","0.25"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962");const q=P.createNS("http://www.w3.org/2000/svg","circle");q.setAttributeNS(null,"fill","#FFFFFF"),q.setAttributeNS(null,"cx","5.5"),q.setAttributeNS(null,"cy","5.5"),q.setAttributeNS(null,"r","5.4999962"),Z.appendChild(K),Z.appendChild(q),w.appendChild(b),w.appendChild(C),w.appendChild(M),w.appendChild(H),w.appendChild(Z),a.appendChild(w),a.setAttributeNS(null,"height",h*this._scale+"px"),a.setAttributeNS(null,"width",p*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),wd(this._element,this._anchor,"marker"),n&&n.className)for(const a of n.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),P.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=c.L.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const p=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(n){return this._offset=c.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const fn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ln=0,Oo=!1;const Da={maxWidth:100,unit:"metric"};function La(m,n,a){const h=a&&a.maxWidth||100,p=m._container.clientHeight/2,y=m.unproject([0,p]),w=m.unproject([h,p]),b=y.distanceTo(w);if(a&&a.unit==="imperial"){const E=3.2808*b;E>5280?to(n,h,E/5280,m._getUIString("ScaleControl.Miles")):to(n,h,E,m._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?to(n,h,b/1852,m._getUIString("ScaleControl.NauticalMiles")):b>=1e3?to(n,h,b/1e3,m._getUIString("ScaleControl.Kilometers")):to(n,h,b,m._getUIString("ScaleControl.Meters"))}function to(m,n,a,h){const p=function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let b=y/w;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(E){const C=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*C)/C}(b),w*b}(a);m.style.width=n*(p/a)+"px",m.innerHTML=`${p}&nbsp;${h}`}const yu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},_u=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bo(m){if(m){if(typeof m=="number"){const n=Math.round(Math.abs(m)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,m),"top-left":new c.P(n,n),"top-right":new c.P(-n,n),bottom:new c.P(0,-m),"bottom-left":new c.P(n,-n),"bottom-right":new c.P(-n,-n),left:new c.P(m,0),right:new c.P(-m,0)}}if(m instanceof c.P||Array.isArray(m)){const n=c.P.convert(m);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:c.P.convert(m.center||[0,0]),top:c.P.convert(m.top||[0,0]),"top-left":c.P.convert(m["top-left"]||[0,0]),"top-right":c.P.convert(m["top-right"]||[0,0]),bottom:c.P.convert(m.bottom||[0,0]),"bottom-left":c.P.convert(m["bottom-left"]||[0,0]),"bottom-right":c.P.convert(m["bottom-right"]||[0,0]),left:c.P.convert(m.left||[0,0]),right:c.P.convert(m.right||[0,0])}}return Bo(new c.P(0,0))}const vu={extend:(m,...n)=>c.e(m,...n),run(m){m()},logToElement(m,n=!1,a="log"){const h=window.document.getElementById(a);h&&(n&&(h.innerHTML=""),h.innerHTML+=`<br>${m}`)}},xu=z;class Ft{static get version(){return xu}static get workerCount(){return Di.workerCount}static set workerCount(n){Di.workerCount=n}static get maxParallelImageRequests(){return c.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(n){c.c.MAX_PARALLEL_IMAGE_REQUESTS=n}static get workerUrl(){return c.c.WORKER_URL}static set workerUrl(n){c.c.WORKER_URL=n}static addProtocol(n,a){c.c.REGISTERED_PROTOCOLS[n]=a}static removeProtocol(n){delete c.c.REGISTERED_PROTOCOLS[n]}}return Ft.Map=class extends yd{constructor(m){if(c.bg.mark(c.bh.create),(m=c.e({},ct,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Pl(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),{bearingSnap:m.bearingSnap}),this._cooperativeGesturesOnWheel=n=>{this._onCooperativeGesture(n,n[this._metaKey],1)},this._contextLost=n=>{n.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.k("webglcontextlost",{originalEvent:n}))},this._contextRestored=n=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:n}))},this._onMapScroll=n=>{if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=m.interactive,this._cooperativeGestures=m.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new Rl,this._controls=[],this._mapId=c.a2(),this._locale=c.e({},pu,m.locale),this._clickTolerance=m.clickTolerance,this._overridePixelRatio=m.pixelRatio,this._maxCanvasSize=m.maxCanvasSize,this.transformCameraUpdate=m.transformCameraUpdate,this._imageQueueHandle=Me.addThrottleControl(()=>this.isMoving()),this._requestManager=new Y(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let n=!1;const a=Qs(h=>{this._trackResize&&!this._removed&&this.resize(h)._update()},50);this._resizeObserver=new ResizeObserver(h=>{n?a(h):n=!0}),this._resizeObserver.observe(this._container)}this.handlers=new du(this,m),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=m.hash&&new ka(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,c.e({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new Wr({customAttribution:m.customAttribution})),m.maplibreLogo&&this.addControl(new Jt,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new c.k(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new c.k(`${n.dataType}dataloading`,n))}),this.on("dataabort",n=>{this.fire(new c.k("sourcedataabort",n))})}_getMapId(){return this._mapId}addControl(m,n){if(n===void 0&&(n=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=m.onAdd(this);this._controls.push(m);const h=this._controlPositions[n];return n.indexOf("bottom")!==-1?h.insertBefore(a,h.firstChild):h.appendChild(a),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(m);return n>-1&&this._controls.splice(n,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,n,a,h){return h==null&&this.terrain&&(h=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,n,a,h)}resize(m){var n;const a=this._containerDimensions(),h=a[0],p=a[1],y=this._getClampedPixelRatio(h,p);if(this._resizeCanvas(h,p,y),this.painter.resize(h,p,y),this.painter.overLimit()){const b=this.painter.context.gl;this._maxCanvasSize=[b.drawingBufferWidth,b.drawingBufferHeight];const E=this._getClampedPixelRatio(h,p);this._resizeCanvas(h,p,E),this.painter.resize(h,p,E)}this.transform.resize(h,p),(n=this._requestedCameraState)===null||n===void 0||n.resize(h,p);const w=!this._moving;return w&&(this.stop(),this.fire(new c.k("movestart",m)).fire(new c.k("move",m))),this.fire(new c.k("resize",m)),w&&this.fire(new c.k("moveend",m)),this}_getClampedPixelRatio(m,n){const{0:a,1:h}=this._maxCanvasSize,p=this.getPixelRatio(),y=m*p,w=n*p;return Math.min(y>a?a/y:1,w>h?h/w:1)*p}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(Pt.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(m){return this.transform.locationPoint(c.L.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(c.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,n,a){if(m==="mouseenter"||m==="mouseover"){let h=!1;return{layer:n,listener:a,delegates:{mousemove:y=>{const w=this.getLayer(n)?this.queryRenderedFeatures(y.point,{layers:[n]}):[];w.length?h||(h=!0,a.call(this,new Hr(m,this,y.originalEvent,{features:w}))):h=!1},mouseout:()=>{h=!1}}}}if(m==="mouseleave"||m==="mouseout"){let h=!1;return{layer:n,listener:a,delegates:{mousemove:w=>{(this.getLayer(n)?this.queryRenderedFeatures(w.point,{layers:[n]}):[]).length?h=!0:h&&(h=!1,a.call(this,new Hr(m,this,w.originalEvent)))},mouseout:w=>{h&&(h=!1,a.call(this,new Hr(m,this,w.originalEvent)))}}}}{const h=p=>{const y=this.getLayer(n)?this.queryRenderedFeatures(p.point,{layers:[n]}):[];y.length&&(p.features=y,a.call(this,p),delete p.features)};return{layer:n,listener:a,delegates:{[m]:h}}}}on(m,n,a){if(a===void 0)return super.on(m,n);const h=this._createDelegatedListener(m,n,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(h);for(const p in h.delegates)this.on(p,h.delegates[p]);return this}once(m,n,a){if(a===void 0)return super.once(m,n);const h=this._createDelegatedListener(m,n,a);for(const p in h.delegates)this.once(p,h.delegates[p]);return this}off(m,n,a){return a===void 0?super.off(m,n):(this._delegatedListeners&&this._delegatedListeners[m]&&(h=>{const p=this._delegatedListeners[m];for(let y=0;y<p.length;y++){const w=p[y];if(w.layer===n&&w.listener===a){for(const b in w.delegates)this.off(b,w.delegates[b]);return p.splice(y,1),this}}})(),this)}queryRenderedFeatures(m,n){if(!this.style)return[];let a;const h=m instanceof c.P||Array.isArray(m),p=h?m:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(h?{}:m)||{},p instanceof c.P||typeof p[0]=="number")a=[c.P.convert(p)];else{const y=c.P.convert(p[0]),w=c.P.convert(p[1]);a=[y,new c.P(w.x,y.y),w,new c.P(y.x,w.y),y]}return this.style.queryRenderedFeatures(a,n,this.transform)}querySourceFeatures(m,n){return this.style.querySourceFeatures(m,n)}setStyle(m,n){return(n=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(m,n))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const n=this._locale[m];if(n==null)throw new Error(`Missing UI string '${m}'`);return n}_updateStyle(m,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,n));const a=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new nr(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,n,a):this.style.loadJSON(m,n,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new nr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,n){if(typeof m=="string"){const a=this._requestManager.transformRequest(m,X.Style);c.f(a,(h,p)=>{h?this.fire(new c.j(h)):p&&this._updateDiff(p,n)})}else typeof m=="object"&&this._updateDiff(m,n)}_updateDiff(m,n){try{this.style.setState(m,n)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(m,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(m,n){return this._lazyInitEmptyStyle(),this.style.addSource(m,n),this._update(!0)}isSourceLoaded(m){const n=this.style&&this.style.sourceCaches[m];if(n!==void 0)return n.loaded();this.fire(new c.j(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const n=this.style.sourceCaches[m.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);for(const a in this.style._layers){const h=this.style._layers[a];h.type==="hillshade"&&h.source===m.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xd(this.painter,n,m),this.painter.renderToTexture=new Dl(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==m.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:m})),this}getTerrain(){var m,n;return(n=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const n in m){const a=m[n]._tiles;for(const h in a){const p=a[h];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(m,n,a){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,n,a)}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,n,a={}){const{pixelRatio:h=1,sdf:p=!1,stretchX:y,stretchY:w,content:b}=a;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||c.a(n))){if(n.width===void 0||n.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:C,data:A}=n,M=n;return this.style.addImage(m,{data:new c.R({width:E,height:C},new Uint8Array(A)),pixelRatio:h,stretchX:y,stretchY:w,content:b,sdf:p,version:0,userImage:M}),M.onAdd&&M.onAdd(this,m),this}}{const{width:E,height:C,data:A}=c.h.getImageData(n);this.style.addImage(m,{data:new c.R({width:E,height:C},A),pixelRatio:h,stretchX:y,stretchY:w,content:b,sdf:p,version:0})}}updateImage(m,n){const a=this.style.getImage(m);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=n instanceof HTMLImageElement||c.a(n)?c.h.getImageData(n):n,{width:p,height:y,data:w}=h;if(p===void 0||y===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==a.data.width||y!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(n instanceof HTMLImageElement||c.a(n));return a.data.replace(w,b),this.style.updateImage(m,a),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,n){Me.getImage(this._requestManager.transformRequest(m,X.Image),n)}listImages(){return this.style.listImages()}addLayer(m,n){return this._lazyInitEmptyStyle(),this.style.addLayer(m,n),this._update(!0)}moveLayer(m,n){return this.style.moveLayer(m,n),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,n,a){return this.style.setLayerZoomRange(m,n,a),this._update(!0)}setFilter(m,n,a={}){return this.style.setFilter(m,n,a),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,n,a,h={}){return this.style.setPaintProperty(m,n,a,h),this._update(!0)}getPaintProperty(m,n){return this.style.getPaintProperty(m,n)}setLayoutProperty(m,n,a,h={}){return this.style.setLayoutProperty(m,n,a,h),this._update(!0)}getLayoutProperty(m,n){return this.style.getLayoutProperty(m,n)}setGlyphs(m,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,n,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,n,a,h=>{h||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,n,a=>{a||this._update(!0)}),this}setLight(m,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(m,n){return this.style.setFeatureState(m,n),this._update()}removeFeatureState(m,n){return this.style.removeFeatureState(m,n),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,n=0;return this._container&&(m=this._container.clientWidth||400,n=this._container.clientHeight||300),[m,n]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const n=this._canvasContainer=P.create("div","maplibregl-canvas-container",m);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=P.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),h=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],h);const p=this._controlContainer=P.create("div","maplibregl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=P.create("div",`maplibregl-ctrl-${w} `,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=P.create("div","maplibregl-cooperative-gesture-screen",this._container);let m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(m=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${m}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){P.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(m,n,a){this._canvas.width=Math.floor(a*m),this._canvas.height=Math.floor(a*n),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",h=>{n={requestedAttributes:m},h&&(n.statusMessage=h.statusMessage,n.type=h.type)},{once:!0});const a=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!a){const h="Failed to initialize WebGL";throw n?(n.message=h,new Error(JSON.stringify(n))):new Error(h)}this.painter=new Js(a,this.transform),V.testSupport(a)}_onCooperativeGesture(m,n,a){return!n&&a<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const p=this.transform.zoom,y=c.h.now();this.style.zoomHistory.update(p,y);const w=new c.a8(p,{now:y,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),b=w.crossFadingFactor();b===1&&b===this._crossFadingFactor||(a=!0,this._crossFadingFactor=b),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bg.mark(c.bh.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0,c.bg.mark(c.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Me.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),P.remove(this._canvasContainer),P.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),c.bg.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=c.h.frame(m=>{c.bg.frame(m),this._frame=null,this._render(m)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return nt}getCameraTargetElevation(){return this.transform.elevation}},Ft.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const n=this._map.getZoom(),a=n===this._map.getMaxZoom(),h=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},this._rotateCompassArrow=()=>{const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._setButtonTitle=(n,a)=>{const h=this._map._getUIString(`NavigationControl.${a}`);n.title=h,n.setAttribute("aria-label",h)},this.options=c.e({},fu,m),this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),P.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),P.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=P.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new mu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){P.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,n){const a=P.create("button",m,this._container);return a.type="button",a.addEventListener("click",n),a}},Ft.GeolocateControl=class extends c.E{constructor(m){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",n)),this._finish()}},this._updateCamera=n=>{const a=new c.L(n.coords.longitude,n.coords.latitude),h=n.coords.accuracy,p=this._map.getBearing(),y=c.e({bearing:p},this.options.fitBoundsOptions),w=Pt.fromLngLat(a,h);this._map.fitBounds(w,y,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const a=new c.L(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Oo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=n=>{if(this._map){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=P.create("button","maplibregl-ctrl-geolocate",this._container),P.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",n===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=P.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new eo({element:this._dotElement}),this._circleElement=P.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new eo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")))})}},this.options=c.e({},fn,m)}onAdd(m){return this._map=m,this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(n,a=!1){Sn===void 0||a?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(h=>{Sn=h.state!=="denied",n(Sn)}).catch(()=>{Sn=!!window.navigator.geolocation,n(Sn)}):(Sn=!!window.navigator.geolocation,n(Sn)):n(Sn)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),P.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ln=0,Oo=!1}_isOutOfMapMaxBounds(m){const n=this._map.getMaxBounds(),a=m.coords;return n&&(a.longitude<n.getWest()||a.longitude>n.getEast()||a.latitude<n.getSouth()||a.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const m=this._map.getBounds(),n=m.getSouthEast(),a=m.getNorthEast(),h=n.distanceTo(a),p=Math.ceil(this._accuracy/(h/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ln--,Oo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ln++,ln>1?(m={maximumAge:6e5,timeout:0},Oo=!0):(m=this.options.positionOptions,Oo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Ft.AttributionControl=Wr,Ft.LogoControl=Jt,Ft.ScaleControl=class{constructor(m){this._onMove=()=>{La(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,La(this._map,this._container,this.options)},this.options=c.e({},Da,m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){P.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Ft.FullscreenControl=class extends c.E{constructor(m={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){P.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=P.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);P.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Ft.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=m}onAdd(m){return this._map=m,this._container=P.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=P.create("button","maplibregl-ctrl-terrain",this._container),P.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){P.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Ft.Popup=class extends c.E{constructor(m){super(),this.remove=()=>(this._content&&P.remove(this._content),this._container&&(P.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new c.k("close")),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=P.create("div","maplibregl-popup",this._map.getContainer()),this._tip=P.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gu(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!n)return;const a=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);let h=this.options.anchor;const p=Bo(this.options.offset);if(!h){const w=this._container.offsetWidth,b=this._container.offsetHeight;let E;E=a.y+p.bottom.y<b?["top"]:a.y>this._map.transform.height-b?["bottom"]:[],a.x<w/2?E.push("left"):a.x>this._map.transform.width-w/2&&E.push("right"),h=E.length===0?"bottom":E.join("-")}const y=a.add(p[h]).round();P.setTransform(this._container,`${di[h]} translate(${y.x}px,${y.y}px)`),wd(this._container,h,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(yu),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=c.L.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const n=document.createDocumentFragment(),a=document.createElement("body");let h;for(a.innerHTML=m;h=a.firstChild,h;)n.appendChild(h);return this.setDOMContent(n)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=P.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){this._container&&this._container.classList.add(m)}removeClassName(m){this._container&&this._container.classList.remove(m)}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}_createCloseButton(){this.options.closeButton&&(this._closeButton=P.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(_u);m&&m.focus()}},Ft.Marker=eo,Ft.Style=nr,Ft.LngLat=c.L,Ft.LngLatBounds=Pt,Ft.Point=c.P,Ft.MercatorCoordinate=c.U,Ft.Evented=c.E,Ft.AJAXError=c.bi,Ft.config=c.c,Ft.CanvasSource=ws,Ft.GeoJSONSource=si,Ft.ImageSource=bn,Ft.RasterDEMTileSource=jn,Ft.RasterTileSource=zn,Ft.VectorTileSource=cr,Ft.VideoSource=_a,Ft.setRTLTextPlugin=c.bj,Ft.getRTLTextPluginStatus=c.bk,Ft.prewarm=function(){ol().acquire(Mt)},Ft.clearPrewarmedResources=function(){const m=es;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Mt),es=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},vu.extend(Ft,{isSafari:c.ac,getPerformanceMetrics:c.bg.getPerformanceMetrics}),Ft});var T=f;return T})})(g2);var gP=g2.exports;const Ua=C1(gP);var kn=function(){function e(){}return e.setup=function(r){r===void 0&&(r={}),e.options=r},e.get=function(){return e.options||{}},e.clear=function(){e.options={}},e.defaultOptions={live:!1,logLevel:"error",host:"https://api.radar.io",version:"v1",debug:!1},e}(),ra={none:0,error:1,warn:2,info:3,debug:4},lp=function(){if(window&&window.RADAR_TEST_ENV)return ra.none;var e=kn.get(),r=e.logLevel,o=e.debug;return o?ra.debug:r?ra[r]:ra.error},un=function(){function e(){}return e.debug=function(r){lp()===ra.debug&&console.log("Radar SDK (debug): ".concat(r.trim()))},e.info=function(r){lp()>=ra.info&&console.log("Radar SDK: ".concat(r.trim()))},e.warn=function(r){lp()>=ra.warn&&console.warn("Radar SDK: ".concat(r.trim()))},e.error=function(r){lp()>=ra.error&&console.error("Radar SDK: ".concat(r.trim()))},e}(),ht=function(){function e(){}return Object.defineProperty(e,"USER_ID",{get:function(){return"radar-userId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEVICE_ID",{get:function(){return"radar-deviceId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INSTALL_ID",{get:function(){return"radar-installId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SESSION_ID",{get:function(){return"radar-sessionId"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DESCRIPTION",{get:function(){return"radar-description"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"METADATA",{get:function(){return"radar-metadata"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CACHED_LOCATION",{get:function(){return"radar-cached-location"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TRIP_OPTIONS",{get:function(){return"radar-trip-options"},enumerable:!1,configurable:!0}),e.getStorage=function(){var r=window==null?void 0:window.localStorage;return r||un.warn("localStorage not available."),r},e.setItem=function(r,o){var u=this.getStorage();u&&o!=null&&u.setItem(r,o)},e.getItem=function(r){var o=this.getStorage();if(!o)return null;var u=o.getItem(r);return u??null},e.getJSON=function(r){var o=this.getItem(r);if(!o)return null;try{return JSON.parse(o)}catch{return un.warn("could not getJSON from storage for key: ".concat(r)),null}},e.removeItem=function(r){var o=this.getStorage();if(!o)return null;o.removeItem(r)},e.clear=function(){var r=this.getStorage();if(!r)return null;r.clear()},e}(),zy=function(e,r){return zy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(o[f]=u[f])},zy(e,r)};function ii(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");zy(e,r);function o(){this.constructor=e}e.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}var Sc=function(){return Sc=Object.assign||function(r){for(var o,u=1,f=arguments.length;u<f;u++){o=arguments[u];for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&(r[v]=o[v])}return r},Sc.apply(this,arguments)};function On(e,r,o,u){function f(v){return v instanceof o?v:new o(function(T){T(v)})}return new(o||(o=Promise))(function(v,T){function c(V){try{P(u.next(V))}catch(U){T(U)}}function z(V){try{P(u.throw(V))}catch(U){T(U)}}function P(V){V.done?v(V.value):f(V.value).then(c,z)}P((u=u.apply(e,r||[])).next())})}function Bn(e,r){var o={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},u,f,v,T;return T={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function c(P){return function(V){return z([P,V])}}function z(P){if(u)throw new TypeError("Generator is already executing.");for(;T&&(T=0,P[0]&&(o=0)),o;)try{if(u=1,f&&(v=P[0]&2?f.return:P[0]?f.throw||((v=f.return)&&v.call(f),0):f.next)&&!(v=v.call(f,P[1])).done)return v;switch(f=0,v&&(P=[P[0]&2,v.value]),P[0]){case 0:case 1:v=P;break;case 4:return o.label++,{value:P[1],done:!1};case 5:o.label++,f=P[1],P=[0];continue;case 7:P=o.ops.pop(),o.trys.pop();continue;default:if(v=o.trys,!(v=v.length>0&&v[v.length-1])&&(P[0]===6||P[0]===2)){o=0;continue}if(P[0]===3&&(!v||P[1]>v[0]&&P[1]<v[3])){o.label=P[1];break}if(P[0]===6&&o.label<v[1]){o.label=v[1],v=P;break}if(v&&o.label<v[2]){o.label=v[2],o.ops.push(P);break}v[2]&&o.ops.pop(),o.trys.pop();continue}P=r.call(e,o)}catch(V){P=[6,V],f=0}finally{u=v=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}var Si=function(e){ii(r,e);function r(o){var u=e.call(this,o)||this;return u.status="",u}return r}(Error),Ry=function(e){ii(r,e);function r(o){var u=e.call(this,o)||this;return u.name="RadarPublishableKeyError",u.status="ERROR_PUBLISHABLE_KEY",u}return r}(Si),Qu=function(e){ii(r,e);function r(o){var u=e.call(this,o)||this;return u.name="RadarLocationError",u.status="ERROR_LOCATION",u}return r}(Si),_2=function(e){ii(r,e);function r(o){var u=e.call(this,o)||this;return u.name="RadarLocationPermissionsError",u.status="ERROR_PERMISSIONS",u}return r}(Si),yP=function(e){ii(r,e);function r(){var o=e.call(this,"Desktop app not running.")||this;return o.name="RadarDesktopAppError",o.status="ERROR_DESKTOP_APP",o}return r}(Si),_P=function(e){ii(r,e);function r(o){var u=this,f;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Bad request.")||this,u.name="RadarBadRequestError",u.code=400,u.response=o,u.status="ERROR_BAD_REQUEST",u}return r}(Si),vP=function(e){ii(r,e);function r(o){var u=this,f;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Unauthorized.")||this,u.name="RadarUnauthorizedError",u.code=401,u.response=o,u.status="ERROR_UNAUTHORIZED",u}return r}(Si),xP=function(e){ii(r,e);function r(o){var u=this,f;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Payment required.")||this,u.name="RadarPaymentRequiredError",u.code=402,u.response=o,u.status="ERROR_PAYMENT_REQUIRED",u}return r}(Si),wP=function(e){ii(r,e);function r(o){var u=this,f;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Forbidden.")||this,u.name="RadarForbiddenError",u.code=403,u.response=o,u.status="ERROR_FORBIDDEN",u}return r}(Si),bP=function(e){ii(r,e);function r(o){var u=this,f;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Not found.")||this,u.name="RadarNotFoundError",u.code=404,u.response=o,u.status="ERROR_NOT_FOUND",u}return r}(Si),SP=function(e){ii(r,e);function r(o){var u=this,f,v;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Rate limit exceeded.")||this,u.name="RadarRateLimitError",u.code=429,u.response=o,u.type=(v=o==null?void 0:o.meta)===null||v===void 0?void 0:v.type,u.status="ERROR_RATE_LIMIT",u}return r}(Si),xg=function(e){ii(r,e);function r(o){var u=this,f;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Internal server error.")||this,u.name="RadarServerError",u.response=o,u.status="ERROR_SERVER",u}return r}(Si),i1=function(e){ii(r,e);function r(){var o=e.call(this,"Request timed out.")||this;return o.name="RadarTimeoutError",o.status="ERROR_TIMED_OUT",o}return r}(Si),TP=function(e){ii(r,e);function r(o){var u=this,f;return u=e.call(this,((f=o==null?void 0:o.meta)===null||f===void 0?void 0:f.message)||"Something went wrong.")||this,u.name="RadarUnknownError",u.response=o,u.status="ERROR_UNKNOWN",u}return r}(Si),EP=function(e){ii(r,e);function r(o){var u=e.call(this,o)||this;return u.name="RadarAutocompleteContainerNotFound",u.status="CONTAINER_NOT_FOUND",u}return r}(Si),IP={1:"Permission denied.",2:"Position unavailable.",3:"Timeout."},CP={maximumAge:0,timeout:1e3*30,enableHighAccuracy:!0},s1=function(e){return e==="high"},Vs=function(){function e(){}return e.getCurrentPosition=function(r){return r===void 0&&(r={}),On(this,void 0,void 0,function(){return Bn(this,function(o){return[2,new Promise(function(u,f){var v=kn.get();if(!navigator||!navigator.geolocation)return f(new Qu("navigator.geolocation is not available."));if(v.cacheLocationMinutes)try{var T=ht.getItem(ht.CACHED_LOCATION);if(T){var c=JSON.parse(T),z=c||{},P=z.latitude,V=z.longitude,U=z.accuracy,N=z.expiresAt;if(Date.now()<parseInt(N)&&P&&V&&U)return u({latitude:P,longitude:V,accuracy:U})}}catch{un.warn("could not load cached location.")}var le=Object.assign({},CP);v.locationMaximumAge!==void 0&&(le.maximumAge=v.locationMaximumAge),v.locationTimeout!==void 0&&(le.timeout=v.locationTimeout),v.desiredAccuracy!==void 0&&(le.enableHighAccuracy=s1(v.desiredAccuracy)),r.desiredAccuracy!==void 0&&(le.enableHighAccuracy=s1(r.desiredAccuracy)),un.info("Using geolocation options: ".concat(JSON.stringify(le))),navigator.geolocation.getCurrentPosition(function(ie){if(!ie||!ie.coords)return f(new Qu("device location return empty coordinates."));var ge=ie.coords,Me=ge.latitude,X=ge.longitude,Y=ge.accuracy;if(v.cacheLocationMinutes){var se=Number.parseFloat(v.cacheLocationMinutes),xe=Date.now(),Ae=xe+se*60*1e3,Fe={latitude:Me,longitude:X,accuracy:Y,updatedAt:xe,expiresAt:Ae};ht.setItem(ht.CACHED_LOCATION,JSON.stringify(Fe))}return u({latitude:Me,longitude:X,accuracy:Y})},function(ie){if(ie&&ie.code){var ge=IP[ie.code.toString()]||"unknown";return f(new _2(ge))}return f(new Qu("Could not determine location."))},le)})]})})},e.getPermissionStatus=function(){return On(this,void 0,void 0,function(){return Bn(this,function(r){return[2,new Promise(function(o,u){if(!navigator||!navigator.permissions)return u(new Qu("navigator.permissions is not available."));navigator.permissions.query({name:"geolocation"}).then(function(f){var v="NOT_DETERMINED";switch(f.state){case"granted":v="GRANTED_FOREGROUND";break;case"denied":v="DENIED";break;case"prompt":v="NOT_DETERMINED";break}return o(v)})})]})})},e}(),Mf="4.1.11",Vr=function(){function e(){}return e.request=function(r){var o=r.method,u=r.path,f=r.data,v=r.host;return On(this,void 0,void 0,function(){return Bn(this,function(T){return[2,new Promise(function(c,z){var P=kn.get(),V=P.publishableKey;if(!V){z(new Ry("publishableKey not set."));return}var U=v||P.host,N=P.version,le="".concat(U,"/").concat(N,"/").concat(u),ie={};if(Object.keys(f||{}).forEach(function(se){var xe=f[se];xe!==void 0&&(ie[se]=xe)}),o==="GET"){var ge=Object.keys(ie).map(function(se){return"".concat(se,"=").concat(encodeURIComponent(ie[se]))});if(ge.length>0){var Me=ge.join("&");le="".concat(le,"?").concat(Me)}ie=void 0}var X=new XMLHttpRequest;if(X.open(o,le,!0),X.setRequestHeader("Authorization",V),X.setRequestHeader("Content-Type","application/json"),X.setRequestHeader("X-Radar-Device-Type","Web"),X.setRequestHeader("X-Radar-SDK-Version",Mf),typeof P.getRequestHeaders=="function"){var Y=P.getRequestHeaders();Object.keys(Y||{}).forEach(function(se){X.setRequestHeader(se,Y[se])})}X.onload=function(){var se,xe;try{xe=JSON.parse(X.response)}catch{return z(new xg(xe))}var Ae=(se=xe==null?void 0:xe.meta)===null||se===void 0?void 0:se.error;if(Ae==="ERROR_PERMISSIONS")return z(new _2("Location permissions not granted."));if(Ae==="ERROR_LOCATION")return z(new Qu("Could not determine location."));if(Ae==="ERROR_NETWORK")return z(new i1);if(X.status==200)return c(xe);P.debug&&(un.debug("API call failed: ".concat(le)),un.debug(JSON.stringify(xe))),X.status===400?z(new _P(xe)):X.status===401?z(new vP(xe)):X.status===402?z(new xP(xe)):X.status===403?z(new wP(xe)):X.status===404?z(new bP(xe)):X.status===429?z(new SP(xe)):500<=X.status&&X.status<600?z(new xg(xe)):z(new TP(xe))},X.onerror=function(){z(v&&v==="https://radar-verify.com:52516"?new yP:new xg)},X.ontimeout=function(){z(new i1)},X.send(JSON.stringify(ie))})]})})},e}(),kP=function(){function e(){}return e.validateAddress=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T;return Bn(this,function(c){switch(c.label){case 0:return o=kn.get(),[4,Vr.request({method:"GET",path:"addresses/validate",data:r})];case 1:return u=c.sent(),f=u.address,v=u.result,T={address:f,result:v},o.debug&&(T.response=u),[2,T]}})})},e}(),o1=function(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var o=Math.random()*16|0,u=r=="x"?o:o&3|8;return u.toString(16)});return e},fa=function(){function e(){}return e.getDeviceId=function(){var r=ht.getItem(ht.DEVICE_ID);if(r)return r;var o=o1();return ht.setItem(ht.DEVICE_ID,o),o},e.getInstallId=function(){var r=ht.getItem(ht.INSTALL_ID);if(r)return r;var o=o1();return ht.setItem(ht.INSTALL_ID,o),o},e}(),PP=300,AP=function(e){var r=Math.trunc(Date.now()/1e3),o=Number.parseInt(e),u=Math.abs(r-o);return u<PP},q_=function(){function e(){}return e.getSessionId=function(){var r=ht.getItem(ht.SESSION_ID);if(r&&AP(r))return r;var o=Math.trunc(Date.now()/1e3).toString();return ht.setItem(ht.SESSION_ID,o),o},e}(),a1=function(){function e(){}return e.getConfig=function(r){return r===void 0&&(r={}),On(this,void 0,void 0,function(){var o,u,f,v,T,c,z;return Bn(this,function(P){switch(P.label){case 0:return o=kn.get(),o.version!="v1"?(un.info("Skipping /config call."),[2]):(u=r.deviceId||fa.getDeviceId(),f=r.installId||fa.getInstallId(),v=q_.getSessionId(),[4,Vs.getPermissionStatus()]);case 1:T=P.sent(),c={deviceId:u,installId:f,sessionId:v,locationAuthorization:T},P.label=2;case 2:return P.trys.push([2,4,,5]),[4,Vr.request({method:"GET",path:"config",data:c})];case 3:return P.sent(),[3,5];case 4:return z=P.sent(),un.warn("Error calling /config: ".concat(z.message)),[3,5];case 5:return[2]}})})},e}(),MP=function(){function e(){}return e.getContext=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,U,N,le;return Bn(this,function(ie){switch(ie.label){case 0:return o=kn.get(),!r.latitude||!r.longitude?[4,Vs.getCurrentPosition()]:[3,2];case 1:r=ie.sent(),ie.label=2;case 2:return u=r.latitude,f=r.longitude,v=r.accuracy,[4,Vr.request({method:"GET",path:"context",data:{coordinates:"".concat(u,",").concat(f),accuracy:v}})];case 3:return T=ie.sent(),c=T.geofences,z=T.place,P=T.country,V=T.state,U=T.dma,N=T.postalCode,le={location:r,geofences:c,place:z,country:P,state:V,dma:U,postalCode:N},o.debug&&(le.response=T),[2,le]}})})},e}(),zP=function(){function e(){}return e.logConversion=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,U;return Bn(this,function(N){switch(N.label){case 0:return o=kn.get(),u=r.name,f=r.userId||ht.getItem(ht.USER_ID),v=r.deviceId||fa.getDeviceId(),T=r.installId||fa.getInstallId(),c=r.metadata||{},z=r.createdAt,r.revenue&&(c.revenue=r.revenue),P={name:u,userId:f,deviceId:v,installId:T,metadata:c},typeof z=="string"?P.createdAt=z:z instanceof Date?P.createdAt=z.toISOString():P.createdAt=new Date().toISOString(),[4,Vr.request({method:"POST",path:"events",data:P})];case 1:return V=N.sent(),U={event:V.event},o.debug&&(U.response=V),[2,U]}})})},e}(),wg=function(){function e(){}return e.forwardGeocode=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c;return Bn(this,function(z){switch(z.label){case 0:return o=kn.get(),u=r.query,f=r.layers,v=r.country,[4,Vr.request({method:"GET",path:"geocode/forward",data:{query:u,layers:f,country:v}})];case 1:return T=z.sent(),c={addresses:T.addresses},o.debug&&(c.response=T),[2,c]}})})},e.reverseGeocode=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z;return Bn(this,function(P){switch(P.label){case 0:return o=kn.get(),u=r.latitude,f=r.longitude,v=r.layers,!u||!f?[4,Vs.getCurrentPosition()]:[3,2];case 1:T=P.sent(),u=T.latitude,f=T.longitude,P.label=2;case 2:return[4,Vr.request({method:"GET",path:"geocode/reverse",data:{coordinates:"".concat(u,",").concat(f),layers:v}})];case 3:return c=P.sent(),z={addresses:c.addresses},o.debug&&(z.response=c),[2,z]}})})},e.ipGeocode=function(){return On(this,void 0,void 0,function(){var r,o,u;return Bn(this,function(f){switch(f.label){case 0:return r=kn.get(),[4,Vr.request({method:"GET",path:"geocode/ip"})];case 1:return o=f.sent(),u={ip:o.ip,address:o.address,proxy:o.proxy},r.debug&&(u.response=o),[2,u]}})})},e}(),l1=function(){function e(){}return e.distance=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,U,V,U,V,U,N,le;return Bn(this,function(ie){switch(ie.label){case 0:return o=kn.get(),u=r.origin,f=r.destination,v=r.modes,T=r.units,c=r.geometry,z=r.geometryPoints,u?[3,2]:[4,Vs.getCurrentPosition()];case 1:return P=ie.sent(),V=P.latitude,U=P.longitude,u="".concat(V,",").concat(U),[3,3];case 2:typeof u!="string"&&(V=u.latitude,U=u.longitude,u="".concat(V,",").concat(U)),ie.label=3;case 3:return typeof f!="string"&&(V=f.latitude,U=f.longitude,f="".concat(V,",").concat(U)),Array.isArray(v)&&(v=v.join(",")),[4,Vr.request({method:"GET",path:"route/distance",data:{origin:u,destination:f,modes:v,units:T,geometry:c,geometryPoints:z}})];case 4:return N=ie.sent(),le={routes:N.routes},o.debug&&(le.response=N),[2,le]}})})},e.matrix=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,U,N,le;return Bn(this,function(ie){switch(ie.label){case 0:return o=kn.get(),u=r.origins,f=r.destinations,v=r.mode,T=r.units,u?[3,2]:[4,Vs.getCurrentPosition()];case 1:for(c=ie.sent(),z=c.latitude,P=c.longitude,V=[],U=0;U<f.length;U++)V.push("".concat(z,",").concat(P));return u=V.join("|"),[3,3];case 2:Array.isArray(u)&&(u=u.map(function(ge){return"".concat(ge.latitude,",").concat(ge.longitude)}).join("|")),ie.label=3;case 3:return Array.isArray(f)&&(f=f.map(function(ge){return"".concat(ge.latitude,",").concat(ge.longitude)}).join("|")),[4,Vr.request({method:"GET",path:"route/matrix",data:{origins:u,destinations:f,mode:v,units:T}})];case 4:return N=ie.sent(),le={origins:N.origins,destinations:N.destinations,matrix:N.matrix},o.debug&&(le.response=N),[2,le]}})})},e}(),Ip=function(){function e(){}return e.autocomplete=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V;return Bn(this,function(U){switch(U.label){case 0:return o=kn.get(),u=r.query,f=r.near,v=r.limit,T=r.layers,c=r.countryCode,z=r.expandUnits,f&&typeof f!="string"&&f.latitude&&f.longitude&&(f="".concat(f.latitude,",").concat(f.longitude)),[4,Vr.request({method:"GET",path:"search/autocomplete",data:{query:u,near:f,limit:v,layers:T,countryCode:c,expandUnits:z}})];case 1:return P=U.sent(),V={addresses:P.addresses},o.debug&&(V.response=P),[2,V]}})})},e.searchGeofences=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,P,V,U,N;return Bn(this,function(le){switch(le.label){case 0:return o=kn.get(),u=r.near,f=r.radius,v=r.tags,T=r.metadata,c=r.limit,u?[3,2]:[4,Vs.getCurrentPosition()];case 1:return z=le.sent(),P=z.latitude,V=z.longitude,u="".concat(P,",").concat(V),[3,3];case 2:typeof u!="string"&&(P=u.latitude,V=u.longitude,u="".concat(P,",").concat(V)),le.label=3;case 3:return Array.isArray(v)&&(v=v.join(",")),[4,Vr.request({method:"GET",path:"search/geofences",data:{near:u,radius:f,tags:v,metadata:T,limit:c}})];case 4:return U=le.sent(),N={geofences:U.geofences},o.debug&&(N.response=U),[2,N]}})})},e.searchPlaces=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,U,V,U,N,le;return Bn(this,function(ie){switch(ie.label){case 0:return o=kn.get(),u=r.near,f=r.radius,v=r.chains,T=r.categories,c=r.groups,z=r.limit,u?[3,2]:[4,Vs.getCurrentPosition()];case 1:return P=ie.sent(),V=P.latitude,U=P.longitude,u="".concat(V,",").concat(U),[3,3];case 2:typeof u!="string"&&(V=u.latitude,U=u.longitude,u="".concat(V,",").concat(U)),ie.label=3;case 3:return Array.isArray(v)&&(v=v.join(",")),Array.isArray(T)&&(T=T.join(",")),Array.isArray(c)&&(c=c.join(",")),[4,Vr.request({method:"GET",path:"search/places",data:{near:u,radius:f,chains:v,categories:T,groups:c,limit:z}})];case 4:return N=ie.sent(),le={places:N.places},o.debug&&(le.response=N),[2,le]}})})},e}(),c1=function(e){return e&&Object.prototype.toString.call(e)==="[object Date]"&&!isNaN(e)},Wo=function(){function e(){}return e.setTripOptions=function(r){if(!r){e.clearTripOptions();return}var o=JSON.stringify(r);un.debug("Saving trip options: ".concat(o)),ht.setItem(ht.TRIP_OPTIONS,o)},e.getTripOptions=function(){var r=ht.getItem(ht.TRIP_OPTIONS);return r&&(r=JSON.parse(r)),r},e.clearTripOptions=function(){ht.removeItem(ht.TRIP_OPTIONS)},e.startTrip=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,U,N,le;return Bn(this,function(ie){switch(ie.label){case 0:return o=kn.get(),r=r||e.getTripOptions(),r||un.warn('tripOptions not set when calling "startTrip"'),u=r.userId||ht.getItem(ht.USER_ID),u&&u!==ht.getItem(ht.USER_ID)&&ht.setItem(ht.USER_ID,u),f=r.externalId,v=r.destinationGeofenceTag,T=r.destinationGeofenceExternalId,c=r.mode,z=r.metadata,P=r.approachingThreshold,V=r.scheduledArrivalAt,U={userId:u,externalId:f,destinationGeofenceTag:v,destinationGeofenceExternalId:T,mode:c,metadata:z,approachingThreshold:P},c1(V)?U.scheduledArrivalAt=V==null?void 0:V.toJSON():(V&&un.warn("Invalid date format for scheduledArrivalAt"),U.scheduledArrivalAt=void 0),[4,Vr.request({method:"POST",path:"trips",data:U})];case 1:return N=ie.sent(),e.setTripOptions(r),le={trip:N.trip,events:N.events},o.debug&&(le.response=N),[2,le]}})})},e.updateTrip=function(r,o){return On(this,void 0,void 0,function(){var u,f,v,T,c,z,P,V,U,N,le;return Bn(this,function(ie){switch(ie.label){case 0:return u=kn.get(),r=r||e.getTripOptions(),r||un.warn('tripOptions not set when calling "startTrip"'),f=r.externalId,v=r.destinationGeofenceTag,T=r.destinationGeofenceExternalId,c=r.mode,z=r.metadata,P=r.approachingThreshold,V=r.scheduledArrivalAt,U={status:o,externalId:f,destinationGeofenceTag:v,destinationGeofenceExternalId:T,mode:c,metadata:z,approachingThreshold:P},c1(V)?U.scheduledArrivalAt=V==null?void 0:V.toJSON():(V&&un.warn("Invalid date format for scheduledArrivalAt"),U.scheduledArrivalAt=void 0),[4,Vr.request({method:"PATCH",path:"trips/".concat(f,"/update"),data:U})];case 1:return N=ie.sent(),le={trip:N.trip,events:N.events},u.debug&&(le.response=N),[2,le]}})})},e.completeTrip=function(){return On(this,void 0,void 0,function(){var r,o;return Bn(this,function(u){switch(u.label){case 0:return r=e.getTripOptions(),[4,e.updateTrip(r,"completed")];case 1:return o=u.sent(),e.clearTripOptions(),[2,o]}})})},e.cancelTrip=function(){return On(this,void 0,void 0,function(){var r,o;return Bn(this,function(u){switch(u.label){case 0:return r=e.getTripOptions(),[4,e.updateTrip(r,"canceled")];case 1:return o=u.sent(),e.clearTripOptions(),[2,o]}})})},e}(),RP=function(){function e(){}return e.trackOnce=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P,V,U,N,le,ie,ge,Me,X,Y,se,xe,Ae,Fe,De;return Bn(this,function(qe){switch(qe.label){case 0:return o=kn.get(),u=r.latitude,f=r.longitude,v=r.accuracy,T=r.desiredAccuracy,!u||!f?[4,Vs.getCurrentPosition({desiredAccuracy:T})]:[3,2];case 1:c=qe.sent(),u=c.latitude,f=c.longitude,v=c.accuracy,qe.label=2;case 2:return qe.trys.push([2,4,,5]),[4,Vs.getPermissionStatus()];case 3:return z=qe.sent(),[3,5];case 4:return P=qe.sent(),un.warn("Location authorization error: ".concat(P.message)),[3,5];case 5:return V=r.userId||ht.getItem(ht.USER_ID),U=r.deviceId||fa.getDeviceId(),N=r.installId||fa.getInstallId(),le=q_.getSessionId(),ie=r.deviceType||"Web",ge=r.description||ht.getItem(ht.DESCRIPTION),V?ht.setItem(ht.USER_ID,V):un.warn("userId not provided for trackOnce."),Me=r.metadata||ht.getJSON(ht.METADATA),X=r.tripOptions||Wo.getTripOptions(),X&&(X.version="2"),Y=Sc(Sc({},r),{locationAuthorization:z,accuracy:v,description:ge,deviceId:U,deviceType:ie,foreground:!0,installId:N,sessionId:le,latitude:u,longitude:f,metadata:Me,sdkVersion:Mf,stopped:!0,userId:V,tripOptions:X}),[4,Vr.request({method:"POST",path:"track",data:Y})];case 6:return se=qe.sent(),xe=se.user,Ae=se.events,Fe={latitude:u,longitude:f,accuracy:v},De={user:xe,events:Ae,location:Fe},o.debug&&(De.response=se),[2,De]}})})},e}(),u1=function(){function e(){}return e.trackVerified=function(r,o){return o===void 0&&(o=!1),On(this,void 0,void 0,function(){var u,f,v,T,c,z,P,V,U,N,le,ie,ge,Me,X,Y,se;return Bn(this,function(xe){switch(xe.label){case 0:return u=kn.get(),f=r.userId||ht.getItem(ht.USER_ID),v=r.deviceId||fa.getDeviceId(),T=r.installId||fa.getInstallId(),c=q_.getSessionId(),z=r.description||ht.getItem(ht.DESCRIPTION),f?ht.setItem(ht.USER_ID,f):un.warn("userId not provided for trackVerified."),P=r.metadata||ht.getJSON(ht.METADATA),V=Sc(Sc({},r),{description:z,deviceId:v,foreground:!0,installId:T,sessionId:c,metadata:P,sdkVersion:Mf,stopped:!0,userId:f,encrypted:o}),U=navigator.userAgent,N=U&&U.toLowerCase().includes("mac"),[4,Vr.request({method:"GET",path:"verify",data:V,host:N?"https://radar-verify.com:52516":"http://localhost:52516"})];case 1:return le=xe.sent(),ie=le.user,ge=le.events,Me=le.token,ie&&ie.location&&ie.location.coordinates&&ie.locationAccuracy&&(X={latitude:ie.location.coordinates[1],longitude:ie.location.coordinates[0],accuracy:ie.locationAccuracy}),o?(Y={token:Me},u.debug&&(Y.response=le),[2,Y]):(se={user:ie,events:ge,location:X},u.debug&&(se.response=le),[2,se])}})})},e}(),DP="radar-default-v1",v2=["radar-default-v1","radar-light-v1","radar-dark-v1"],LP="https://api.radar.io/maps/static/images/logo.svg",FP={minZoom:1,maxZoom:20,attributionControl:!1,dragRotate:!1,touchPitch:!1,maplibreLogo:!1},OP={color:"#000257"},x2=function(e,r){return r===void 0&&(r=DP),"".concat(e.host,"/maps/styles/").concat(r,"?publishableKey=").concat(e.publishableKey)},BP=function(e,r){var o=r.style;return!o||typeof o=="string"&&v2.includes(o)?x2(e,r.style):r.style},bg=function(){function e(){}return e.getMapLibre=function(){return Ua},e.createMap=function(r){var o=kn.get();o.publishableKey||un.warn("publishableKey not set. Call Radar.initialize() with key before creating a new map.");var u=BP(o,r),f=Object.assign({},FP,r,{style:u});un.debug("initialize map with options: ".concat(JSON.stringify(f))),f.container=r.container,f.transformRequest=function(N,le){if(le==="Style"&&v2.includes(N)){var ie=x2(o,N);return{url:ie}}else return{url:N}};var v=new Ua.Map(f),T=v.getContainer();!T.style.width&&!T.style.height&&un.warn('map container does not have a set "width" or "height"');var c=document.createElement("img");c.src=LP;var z=document.createElement("a");z.id="radar-map-logo",z.href="https://radar.com?ref=powered_by_radar",z.target="_blank",z.style.position="absolute",z.style.bottom="0",z.style.left="5px",z.style.width="80px",z.style.height="38px",z.appendChild(c),v.getContainer().appendChild(z);var P=new Ua.AttributionControl({compact:!1});v.addControl(P,"bottom-right");var V=new Ua.NavigationControl({showCompass:!1});v.addControl(V,"bottom-right");var U=function(){var N=document.querySelector(".maplibregl-ctrl-attrib");if(N){var le=v.getContainer().clientWidth;le<380?N.classList.add("hidden"):N.classList.remove("hidden")}};return v.on("resize",U),v.on("load",U),v},e.createMarker=function(r){r===void 0&&(r={});var o=Object.assign({},OP);r.color&&(o.color=r.color),r.element&&(o.element=r.element),r.scale&&(o.scale=r.scale);var u=new Ua.Marker(o);if(r.text){var f=new Ua.Popup({offset:35}).setText(r.text);u.setPopup(f)}else if(r.html){var f=new Ua.Popup({offset:35}).setHTML(r.html);u.setPopup(f)}return u},e}(),mi={WRAPPER:"radar-autocomplete-wrapper",INPUT:"radar-autocomplete-input",SEARCH_ICON:"radar-autocomplete-search-icon",RESULTS_LIST:"radar-autocomplete-results-list",RESULTS_ITEM:"radar-autocomplete-results-item",RESULTS_MARKER:"radar-autocomplete-results-marker",SELECTED_ITEM:"radar-autocomplete-results-item-selected",POWERED_BY_RADAR:"radar-powered",NO_RESULTS:"radar-no-results"},h1={EXPANDED:"aria-expanded"},NP={container:"autocomplete",debounceMS:200,minCharacters:3,limit:8,placeholder:"Search address",responsive:!0,disabled:!1,showMarkers:!0,hideResultsOnBlur:!0},Dy=function(e){return typeof e=="number"?"".concat(e,"px"):e},jP=400,Sg=function(e,r){if(r.responsive){e.style.width="100%",r.width&&(e.style.maxWidth=Dy(r.width));return}e.style.width=Dy(r.width||jP),e.style.removeProperty("max-width")},d1=function(e,r){r.maxHeight&&(e.style.maxHeight=Dy(r.maxHeight),e.style.overflowY="auto")},Tg=function(e){e===void 0&&(e="#ACBDC8");var r=e.replace("#","%23"),o=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M12.5704 6.57036C12.5704 4.11632 10.6342 2.11257 8.21016 2C8.14262 2 8.06757 2 8.00003 2C7.93249 2 7.85744 2 7.7899 2C5.35838 2.11257 3.42967 4.11632 3.42967 6.57036C3.42967 6.60037 3.42967 6.6379 3.42967 6.66792C3.42967 6.69794 3.42967 6.73546 3.42967 6.76548C3.42967 9.46717 7.09196 13.3621 7.4672 13.7598C7.61729 13.9174 7.84994 14 8.00003 14C8.15012 14 8.38277 13.9174 8.53286 13.7598C8.9156 13.3621 12.5704 9.46717 12.5704 6.76548C12.5704 6.72795 12.5704 6.69794 12.5704 6.66792C12.5704 6.6379 12.5704 6.60037 12.5704 6.57036ZM7.99252 8.28893C7.04693 8.28893 6.27395 7.52345 6.27395 6.57036C6.27395 5.61726 7.03943 4.85178 7.99252 4.85178C8.94562 4.85178 9.7111 5.61726 9.7111 6.57036C9.7111 7.52345 8.94562 8.28893 7.99252 8.28893Z" fill="`.concat(r,`"/>
  </svg>`).trim();return"data:image/svg+xml;charset=utf-8,".concat(o)},UP=function(){function e(r){r===void 0&&(r={}),this.config=Object.assign({},NP,r),this.isOpen=!1,this.debouncedFetchResults=this.debounce(this.fetchResults,this.config.debounceMS),this.results=[],this.highlightedIndex=-1,this.config.threshold!==void 0&&(this.config.minCharacters=this.config.threshold,un.warn('AutocompleteUI option "threshold" is deprecated, use "minCharacters" instead.')),r.near&&(typeof r.near=="string"?this.near=r.near:this.near="".concat(r.near.latitude,",").concat(r.near.longitude));var o;if(typeof this.config.container=="string"?o=document.getElementById(this.config.container):o=this.config.container,!o)throw new EP("Could not find container element: ".concat(this.config.container));if(this.container=o,this.wrapper=document.createElement("div"),this.wrapper.classList.add(mi.WRAPPER),this.wrapper.style.display=this.config.responsive?"block":"inline-block",Sg(this.wrapper,this.config),this.resultsList=document.createElement("ul"),this.resultsList.classList.add(mi.RESULTS_LIST),d1(this.resultsList,this.config),o.nodeName==="INPUT")this.inputField=o,this.wrapper.appendChild(this.resultsList),o.parentNode.appendChild(this.wrapper);else{this.inputField=document.createElement("input"),this.inputField.classList.add(mi.INPUT),this.inputField.placeholder=this.config.placeholder,this.inputField.type="text",this.inputField.disabled=this.config.disabled;var u=document.createElement("div");u.classList.add(mi.SEARCH_ICON),this.wrapper.appendChild(this.inputField),this.wrapper.appendChild(this.resultsList),this.wrapper.appendChild(u),this.container.appendChild(this.wrapper)}this.inputField.addEventListener("input",this.handleInput.bind(this)),this.inputField.addEventListener("keydown",this.handleKeyboardNavigation.bind(this)),this.config.hideResultsOnBlur&&this.inputField.addEventListener("blur",this.close.bind(this),!0),un.debug("AutocompleteUI iniailized with options: ".concat(JSON.stringify(this.config)))}return e.createAutocomplete=function(r){return new e(r)},e.prototype.handleInput=function(){var r=this,o=this.inputField.value;o.length<this.config.minCharacters||this.debouncedFetchResults(o).then(function(u){var f=r.config.onResults;f&&f(u),r.displayResults(u)}).catch(function(u){un.warn("Autocomplete ui error: ".concat(u.message));var f=r.config.onError;f&&f(u)})},e.prototype.debounce=function(r,o){var u=this,f,v,T;return function(){for(var c=[],z=0;z<arguments.length;z++)c[z]=arguments[z];return clearTimeout(f),f=setTimeout(function(){var P=r.apply(u,c);P instanceof Promise&&P.then(function(V){v&&v(V)}).catch(function(V){T&&T(V)})},o),new Promise(function(P,V){v=P,T=V})}},e.prototype.fetchResults=function(r){return On(this,void 0,void 0,function(){var o,u,f,v,T,c,z,P;return Bn(this,function(V){switch(V.label){case 0:return o=this.config,u=o.limit,f=o.layers,v=o.countryCode,T=o.expandUnits,c=o.onRequest,z={query:r,limit:u,layers:f,countryCode:v,expandUnits:T},this.near&&(z.near=this.near),c&&c(z),[4,Ip.autocomplete(z)];case 1:return P=V.sent().addresses,[2,P]}})})},e.prototype.displayResults=function(r){var o=this;this.clearResultsList(),this.results=r;var u;if(this.config.showMarkers&&(u=document.createElement("img"),u.classList.add(mi.RESULTS_MARKER),u.setAttribute("src",Tg(this.config.markerColor))),r.forEach(function(P,V){var U=document.createElement("li");U.classList.add(mi.RESULTS_ITEM);var N;if(P.formattedAddress.includes(P.addressLabel)&&P.layer!=="postalCode"){var le=new RegExp("(".concat(P.addressLabel,"),?"));N=P.formattedAddress.replace(le,"<b>$1</b>")}else{var ie=P.placeLabel||P.addressLabel;N="<b>".concat(ie,"</b> ").concat(P.formattedAddress)}U.innerHTML=N,u&&U.prepend(u.cloneNode()),U.addEventListener("mousedown",function(){o.select(V)}),o.resultsList.appendChild(U)}),this.open(),r.length>0){var f=document.createElement("a");f.href="https://radar.com?ref=powered_by_radar",f.target="_blank",this.poweredByLink=f;var v=document.createElement("span");v.textContent="Powered by",f.appendChild(v);var T=document.createElement("span");T.id="radar-powered-logo",f.appendChild(T);var c=document.createElement("div");c.classList.add(mi.POWERED_BY_RADAR),c.appendChild(f),this.resultsList.appendChild(c)}else{var z=document.createElement("div");z.classList.add(mi.NO_RESULTS),z.textContent="No results",this.resultsList.appendChild(z)}},e.prototype.open=function(){this.isOpen||(this.wrapper.setAttribute(h1.EXPANDED,"true"),this.resultsList.removeAttribute("hidden"),this.isOpen=!0)},e.prototype.close=function(r){var o=this;if(this.isOpen){var u=r&&r.relatedTarget===this.poweredByLink;setTimeout(function(){o.wrapper.removeAttribute(h1.EXPANDED),o.resultsList.setAttribute("hidden",""),o.highlightedIndex=-1,o.isOpen=!1,o.clearResultsList()},u?100:0)}},e.prototype.goTo=function(r){if(!(!this.isOpen||!this.results.length)){r<0?r=this.results.length-1:r>=this.results.length&&(r=0);var o=this.resultsList.getElementsByTagName("li");this.highlightedIndex>-1&&o[this.highlightedIndex].classList.remove(mi.SELECTED_ITEM),o[r].classList.add(mi.SELECTED_ITEM),this.highlightedIndex=r}},e.prototype.handleKeyboardNavigation=function(r){var o=r.code!==void 0?r.code:r.keyCode;if(this.isOpen)switch(o){case"Tab":case"ArrowDown":case 40:r.preventDefault(),this.goTo(this.highlightedIndex+1);break;case"ArrowUp":case 38:r.preventDefault(),this.goTo(this.highlightedIndex-1);break;case"Enter":case 13:this.select(this.highlightedIndex);break;case"Esc":case 27:this.close();break}},e.prototype.select=function(r){var o=this.results[r];if(!o){un.warn("No autocomplete result found at index: ".concat(r));return}var u;if(o.formattedAddress.includes(o.addressLabel))u=o.formattedAddress;else{var f=o.placeLabel||o.addressLabel;u="".concat(f,", ").concat(o.formattedAddress)}this.inputField.value=u;var v=this.config.onSelection;v&&v(o),this.close()},e.prototype.clearResultsList=function(){this.resultsList.innerHTML="",this.results=[]},e.prototype.remove=function(){un.debug("AutocompleteUI removed."),this.inputField.remove(),this.resultsList.remove(),this.wrapper.remove()},e.prototype.setNear=function(r){return r==null?this.near=void 0:typeof r=="string"?this.near=r:this.near="".concat(r.latitude,",").concat(r.longitude),this},e.prototype.setPlaceholder=function(r){return this.config.placeholder=r,this.inputField.placeholder=r,this},e.prototype.setDisabled=function(r){return this.config.disabled=r,this.inputField.disabled=r,this},e.prototype.setResponsive=function(r){return this.config.responsive=r,Sg(this.wrapper,this.config),this},e.prototype.setWidth=function(r){return this.config.width=r,Sg(this.wrapper,this.config),this},e.prototype.setMaxHeight=function(r){return this.config.maxHeight=r,d1(this.resultsList,this.config),this},e.prototype.setMinCharacters=function(r){return this.config.minCharacters=r,this.config.threshold=r,this},e.prototype.setLimit=function(r){return this.config.limit=r,this},e.prototype.setShowMarkers=function(r){if(this.config.showMarkers=r,r){var o=document.createElement("img");o.classList.add(mi.RESULTS_MARKER),o.setAttribute("src",Tg(this.config.markerColor));for(var u=this.resultsList.getElementsByTagName("li"),f=0;f<u.length;f++){var v=u[f].getElementsByClassName(mi.RESULTS_MARKER)[0];v||u[f].prepend(o.cloneNode())}}else for(var u=this.resultsList.getElementsByTagName("li"),f=0;f<u.length;f++){var o=u[f].getElementsByClassName(mi.RESULTS_MARKER)[0];o&&o.remove()}return this},e.prototype.setMarkerColor=function(r){this.config.markerColor=r;for(var o=this.resultsList.getElementsByClassName(mi.RESULTS_MARKER),u=0;u<o.length;u++)o[u].setAttribute("src",Tg(r));return this},e.prototype.setHideResultsOnBlur=function(r){return this.config.hideResultsOnBlur=r,r?this.inputField.addEventListener("blur",this.close.bind(this),!0):this.inputField.removeEventListener("blur",this.close.bind(this),!0),this},e}(),VP=function(e){return e.includes("_sk_")},$P=function(e){return e.includes("_live_")},cp=function(){function e(){}return Object.defineProperty(e,"VERSION",{get:function(){return Mf},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ui",{get:function(){return{maplibregl:bg.getMapLibre(),map:bg.createMap,marker:bg.createMarker,autocomplete:UP.createAutocomplete}},enumerable:!1,configurable:!0}),e.initialize=function(r,o){if(o===void 0&&(o={}),!r)throw new Ry("Publishable key required in initialization.");if(VP(r))throw new Ry("Secret keys are not allowed. Please use your Radar publishable key.");var u=$P(r),f=u?"error":"info",v=!u,T=Object.assign(kn.defaultOptions,{publishableKey:r,live:u,logLevel:f,debug:v},o);kn.setup(T),un.info("initialized with ".concat(u?"live":"test"," publishableKey.")),o.debug&&un.info("using options: ".concat(JSON.stringify(o))),window!=null&&window.RADAR_TEST_ENV||a1.getConfig()},e.clear=function(){kn.clear()},e.setUserId=function(r){if(!r){ht.removeItem(ht.USER_ID);return}ht.setItem(ht.USER_ID,String(r).trim())},e.setDescription=function(r){if(!r){ht.removeItem(ht.DESCRIPTION);return}ht.setItem(ht.DESCRIPTION,String(r).trim())},e.setMetadata=function(r){if(!r){ht.removeItem(ht.METADATA);return}ht.setItem(ht.METADATA,JSON.stringify(r))},e.getLocation=function(){return Vs.getCurrentPosition()},e.trackOnce=function(r){r===void 0&&(r={});try{return RP.trackOnce(r)}finally{a1.getConfig(r)}},e.trackVerified=function(r){return r===void 0&&(r={}),u1.trackVerified(r)},e.trackVerifiedToken=function(r){return r===void 0&&(r={}),u1.trackVerified(r,!0)},e.getContext=function(r){return MP.getContext(r)},e.setTripOptions=function(r){Wo.setTripOptions(r)},e.clearTripOptions=function(){Wo.clearTripOptions()},e.getTripOptions=function(){return Wo.getTripOptions()},e.startTrip=function(r){return Wo.startTrip(r)},e.updateTrip=function(r){return Wo.updateTrip(r)},e.completeTrip=function(){return Wo.completeTrip()},e.cancelTrip=function(){return Wo.cancelTrip()},e.logConversion=function(r){return zP.logConversion(r)},e.forwardGeocode=function(r){return wg.forwardGeocode(r)},e.reverseGeocode=function(r){return wg.reverseGeocode(r)},e.ipGeocode=function(){return wg.ipGeocode()},e.autocomplete=function(r){return Ip.autocomplete(r)},e.searchGeofences=function(r){return Ip.searchGeofences(r)},e.searchPlaces=function(r){return Ip.searchPlaces(r)},e.validateAddress=function(r){return kP.validateAddress(r)},e.distance=function(r){return l1.distance(r)},e.matrix=function(r){return l1.matrix(r)},e}();var _i=function(){return _i=Object.assign||function(r){for(var o,u=1,f=arguments.length;u<f;u++){o=arguments[u];for(var v in o)Object.prototype.hasOwnProperty.call(o,v)&&(r[v]=o[v])}return r},_i.apply(this,arguments)};function rf(e,r,o){if(o||arguments.length===2)for(var u=0,f=r.length,v;u<f;u++)(v||!(u in r))&&(v||(v=Array.prototype.slice.call(r,0,u)),v[u]=r[u]);return e.concat(v||Array.prototype.slice.call(r))}var gn="-ms-",uh="-moz-",Wt="-webkit-",w2="comm",zf="rule",G_="decl",qP="@import",b2="@keyframes",GP="@layer",ZP=Math.abs,Z_=String.fromCharCode,Ly=Object.assign;function HP(e,r){return _r(e,0)^45?(((r<<2^_r(e,0))<<2^_r(e,1))<<2^_r(e,2))<<2^_r(e,3):0}function S2(e){return e.trim()}function ho(e,r){return(e=r.exec(e))?e[0]:e}function Ct(e,r,o){return e.replace(r,o)}function Cp(e,r){return e.indexOf(r)}function _r(e,r){return e.charCodeAt(r)|0}function Tc(e,r,o){return e.slice(r,o)}function Fs(e){return e.length}function T2(e){return e.length}function eh(e,r){return r.push(e),e}function WP(e,r){return e.map(r).join("")}function p1(e,r){return e.filter(function(o){return!ho(o,r)})}var Rf=1,Ec=1,E2=0,Ji=0,Xn=0,Rc="";function Df(e,r,o,u,f,v,T,c){return{value:e,root:r,parent:o,type:u,props:f,children:v,line:Rf,column:Ec,length:T,return:"",siblings:c}}function Ko(e,r){return Ly(Df("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},r)}function Hl(e){for(;e.root;)e=Ko(e.root,{children:[e]});eh(e,e.siblings)}function KP(){return Xn}function XP(){return Xn=Ji>0?_r(Rc,--Ji):0,Ec--,Xn===10&&(Ec=1,Rf--),Xn}function vs(){return Xn=Ji<E2?_r(Rc,Ji++):0,Ec++,Xn===10&&(Ec=1,Rf++),Xn}function Xa(){return _r(Rc,Ji)}function kp(){return Ji}function Lf(e,r){return Tc(Rc,e,r)}function Fy(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function YP(e){return Rf=Ec=1,E2=Fs(Rc=e),Ji=0,[]}function JP(e){return Rc="",e}function Eg(e){return S2(Lf(Ji-1,Oy(e===91?e+2:e===40?e+1:e)))}function QP(e){for(;(Xn=Xa())&&Xn<33;)vs();return Fy(e)>2||Fy(Xn)>3?"":" "}function eA(e,r){for(;--r&&vs()&&!(Xn<48||Xn>102||Xn>57&&Xn<65||Xn>70&&Xn<97););return Lf(e,kp()+(r<6&&Xa()==32&&vs()==32))}function Oy(e){for(;vs();)switch(Xn){case e:return Ji;case 34:case 39:e!==34&&e!==39&&Oy(Xn);break;case 40:e===41&&Oy(e);break;case 92:vs();break}return Ji}function tA(e,r){for(;vs()&&e+Xn!==47+10;)if(e+Xn===42+42&&Xa()===47)break;return"/*"+Lf(r,Ji-1)+"*"+Z_(e===47?e:vs())}function nA(e){for(;!Fy(Xa());)vs();return Lf(e,Ji)}function rA(e){return JP(Pp("",null,null,null,[""],e=YP(e),0,[0],e))}function Pp(e,r,o,u,f,v,T,c,z){for(var P=0,V=0,U=T,N=0,le=0,ie=0,ge=1,Me=1,X=1,Y=0,se="",xe=f,Ae=v,Fe=u,De=se;Me;)switch(ie=Y,Y=vs()){case 40:if(ie!=108&&_r(De,U-1)==58){Cp(De+=Ct(Eg(Y),"&","&\f"),"&\f")!=-1&&(X=-1);break}case 34:case 39:case 91:De+=Eg(Y);break;case 9:case 10:case 13:case 32:De+=QP(ie);break;case 92:De+=eA(kp()-1,7);continue;case 47:switch(Xa()){case 42:case 47:eh(iA(tA(vs(),kp()),r,o,z),z);break;default:De+="/"}break;case 123*ge:c[P++]=Fs(De)*X;case 125*ge:case 59:case 0:switch(Y){case 0:case 125:Me=0;case 59+V:X==-1&&(De=Ct(De,/\f/g,"")),le>0&&Fs(De)-U&&eh(le>32?m1(De+";",u,o,U-1,z):m1(Ct(De," ","")+";",u,o,U-2,z),z);break;case 59:De+=";";default:if(eh(Fe=f1(De,r,o,P,V,f,c,se,xe=[],Ae=[],U,v),v),Y===123)if(V===0)Pp(De,r,Fe,Fe,xe,v,U,c,Ae);else switch(N===99&&_r(De,3)===110?100:N){case 100:case 108:case 109:case 115:Pp(e,Fe,Fe,u&&eh(f1(e,Fe,Fe,0,0,f,c,se,f,xe=[],U,Ae),Ae),f,Ae,U,c,u?xe:Ae);break;default:Pp(De,Fe,Fe,Fe,[""],Ae,0,c,Ae)}}P=V=le=0,ge=X=1,se=De="",U=T;break;case 58:U=1+Fs(De),le=ie;default:if(ge<1){if(Y==123)--ge;else if(Y==125&&ge++==0&&XP()==125)continue}switch(De+=Z_(Y),Y*ge){case 38:X=V>0?1:(De+="\f",-1);break;case 44:c[P++]=(Fs(De)-1)*X,X=1;break;case 64:Xa()===45&&(De+=Eg(vs())),N=Xa(),V=U=Fs(se=De+=nA(kp())),Y++;break;case 45:ie===45&&Fs(De)==2&&(ge=0)}}return v}function f1(e,r,o,u,f,v,T,c,z,P,V,U){for(var N=f-1,le=f===0?v:[""],ie=T2(le),ge=0,Me=0,X=0;ge<u;++ge)for(var Y=0,se=Tc(e,N+1,N=ZP(Me=T[ge])),xe=e;Y<ie;++Y)(xe=S2(Me>0?le[Y]+" "+se:Ct(se,/&\f/g,le[Y])))&&(z[X++]=xe);return Df(e,r,o,f===0?zf:c,z,P,V,U)}function iA(e,r,o,u){return Df(e,r,o,w2,Z_(KP()),Tc(e,2,-2),0,u)}function m1(e,r,o,u,f){return Df(e,r,o,G_,Tc(e,0,u),Tc(e,u+1,-1),u,f)}function I2(e,r,o){switch(HP(e,r)){case 5103:return Wt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Wt+e+e;case 4789:return uh+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Wt+e+uh+e+gn+e+e;case 5936:switch(_r(e,r+11)){case 114:return Wt+e+gn+Ct(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Wt+e+gn+Ct(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Wt+e+gn+Ct(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return Wt+e+gn+e+e;case 6165:return Wt+e+gn+"flex-"+e+e;case 5187:return Wt+e+Ct(e,/(\w+).+(:[^]+)/,Wt+"box-$1$2"+gn+"flex-$1$2")+e;case 5443:return Wt+e+gn+"flex-item-"+Ct(e,/flex-|-self/g,"")+(ho(e,/flex-|baseline/)?"":gn+"grid-row-"+Ct(e,/flex-|-self/g,""))+e;case 4675:return Wt+e+gn+"flex-line-pack"+Ct(e,/align-content|flex-|-self/g,"")+e;case 5548:return Wt+e+gn+Ct(e,"shrink","negative")+e;case 5292:return Wt+e+gn+Ct(e,"basis","preferred-size")+e;case 6060:return Wt+"box-"+Ct(e,"-grow","")+Wt+e+gn+Ct(e,"grow","positive")+e;case 4554:return Wt+Ct(e,/([^-])(transform)/g,"$1"+Wt+"$2")+e;case 6187:return Ct(Ct(Ct(e,/(zoom-|grab)/,Wt+"$1"),/(image-set)/,Wt+"$1"),e,"")+e;case 5495:case 3959:return Ct(e,/(image-set\([^]*)/,Wt+"$1$`$1");case 4968:return Ct(Ct(e,/(.+:)(flex-)?(.*)/,Wt+"box-pack:$3"+gn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Wt+e+e;case 4200:if(!ho(e,/flex-|baseline/))return gn+"grid-column-align"+Tc(e,r)+e;break;case 2592:case 3360:return gn+Ct(e,"template-","")+e;case 4384:case 3616:return o&&o.some(function(u,f){return r=f,ho(u.props,/grid-\w+-end/)})?~Cp(e+(o=o[r].value),"span")?e:gn+Ct(e,"-start","")+e+gn+"grid-row-span:"+(~Cp(o,"span")?ho(o,/\d+/):+ho(o,/\d+/)-+ho(e,/\d+/))+";":gn+Ct(e,"-start","")+e;case 4896:case 4128:return o&&o.some(function(u){return ho(u.props,/grid-\w+-start/)})?e:gn+Ct(Ct(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Ct(e,/(.+)-inline(.+)/,Wt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Fs(e)-1-r>6)switch(_r(e,r+1)){case 109:if(_r(e,r+4)!==45)break;case 102:return Ct(e,/(.+:)(.+)-([^]+)/,"$1"+Wt+"$2-$3$1"+uh+(_r(e,r+3)==108?"$3":"$2-$3"))+e;case 115:return~Cp(e,"stretch")?I2(Ct(e,"stretch","fill-available"),r,o)+e:e}break;case 5152:case 5920:return Ct(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(u,f,v,T,c,z,P){return gn+f+":"+v+P+(T?gn+f+"-span:"+(c?z:+z-+v)+P:"")+e});case 4949:if(_r(e,r+6)===121)return Ct(e,":",":"+Wt)+e;break;case 6444:switch(_r(e,_r(e,14)===45?18:11)){case 120:return Ct(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Wt+(_r(e,14)===45?"inline-":"")+"box$3$1"+Wt+"$2$3$1"+gn+"$2box$3")+e;case 100:return Ct(e,":",":"+gn)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Ct(e,"scroll-","scroll-snap-")+e}return e}function sf(e,r){for(var o="",u=0;u<e.length;u++)o+=r(e[u],u,e,r)||"";return o}function sA(e,r,o,u){switch(e.type){case GP:if(e.children.length)break;case qP:case G_:return e.return=e.return||e.value;case w2:return"";case b2:return e.return=e.value+"{"+sf(e.children,u)+"}";case zf:if(!Fs(e.value=e.props.join(",")))return""}return Fs(o=sf(e.children,u))?e.return=e.value+"{"+o+"}":""}function oA(e){var r=T2(e);return function(o,u,f,v){for(var T="",c=0;c<r;c++)T+=e[c](o,u,f,v)||"";return T}}function aA(e){return function(r){r.root||(r=r.return)&&e(r)}}function lA(e,r,o,u){if(e.length>-1&&!e.return)switch(e.type){case G_:e.return=I2(e.value,e.length,o);return;case b2:return sf([Ko(e,{value:Ct(e.value,"@","@"+Wt)})],u);case zf:if(e.length)return WP(o=e.props,function(f){switch(ho(f,u=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Hl(Ko(e,{props:[Ct(f,/:(read-\w+)/,":"+uh+"$1")]})),Hl(Ko(e,{props:[f]})),Ly(e,{props:p1(o,u)});break;case"::placeholder":Hl(Ko(e,{props:[Ct(f,/:(plac\w+)/,":"+Wt+"input-$1")]})),Hl(Ko(e,{props:[Ct(f,/:(plac\w+)/,":"+uh+"$1")]})),Hl(Ko(e,{props:[Ct(f,/:(plac\w+)/,gn+"input-$1")]})),Hl(Ko(e,{props:[f]})),Ly(e,{props:p1(o,u)});break}return""})}}var cA={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ic=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",H_=typeof window<"u"&&"HTMLElement"in window,uA=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY),Ff=Object.freeze([]),Cc=Object.freeze({});function hA(e,r,o){return o===void 0&&(o=Cc),e.theme!==o.theme&&e.theme||r||o.theme}var C2=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),dA=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,pA=/(^-|-$)/g;function g1(e){return e.replace(dA,"-").replace(pA,"")}var fA=/(a)(d)/gi,y1=function(e){return String.fromCharCode(e+(e>25?39:97))};function By(e){var r,o="";for(r=Math.abs(e);r>52;r=r/52|0)o=y1(r%52)+o;return(y1(r%52)+o).replace(fA,"$1-$2")}var Ig,ac=function(e,r){for(var o=r.length;o;)e=33*e^r.charCodeAt(--o);return e},k2=function(e){return ac(5381,e)};function mA(e){return By(k2(e)>>>0)}function gA(e){return e.displayName||e.name||"Component"}function Cg(e){return typeof e=="string"&&!0}var P2=typeof Symbol=="function"&&Symbol.for,A2=P2?Symbol.for("react.memo"):60115,yA=P2?Symbol.for("react.forward_ref"):60112,_A={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},vA={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},M2={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},xA=((Ig={})[yA]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ig[A2]=M2,Ig);function _1(e){return("type"in(r=e)&&r.type.$$typeof)===A2?M2:"$$typeof"in e?xA[e.$$typeof]:_A;var r}var wA=Object.defineProperty,bA=Object.getOwnPropertyNames,v1=Object.getOwnPropertySymbols,SA=Object.getOwnPropertyDescriptor,TA=Object.getPrototypeOf,x1=Object.prototype;function z2(e,r,o){if(typeof r!="string"){if(x1){var u=TA(r);u&&u!==x1&&z2(e,u,o)}var f=bA(r);v1&&(f=f.concat(v1(r)));for(var v=_1(e),T=_1(r),c=0;c<f.length;++c){var z=f[c];if(!(z in vA||o&&o[z]||T&&z in T||v&&z in v)){var P=SA(r,z);try{wA(e,z,P)}catch{}}}}return e}function kc(e){return typeof e=="function"}function W_(e){return typeof e=="object"&&"styledComponentId"in e}function Ha(e,r){return e&&r?"".concat(e," ").concat(r):e||r||""}function w1(e,r){if(e.length===0)return"";for(var o=e[0],u=1;u<e.length;u++)o+=r?r+e[u]:e[u];return o}function Ph(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function Ny(e,r,o){if(o===void 0&&(o=!1),!o&&!Ph(e)&&!Array.isArray(e))return r;if(Array.isArray(r))for(var u=0;u<r.length;u++)e[u]=Ny(e[u],r[u]);else if(Ph(r))for(var u in r)e[u]=Ny(e[u],r[u]);return e}function K_(e,r){Object.defineProperty(e,"toString",{value:r})}function Oh(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(r.length>0?" Args: ".concat(r.join(", ")):""))}var EA=function(){function e(r){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=r}return e.prototype.indexOfGroup=function(r){for(var o=0,u=0;u<r;u++)o+=this.groupSizes[u];return o},e.prototype.insertRules=function(r,o){if(r>=this.groupSizes.length){for(var u=this.groupSizes,f=u.length,v=f;r>=v;)if((v<<=1)<0)throw Oh(16,"".concat(r));this.groupSizes=new Uint32Array(v),this.groupSizes.set(u),this.length=v;for(var T=f;T<v;T++)this.groupSizes[T]=0}for(var c=this.indexOfGroup(r+1),z=(T=0,o.length);T<z;T++)this.tag.insertRule(c,o[T])&&(this.groupSizes[r]++,c++)},e.prototype.clearGroup=function(r){if(r<this.length){var o=this.groupSizes[r],u=this.indexOfGroup(r),f=u+o;this.groupSizes[r]=0;for(var v=u;v<f;v++)this.tag.deleteRule(u)}},e.prototype.getGroup=function(r){var o="";if(r>=this.length||this.groupSizes[r]===0)return o;for(var u=this.groupSizes[r],f=this.indexOfGroup(r),v=f+u,T=f;T<v;T++)o+="".concat(this.tag.getRule(T)).concat(`/*!sc*/
`);return o},e}(),Ap=new Map,of=new Map,kg=1,up=function(e){if(Ap.has(e))return Ap.get(e);for(;of.has(kg);)kg++;var r=kg++;return Ap.set(e,r),of.set(r,e),r},IA=function(e,r){Ap.set(e,r),of.set(r,e)},CA="style[".concat(Ic,"][").concat("data-styled-version",'="').concat("6.1.0",'"]'),kA=new RegExp("^".concat(Ic,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),PA=function(e,r,o){for(var u,f=o.split(","),v=0,T=f.length;v<T;v++)(u=f[v])&&e.registerName(r,u)},AA=function(e,r){for(var o,u=((o=r.textContent)!==null&&o!==void 0?o:"").split(`/*!sc*/
`),f=[],v=0,T=u.length;v<T;v++){var c=u[v].trim();if(c){var z=c.match(kA);if(z){var P=0|parseInt(z[1],10),V=z[2];P!==0&&(IA(V,P),PA(e,V,z[3]),e.getTag().insertRules(P,f)),f.length=0}else f.push(c)}}};function MA(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var R2=function(e){var r=document.head,o=e||r,u=document.createElement("style"),f=function(c){var z=Array.from(c.querySelectorAll("style[".concat(Ic,"]")));return z[z.length-1]}(o),v=f!==void 0?f.nextSibling:null;u.setAttribute(Ic,"active"),u.setAttribute("data-styled-version","6.1.0");var T=MA();return T&&u.setAttribute("nonce",T),o.insertBefore(u,v),u},zA=function(){function e(r){this.element=R2(r),this.element.appendChild(document.createTextNode("")),this.sheet=function(o){if(o.sheet)return o.sheet;for(var u=document.styleSheets,f=0,v=u.length;f<v;f++){var T=u[f];if(T.ownerNode===o)return T}throw Oh(17)}(this.element),this.length=0}return e.prototype.insertRule=function(r,o){try{return this.sheet.insertRule(o,r),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(r){this.sheet.deleteRule(r),this.length--},e.prototype.getRule=function(r){var o=this.sheet.cssRules[r];return o&&o.cssText?o.cssText:""},e}(),RA=function(){function e(r){this.element=R2(r),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(r,o){if(r<=this.length&&r>=0){var u=document.createTextNode(o);return this.element.insertBefore(u,this.nodes[r]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(r){this.element.removeChild(this.nodes[r]),this.length--},e.prototype.getRule=function(r){return r<this.length?this.nodes[r].textContent:""},e}(),DA=function(){function e(r){this.rules=[],this.length=0}return e.prototype.insertRule=function(r,o){return r<=this.length&&(this.rules.splice(r,0,o),this.length++,!0)},e.prototype.deleteRule=function(r){this.rules.splice(r,1),this.length--},e.prototype.getRule=function(r){return r<this.length?this.rules[r]:""},e}(),b1=H_,LA={isServer:!H_,useCSSOMInjection:!uA},D2=function(){function e(r,o,u){r===void 0&&(r=Cc),o===void 0&&(o={});var f=this;this.options=_i(_i({},LA),r),this.gs=o,this.names=new Map(u),this.server=!!r.isServer,!this.server&&H_&&b1&&(b1=!1,function(v){for(var T=document.querySelectorAll(CA),c=0,z=T.length;c<z;c++){var P=T[c];P&&P.getAttribute(Ic)!=="active"&&(AA(v,P),P.parentNode&&P.parentNode.removeChild(P))}}(this)),K_(this,function(){return function(v){for(var T=v.getTag(),c=T.length,z="",P=function(U){var N=function(X){return of.get(X)}(U);if(N===void 0)return"continue";var le=v.names.get(N),ie=T.getGroup(U);if(le===void 0||ie.length===0)return"continue";var ge="".concat(Ic,".g").concat(U,'[id="').concat(N,'"]'),Me="";le!==void 0&&le.forEach(function(X){X.length>0&&(Me+="".concat(X,","))}),z+="".concat(ie).concat(ge,'{content:"').concat(Me,'"}').concat(`/*!sc*/
`)},V=0;V<c;V++)P(V);return z}(f)})}return e.registerId=function(r){return up(r)},e.prototype.reconstructWithOptions=function(r,o){return o===void 0&&(o=!0),new e(_i(_i({},this.options),r),this.gs,o&&this.names||void 0)},e.prototype.allocateGSInstance=function(r){return this.gs[r]=(this.gs[r]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(r=function(o){var u=o.useCSSOMInjection,f=o.target;return o.isServer?new DA(f):u?new zA(f):new RA(f)}(this.options),new EA(r)));var r},e.prototype.hasNameForId=function(r,o){return this.names.has(r)&&this.names.get(r).has(o)},e.prototype.registerName=function(r,o){if(up(r),this.names.has(r))this.names.get(r).add(o);else{var u=new Set;u.add(o),this.names.set(r,u)}},e.prototype.insertRules=function(r,o,u){this.registerName(r,o),this.getTag().insertRules(up(r),u)},e.prototype.clearNames=function(r){this.names.has(r)&&this.names.get(r).clear()},e.prototype.clearRules=function(r){this.getTag().clearGroup(up(r)),this.clearNames(r)},e.prototype.clearTag=function(){this.tag=void 0},e}(),FA=/&/g,OA=/^\s*\/\/.*$/gm;function L2(e,r){return e.map(function(o){return o.type==="rule"&&(o.value="".concat(r," ").concat(o.value),o.value=o.value.replaceAll(",",",".concat(r," ")),o.props=o.props.map(function(u){return"".concat(r," ").concat(u)})),Array.isArray(o.children)&&o.type!=="@keyframes"&&(o.children=L2(o.children,r)),o})}function BA(e){var r,o,u,f=e===void 0?Cc:e,v=f.options,T=v===void 0?Cc:v,c=f.plugins,z=c===void 0?Ff:c,P=function(N,le,ie){return ie===o||ie.startsWith(o)&&ie.endsWith(o)&&ie.replaceAll(o,"").length>0?".".concat(r):N},V=z.slice();V.push(function(N){N.type===zf&&N.value.includes("&")&&(N.props[0]=N.props[0].replace(FA,o).replace(u,P))}),T.prefix&&V.push(lA),V.push(sA);var U=function(N,le,ie,ge){le===void 0&&(le=""),ie===void 0&&(ie=""),ge===void 0&&(ge="&"),r=ge,o=le,u=new RegExp("\\".concat(o,"\\b"),"g");var Me=N.replace(OA,""),X=rA(ie||le?"".concat(ie," ").concat(le," { ").concat(Me," }"):Me);T.namespace&&(X=L2(X,T.namespace));var Y=[];return sf(X,oA(V.concat(aA(function(se){return Y.push(se)})))),Y};return U.hash=z.length?z.reduce(function(N,le){return le.name||Oh(15),ac(N,le.name)},5381).toString():"",U}var NA=new D2,jy=BA(),F2=Ja.createContext({shouldForwardProp:void 0,styleSheet:NA,stylis:jy});F2.Consumer;Ja.createContext(void 0);function S1(){return lt.useContext(F2)}var jA=function(){function e(r,o){var u=this;this.inject=function(f,v){v===void 0&&(v=jy);var T=u.name+v.hash;f.hasNameForId(u.id,T)||f.insertRules(u.id,T,v(u.rules,T,"@keyframes"))},this.name=r,this.id="sc-keyframes-".concat(r),this.rules=o,K_(this,function(){throw Oh(12,String(u.name))})}return e.prototype.getName=function(r){return r===void 0&&(r=jy),this.name+r.hash},e}(),UA=function(e){return e>="A"&&e<="Z"};function T1(e){for(var r="",o=0;o<e.length;o++){var u=e[o];if(o===1&&u==="-"&&e[0]==="-")return e;UA(u)?r+="-"+u.toLowerCase():r+=u}return r.startsWith("ms-")?"-"+r:r}var O2=function(e){return e==null||e===!1||e===""},B2=function(e){var r,o,u=[];for(var f in e){var v=e[f];e.hasOwnProperty(f)&&!O2(v)&&(Array.isArray(v)&&v.isCss||kc(v)?u.push("".concat(T1(f),":"),v,";"):Ph(v)?u.push.apply(u,rf(rf(["".concat(f," {")],B2(v),!1),["}"],!1)):u.push("".concat(T1(f),": ").concat((r=f,(o=v)==null||typeof o=="boolean"||o===""?"":typeof o!="number"||o===0||r in cA||r.startsWith("--")?String(o).trim():"".concat(o,"px")),";")))}return u};function Ya(e,r,o,u){if(O2(e))return[];if(W_(e))return[".".concat(e.styledComponentId)];if(kc(e)){if(!kc(v=e)||v.prototype&&v.prototype.isReactComponent||!r)return[e];var f=e(r);return Ya(f,r,o,u)}var v;return e instanceof jA?o?(e.inject(o,u),[e.getName(u)]):[e]:Ph(e)?B2(e):Array.isArray(e)?Array.prototype.concat.apply(Ff,e.map(function(T){return Ya(T,r,o,u)})):[e.toString()]}function VA(e){for(var r=0;r<e.length;r+=1){var o=e[r];if(kc(o)&&!W_(o))return!1}return!0}var $A=k2("6.1.0"),qA=function(){function e(r,o,u){this.rules=r,this.staticRulesId="",this.isStatic=(u===void 0||u.isStatic)&&VA(r),this.componentId=o,this.baseHash=ac($A,o),this.baseStyle=u,D2.registerId(o)}return e.prototype.generateAndInjectStyles=function(r,o,u){var f=this.baseStyle?this.baseStyle.generateAndInjectStyles(r,o,u):"";if(this.isStatic&&!u.hash)if(this.staticRulesId&&o.hasNameForId(this.componentId,this.staticRulesId))f=Ha(f,this.staticRulesId);else{var v=w1(Ya(this.rules,r,o,u)),T=By(ac(this.baseHash,v)>>>0);if(!o.hasNameForId(this.componentId,T)){var c=u(v,".".concat(T),void 0,this.componentId);o.insertRules(this.componentId,T,c)}f=Ha(f,T),this.staticRulesId=T}else{for(var z=ac(this.baseHash,u.hash),P="",V=0;V<this.rules.length;V++){var U=this.rules[V];if(typeof U=="string")P+=U;else if(U){var N=w1(Ya(U,r,o,u));z=ac(z,N+V),P+=N}}if(P){var le=By(z>>>0);o.hasNameForId(this.componentId,le)||o.insertRules(this.componentId,le,u(P,".".concat(le),void 0,this.componentId)),f=Ha(f,le)}}return f},e}(),N2=Ja.createContext(void 0);N2.Consumer;var Pg={};function GA(e,r,o){var u=W_(e),f=e,v=!Cg(e),T=r.attrs,c=T===void 0?Ff:T,z=r.componentId,P=z===void 0?function(se,xe){var Ae=typeof se!="string"?"sc":g1(se);Pg[Ae]=(Pg[Ae]||0)+1;var Fe="".concat(Ae,"-").concat(mA("6.1.0"+Ae+Pg[Ae]));return xe?"".concat(xe,"-").concat(Fe):Fe}(r.displayName,r.parentComponentId):z,V=r.displayName;V===void 0&&function(se){return Cg(se)?"styled.".concat(se):"Styled(".concat(gA(se),")")}(e);var U=r.displayName&&r.componentId?"".concat(g1(r.displayName),"-").concat(r.componentId):r.componentId||P,N=u&&f.attrs?f.attrs.concat(c).filter(Boolean):c,le=r.shouldForwardProp;if(u&&f.shouldForwardProp){var ie=f.shouldForwardProp;if(r.shouldForwardProp){var ge=r.shouldForwardProp;le=function(se,xe){return ie(se,xe)&&ge(se,xe)}}else le=ie}var Me=new qA(o,U,u?f.componentStyle:void 0);function X(se,xe){return function(Ae,Fe,De){var qe=Ae.attrs,Gt=Ae.componentStyle,it=Ae.defaultProps,An=Ae.foldedComponentIds,Nn=Ae.styledComponentId,lr=Ae.target,Mn=Ja.useContext(N2),Qn=S1(),er=Ae.shouldForwardProp||Qn.shouldForwardProp,tn=function(Pt,Zt,cr){for(var zn,jn=_i(_i({},Zt),{className:void 0,theme:cr}),si=0;si<Pt.length;si+=1){var ur=kc(zn=Pt[si])?zn(jn):zn;for(var bn in ur)jn[bn]=bn==="className"?Ha(jn[bn],ur[bn]):bn==="style"?_i(_i({},jn[bn]),ur[bn]):ur[bn]}return Zt.className&&(jn.className=Ha(jn.className,Zt.className)),jn}(qe,Fe,hA(Fe,Mn,it)||Cc),We=tn.as||lr,dt={};for(var pt in tn)tn[pt]===void 0||pt[0]==="$"||pt==="as"||pt==="theme"||(pt==="forwardedAs"?dt.as=tn.forwardedAs:er&&!er(pt,We)||(dt[pt]=tn[pt]));var jt=function(Pt,Zt){var cr=S1(),zn=Pt.generateAndInjectStyles(Zt,cr.styleSheet,cr.stylis);return zn}(Gt,tn),Rt=Ha(An,Nn);return jt&&(Rt+=" "+jt),tn.className&&(Rt+=" "+tn.className),dt[Cg(We)&&!C2.has(We)?"class":"className"]=Rt,dt.ref=De,lt.createElement(We,dt)}(Y,se,xe)}var Y=Ja.forwardRef(X);return Y.attrs=N,Y.componentStyle=Me,Y.shouldForwardProp=le,Y.foldedComponentIds=u?Ha(f.foldedComponentIds,f.styledComponentId):"",Y.styledComponentId=U,Y.target=u?f.target:e,Object.defineProperty(Y,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(se){this._foldedDefaultProps=u?function(xe){for(var Ae=[],Fe=1;Fe<arguments.length;Fe++)Ae[Fe-1]=arguments[Fe];for(var De=0,qe=Ae;De<qe.length;De++)Ny(xe,qe[De],!0);return xe}({},f.defaultProps,se):se}}),K_(Y,function(){return".".concat(Y.styledComponentId)}),v&&z2(Y,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),Y}function E1(e,r){for(var o=[e[0]],u=0,f=r.length;u<f;u+=1)o.push(r[u],e[u+1]);return o}var I1=function(e){return Object.assign(e,{isCss:!0})};function ZA(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(kc(e)||Ph(e)){var u=e;return I1(Ya(E1(Ff,rf([u],r,!0))))}var f=e;return r.length===0&&f.length===1&&typeof f[0]=="string"?Ya(f):I1(Ya(E1(f,r)))}function Uy(e,r,o){if(o===void 0&&(o=Cc),!r)throw Oh(1,r);var u=function(f){for(var v=[],T=1;T<arguments.length;T++)v[T-1]=arguments[T];return e(r,o,ZA.apply(void 0,rf([f],v,!1)))};return u.attrs=function(f){return Uy(e,r,_i(_i({},o),{attrs:Array.prototype.concat(o.attrs,f).filter(Boolean)}))},u.withConfig=function(f){return Uy(e,r,_i(_i({},o),f))},u}var j2=function(e){return Uy(GA,e)},U2=j2;C2.forEach(function(e){U2[e]=j2(e)});function HA(){const[e,r]=lt.useState([]),[o,u]=lt.useState([]),[f]=lt.useState({}),v=()=>{Us.get("http://localhost:3000/parks_lists.json").then(N=>{console.log(N.data),r(N.data)}).catch(N=>{console.error("Error fetching data from the server:",N)})},T=N=>{Us.delete(`http://localhost:3000/parks_lists/${N}.json`).then(le=>{console.log(le.data),u([...o,le.data])})};lt.useEffect(v,[]);const[c,z]=lt.useState(null);lt.useEffect(()=>{c&&e.length>0&&V()},[c,e]),lt.useEffect(()=>{navigator.geolocation.getCurrentPosition(P)},[]);const P=N=>{console.log(N),z(N.coords)},V=()=>{const N="https://api.radar.io/v1/route/matrix?origins=40.78382,-73.97536&destinations=40.70390,-73.98690|40.73237,-73.94884&mode=car&units=imperial";Us.get(N,{headers:{Authorization:"prj_live_pk_de82543ab49a7a7b86fc1d55c635cf2af48357e3"}}).then(le=>{console.log(le.data)})};lt.useEffect(()=>{if(c){cp.initialize("prj_live_pk_de82543ab49a7a7b86fc1d55c635cf2af48357e3");const N=new cp.ui.map({container:"map",style:"radar-light-v1",center:[c.longitude,c.latitude],zoom:4});cp.ui.marker({text:"Home"}).setLngLat([c.longitude,c.latitude]).addTo(N);const le=[];e.forEach(ie=>{le.push({name:ie.name,lngLat:[ie.longitude,ie.latitude]})}),le.forEach(ie=>{cp.ui.marker({text:ie.name}).setLngLat(ie.lngLat).addTo(N)})}},[c,e]);const U=U2.div`
    height: 74vh;
    width: 100%;
    overflow-y: scroll;
  `;return ce.jsx("div",{className:"myparks-page",children:ce.jsxs("div",{className:"myparks",children:[ce.jsx("h1",{className:"nationalp",children:"MY NATIONAL PARKS"}),ce.jsx("div",{className:"mapview",children:ce.jsx("div",{id:"map-container",style:{height:"700px",position:"absolute",width:"50%"},children:ce.jsx("div",{id:"map",style:{height:"100%",position:"absolute",width:"100%"}})})}),ce.jsx("div",{className:"mymaps",children:ce.jsxs(U,{children:[ce.jsx("h4",{className:"mylistname",children:"MY PARKS"}),e.map(N=>ce.jsxs("div",{children:[ce.jsxs("span",{children:[ce.jsxs("div",{className:"list",children:[ce.jsx("img",{className:"image",src:"https://www.pngkit.com/png/full/14-146161_white-location-icon-png-location-logo-png-white.png",width:"30",height:"40"}),N.name.toUpperCase()]}),ce.jsxs("ul",{className:"list-info",children:[ce.jsxs("p",{children:["Total campsites - ",N.totalsites]}),ce.jsxs("p",{children:["Entry Fee - ",N.fees]}),f[N.id]&&ce.jsxs("div",{children:[ce.jsx("p",{children:"Directions:"}),ce.jsx("ul",{children:f[N.id].matrix.map((le,ie)=>ce.jsx("li",{children:`Distance: ${le.distance.text}, Duration: ${le.duration.text}`},ie))})]}),ce.jsx("a",{href:N.url,children:"Park Website"})]}),ce.jsx("button",{className:"button3",type:"button",onClick:()=>T(N.id),children:ce.jsx("div",{className:"remove",children:"REMOVE"})})]}),ce.jsx("hr",{})]},N.id))]})}),ce.jsx("div",{className:"summary",children:e.map(N=>ce.jsxs("div",{className:"parksummary",children:[ce.jsxs("div",{children:[ce.jsxs("span",{children:[ce.jsx("h2",{className:"park-name",children:N.name.toUpperCase()}),N.city!=="f"?ce.jsx("h2",{className:"city-name",children:N.city.toUpperCase()}):null]}),ce.jsx("div",{className:"parkinfo-background",children:ce.jsxs("div",{className:"row",children:[ce.jsx("div",{className:"col",children:ce.jsxs("div",{className:"campsites",children:[ce.jsxs("span",{children:[ce.jsx("h6",{children:"Total Campsites"}),N.totalsites]}),ce.jsxs("span",{children:[ce.jsx("h6",{children:"First Come First Serve"}),N.firstcome]}),ce.jsxs("span",{children:[ce.jsx("h6",{children:"Reservable"}),N.reservable]})]})}),ce.jsx("div",{className:"col",children:ce.jsxs("div",{className:"ratinginfo",children:[ce.jsx("h5",{children:"Site Info"}),ce.jsx("div",{children:ce.jsxs("p",{children:["Entry Fee - ",N.fees]})}),ce.jsxs("p",{children:["Showers - ",N.showers]}),ce.jsxs("p",{children:["Toilets - ",N.toilets]}),ce.jsxs("p",{children:["Phone Reception - ",N.phone]}),ce.jsx("a",{href:N.url,children:N.url})]})}),ce.jsx("div",{className:"col",children:ce.jsx("div",{className:"parkinfo",children:ce.jsxs("span",{children:[ce.jsx("h5",{children:"Description"}),N.description]})})})]})})]}),ce.jsx("button",{className:"button2",type:"button",onClick:()=>T(N.id),children:"REMOVE"})]},N.id))})]})})}function WA(){return ce.jsx("div",{className:"body",children:ce.jsxs(hP,{children:[ce.jsx(Ck,{}),ce.jsxs(m2,{children:[ce.jsx(oc,{path:"*",element:ce.jsx(pP,{})}),ce.jsx(oc,{path:"/signup",element:ce.jsx(fP,{})}),ce.jsx(oc,{path:"/nationalparks",element:ce.jsx(mP,{})}),ce.jsx(oc,{path:"/myparks",element:ce.jsx(HA,{})})]})]})})}Ag.createRoot(document.getElementById("root")).render(ce.jsx(Ja.StrictMode,{children:ce.jsx(WA,{})}));
